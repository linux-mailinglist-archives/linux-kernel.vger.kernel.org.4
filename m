Return-Path: <linux-kernel-owner@vger.kernel.org>
X-Original-To: lists+linux-kernel@lfdr.de
Delivered-To: lists+linux-kernel@lfdr.de
Received: from out1.vger.email (out1.vger.email [IPv6:2620:137:e000::1:20])
	by mail.lfdr.de (Postfix) with ESMTP id 4F8976A63C7
	for <lists+linux-kernel@lfdr.de>; Wed,  1 Mar 2023 00:24:22 +0100 (CET)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S229691AbjB1XYU (ORCPT <rfc822;lists+linux-kernel@lfdr.de>);
        Tue, 28 Feb 2023 18:24:20 -0500
Received: from lindbergh.monkeyblade.net ([23.128.96.19]:45592 "EHLO
        lindbergh.monkeyblade.net" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S229492AbjB1XYS (ORCPT
        <rfc822;linux-kernel@vger.kernel.org>);
        Tue, 28 Feb 2023 18:24:18 -0500
Received: from dfw.source.kernel.org (dfw.source.kernel.org [139.178.84.217])
        by lindbergh.monkeyblade.net (Postfix) with ESMTPS id 1B40723331
        for <linux-kernel@vger.kernel.org>; Tue, 28 Feb 2023 15:24:18 -0800 (PST)
Received: from smtp.kernel.org (relay.kernel.org [52.25.139.140])
        (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
        (No client certificate requested)
        by dfw.source.kernel.org (Postfix) with ESMTPS id 96B2861200
        for <linux-kernel@vger.kernel.org>; Tue, 28 Feb 2023 23:24:17 +0000 (UTC)
Received: by smtp.kernel.org (Postfix) with ESMTPSA id 06565C433D2;
        Tue, 28 Feb 2023 23:24:17 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=kernel.org;
        s=k20201202; t=1677626657;
        bh=FlFjMaHBoVnlyFlLboRW0rfUjjVpER/mA1opjr1XSOQ=;
        h=Date:From:To:Cc:Subject:In-Reply-To:References:From;
        b=vCGcIE8B91crNBUMZCUHUnPupKfi3dKpf5e0DFD2zrl8EVEq7gCW2GYlPpV3v6RMv
         nO5S30rxdmE8UoloS4xonxiDvag24VQ/i9DKZpto6m5FFRxcOxMNzmL3tXoPNSdU2l
         gi+CBYwF1esv/xF26/jbd6SVEXs1y1MsV/AKNF73cZfviWvKqb66wsj3/YpuiAeoFG
         7N6IkFk7c/DYYTF70AjZAU0qAp8u6o6VMSAvFVUbxgvugNNaRXgHIj8HY/FI6HwTBK
         T0kWAFcf+SaTHg4G3zc2Tqn/+XW7fR14x2p0xZKFmtAtjRcVHY6UU7r3AXBn1G6inT
         2ELQk4zq4FcZA==
Received: from sofa.misterjones.org ([185.219.108.64] helo=goblin-girl.misterjones.org)
        by disco-boy.misterjones.org with esmtpsa  (TLS1.3) tls TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
        (Exim 4.95)
        (envelope-from <maz@kernel.org>)
        id 1pX9KQ-00Dy0j-Em;
        Tue, 28 Feb 2023 23:24:14 +0000
Date:   Tue, 28 Feb 2023 23:22:57 +0000
Message-ID: <86lekhl6i6.wl-maz@kernel.org>
From:   Marc Zyngier <maz@kernel.org>
To:     Tim Harvey <tharvey@gateworks.com>
Cc:     Robin Murphy <robin.murphy@arm.com>,
        Ulf Hansson <ulf.hansson@linaro.org>,
        Al Cooper <alcooperx@gmail.com>,
        Adrian Hunter <adrian.hunter@intel.com>, tglx@linutronix.de,
        linux-arm-kernel@lists.infradead.org, linux-kernel@vger.kernel.org
Subject: Re: [RFC PATCH] irqchip/gic-v3: Claim iomem resources
In-Reply-To: <CAJ+vNU3+rz50MRQQsz39Jfbspy2ig9tqzb_yg1RFooxGutCM+g@mail.gmail.com>
References: <c534c2a458a3bf94ccdae8abc6edc3d45a689c30.1649777295.git.robin.murphy@arm.com>
        <CAJ+vNU3+rz50MRQQsz39Jfbspy2ig9tqzb_yg1RFooxGutCM+g@mail.gmail.com>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) SEMI-EPG/1.14.7 (Harue)
 FLIM-LB/1.14.9 (=?UTF-8?B?R29qxY0=?=) APEL-LB/10.8 EasyPG/1.0.0 Emacs/28.2
 (aarch64-unknown-linux-gnu) MULE/6.0 (HANACHIRUSATO)
MIME-Version: 1.0 (generated by SEMI-EPG 1.14.7 - "Harue")
Content-Type: text/plain; charset=US-ASCII
X-SA-Exim-Connect-IP: 185.219.108.64
X-SA-Exim-Rcpt-To: tharvey@gateworks.com, robin.murphy@arm.com, ulf.hansson@linaro.org, alcooperx@gmail.com, adrian.hunter@intel.com, tglx@linutronix.de, linux-arm-kernel@lists.infradead.org, linux-kernel@vger.kernel.org
X-SA-Exim-Mail-From: maz@kernel.org
X-SA-Exim-Scanned: No (on disco-boy.misterjones.org); SAEximRunCond expanded to false
X-Spam-Status: No, score=-7.1 required=5.0 tests=BAYES_00,DKIMWL_WL_HIGH,
        DKIM_SIGNED,DKIM_VALID,DKIM_VALID_AU,DKIM_VALID_EF,RCVD_IN_DNSWL_HI,
        SPF_HELO_NONE,SPF_PASS autolearn=ham autolearn_force=no version=3.4.6
X-Spam-Checker-Version: SpamAssassin 3.4.6 (2021-04-09) on
        lindbergh.monkeyblade.net
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

On Tue, 28 Feb 2023 23:11:15 +0000,
Tim Harvey <tharvey@gateworks.com> wrote:
> 
> I have bisected a kernel issue where octeontx (CN803x) will hang on
> reboot caused by commit c0db06fd0993 ("mmc: core: Disable card detect
> during shutdown"). This commit made it into 5.16 and stable kernels.
> I've found that the patch here which is commit 2b2cd74a06c3 resolves
> this hang but I'm not entirely clear why.
> 
> Does anyone have a good explanation of why the hang occurs in the
> first place and why this resolves it? I would like to get the proper
> fix into the affected stable branches.

Wild guess: the reservation prevents some other driver from probing
because the firmware describes overlapping ranges, and that driver is
what is causing your above hang.

But you don't give much information that would allow this theory to be
checked. I guess you'll have to instrument your kernel and find out.

	M.

-- 
Without deviation from the norm, progress is not possible.
