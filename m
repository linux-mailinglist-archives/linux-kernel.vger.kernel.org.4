Return-Path: <linux-kernel-owner@vger.kernel.org>
X-Original-To: lists+linux-kernel@lfdr.de
Delivered-To: lists+linux-kernel@lfdr.de
Received: from out1.vger.email (out1.vger.email [IPv6:2620:137:e000::1:20])
	by mail.lfdr.de (Postfix) with ESMTP id B61C26E0041
	for <lists+linux-kernel@lfdr.de>; Wed, 12 Apr 2023 22:58:05 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S230056AbjDLU6D (ORCPT <rfc822;lists+linux-kernel@lfdr.de>);
        Wed, 12 Apr 2023 16:58:03 -0400
Received: from lindbergh.monkeyblade.net ([23.128.96.19]:34632 "EHLO
        lindbergh.monkeyblade.net" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S229817AbjDLU57 (ORCPT
        <rfc822;linux-kernel@vger.kernel.org>);
        Wed, 12 Apr 2023 16:57:59 -0400
Received: from smtpout.efficios.com (unknown [IPv6:2607:5300:203:b2ee::31e5])
        by lindbergh.monkeyblade.net (Postfix) with ESMTPS id 5C0BF7284
        for <linux-kernel@vger.kernel.org>; Wed, 12 Apr 2023 13:57:51 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=efficios.com;
        s=smtpout1; t=1681333070;
        bh=HIHfcU1F/lw5ZWop4GelVKzsddKOI9fKwOU1x+IpQ+E=;
        h=Date:Subject:To:Cc:References:From:In-Reply-To:From;
        b=qM334WKNze6qi0X1mtjfVzcskZfZRGA2w5M2Bp/ALFwULAP1lV/uiiAni+njemXLe
         Dz2I0v1xSARTSIdukp2aK6gDUejTbg5EEWPyGK2+Vyar4eKhAtfXi52kjfBaMWleud
         E4g//3iHVDwYXMPW56ePZggohgrdBsJYaTtFZhBY70loVI4wAQiOwLKmXKhUp8PZ+b
         2yJKCCCVZ6kWDELjhLNU+DqCigWWa0/rQbZB27Vbr9BXp3ifdre0yta9D8Rb5RyVz9
         oBgMcTf/1lP1KSEG80omnnJZ9zMHeGwI18NS/8Qx15cQieNjvjybb6eMi4m/ZKe4Gx
         Y8zQ9fCgOmMcQ==
Received: from [172.16.0.188] (192-222-143-198.qc.cable.ebox.net [192.222.143.198])
        by smtpout.efficios.com (Postfix) with ESMTPSA id 4PxZmG2j3CzvFp;
        Wed, 12 Apr 2023 16:57:50 -0400 (EDT)
Message-ID: <9b5eb88c-83b3-23f4-fc31-1bd1b9e3dc87@efficios.com>
Date:   Wed, 12 Apr 2023 16:57:50 -0400
MIME-Version: 1.0
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101
 Thunderbird/102.9.0
Subject: Re: [RFC PATCH v4] sched: Fix performance regression introduced by
 mm_cid
Content-Language: en-US
To:     Aaron Lu <aaron.lu@intel.com>
Cc:     Peter Zijlstra <peterz@infradead.org>,
        linux-kernel@vger.kernel.org, Olivier Dion <odion@efficios.com>,
        michael.christie@oracle.com
References: <20230410150150.2179062-1-mathieu.desnoyers@efficios.com>
 <20230412042747.GA10674@ziqianlu-desk2>
From:   Mathieu Desnoyers <mathieu.desnoyers@efficios.com>
In-Reply-To: <20230412042747.GA10674@ziqianlu-desk2>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: base64
X-Spam-Status: No, score=-2.4 required=5.0 tests=BAYES_00,DKIM_SIGNED,
        DKIM_VALID,DKIM_VALID_AU,DKIM_VALID_EF,NICE_REPLY_A,RDNS_NONE,
        SPF_HELO_NONE,SPF_PASS,URIBL_BLOCKED autolearn=ham autolearn_force=no
        version=3.4.6
X-Spam-Checker-Version: SpamAssassin 3.4.6 (2021-04-09) on
        lindbergh.monkeyblade.net
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

T24gMjAyMy0wNC0xMiAwMDoyNywgQWFyb24gTHUgd3JvdGU6DQo+IEp1c3Qgbm90aWNlZCBi
ZWxvdyB3YXJuaW5nIGluIGRtZXNnIG9uIHY0LCB0aGUgd2FybmluZyBpcyB0cmlnZ2VyZWQg
YnkNCj4gV0FSTl9PTl9PTkNFKChpbnQpIG1tX2NpZCA8IDApOyBpbiByc2VxX3VwZGF0ZV9j
cHVfbm9kZV9pZCgpLg0KDQpJIHRoaW5rIEkga25vdyB3aGF0IHRyaWdnZXJzIHRoaXMgaW4g
djQuDQoNClNlZSBzY2hlZF9tbV9jaWRfbWlncmF0ZV9mcm9tKCkgKG5lYXIgdGhlIGVuZCk6
DQoNCisgICAgICAgLyoNCisgICAgICAgICogVGhlIHNyY19jaWQgaXMgdW51c2VkLCBzbyBp
dCBjYW4gYmUgdW5zZXQuDQorICAgICAgICAqLw0KKyAgICAgICBpZiAoY21weGNoZyhzcmNf
cGNwdV9jaWQsIG1tX2NpZF9zZXRfbGF6eV9wdXQoc3JjX2NpZCksIE1NX0NJRF9VTlNFVCkg
IT0NCisgICAgICAgICAgIG1tX2NpZF9zZXRfbGF6eV9wdXQoc3JjX2NpZCkpDQorICAgICAg
ICAgICAgICAgcmV0dXJuOw0KKyAgICAgICBfX21tX2NpZF9wdXQobW0sIHNyY19jaWQpOw0K
DQpUaGVyZSBpcyBhIHNob3J0IHdpbmRvdyBoZXJlIGJldHdlZW4gc3VjY2Vzc2Z1bCBjbXB4
Y2hnIGFuZCBjbGVhciBtYXNrIGJpdA0Kd2hlcmUgdGhlIHRocmVhZCBoYXMgb3duZXJzaGlw
IG9mIHRoZSBjaWQgd2l0aG91dCBycSBsb2NrIGhlbGQuIFRoaXMgY2FuDQpsZWFkIHRvIHJh
cmUgb3Zlci1hbGxvY2F0aW9uIG9mIGNpZHMgYmV5b25kIG5yX3Bvc3NpYmxlX2NwdXMgaWYg
dGhlIHNyYyBjcHUNCnJ1bnF1ZXVlIHJlYWxsb2NhdGVzIGEgY2lkIGNvbmN1cnJlbnRseSwg
d2hpY2ggY2F1c2VzIF9fbW1fY2lkX2dldCgpIHRvDQpyZXR1cm4gLTEuDQoNCkJlY2F1c2Ug
d2Ugd2FudCB0byBhdm9pZCB0YWtpbmcgdGhlIHNyYyBycSBsb2NrIGluIG1pZ3JhdGUtZnJv
bSwgSSBwbGFuIHRvDQpmaXggdGhpcyBieSBkb2luZyB0aGUgZm9sbG93aW5nOg0KDQotIGRp
c2FibGUgaW50ZXJydXB0cyBhcm91bmQgdGhpcyBjbXB4Y2hnIGFuZCBfX21tX2NpZF9wdXQo
KSwNCi0gbW9kaWZ5IF9fbW1fY2lkX2dldCBzbyBpdCByZXRyaWVzIGlmIGNwdW1hc2tfZmly
c3RfemVybygpIHJldHVybnMgLTEuDQoNClRoaXMgc2hvdWxkIHRha2UgY2FyZSBvZiB0aGlz
IGtpbmQgb2YgZXh0cmVtZWx5IHJhcmUgb3Zlci1hbGxvY2F0aW9uDQpzY2VuYXJpbyB0aHJv
dWdoIHJldHJ5LCB3aGljaCB3aWxsIGJlIGJvdW5kZWQgYnkgdGhlIGR1cmF0aW9uIG9mIHRo
ZQ0KaW5zdHJ1Y3Rpb24gc2VxdWVuY2UgYmV0d2VlbiBjbXB4Y2hnIGFuZCBjbGVhcmluZyB0
aGUgYml0IGluIHRoZSBiaXRtYXNrLg0KDQpJIGhhdmUgbm90IHJlcHJvZHVjZWQgdGhlIHdh
cm5pbmcgb24gbXkgZW5kLCBvbmx5IGZpZ3VyZWQgdGhpcyBvdXQgZnJvbQ0KY29kZSByZXZp
ZXcuDQoNClRob3VnaHRzID8NCg0KVGhhbmtzLA0KDQpNYXRoaWV1DQoNCj4gDQo+IFsgMTgx
OS42NDk4MDNdIC0tLS0tLS0tLS0tLVsgY3V0IGhlcmUgXS0tLS0tLS0tLS0tLQ0KPiBbIDE4
MTkuNjQ5ODEzXSBXQVJOSU5HOiBDUFU6IDE4OCBQSUQ6IDI5ODgxIGF0IGtlcm5lbC9yc2Vx
LmM6OTUgX19yc2VxX2hhbmRsZV9ub3RpZnlfcmVzdW1lKzB4NDliLzB4NTkwDQo+IFsgMTgx
OS42NDk4MjNdIE1vZHVsZXMgbGlua2VkIGluOiB2ZXRoIHRscyB4dF9jb25udHJhY2sgbmZ0
X2NoYWluX25hdCB4dF9NQVNRVUVSQURFIG5mX25hdCBuZl9jb25udHJhY2tfbmV0bGluayBu
Zl9jb25udHJhY2sgbmZfZGVmcmFnX2lwdjYgbmZfZGVmcmFnX2lwdjQgeGZybV91c2VyIHhm
cm1fYWxnbyB4dF9hZGRydHlwZSBuZnRfY29tcGF0IG5mX3RhYmxlcyBuZm5ldGxpbmsgYnJf
bmV0ZmlsdGVyIGJyaWRnZSBzdHAgbGxjIG92ZXJsYXkgaW50ZWxfcmFwbF9tc3IgaW50ZWxf
cmFwbF9jb21tb24gaW50ZWxfdW5jb3JlX2ZyZXF1ZW5jeSBpbnRlbF91bmNvcmVfZnJlcXVl
bmN5X2NvbW1vbiBpMTBubV9lZGFjIG5maXQgeDg2X3BrZ190ZW1wX3RoZXJtYWwgaW50ZWxf
cG93ZXJjbGFtcCBjb3JldGVtcCBrdm1faW50ZWwgYmluZm10X21pc2Mga3ZtIG5sc19pc284
ODU5XzEgcmFwbCBpbnRlbF9jc3RhdGUgbWVpX21lIGlzc3RfaWZfbWJveF9wY2kgaXNzdF9p
Zl9tbWlvIGlkeGQgaW5wdXRfbGVkcyBqb3lkZXYgaXNzdF9pZl9jb21tb24gaWR4ZF9idXMg
bWVpIGlwbWlfc3NpZiBhY3BpX2lwbWkgaXBtaV9zaSBpcG1pX2RldmludGYgaXBtaV9tc2do
YW5kbGVyIGFjcGlfcG93ZXJfbWV0ZXIgYWNwaV9wYWQgbWFjX2hpZCBzY2hfZnFfY29kZWwg
ZG1fbXVsdGlwYXRoIHNjc2lfZGhfcmRhYyBzY3NpX2RoX2VtYyBzY3NpX2RoX2FsdWEgbXNy
IHJhbW9vcHMgcHN0b3JlX2JsayByZWVkX3NvbG9tb24gcHN0b3JlX3pvbmUgZWZpX3BzdG9y
ZSBpcF90YWJsZXMgeF90YWJsZXMgYXV0b2ZzNCBidHJmcyBibGFrZTJiX2dlbmVyaWMgcmFp
ZDEwIHJhaWQ0NTYgYXN5bmNfcmFpZDZfcmVjb3YgYXN5bmNfbWVtY3B5IGFzeW5jX3BxIGFz
eW5jX3hvciBhc3luY190eCB4b3IgcmFpZDZfcHEgbGliY3JjMzJjIHJhaWQxIHJhaWQwIG11
bHRpcGF0aCBsaW5lYXIgaGlkX2dlbmVyaWMgdXNiaGlkIGhpZCBhc3QgaTJjX2FsZ29fYml0
IGRybV9zaG1lbV9oZWxwZXIgZHJtX2ttc19oZWxwZXIgc3lzY29weWFyZWEgc3lzZmlsbHJl
Y3QNCj4gWyAxODE5LjY0OTkwM10gIHN5c2ltZ2JsdCBjcmN0MTBkaWZfcGNsbXVsIGNyYzMy
X3BjbG11bCBnaGFzaF9jbG11bG5pX2ludGVsIHNoYTUxMl9zc3NlMyBhZXNuaV9pbnRlbCBk
YXhfaG1lbSBjeGxfYWNwaSBjcnlwdG9fc2ltZCBudm1lIGNyeXB0ZCBjeGxfY29yZSBudm1l
X2NvcmUgaTJjX2k4MDEgeGhjaV9wY2kgaTQwZSBkcm0gaTJjX3NtYnVzIHhoY2lfcGNpX3Jl
bmVzYXMgaTJjX2lzbXQgd21pIHBpbmN0cmxfZW1taXRzYnVyZw0KPiBbIDE4MTkuNjQ5OTI0
XSBDUFU6IDE4OCBQSUQ6IDI5ODgxIENvbW06IGhhY2tiZW5jaCBOb3QgdGFpbnRlZCA2LjMu
MC1yYzYtMDAwMDItZzFhY2ZkNmFlOWFmYyAjMg0KPiBbIDE4MTkuNjQ5OTI3XSBIYXJkd2Fy
ZSBuYW1lOiBJbnRlbCBDb3Jwb3JhdGlvbiBENTBETlAxU0JCL0Q1MEROUDFTQkIsIEJJT1Mg
U0U1Qzc0MTEuODZCLjg5MDEuRDAzLjIyMTAxMzEyMzIgMTAvMTMvMjAyMg0KPiBbIDE4MTku
NjQ5OTI5XSBSSVA6IDAwMTA6X19yc2VxX2hhbmRsZV9ub3RpZnlfcmVzdW1lKzB4NDliLzB4
NTkwDQo+IFsgMTgxOS42NDk5MzRdIENvZGU6IGYwIGZmIGZmIGZmIGZmIGZmIDAwIGU5IDAw
IGZlIGZmIGZmIDQ4IGJhIDAwIGYwIGZmIGZmIGZmIGZmIGZmIDAwIGU5IDNhIGZlIGZmIGZm
IDQ4IGJhIDAwIGYwIGZmIGZmZmYgZmYgZmYgMDAgZTkgNjYgZmUgZmYgZmYgPDBmPiAwYiBl
OSA3ZCBmYyBmZiBmZiAwZiAwMSBjYSBlOSBhNiBmYyBmZiBmZiA0OCA4YiA0YyAyNCAzMCA0
OCA4Yg0KPiBbIDE4MTkuNjQ5OTM2XSBSU1A6IDAwMTg6ZmZhMDAwMDAxOGIwZmU2MCBFRkxB
R1M6IDAwMDEwMjg2DQo+IFsgMTgxOS42NDk5MzldIFJBWDogZmYxMTAwN2Y3MzUwMDAwMCBS
Qlg6IDAwMDA3ZjgxYTcyMjZmZTAgUkNYOiAwMDAwMDAwMDAwMDAwMDAwDQo+IFsgMTgxOS42
NDk5NDFdIFJEWDogMDAwMDAwMDBmZmZmZmZmZiBSU0k6IDAwMDAwMDAwMDAwMDAwMDEgUkRJ
OiBmZmZmZmZmZjgyOGY5NDc3DQo+IFsgMTgxOS42NDk5NDNdIFJCUDogZmZhMDAwMDAxOGIw
ZmVlOCBSMDg6IGZmMTEwMDQwYzE5MmNjMjggUjA5OiBmZjExMDA0MDhlMmEzOTgwDQo+IFsg
MTgxOS42NDk5NDRdIFIxMDogMDAwMDAwMDAwMDAwMDAwMSBSMTE6IDAwMDAwMDAwMDAwMDAw
MDAgUjEyOiBmZjExMDA0MGNhYTY0MDAwDQo+IFsgMTgxOS42NDk5NDZdIFIxMzogMDAwMDAw
MDAwMDAyZmE0MCBSMTQ6IDAwMDAwMDAwMDAwMDAwMDAgUjE1OiAwMDAwMDAwMDAwMDAwMGJj
DQo+IFsgMTgxOS42NDk5NDddIEZTOiAgMDAwMDdmODFhNzIyNjY0MCgwMDAwKSBHUzpmZjEx
MDA3ZjczNTAwMDAwKDAwMDApIGtubEdTOjAwMDAwMDAwMDAwMDAwMDANCj4gWyAxODE5LjY0
OTk1MF0gQ1M6ICAwMDEwIERTOiAwMDAwIEVTOiAwMDAwIENSMDogMDAwMDAwMDA4MDA1MDAz
Mw0KPiBbIDE4MTkuNjQ5OTUxXSBDUjI6IDAwMDA3ZmQ4YjAwZDUwMDAgQ1IzOiAwMDAwMDA0
MGNmMDYwMDAxIENSNDogMDAwMDAwMDAwMGY3MWVlMA0KPiBbIDE4MTkuNjQ5OTUzXSBEUjA6
IDAwMDAwMDAwMDAwMDAwMDAgRFIxOiAwMDAwMDAwMDAwMDAwMDAwIERSMjogMDAwMDAwMDAw
MDAwMDAwMA0KPiBbIDE4MTkuNjQ5OTU1XSBEUjM6IDAwMDAwMDAwMDAwMDAwMDAgRFI2OiAw
MDAwMDAwMGZmZmUwN2YwIERSNzogMDAwMDAwMDAwMDAwMDQwMA0KPiBbIDE4MTkuNjQ5OTU3
XSBQS1JVOiA1NTU1NTU1NA0KPiBbIDE4MTkuNjQ5OTU4XSBDYWxsIFRyYWNlOg0KPiBbIDE4
MTkuNjQ5OTYwXSAgPFRBU0s+DQo+IFsgMTgxOS42NDk5NjRdICBleGl0X3RvX3VzZXJfbW9k
ZV9wcmVwYXJlKzB4MTNiLzB4MWEwDQo+IFsgMTgxOS42NDk5NzBdICBzeXNjYWxsX2V4aXRf
dG9fdXNlcl9tb2RlKzB4MmEvMHg1MA0KPiBbIDE4MTkuNjQ5OTc2XSAgPyBfX3g2NF9zeXNf
cmVhZCsweDFkLzB4MzANCj4gWyAxODE5LjY0OTk4MF0gIGRvX3N5c2NhbGxfNjQrMHg2ZC8w
eDkwDQo+IFsgMTgxOS42NDk5ODRdICBlbnRyeV9TWVNDQUxMXzY0X2FmdGVyX2h3ZnJhbWUr
MHg3Mi8weGRjDQo+IFsgMTgxOS42NDk5OTBdIFJJUDogMDAzMzoweDdmODFhNzcxNDljYw0K
PiBbIDE4MTkuNjQ5OTk2XSBDb2RlOiBlYyAyOCA0OCA4OSA1NCAyNCAxOCA0OCA4OSA3NCAy
NCAxMCA4OSA3YyAyNCAwOCBlOCBiOSBjMCBmNyBmZiA0OCA4YiA1NCAyNCAxOCA0OCA4YiA3
NCAyNCAxMCA0MSA4OSBjMCA4YiA3YyAyNCAwOCAzMSBjMCAwZiAwNSA8NDg+IDNkIDAwIGYw
IGZmIGZmIDc3IDM0IDQ0IDg5IGM3IDQ4IDg5IDQ0IDI0IDA4IGU4IGZmIGMwIGY3IGZmIDQ4
DQo+IFsgMTgxOS42NDk5OThdIFJTUDogMDAyYjowMDAwN2Y4MWE3MjI1ZDcwIEVGTEFHUzog
MDAwMDAyNDYgT1JJR19SQVg6IDAwMDAwMDAwMDAwMDAwMDANCj4gWyAxODE5LjY1MDAwNF0g
UkFYOiAwMDAwMDAwMDAwMDAwMDY0IFJCWDogMDAwMDdmODFhNzIyNWRhMCBSQ1g6IDAwMDA3
ZjgxYTc3MTQ5Y2MNCj4gWyAxODE5LjY1MDAwNV0gUkRYOiAwMDAwMDAwMDAwMDAwMDY0IFJT
STogMDAwMDdmODFhNzIyNWRhMCBSREk6IDAwMDAwMDAwMDAwMDAxMzUNCj4gWyAxODE5LjY1
MDAwN10gUkJQOiAwMDAwN2Y4MWE3MjI1ZTUwIFIwODogMDAwMDAwMDAwMDAwMDAwMCBSMDk6
IDAwMDAwMDAwMDAwMDAwMDANCj4gWyAxODE5LjY1MDAwOF0gUjEwOiAwMDAwMDAwMDAwMDAw
MDA4IFIxMTogMDAwMDAwMDAwMDAwMDI0NiBSMTI6IDAwMDAwMDAwMDA0YTNjMTINCj4gWyAx
ODE5LjY1MDAwOV0gUjEzOiAwMDAwN2Y4MWE3MjI1ZTEwIFIxNDogMDAwMDAwMDAwMDAwMDAw
MCBSMTU6IDAwMDA1NThkZjdhZjZkMDANCj4gWyAxODE5LjY1MDAxMl0gIDwvVEFTSz4NCj4g
WyAxODE5LjY1MDAxM10gLS0tWyBlbmQgdHJhY2UgMDAwMDAwMDAwMDAwMDAwMCBdLS0tDQoN
Ci0tIA0KTWF0aGlldSBEZXNub3llcnMNCkVmZmljaU9TIEluYy4NCmh0dHBzOi8vd3d3LmVm
ZmljaW9zLmNvbQ0KDQo=
