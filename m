Return-Path: <linux-kernel-owner@vger.kernel.org>
X-Original-To: lists+linux-kernel@lfdr.de
Delivered-To: lists+linux-kernel@lfdr.de
Received: from out1.vger.email (out1.vger.email [IPv6:2620:137:e000::1:20])
	by mail.lfdr.de (Postfix) with ESMTP id ECD475F2796
	for <lists+linux-kernel@lfdr.de>; Mon,  3 Oct 2022 04:03:48 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S229478AbiJCCDp (ORCPT <rfc822;lists+linux-kernel@lfdr.de>);
        Sun, 2 Oct 2022 22:03:45 -0400
Received: from lindbergh.monkeyblade.net ([23.128.96.19]:49028 "EHLO
        lindbergh.monkeyblade.net" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S229436AbiJCCDl (ORCPT
        <rfc822;linux-kernel@vger.kernel.org>);
        Sun, 2 Oct 2022 22:03:41 -0400
Received: from mail-qv1-xf2a.google.com (mail-qv1-xf2a.google.com [IPv6:2607:f8b0:4864:20::f2a])
        by lindbergh.monkeyblade.net (Postfix) with ESMTPS id D41562FFD7
        for <linux-kernel@vger.kernel.org>; Sun,  2 Oct 2022 19:03:40 -0700 (PDT)
Received: by mail-qv1-xf2a.google.com with SMTP id mg6so938051qvb.10
        for <linux-kernel@vger.kernel.org>; Sun, 02 Oct 2022 19:03:40 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20210112;
        h=content-disposition:mime-version:message-id:subject:cc:to:from:date
         :from:to:cc:subject:date;
        bh=/ydgguPlRMLpv+KLraOBXAFlseKa5tGQl5mzytpRDHg=;
        b=jX5EzOEzHWjS7m0Rsg6J0OIZYIPbwsb+radkOagnPP0G15JwKQ5//SFqeqVbujFAap
         5rm+n4DFW/QUyKjVLKbt36Pn9DJf+enJT93fGcn5UVh4f/e2BaXms0MoFEqxFZLTz60O
         Lf2CJpXLOJtn7j0i6/jVhNglhWhBOsqXBYV1bJGinyfXffmGArwJfmvkB8F60ZCf8lcN
         A2an/IqV6NaIAxO/2Rghz0AGfLEYzK7vcqXQyrR7hgpQOPhG5tI7z7HppK83VEGzaUeq
         Q2501fzJuGJ8oGdb0qIEzFEoSQIDEPQU5vpOa9LJphqSI5OfYdyw03KsmXrGBXxE4wOP
         DH9g==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20210112;
        h=content-disposition:mime-version:message-id:subject:cc:to:from:date
         :x-gm-message-state:from:to:cc:subject:date;
        bh=/ydgguPlRMLpv+KLraOBXAFlseKa5tGQl5mzytpRDHg=;
        b=Cxkqf1zckf5UDtUUorCN07w5VPX7yi837qDeOd4O70LL6tfRAvdTGZvWoXocQ7ndzQ
         0DYRKYD2oO9qYdWU7hTiqNj5W6W1Z8jf28sNKHdM04okCrCza8ttSGpX/fjBlYGt+uFJ
         gD6hUvmyW/OimN00fPWJ9mkMfcO00t2CRKjNdsAS3xsWOU9Kfchf5o+lKm9PjVeRUAOy
         P/UJWQwhzQc1knq30TBkdnAvtEzwHPtK5ras4dOQQ4Mf2uUUFfp0lMxfaZnM1cTI9Msm
         dbfNranNH+afFj76taF8a+wC45HNz0lnEKt3uz6+EyMewnzHrk94c+smj/DelPf3LhHK
         DlXw==
X-Gm-Message-State: ACrzQf3/aruJAUSvkdIvjMhEg6W9kssEi3N8hI5Fi8eiUF2MIn0gJ4b1
        CdufErLAT9ZcLC6Mg5DkJOY=
X-Google-Smtp-Source: AMsMyM5ywaLylKtXjmQVuYhvTxDrRMdg+DCZmOrZH8vuvaryemjqzHC0B1dyGz+ZwMcVxGenDWPg5Q==
X-Received: by 2002:a0c:aa48:0:b0:4aa:b039:35be with SMTP id e8-20020a0caa48000000b004aab03935bemr14721931qvb.57.1664762619966;
        Sun, 02 Oct 2022 19:03:39 -0700 (PDT)
Received: from localhost ([2601:4c1:c100:2270:ec09:fca7:de7a:72aa])
        by smtp.gmail.com with ESMTPSA id bl11-20020a05620a1a8b00b006ce30a5f892sm9390529qkb.102.2022.10.02.19.03.39
        (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
        Sun, 02 Oct 2022 19:03:39 -0700 (PDT)
Date:   Sun, 2 Oct 2022 19:03:38 -0700
From:   Yury Norov <yury.norov@gmail.com>
To:     Linus Torvalds <torvalds@linux-foundation.org>
Cc:     yury.norov@gmail.com, linux-kernel@vger.kernel.org,
        Andy Shevchenko <andriy.shevchenko@linux.intel.com>,
        Rasmus Villemoes <linux@rasmusvillemoes.dk>
Subject: [GIT PULL] bitmap changes for v6.0-rc1
Message-ID: <YzpC+uJlYq1nbcIw@yury-laptop>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
X-Spam-Status: No, score=-2.1 required=5.0 tests=BAYES_00,DKIM_SIGNED,
        DKIM_VALID,DKIM_VALID_AU,DKIM_VALID_EF,FREEMAIL_FROM,
        RCVD_IN_DNSWL_NONE,SPF_HELO_NONE,SPF_PASS autolearn=ham
        autolearn_force=no version=3.4.6
X-Spam-Checker-Version: SpamAssassin 3.4.6 (2021-04-09) on
        lindbergh.monkeyblade.net
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

The following changes since commit 7e18e42e4b280c85b76967a9106a13ca61c16179:

  Linux 6.0-rc4 (2022-09-04 13:10:01 -0700)

are available in the Git repository at:

  https://github.com/norov/linux.git tags/bitmap-6.1-rc1

for you to fetch changes up to 78e5a3399421ad79fc024e6d78e2deb7809d26af:

  cpumask: fix checking valid cpu range (2022-10-01 10:22:58 -0700)

----------------------------------------------------------------
bitmap patches for v6.1-rc1

Hi Linus,

Please pull this patches. They spent more than a week in -next without
major problems. The only problem with warnings generated by cpumask_check(),
when robots do bisection, is fixed by moving the patch "cpumask: fix
checking valid cpu range" to the very end of the series.

Also, it looks like Phil's patch is already in master, merged through
Greg's tree.

Thanks,
Yury

This branch is based on v6.0-rc4 and includes:

drivers/base: Fix unsigned comparison to -1 in CPUMAP_FILE_MAX_BYTES
From Phil Auld
https://lore.kernel.org/lkml/20220906203542.1796629-1-pauld@redhat.com/

cpumask: cleanup nr_cpu_ids vs nr_cpumask_bits mess
From me
https://lore.kernel.org/lkml/20220905230820.3295223-4-yury.norov@gmail.com/T/#m96ffe122721893471fd3470d911a8f2fad6d03b3

lib: optimize find_bit() functions
From me
https://lore.kernel.org/lkml/20220915020730.852234-2-yury.norov@gmail.com/T/

lib/find: add find_nth_bit()
From me
https://lore.kernel.org/lkml/20220918030716.1252285-1-yury.norov@gmail.com/

cpumask: repair cpumask_check()
From me
https://lore.kernel.org/netdev/xhsmhwn9k3ibb.mognet@vschneid.remote.csb/T/

----------------------------------------------------------------
Phil Auld (1):
      drivers/base: Fix unsigned comparison to -1 in CPUMAP_FILE_MAX_BYTES

Yury Norov (23):
      smp: don't declare nr_cpu_ids if NR_CPUS == 1
      smp: add set_nr_cpu_ids()
      lib/cpumask: delete misleading comment
      lib/cpumask: deprecate nr_cpumask_bits
      powerpc/64: don't refer nr_cpu_ids in asm code when it's undefined
      lib/cpumask: add FORCE_NR_CPUS config option
      lib/find_bit: introduce FIND_FIRST_BIT() macro
      lib/find_bit: create find_first_zero_bit_le()
      lib/find_bit: optimize find_next_bit() functions
      tools: sync find_bit() implementation
      lib/bitmap: don't call __bitmap_weight() in kernel code
      lib/bitmap: add bitmap_weight_and()
      lib: add find_nth{,_and,_andnot}_bit()
      lib/bitmap: add tests for find_nth_bit()
      lib/bitmap: remove bitmap_ord_to_pos
      cpumask: add cpumask_nth_{,and,andnot}
      net: fix cpu_max_bits_warn() usage in netif_attrmask_next{,_and}
      cpumask: switch for_each_cpu{,_not} to use for_each_bit()
      lib/find_bit: add find_next{,_and}_bit_wrap
      lib/bitmap: introduce for_each_set_bit_wrap() macro
      lib/find: optimize for_each() macros
      lib/bitmap: add tests for for_each() loops
      cpumask: fix checking valid cpu range

 arch/loongarch/kernel/setup.c |   2 +-
 arch/mips/kernel/setup.c      |   2 +-
 arch/powerpc/kernel/head_64.S |   4 +
 arch/x86/kernel/smpboot.c     |   4 +-
 arch/x86/xen/smp_pv.c         |   2 +-
 fs/ntfs3/bitmap.c             |   4 +-
 include/linux/bitmap.h        |  13 +-
 include/linux/bitops.h        |  19 +++
 include/linux/cpumask.h       | 119 +++++++++++------
 include/linux/find.h          | 272 +++++++++++++++++++++++++++++++++------
 include/linux/netdevice.h     |  10 +-
 include/linux/nodemask.h      |   3 +-
 kernel/smp.c                  |   6 +-
 lib/Kconfig                   |   9 ++
 lib/bitmap.c                  |  68 ++++------
 lib/cpumask.c                 |  40 +++---
 lib/find_bit.c                | 224 +++++++++++++++++++++-----------
 lib/find_bit_benchmark.c      |  18 +++
 lib/test_bitmap.c             | 291 +++++++++++++++++++++++++++++++++++++++++-
 tools/include/linux/find.h    |  61 ++-------
 tools/lib/find_bit.c          | 149 ++++++++++-----------
 21 files changed, 953 insertions(+), 367 deletions(-)
