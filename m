Return-Path: <linux-kernel-owner@vger.kernel.org>
X-Original-To: lists+linux-kernel@lfdr.de
Delivered-To: lists+linux-kernel@lfdr.de
Received: from out1.vger.email (out1.vger.email [IPv6:2620:137:e000::1:20])
	by mail.lfdr.de (Postfix) with ESMTP id 3F5815F6BE3
	for <lists+linux-kernel@lfdr.de>; Thu,  6 Oct 2022 18:37:15 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S230410AbiJFQhM (ORCPT <rfc822;lists+linux-kernel@lfdr.de>);
        Thu, 6 Oct 2022 12:37:12 -0400
Received: from lindbergh.monkeyblade.net ([23.128.96.19]:52392 "EHLO
        lindbergh.monkeyblade.net" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S229555AbiJFQhJ (ORCPT
        <rfc822;linux-kernel@vger.kernel.org>);
        Thu, 6 Oct 2022 12:37:09 -0400
Received: from mx.gpxsee.org (mx.gpxsee.org [37.205.14.76])
        by lindbergh.monkeyblade.net (Postfix) with ESMTP id A0BCCCE9A1;
        Thu,  6 Oct 2022 09:37:03 -0700 (PDT)
Received: from [192.168.4.25] (unknown [62.77.71.229])
        by mx.gpxsee.org (Postfix) with ESMTPSA id 233C236BC1;
        Thu,  6 Oct 2022 18:37:01 +0200 (CEST)
Content-Type: multipart/mixed; boundary="------------A3EY0LQxb1Rn0VPJLv1kXqq3"
Message-ID: <4e4481e9-0eb9-ac28-b9ff-348adb4dc866@gpxsee.org>
Date:   Thu, 6 Oct 2022 18:37:00 +0200
MIME-Version: 1.0
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101
 Thunderbird/102.3.0
Subject: Re: [PATCH V6 XDMA 0/2] xilinx XDMA driver
To:     Lizhi Hou <lizhi.hou@amd.com>, vkoul@kernel.org,
        dmaengine@vger.kernel.org, linux-kernel@vger.kernel.org,
        trix@redhat.com
Cc:     max.zhen@amd.com, sonal.santan@amd.com, larry.liu@amd.com,
        brian.xu@amd.com
References: <1664919839-27149-1-git-send-email-lizhi.hou@amd.com>
Content-Language: en-US
From:   =?UTF-8?Q?Martin_T=c5=afma?= <tumic@gpxsee.org>
In-Reply-To: <1664919839-27149-1-git-send-email-lizhi.hou@amd.com>
X-Spam-Status: No, score=-3.3 required=5.0 tests=BAYES_00,NICE_REPLY_A,
        SPF_HELO_NONE,SPF_NONE autolearn=ham autolearn_force=no version=3.4.6
X-Spam-Checker-Version: SpamAssassin 3.4.6 (2021-04-09) on
        lindbergh.monkeyblade.net
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

This is a multi-part message in MIME format.
--------------A3EY0LQxb1Rn0VPJLv1kXqq3
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit

On 04. 10. 22 23:43, Lizhi Hou wrote:
> Hello,
> 
> This V6 of patch series is to provide the platform driver to support the
> Xilinx XDMA subsystem. The XDMA subsystem is used in conjunction with the
> PCI Express IP block to provide high performance data transfer between host
> memory and the card's DMA subsystem. It also provides up to 16 user
> interrupt wires to user logic that generate interrupts to the host.
> 
>              +-------+       +-------+       +-----------+
>     PCIe     |       |       |       |       |           |
>     Tx/Rx    |       |       |       |  AXI  |           |
>   <=======>  | PCIE  | <===> | XDMA  | <====>| User Logic|
>              |       |       |       |       |           |
>              +-------+       +-------+       +-----------+
> 
> The XDMA has been used for Xilinx Alveo PCIe devices.
> And it is also integrated into Versal ACAP DMA and Bridge Subsystem.
>      https://www.xilinx.com/products/boards-and-kits/alveo.html
>      https://docs.xilinx.com/r/en-US/pg344-pcie-dma-versal/Introduction-to-the-DMA-and-Bridge-Subsystems
> 
> The device driver for any FPGA based PCIe device which leverages XDMA can
> call the standard dmaengine APIs to discover and use the XDMA subsystem
> without duplicating the XDMA driver code in its own driver.
> 
> Changes since v5:
> - Modified user logic interrupt APIs to handle user logic IP which does not
>    have its own register to enable/disable interrupt.
> - Clean up code based on review comments.
> 
> Changes since v4:
> - Modified user logic interrupt APIs.
> 
> Changes since v3:
> - Added one patch to support user logic interrupt.
> 
> Changes since v2:
> - Removed tasklet.
> - Fixed regression bug introduced to V2.
> - Test Robot warning.
> 
> Changes since v1:
> - Moved filling hardware descriptor to xdma_prep_device_sg().
> - Changed hardware descriptor enum to "struct xdma_hw_desc".
> - Minor changes from code review comments.
> 
> Lizhi Hou (2):
>    dmaengine: xilinx: xdma: Add xilinx xdma driver
>    dmaengine: xilinx: xdma: Add user logic interrupt support
> 
>   MAINTAINERS                            |   11 +
>   drivers/dma/Kconfig                    |   13 +
>   drivers/dma/xilinx/Makefile            |    1 +
>   drivers/dma/xilinx/xdma-regs.h         |  171 ++++
>   drivers/dma/xilinx/xdma.c              | 1034 ++++++++++++++++++++++++
>   include/linux/dma/amd_xdma.h           |   16 +
>   include/linux/platform_data/amd_xdma.h |   34 +
>   7 files changed, 1280 insertions(+)
>   create mode 100644 drivers/dma/xilinx/xdma-regs.h
>   create mode 100644 drivers/dma/xilinx/xdma.c
>   create mode 100644 include/linux/dma/amd_xdma.h
>   create mode 100644 include/linux/platform_data/amd_xdma.h
> 

Hi,
I have rewritten our V4L2 driver to use this new XDMA driver, but it 
does not work on our HW (where the previous Xilinx XDMA driver derived 
from the Xilinx sample code worked fine). The driver is sucessfully 
loaded and 4(2+2) DMA channels are successfully created. But when a DMA 
transfer is initiated, I get an error from my PC's DMA chip:

AMD-Vi: Event logged [IO_PAGE_FAULT domain=0x000a address=0x36a00000 
flags=0x0000]

and no error from XDMA.

Does the driver expect some special FPGA IP core configuration? Or is 
there something else I'm missing? My code is quiet similar to what you 
use in your XRT repo on GitHub (there is btw. a bug in the XRT code - 
you do not clear the dma_slave_config struct before using) but in my 
case the DMA transfer triggers the AMD-Vi error and timeouts.

The code of our driver is attached, the relevant parts are in mgb4_dma.c
and mgb4_core.c.

M.
--------------A3EY0LQxb1Rn0VPJLv1kXqq3
Content-Type: text/x-patch; charset=UTF-8; name="mgb4.patch"
Content-Disposition: attachment; filename="mgb4.patch"
Content-Transfer-Encoding: base64

ZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGNpL0tjb25maWcgYi9kcml2ZXJzL21lZGlh
L3BjaS9LY29uZmlnCmluZGV4IDEyMjRkOTA4NzEzYS4uZTNmOWQwZDRlNGNjIDEwMDY0NAot
LS0gYS9kcml2ZXJzL21lZGlhL3BjaS9LY29uZmlnCisrKyBiL2RyaXZlcnMvbWVkaWEvcGNp
L0tjb25maWcKQEAgLTEzLDYgKzEzLDcgQEAgaWYgTUVESUFfUENJX1NVUFBPUlQKIGlmIE1F
RElBX0NBTUVSQV9TVVBQT1JUCiAJY29tbWVudCAiTWVkaWEgY2FwdHVyZSBzdXBwb3J0Igog
Citzb3VyY2UgImRyaXZlcnMvbWVkaWEvcGNpL21nYjQvS2NvbmZpZyIKIHNvdXJjZSAiZHJp
dmVycy9tZWRpYS9wY2kvbWV5ZS9LY29uZmlnIgogc291cmNlICJkcml2ZXJzL21lZGlhL3Bj
aS9zb2xvNngxMC9LY29uZmlnIgogc291cmNlICJkcml2ZXJzL21lZGlhL3BjaS9zdGEyeDEx
L0tjb25maWciCmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3BjaS9NYWtlZmlsZSBiL2Ry
aXZlcnMvbWVkaWEvcGNpL01ha2VmaWxlCmluZGV4IDU1MTE2OWEzZTQzNC4uOGNhODE5Y2Yz
Y2MxIDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL3BjaS9NYWtlZmlsZQorKysgYi9kcml2
ZXJzL21lZGlhL3BjaS9NYWtlZmlsZQpAQCAtMzMsNiArMzMsNyBAQCBvYmotJChDT05GSUdf
VklERU9fQ1g4OCkgKz0gY3g4OC8KIG9iai0kKENPTkZJR19WSURFT19EVDMxNTUpICs9IGR0
MzE1NS8KIG9iai0kKENPTkZJR19WSURFT19JVlRWKSArPSBpdnR2Lwogb2JqLSQoQ09ORklH
X1ZJREVPX01FWUUpICs9IG1leWUvCitvYmotJChDT05GSUdfVklERU9fTUdCNCkgKz0gbWdi
NC8KIG9iai0kKENPTkZJR19WSURFT19TQUE3MTM0KSArPSBzYWE3MTM0Lwogb2JqLSQoQ09O
RklHX1ZJREVPX1NBQTcxNjQpICs9IHNhYTcxNjQvCiBvYmotJChDT05GSUdfVklERU9fU09M
TzZYMTApICs9IHNvbG82eDEwLwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wY2kvbWdi
NC9LY29uZmlnIGIvZHJpdmVycy9tZWRpYS9wY2kvbWdiNC9LY29uZmlnCm5ldyBmaWxlIG1v
ZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uMTNmYWQxNWE0MzRjCi0tLSAvZGV2L251
bGwKKysrIGIvZHJpdmVycy9tZWRpYS9wY2kvbWdiNC9LY29uZmlnCkBAIC0wLDAgKzEsMTcg
QEAKKyMgU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb25seQorY29uZmlnIFZJ
REVPX01HQjQKKwl0cmlzdGF0ZSAiRGlnaXRlcSBBdXRvbW90aXZlIE1HQjQgc3VwcG9ydCIK
KwlkZXBlbmRzIG9uIFZJREVPX0RFViAmJiBQQ0kgJiYgSTJDICYmIERNQURFVklDRVMgJiYg
U1BJICYmIE1URCAmJiBJSU8KKwlzZWxlY3QgVklERU9CVUYyX0RNQV9TRworCXNlbGVjdCBJ
SU9fQlVGRkVSCisJc2VsZWN0IElJT19UUklHR0VSRURfQlVGRkVSCisJc2VsZWN0IEkyQ19Y
SUxJTlgKKwlzZWxlY3QgU1BJX1hJTElOWAorCXNlbGVjdCBNVERfU1BJX05PUgorCXNlbGVj
dCBYSUxJTlhfWERNQQorCWhlbHAKKwkgIFRoaXMgaXMgYSB2aWRlbzRsaW51eCBkcml2ZXIg
Zm9yIERpZ2l0ZXEgQXV0b21vdGl2ZSBNR0I0IGdyYWJiZXIKKwkgIGNhcmRzLgorCisJICBU
byBjb21waWxlIHRoaXMgZHJpdmVyIGFzIGEgbW9kdWxlLCBjaG9vc2UgTSBoZXJlOiB0aGUK
KwkgIG1vZHVsZSB3aWxsIGJlIGNhbGxlZCBtZ2I0LgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9t
ZWRpYS9wY2kvbWdiNC9NYWtlZmlsZSBiL2RyaXZlcnMvbWVkaWEvcGNpL21nYjQvTWFrZWZp
bGUKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi5lOTJlYWQxOGJl
ZDAKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL21lZGlhL3BjaS9tZ2I0L01ha2VmaWxl
CkBAIC0wLDAgKzEsNiBAQAorIyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMAor
bWdiNC1vYmpzCTo9IG1nYjRfcmVncy5vIG1nYjRfY29yZS5vIG1nYjRfdmluLm8gbWdiNF92
b3V0Lm8gXAorICAgICAgICAgICAgICAgbWdiNF9zeXNmc19wY2kubyBtZ2I0X3N5c2ZzX2lu
Lm8gbWdiNF9zeXNmc19vdXQubyBcCisgICAgICAgICAgICAgICBtZ2I0X2kyYy5vIG1nYjRf
Y210Lm8gbWdiNF90cmlnZ2VyLm8gbWdiNF9kbWEubworCitvYmotJChDT05GSUdfVklERU9f
TUdCNCkgKz0gbWdiNC5vCmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3BjaS9tZ2I0L21n
YjRfY210LmMgYi9kcml2ZXJzL21lZGlhL3BjaS9tZ2I0L21nYjRfY210LmMKbmV3IGZpbGUg
bW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi4zZWMzOTRlNDZiZDAKLS0tIC9kZXYv
bnVsbAorKysgYi9kcml2ZXJzL21lZGlhL3BjaS9tZ2I0L21nYjRfY210LmMKQEAgLTAsMCAr
MSwyNDMgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9ubHkKKy8q
CisgKiBDb3B5cmlnaHQgKEMpIDIwMjEtMjAyMiBEaWdpdGVxIEF1dG9tb3RpdmUKKyAqICAg
ICBhdXRob3I6IE1hcnRpbiBUdW1hIDxtYXJ0aW4udHVtYUBkaWdpdGVxYXV0b21vdGl2ZS5j
b20+CisgKi8KKworI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+CisjaW5jbHVkZSA8bGludXgv
a2VybmVsLmg+CisjaW5jbHVkZSAibWdiNF9jb3JlLmgiCisjaW5jbHVkZSAibWdiNF9jbXQu
aCIKKworc3RhdGljIGNvbnN0IHVpbnQxNl90IGNtdF92YWxzX291dFtdWzE1XSA9IHsKKwl7
MHgxMjA4LCAweDAwMDAsIDB4MTcxQywgMHgwMDAwLCAweDFFMzgsIDB4MDAwMCwgMHgxMUM3
LCAweDAwMDAsIDB4MTA0MSwgMHgwMUJDLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDk5
MDAsIDB4ODEwMCwgfSwKKwl7MHgxMUM3LCAweDAwMDAsIDB4MTYxOSwgMHgwMDgwLCAweDFD
NzEsIDB4MDAwMCwgMHgxMzBELCAweDAwODAsIDB4MDA0MSwgMHgwMDkwLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDExMDAsIDB4OTAwMCwgfSwKKwl7MHgxMUM3LCAweDAwMDAsIDB4
MTYxOSwgMHgwMDgwLCAweDFDNzEsIDB4MDAwMCwgMHgxNjVBLCAweDAwODAsIDB4MDA4Miwg
MHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDEwMDAsIDB4OTAwMCwgfSwKKwl7
MHgxMUM3LCAweDAwMDAsIDB4MTYxOSwgMHgwMDgwLCAweDFDNzEsIDB4MDAwMCwgMHgxMTg3
LCAweDAwODAsIDB4MTA0MSwgMHgwMUVFLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDk5
MDAsIDB4ODEwMCwgfSwKKwl7MHgxMTg2LCAweDAwMDAsIDB4MTU1NSwgMHgwMDAwLCAweDFB
QUEsIDB4MDAwMCwgMHgxNDUxLCAweDAwMDAsIDB4MDA0MiwgMHgwMDEzLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDA5MDAsIDB4MTAwMCwgfSwKKwl7MHgxMUM3LCAweDAwMDAsIDB4
MTYxOSwgMHgwMDgwLCAweDFDNzEsIDB4MDAwMCwgMHgxMzRFLCAweDAwODAsIDB4MDA0MSwg
MHgwMDVFLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA5MDAsIDB4MTAwMCwgfSwKKwl7
MHgxMTQ1LCAweDAwMDAsIDB4MTQ1MiwgMHgwMDgwLCAweDE4RTMsIDB4MDAwMCwgMHgxNjE5
LCAweDAwODAsIDB4MDA4MywgMHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDEw
MDAsIDB4OTAwMCwgfSwKKwl7MHgxMTQ1LCAweDAwMDAsIDB4MTQ1MiwgMHgwMDgwLCAweDE4
RTMsIDB4MDAwMCwgMHgxNzlFLCAweDAwMDAsIDB4MDBDMywgMHgwMEZBLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDA4MDAsIDB4MTAwMCwgfSwKKwl7MHgxMTQ1LCAweDAwMDAsIDB4
MTQ1MiwgMHgwMDgwLCAweDE4RTMsIDB4MDAwMCwgMHgxNzlGLCAweDAwODAsIDB4MDBDMywg
MHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA4MDAsIDB4MTAwMCwgfSwKKwl7
MHgxMTQ1LCAweDAwMDAsIDB4MTQ1MiwgMHgwMDgwLCAweDE4RTMsIDB4MDAwMCwgMHgxN0RG
LCAweDAwMDAsIDB4MDBDMywgMHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDEw
MDAsIDB4ODgwMCwgfSwKKwl7MHgxMTQ1LCAweDAwMDAsIDB4MTQ1MiwgMHgwMDgwLCAweDE4
RTMsIDB4MDAwMCwgMHgxMjhCLCAweDAwODAsIDB4MDA0MSwgMHgwMERCLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDkwMDAsIDB4MDEwMCwgfSwKKwl7MHgxMTg2LCAweDAwMDAsIDB4
MTU1NSwgMHgwMDAwLCAweDFBQUEsIDB4MDAwMCwgMHgxODIwLCAweDAwMDAsIDB4MDA4Mywg
MHgwMEZBLCAweDdERTksIDB4N0RFOCwgMHhGRkZGLCAweDA5MDAsIDB4OTAwMCwgfSwKKwl7
MHgxMTg2LCAweDAwMDAsIDB4MTU1NSwgMHgwMDAwLCAweDFBQUEsIDB4MDAwMCwgMHgxMTg3
LCAweDAwODAsIDB4MTA0MSwgMHgwMUVFLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDk5
MDAsIDB4ODEwMCwgfSwKKwl7MHgxMTA0LCAweDAwMDAsIDB4MTM4RSwgMHgwMDAwLCAweDE3
MUMsIDB4MDAwMCwgMHgxNjlCLCAweDAwODAsIDB4MDBDMywgMHgwMEZBLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDE4MDAsIDB4MDEwMCwgfSwKKwl7MHgxMTQ1LCAweDAwMDAsIDB4
MTQ1MiwgMHgwMDgwLCAweDE4RTMsIDB4MDAwMCwgMHgxNzFDLCAweDAwMDAsIDB4MDA4Mywg
MHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDExMDAsIDB4MTgwMCwgfSwKKwl7
MHgxMTg2LCAweDAwMDAsIDB4MTU1NSwgMHgwMDAwLCAweDFBQUEsIDB4MDAwMCwgMHgxNTE1
LCAweDAwODAsIDB4MDA0MiwgMHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA5
MDAsIDB4MTAwMCwgfSwKKwl7MHgxMTA0LCAweDAwMDAsIDB4MTM4RSwgMHgwMDAwLCAweDE3
MUMsIDB4MDAwMCwgMHgxNDkzLCAweDAwODAsIDB4MDA4MiwgMHgwMEZBLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDA5MDAsIDB4MTAwMCwgfSwKKwl7MHgxMTQ1LCAweDAwMDAsIDB4
MTQ1MiwgMHgwMDgwLCAweDE4RTMsIDB4MDAwMCwgMHgxNUQ4LCAweDAwODAsIDB4MDA4Miwg
MHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDE5MDAsIDB4MDEwMCwgfSwKKwl7
MHgxMTA0LCAweDAwMDAsIDB4MTM4RSwgMHgwMDAwLCAweDE3MUMsIDB4MDAwMCwgMHgxMjRB
LCAweDAwODAsIDB4MDA0MSwgMHgwMTBELCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDkw
MDAsIDB4MDEwMCwgfSwKKwl7MHgxMTA0LCAweDAwMDAsIDB4MTM4RSwgMHgwMDAwLCAweDE3
MUMsIDB4MDAwMCwgMHgxNzVELCAweDAwMDAsIDB4MDBDMywgMHgwMEZBLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDA4MDAsIDB4MTAwMCwgfSwKKwl7MHgxMTQ1LCAweDAwMDAsIDB4
MTQ1MiwgMHgwMDgwLCAweDE4RTMsIDB4MDAwMCwgMHgxNjE5LCAweDAwODAsIDB4MDA4Miwg
MHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDEwMDAsIDB4OTAwMCwgfSwKKwl7
MHgxMTQ1LCAweDAwMDAsIDB4MTQ1MiwgMHgwMDgwLCAweDE4RTMsIDB4MDAwMCwgMHgxN0RG
LCAweDAwMDAsIDB4MDA4MywgMHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDEw
MDAsIDB4ODgwMCwgfSwKKwl7MHgxMTQ1LCAweDAwMDAsIDB4MTQ1MiwgMHgwMDgwLCAweDE4
RTMsIDB4MDAwMCwgMHgxN0UwLCAweDAwODAsIDB4MDA4MywgMHgwMEZBLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDA5MDAsIDB4OTAwMCwgfSwKKwl7MHgxMTQ1LCAweDAwMDAsIDB4
MTQ1MiwgMHgwMDgwLCAweDE4RTMsIDB4MDAwMCwgMHgxODIwLCAweDAwMDAsIDB4MDA4Mywg
MHgwMEZBLCAweDdERTksIDB4N0RFOCwgMHhGRkZGLCAweDA5MDAsIDB4OTAwMCwgfSwKKwl7
MHgxMTA0LCAweDAwMDAsIDB4MTM4RSwgMHgwMDAwLCAweDE3MUMsIDB4MDAwMCwgMHgxM0Qw
LCAweDAwODAsIDB4MDA0MiwgMHgwMDJDLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA5
MDAsIDB4MTAwMCwgfSwKKwl7MHgxMTA0LCAweDAwMDAsIDB4MTM4RSwgMHgwMDAwLCAweDE3
MUMsIDB4MDAwMCwgMHgxMjhCLCAweDAwODAsIDB4MDA0MSwgMHgwMERCLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDkwMDAsIDB4MDEwMCwgfSwKKwl7MHgxMTA0LCAweDAwMDAsIDB4
MTM4RSwgMHgwMDAwLCAweDE3MUMsIDB4MDAwMCwgMHgxODIwLCAweDAwMDAsIDB4MDBDMywg
MHgwMEZBLCAweDdERTksIDB4N0RFOCwgMHhGRkZGLCAweDA5MDAsIDB4OTAwMCwgfSwKKwl7
MHgxMTQ1LCAweDAwMDAsIDB4MTQ1MiwgMHgwMDgwLCAweDE4RTMsIDB4MDAwMCwgMHgxMzRF
LCAweDAwODAsIDB4MDA0MSwgMHgwMDVFLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA5
MDAsIDB4MTAwMCwgfSwKKwl7MHgxMTQ1LCAweDAwMDAsIDB4MTQ1MiwgMHgwMDgwLCAweDE4
RTMsIDB4MDAwMCwgMHgxNTE1LCAweDAwODAsIDB4MDA0MiwgMHgwMEZBLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDA5MDAsIDB4MTAwMCwgfSwKKwl7MHgxMEMzLCAweDAwMDAsIDB4
MTI4QiwgMHgwMDgwLCAweDE1NTUsIDB4MDAwMCwgMHgxNzVELCAweDAwMDAsIDB4MDBDNCwg
MHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA4MDAsIDB4MTAwMCwgfSwKKwl7
MHgxMTQ1LCAweDAwMDAsIDB4MTQ1MiwgMHgwMDgwLCAweDE4RTMsIDB4MDAwMCwgMHgxMUM3
LCAweDAwMDAsIDB4MTA0MSwgMHgwMUJDLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDk5
MDAsIDB4ODEwMCwgfSwKKwl7MHgxMEMzLCAweDAwMDAsIDB4MTI4QiwgMHgwMDgwLCAweDE1
NTUsIDB4MDAwMCwgMHgxMjA5LCAweDAwODAsIDB4MDA0MSwgMHgwMTNGLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDk5MDAsIDB4MTEwMCwgfSwKKwl7MHgxMEMzLCAweDAwMDAsIDB4
MTI4QiwgMHgwMDgwLCAweDE1NTUsIDB4MDAwMCwgMHgxNTU2LCAweDAwODAsIDB4MDA4Mywg
MHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA4MDAsIDB4ODAwMCwgfSwKKwl7
MHgxMEMzLCAweDAwMDAsIDB4MTI4QiwgMHgwMDgwLCAweDE1NTUsIDB4MDAwMCwgMHgxNzlG
LCAweDAwODAsIDB4MDBDNCwgMHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA4
MDAsIDB4MTAwMCwgfSwKKwl7MHgxMTA0LCAweDAwMDAsIDB4MTM4RSwgMHgwMDAwLCAweDE3
MUMsIDB4MDAwMCwgMHgxNUQ4LCAweDAwODAsIDB4MDA4MiwgMHgwMEZBLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDE5MDAsIDB4MDEwMCwgfSwKKwl7MHgxMEMzLCAweDAwMDAsIDB4
MTI4QiwgMHgwMDgwLCAweDE1NTUsIDB4MDAwMCwgMHgxMTA1LCAweDAwODAsIDB4MTA0MSwg
MHgwMUU4LCAweDY0MDEsIDB4NjVFOSwgMHhGRkZGLCAweDk4MDAsIDB4MTEwMCwgfSwKKwl7
MHgxMEMzLCAweDAwMDAsIDB4MTI4QiwgMHgwMDgwLCAweDE1NTUsIDB4MDAwMCwgMHgxODIw
LCAweDAwMDAsIDB4MDBDNCwgMHgwMEZBLCAweDdERTksIDB4N0RFOCwgMHhGRkZGLCAweDA5
MDAsIDB4OTAwMCwgfSwKKwl7MHgxMTA0LCAweDAwMDAsIDB4MTM4RSwgMHgwMDAwLCAweDE3
MUMsIDB4MDAwMCwgMHgxNDkzLCAweDAwODAsIDB4MDA0MiwgMHgwMEZBLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDA5MDAsIDB4MTAwMCwgfSwKKwl7MHgxMEMzLCAweDAwMDAsIDB4
MTI4QiwgMHgwMDgwLCAweDE1NTUsIDB4MDAwMCwgMHgxMzhFLCAweDAwMDAsIDB4MDA0Miwg
MHgwMDVFLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA5MDAsIDB4MTAwMCwgfSwKKwl7
MHgxMTA0LCAweDAwMDAsIDB4MTM4RSwgMHgwMDAwLCAweDE3MUMsIDB4MDAwMCwgMHgxN0Uw
LCAweDAwODAsIDB4MDA4MywgMHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA5
MDAsIDB4OTAwMCwgfSwKKwl7MHgxMTA0LCAweDAwMDAsIDB4MTM4RSwgMHgwMDAwLCAweDE3
MUMsIDB4MDAwMCwgMHgxNjVBLCAweDAwODAsIDB4MDA4MiwgMHgwMEZBLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDEwMDAsIDB4OTAwMCwgfSwKKwl7MHgxMEMzLCAweDAwMDAsIDB4
MTI4QiwgMHgwMDgwLCAweDE1NTUsIDB4MDAwMCwgMHgxNzVELCAweDAwMDAsIDB4MDBDMywg
MHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA4MDAsIDB4MTAwMCwgfSwKKwl7
MHgxMTA0LCAweDAwMDAsIDB4MTM4RSwgMHgwMDAwLCAweDE3MUMsIDB4MDAwMCwgMHgxMTg3
LCAweDAwODAsIDB4MTA0MSwgMHgwMUVFLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDk5
MDAsIDB4ODEwMCwgfSwKKwl7MHgxMEMzLCAweDAwMDAsIDB4MTI4QiwgMHgwMDgwLCAweDE1
NTUsIDB4MDAwMCwgMHgxNzVFLCAweDAwODAsIDB4MDBDMywgMHgwMEZBLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDA4MDAsIDB4MTAwMCwgfSwKKwl7MHgxMEMzLCAweDAwMDAsIDB4
MTI4QiwgMHgwMDgwLCAweDE1NTUsIDB4MDAwMCwgMHgxNzlFLCAweDAwMDAsIDB4MDBDMywg
MHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA4MDAsIDB4MTAwMCwgfSwKKwl7
MHgxMTA0LCAweDAwMDAsIDB4MTM4RSwgMHgwMDAwLCAweDE3MUMsIDB4MDAwMCwgMHgxMzRF
LCAweDAwODAsIDB4MDA0MSwgMHgwMDVFLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA5
MDAsIDB4MTAwMCwgfSwKKwl7MHgxMEMzLCAweDAwMDAsIDB4MTI4QiwgMHgwMDgwLCAweDE1
NTUsIDB4MDAwMCwgMHgxNjVBLCAweDAwODAsIDB4MDA4MywgMHgwMEZBLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDEwMDAsIDB4OTAwMCwgfSwKKwl7MHgxMTA0LCAweDAwMDAsIDB4
MTM4RSwgMHgwMDAwLCAweDE3MUMsIDB4MDAwMCwgMHgxNkRDLCAweDAwODAsIDB4MDA4Miwg
MHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDExMDAsIDB4MTgwMCwgfSwKKwl7
MHgxMEMzLCAweDAwMDAsIDB4MTI4QiwgMHgwMDgwLCAweDE1NTUsIDB4MDAwMCwgMHgxNjlB
LCAweDAwMDAsIDB4MDA4MywgMHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDEw
MDAsIDB4OTAwMCwgfSwKKwl7MHgxMTA0LCAweDAwMDAsIDB4MTM4RSwgMHgwMDAwLCAweDE3
MUMsIDB4MDAwMCwgMHgxMUM3LCAweDAwMDAsIDB4MTA0MSwgMHgwMUJDLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDk5MDAsIDB4ODEwMCwgfSwKKwl7MHgxMEMzLCAweDAwMDAsIDB4
MTI4QiwgMHgwMDgwLCAweDE1NTUsIDB4MDAwMCwgMHgxNjlCLCAweDAwODAsIDB4MDA4Mywg
MHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDE4MDAsIDB4MDEwMCwgfSwKKwl7
MHgxMTA0LCAweDAwMDAsIDB4MTM4RSwgMHgwMDAwLCAweDE3MUMsIDB4MDAwMCwgMHgxNzFE
LCAweDAwODAsIDB4MDA4MiwgMHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDEx
MDAsIDB4MTgwMCwgfSwKKwl7MHgxMEMzLCAweDAwMDAsIDB4MTI4QiwgMHgwMDgwLCAweDE1
NTUsIDB4MDAwMCwgMHgxNkRCLCAweDAwMDAsIDB4MDA4MywgMHgwMEZBLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDE4MDAsIDB4MDEwMCwgfSwKKwl7MHgxMEMzLCAweDAwMDAsIDB4
MTI4QiwgMHgwMDgwLCAweDE1NTUsIDB4MDAwMCwgMHgxMTQ2LCAweDAwODAsIDB4MTA0MSwg
MHgwMTg0LCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDk5MDAsIDB4ODEwMCwgfSwKKwl7
MHgxMEMzLCAweDAwMDAsIDB4MTI4QiwgMHgwMDgwLCAweDE1NTUsIDB4MDAwMCwgMHgxNzFD
LCAweDAwMDAsIDB4MDA4MywgMHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDEx
MDAsIDB4MTgwMCwgfSwKKwl7MHgxMEMzLCAweDAwMDAsIDB4MTI4QiwgMHgwMDgwLCAweDE1
NTUsIDB4MDAwMCwgMHgxNDUxLCAweDAwMDAsIDB4MDA0MiwgMHgwMDEzLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDA5MDAsIDB4MTAwMCwgfSwKKwl7MHgxMEMzLCAweDAwMDAsIDB4
MTI4QiwgMHgwMDgwLCAweDE1NTUsIDB4MDAwMCwgMHgxNzFELCAweDAwODAsIDB4MDA4Mywg
MHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDExMDAsIDB4MTgwMCwgfSwKKwl7
MHgxMEMzLCAweDAwMDAsIDB4MTI4QiwgMHgwMDgwLCAweDE1NTUsIDB4MDAwMCwgMHgxNzVE
LCAweDAwMDAsIDB4MDA4MywgMHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA4
MDAsIDB4MTAwMCwgfSwKKwl7MHgxMEMzLCAweDAwMDAsIDB4MTI4QiwgMHgwMDgwLCAweDE1
NTUsIDB4MDAwMCwgMHgxNDUyLCAweDAwODAsIDB4MDA0MiwgMHgwMDEzLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDA5MDAsIDB4MTAwMCwgfSwKKwl7MHgxMEMzLCAweDAwMDAsIDB4
MTI4QiwgMHgwMDgwLCAweDE1NTUsIDB4MDAwMCwgMHgxNUQ4LCAweDAwODAsIDB4MDA4Miwg
MHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDE5MDAsIDB4MDEwMCwgfSwKKwl7
MHgxMDgyLCAweDAwMDAsIDB4MTFDNywgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxMTA0
LCAweDAwMDAsIDB4MTA0MSwgMHgwMUU4LCAweDU4MDEsIDB4NTlFOSwgMHhGRkZGLCAweDk5
MDAsIDB4MDkwMCwgfSwKKwl7MHgxMEMzLCAweDAwMDAsIDB4MTI4QiwgMHgwMDgwLCAweDE1
NTUsIDB4MDAwMCwgMHgxNzlGLCAweDAwODAsIDB4MDA4MywgMHgwMEZBLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDA4MDAsIDB4MTAwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4
MTFDNywgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxNTE1LCAweDAwODAsIDB4MDA4Mywg
MHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA5MDAsIDB4MTAwMCwgfSwKKwl7
MHgxMEMzLCAweDAwMDAsIDB4MTI4QiwgMHgwMDgwLCAweDE1NTUsIDB4MDAwMCwgMHgxN0RG
LCAweDAwMDAsIDB4MDA4MywgMHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDEw
MDAsIDB4ODgwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4MTFDNywgMHgwMDAwLCAweDEz
OEUsIDB4MDAwMCwgMHgxNjU5LCAweDAwMDAsIDB4MDBDMywgMHgwMEZBLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDEwMDAsIDB4OTAwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4
MTFDNywgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxNTU1LCAweDAwMDAsIDB4MDA4Mywg
MHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA4MDAsIDB4ODAwMCwgfSwKKwl7
MHgxMEMzLCAweDAwMDAsIDB4MTI4QiwgMHgwMDgwLCAweDE1NTUsIDB4MDAwMCwgMHgxNEQz
LCAweDAwMDAsIDB4MDA0MiwgMHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA5
MDAsIDB4MTAwMCwgfSwKKwl7MHgxMEMzLCAweDAwMDAsIDB4MTI4QiwgMHgwMDgwLCAweDE1
NTUsIDB4MDAwMCwgMHgxODIwLCAweDAwMDAsIDB4MDA4MywgMHgwMEZBLCAweDdERTksIDB4
N0RFOCwgMHhGRkZGLCAweDA5MDAsIDB4OTAwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4
MTFDNywgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxNTU2LCAweDAwODAsIDB4MDA4Mywg
MHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA4MDAsIDB4ODAwMCwgfSwKKwl7
MHgxMEMzLCAweDAwMDAsIDB4MTI4QiwgMHgwMDgwLCAweDE1NTUsIDB4MDAwMCwgMHgxMTg3
LCAweDAwODAsIDB4MTA0MSwgMHgwMUVFLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDk5
MDAsIDB4ODEwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4MTFDNywgMHgwMDAwLCAweDEz
OEUsIDB4MDAwMCwgMHgxNDUyLCAweDAwODAsIDB4MDA4MiwgMHgwMDEzLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDA5MDAsIDB4MTAwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4
MTFDNywgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxNjlCLCAweDAwODAsIDB4MDBDMywg
MHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDE4MDAsIDB4MDEwMCwgfSwKKwl7
MHgxMEMzLCAweDAwMDAsIDB4MTI4QiwgMHgwMDgwLCAweDE1NTUsIDB4MDAwMCwgMHgxNTE0
LCAweDAwMDAsIDB4MDA0MiwgMHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA5
MDAsIDB4MTAwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4MTFDNywgMHgwMDAwLCAweDEz
OEUsIDB4MDAwMCwgMHgxN0UwLCAweDAwODAsIDB4MDBDNCwgMHgwMEZBLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDA5MDAsIDB4OTAwMCwgfSwKKwl7MHgxMEMzLCAweDAwMDAsIDB4
MTI4QiwgMHgwMDgwLCAweDE1NTUsIDB4MDAwMCwgMHgxNTE1LCAweDAwODAsIDB4MDA0Miwg
MHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA5MDAsIDB4MTAwMCwgfSwKKwl7
MHgxMEMzLCAweDAwMDAsIDB4MTI4QiwgMHgwMDgwLCAweDE1NTUsIDB4MDAwMCwgMHgxNkRD
LCAweDAwODAsIDB4MDA4MiwgMHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDEx
MDAsIDB4MTgwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4MTFDNywgMHgwMDAwLCAweDEz
OEUsIDB4MDAwMCwgMHgxNDkzLCAweDAwODAsIDB4MDA4MiwgMHgwMEZBLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDA5MDAsIDB4MTAwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4
MTFDNywgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxNzFDLCAweDAwMDAsIDB4MDBDMywg
MHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDExMDAsIDB4MTgwMCwgfSwKKwl7
MHgxMDgyLCAweDAwMDAsIDB4MTFDNywgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxNUQ4
LCAweDAwODAsIDB4MDA4MywgMHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDE5
MDAsIDB4MDEwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4MTFDNywgMHgwMDAwLCAweDEz
OEUsIDB4MDAwMCwgMHgxNzFELCAweDAwODAsIDB4MDBDMywgMHgwMEZBLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDExMDAsIDB4MTgwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4
MTFDNywgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxNjE4LCAweDAwMDAsIDB4MDA4Mywg
MHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDE5MDAsIDB4MDEwMCwgfSwKKwl7
MHgxMDgyLCAweDAwMDAsIDB4MTFDNywgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxNzVE
LCAweDAwMDAsIDB4MDBDMywgMHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA4
MDAsIDB4MTAwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4MTFDNywgMHgwMDAwLCAweDEz
OEUsIDB4MDAwMCwgMHgxNEQ0LCAweDAwODAsIDB4MDA4MiwgMHgwMEZBLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDA5MDAsIDB4MTAwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4
MTFDNywgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxNjE5LCAweDAwODAsIDB4MDA4Mywg
MHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDEwMDAsIDB4OTAwMCwgfSwKKwl7
MHgxMDgyLCAweDAwMDAsIDB4MTFDNywgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxNzlF
LCAweDAwMDAsIDB4MDBDMywgMHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA4
MDAsIDB4MTAwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4MTFDNywgMHgwMDAwLCAweDEz
OEUsIDB4MDAwMCwgMHgxNzlGLCAweDAwODAsIDB4MDBDMywgMHgwMEZBLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDA4MDAsIDB4MTAwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4
MTFDNywgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxNTE1LCAweDAwODAsIDB4MDA4Miwg
MHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA5MDAsIDB4MTAwMCwgfSwKKwl7
MHgxMDgyLCAweDAwMDAsIDB4MTFDNywgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxM0Qw
LCAweDAwODAsIDB4MDA0MiwgMHgwMDJDLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA5
MDAsIDB4MTAwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4MTFDNywgMHgwMDAwLCAweDEz
OEUsIDB4MDAwMCwgMHgxNjlBLCAweDAwMDAsIDB4MDA4MywgMHgwMEZBLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDEwMDAsIDB4OTAwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4
MTFDNywgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxMjhCLCAweDAwODAsIDB4MDA0MSwg
MHgwMERCLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDkwMDAsIDB4MDEwMCwgfSwKKwl7
MHgxMDgyLCAweDAwMDAsIDB4MTFDNywgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxNjlC
LCAweDAwODAsIDB4MDA4MywgMHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDE4
MDAsIDB4MDEwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4MTFDNywgMHgwMDAwLCAweDEz
OEUsIDB4MDAwMCwgMHgxODIwLCAweDAwMDAsIDB4MDBDMywgMHgwMEZBLCAweDdERTksIDB4
N0RFOCwgMHhGRkZGLCAweDA5MDAsIDB4OTAwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4
MTFDNywgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxNTU2LCAweDAwODAsIDB4MDA4Miwg
MHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA4MDAsIDB4ODAwMCwgfSwKKwl7
MHgxMDgyLCAweDAwMDAsIDB4MTFDNywgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxNkRC
LCAweDAwMDAsIDB4MDA4MywgMHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDE4
MDAsIDB4MDEwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4MTFDNywgMHgwMDAwLCAweDEz
OEUsIDB4MDAwMCwgMHgxNDExLCAweDAwODAsIDB4MDA0MiwgMHgwMDJDLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDA5MDAsIDB4MTAwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4
MTFDNywgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxNzFDLCAweDAwMDAsIDB4MDA4Mywg
MHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDExMDAsIDB4MTgwMCwgfSwKKwl7
MHgxMDgyLCAweDAwMDAsIDB4MTFDNywgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxNTk3
LCAweDAwODAsIDB4MDA4MiwgMHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA4
MDAsIDB4ODAwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4MTFDNywgMHgwMDAwLCAweDEz
OEUsIDB4MDAwMCwgMHgxNDUxLCAweDAwMDAsIDB4MDA0MiwgMHgwMDEzLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDA5MDAsIDB4MTAwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4
MTFDNywgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxNzFELCAweDAwODAsIDB4MDA4Mywg
MHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDExMDAsIDB4MTgwMCwgfSwKKwl7
MHgxMDgyLCAweDAwMDAsIDB4MTFDNywgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxMkND
LCAweDAwODAsIDB4MDA0MSwgMHgwMEE5LCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDEx
MDAsIDB4OTAwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4MTFDNywgMHgwMDAwLCAweDEz
OEUsIDB4MDAwMCwgMHgxNzVELCAweDAwMDAsIDB4MDA4MywgMHgwMEZBLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDA4MDAsIDB4MTAwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4
MTFDNywgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxNDUyLCAweDAwODAsIDB4MDA0Miwg
MHgwMDEzLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA5MDAsIDB4MTAwMCwgfSwKKwl7
MHgxMDgyLCAweDAwMDAsIDB4MTFDNywgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxNUQ4
LCAweDAwODAsIDB4MDA4MiwgMHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDE5
MDAsIDB4MDEwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4MTFDNywgMHgwMDAwLCAweDEz
OEUsIDB4MDAwMCwgMHgxNzVFLCAweDAwODAsIDB4MDA4MywgMHgwMEZBLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDA4MDAsIDB4MTAwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4
MTFDNywgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxNDkyLCAweDAwMDAsIDB4MDA0Miwg
MHgwMDEzLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA5MDAsIDB4MTAwMCwgfSwKKwl7
MHgxMDgyLCAweDAwMDAsIDB4MTFDNywgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxNzlG
LCAweDAwODAsIDB4MDA4MywgMHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA4
MDAsIDB4MTAwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4MTFDNywgMHgwMDAwLCAweDEz
OEUsIDB4MDAwMCwgMHgxNjE5LCAweDAwODAsIDB4MDA4MiwgMHgwMEZBLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDEwMDAsIDB4OTAwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4
MTFDNywgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxNDkzLCAweDAwODAsIDB4MDA0Miwg
MHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA5MDAsIDB4MTAwMCwgfSwKKwl7
MHgxMDgyLCAweDAwMDAsIDB4MTFDNywgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxN0RG
LCAweDAwMDAsIDB4MDA4MywgMHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDEw
MDAsIDB4ODgwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4MTFDNywgMHgwMDAwLCAweDEz
OEUsIDB4MDAwMCwgMHgxMzBELCAweDAwODAsIDB4MDA0MSwgMHgwMDkwLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDExMDAsIDB4OTAwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4
MTFDNywgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxN0UwLCAweDAwODAsIDB4MDA4Mywg
MHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA5MDAsIDB4OTAwMCwgfSwKKwl7
MHgxMDgyLCAweDAwMDAsIDB4MTFDNywgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxNEQz
LCAweDAwMDAsIDB4MDA0MiwgMHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA5
MDAsIDB4MTAwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4MTFDNywgMHgwMDAwLCAweDEz
OEUsIDB4MDAwMCwgMHgxNjVBLCAweDAwODAsIDB4MDA4MiwgMHgwMEZBLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDEwMDAsIDB4OTAwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4
MTFDNywgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxODIwLCAweDAwMDAsIDB4MDA4Mywg
MHgwMEZBLCAweDdERTksIDB4N0RFOCwgMHhGRkZGLCAweDA5MDAsIDB4OTAwMCwgfSwKKwl7
MHgxMDgyLCAweDAwMDAsIDB4MTFDNywgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxNEQ0
LCAweDAwODAsIDB4MDA0MiwgMHgwMEZBLCAweDdDMDEsIDB4N0RFOSwgMHhGRkZGLCAweDA5
MDAsIDB4MTAwMCwgfSwKKwl7MHgxMDgyLCAweDAwMDAsIDB4MTFDNywgMHgwMDAwLCAweDEz
OEUsIDB4MDAwMCwgMHgxNjlCLCAweDAwODAsIDB4MDA4MiwgMHgwMEZBLCAweDdDMDEsIDB4
N0RFOSwgMHhGRkZGLCAweDE4MDAsIDB4MDEwMCwgfSwKK307CisKK3N0YXRpYyBjb25zdCB1
aW50MTZfdCBjbXRfdmFsc19pbltdWzEzXSA9IHsKKwl7MHgxMDgyLCAweDAwMDAsIDB4NTEw
NCwgMHgwMDAwLCAweDExQzcsIDB4MDAwMCwgMHgxMDQxLCAweDAyQkMsIDB4N0MwMSwgMHhG
RkU5LCAweDk5MDAsIDB4OTkwOCwgMHg4MTAwfSwKKwl7MHgxMTA0LCAweDAwMDAsIDB4OTIw
OCwgMHgwMDAwLCAweDEzOEUsIDB4MDAwMCwgMHgxMDQxLCAweDAxNUUsIDB4N0MwMSwgMHhG
RkU5LCAweDAxMDAsIDB4MDkwOCwgMHgxMDAwfSwKK307CisKK3N0YXRpYyBjb25zdCB1aW50
MzJfdCBjbXRfYWRkcnNfb3V0W11bMTVdID0geworCXsweDQyMCwgMHg0MjQsIDB4NDI4LCAw
eDQyQywgMHg0MzAsIDB4NDM0LCAweDQ1MCwgMHg0NTQsIDB4NDU4LCAweDQ2MCwgMHg0NjQs
IDB4NDY4LCAweDRBMCwgMHg1MzgsIDB4NTNDfSwKKwl7MHg2MjAsIDB4NjI0LCAweDYyOCwg
MHg2MkMsIDB4NjMwLCAweDYzNCwgMHg2NTAsIDB4NjU0LCAweDY1OCwgMHg2NjAsIDB4NjY0
LCAweDY2OCwgMHg2QTAsIDB4NzM4LCAweDczQ30sCit9OworCitzdGF0aWMgY29uc3QgdWlu
dDMyX3QgY210X2FkZHJzX2luW11bMTNdID0geworCXsweDAyMCwgMHgwMjQsIDB4MDI4LCAw
eDAyQywgMHgwNTAsIDB4MDU0LCAweDA1OCwgMHgwNjAsIDB4MDY0LCAweDA2OCwgMHgwQTAs
IDB4MTM4LCAweDEzQ30sCisJezB4MjIwLCAweDIyNCwgMHgyMjgsIDB4MjJDLCAweDI1MCwg
MHgyNTQsIDB4MjU4LCAweDI2MCwgMHgyNjQsIDB4MjY4LCAweDJBMCwgMHgzMzgsIDB4MzND
fSwKK307CisKK3N0YXRpYyBjb25zdCB1aW50MzJfdCBjbXRfZnJlcVtdID0geworCTI1MDAw
LCAyNTUxMCwgMjYwMjAsIDI2NTMwLCAyNjk4MywgMjc1NTEsIDI4MDAwLCAyODU3MCwKKwky
OTA0NiwgMjk1MjIsIDMwMDAwLCAzMDQ3NiwgMzA5NTIsIDMxNTQ2LCAzMjAwMCwgMzI1Mzks
CisJMzMwMzUsIDMzNTcxLCAzMzkyOCwgMzQ1MjIsIDM1MDAwLCAzNTQyOCwgMzYwMDAsIDM2
NTcxLAorCTM2OTA0LCAzNzUwMCwgMzgwOTMsIDM4NTcxLCAzOTA0NywgMzk0NTMsIDQwMDAw
LCA0MDQ3NiwKKwk0MDk1MiwgNDE0OTQsIDQxOTY0LCA0Mjg1NywgNDM1MzUsIDQ0MDQ3LCA0
NDQ0NCwgNDUwMDAsCisJNDU1MzUsIDQ2MDI5LCA0NjQyOCwgNDY4MjMsIDQ3NjE3LCA0ODIx
NCwgNDg1NzEsIDQ5MTA3LAorCTQ5NTIzLCA1MDAwMCwgNTA0NzYsIDUwODkyLCA1MTQyOCwg
NTIzODAsIDUzMzMzLCA1Mzk2NywKKwk1NDI4NSwgNTUyMzgsIDU1NTU1LCA1NTk1MiwgNTcx
NDIsIDU4MDk1LCA1ODU3MSwgNTkwNDcsCisJNTk1MjEsIDYwMDAwLCA2MDMxNiwgNjA5NTIs
IDYxNDI4LCA2MTkwNCwgNjI1MDAsIDYzMDkyLAorCTYzNDkxLCA2NDI4MiwgNjUwNzgsIDY1
NDc2LCA2NjA3MSwgNjY2NjQsIDY3MTQyLCA2Nzg1NCwKKwk2ODU3MSwgNjkwNDQsIDY5NjQy
LCA3MDAwMCwgNzE0MjUsIDcyNjE2LCA3MzIxNCwgNzM4MDgsCisJNzQyODUsIDc1MDAwLCA3
NTcxNCwgNzYxODcsIDc2Nzg1LCA3NzE0MiwgNzg1NzAsIDgwMDAwLAorCTgwMzU3LCA4MDk1
MSwgODE0MjgsIDgyMTQyLCA4Mjg1NywgODMzMzIsIDgzOTI4LCA4NDI4NSwKKwk4NTcxMywg
ODcxNDIsIDg3NTAwLCA4ODA5NCwgODg1NzEsIDg5Mjg1LCA5MDAwMCwgOTA0NzUsCisJOTEw
NzEsIDkxNDI4LCA5Mjg1NiwgOTQ2NDIsCit9OworCisKK3N0YXRpYyBzaXplX3QgZnJlcV9z
cmNoKHUzMiBrZXksIGNvbnN0IHUzMiAqYXJyYXksIHNpemVfdCBzaXplKQoreworCWludCBs
ID0gMDsKKwlpbnQgciA9IHNpemUgLSAxOworCWludCBtOworCisJd2hpbGUgKGwgPD0gcikg
eworCQltID0gKGwgKyByKSAvIDI7CisJCWlmIChhcnJheVttXSA8IGtleSkKKwkJCWwgPSBt
ICsgMTsKKwkJZWxzZSBpZiAoYXJyYXlbbV0gPiBrZXkpCisJCQlyID0gbSAtIDE7CisJCWVs
c2UKKwkJCXJldHVybiBtOworCX0KKworCWlmIChyIDwgMCB8fCBsID4gc2l6ZSAtIDEpCisJ
CXJldHVybiBtOworCWVsc2UKKwkJcmV0dXJuIChhYnMoa2V5IC0gYXJyYXlbbF0pIDwgYWJz
KGtleSAtIGFycmF5W3JdKSkgPyBsIDogcjsKK30KKworCit1MzIgbWdiNF9jbXRfc2V0X3Zv
dXQoc3RydWN0IG1nYjRfdm91dF9kZXYgKnZvdXRkZXYsIHVuc2lnbmVkIGludCBmcmVxKQor
eworCWNvbnN0IHVpbnQxNl90ICpyZWdfc2V0OworCWNvbnN0IHVpbnQzMl90ICphZGRyOwor
CXUzMiBjb25maWc7CisJc2l6ZV90IGksIGluZGV4OworCisJaW5kZXggPSBmcmVxX3NyY2go
ZnJlcSwgY210X2ZyZXEsIEFSUkFZX1NJWkUoY210X2ZyZXEpKTsKKwlhZGRyID0gY210X2Fk
ZHJzX291dFt2b3V0ZGV2LT5jb25maWctPmlkXTsKKwlyZWdfc2V0ID0gY210X3ZhbHNfb3V0
W2luZGV4XTsKKworCWNvbmZpZyA9IG1nYjRfcmVhZF9yZWcoJnZvdXRkZXYtPm1nYmRldi0+
dmlkZW8sIHZvdXRkZXYtPmNvbmZpZy0+cmVncy5jb25maWcpOworCisJbWdiNF93cml0ZV9y
ZWcoJnZvdXRkZXYtPm1nYmRldi0+dmlkZW8sIHZvdXRkZXYtPmNvbmZpZy0+cmVncy5jb25m
aWcsCisJICAweDEgfCAoY29uZmlnICYgfjB4MykpOworCisJZm9yIChpID0gMDsgaSA8IEFS
UkFZX1NJWkUoY210X2FkZHJzX291dFswXSk7IGkrKykKKwkJbWdiNF93cml0ZV9yZWcoJnZv
dXRkZXYtPm1nYmRldi0+Y210LCBhZGRyW2ldLCByZWdfc2V0W2ldKTsKKworCW1nYjRfbWFz
a19yZWcoJnZvdXRkZXYtPm1nYmRldi0+dmlkZW8sIHZvdXRkZXYtPmNvbmZpZy0+cmVncy5j
b25maWcsCisJICAweDEwMCwgMHgxMDApOworCW1nYjRfbWFza19yZWcoJnZvdXRkZXYtPm1n
YmRldi0+dmlkZW8sIHZvdXRkZXYtPmNvbmZpZy0+cmVncy5jb25maWcsCisJICAweDEwMCwg
MHgwKTsKKworCW1nYjRfd3JpdGVfcmVnKCZ2b3V0ZGV2LT5tZ2JkZXYtPnZpZGVvLCB2b3V0
ZGV2LT5jb25maWctPnJlZ3MuY29uZmlnLAorCSAgY29uZmlnICYgfjB4MSk7CisKKwlyZXR1
cm4gY210X2ZyZXFbaW5kZXhdOworfQorCit2b2lkIG1nYjRfY210X3NldF92aW4oc3RydWN0
IG1nYjRfdmluX2RldiAqdmluZGV2LCB1bnNpZ25lZCBpbnQgZnJlcV9yYW5nZSkKK3sKKwlj
b25zdCB1aW50MTZfdCAqcmVnX3NldDsKKwljb25zdCB1aW50MzJfdCAqYWRkcjsKKwl1MzIg
Y29uZmlnOworCXNpemVfdCBpOworCisJYWRkciA9IGNtdF9hZGRyc19pblt2aW5kZXYtPmNv
bmZpZy0+aWRdOworCXJlZ19zZXQgPSBjbXRfdmFsc19pbltmcmVxX3JhbmdlXTsKKworCWNv
bmZpZyA9IG1nYjRfcmVhZF9yZWcoJnZpbmRldi0+bWdiZGV2LT52aWRlbywgdmluZGV2LT5j
b25maWctPnJlZ3MuY29uZmlnKTsKKworCW1nYjRfd3JpdGVfcmVnKCZ2aW5kZXYtPm1nYmRl
di0+dmlkZW8sIHZpbmRldi0+Y29uZmlnLT5yZWdzLmNvbmZpZywKKwkgIDB4MSB8IChjb25m
aWcgJiB+MHgzKSk7CisKKwlmb3IgKGkgPSAwOyBpIDwgQVJSQVlfU0laRShjbXRfYWRkcnNf
aW5bMF0pOyBpKyspCisJCW1nYjRfd3JpdGVfcmVnKCZ2aW5kZXYtPm1nYmRldi0+Y210LCBh
ZGRyW2ldLCByZWdfc2V0W2ldKTsKKworCW1nYjRfbWFza19yZWcoJnZpbmRldi0+bWdiZGV2
LT52aWRlbywgdmluZGV2LT5jb25maWctPnJlZ3MuY29uZmlnLAorCSAgMHgxMDAwLCAweDEw
MDApOworCW1nYjRfbWFza19yZWcoJnZpbmRldi0+bWdiZGV2LT52aWRlbywgdmluZGV2LT5j
b25maWctPnJlZ3MuY29uZmlnLAorCSAgMHgxMDAwLCAweDApOworCisJbWdiNF93cml0ZV9y
ZWcoJnZpbmRldi0+bWdiZGV2LT52aWRlbywgdmluZGV2LT5jb25maWctPnJlZ3MuY29uZmln
LAorCSAgY29uZmlnICYgfjB4MSk7Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3Bj
aS9tZ2I0L21nYjRfY210LmggYi9kcml2ZXJzL21lZGlhL3BjaS9tZ2I0L21nYjRfY210LmgK
bmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi4zNTM5NjY2NTRjOTUK
LS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL21lZGlhL3BjaS9tZ2I0L21nYjRfY210LmgK
QEAgLTAsMCArMSwxNiBAQAorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAt
b25seSAqLworLyoKKyAqIENvcHlyaWdodCAoQykgMjAyMS0yMDIyIERpZ2l0ZXEgQXV0b21v
dGl2ZQorICogICAgIGF1dGhvcjogTWFydGluIFR1bWEgPG1hcnRpbi50dW1hQGRpZ2l0ZXFh
dXRvbW90aXZlLmNvbT4KKyAqLworCisjaWZuZGVmIF9fTUdCNF9DTVRfSF9fCisjZGVmaW5l
IF9fTUdCNF9DTVRfSF9fCisKKyNpbmNsdWRlICJtZ2I0X3ZvdXQuaCIKKyNpbmNsdWRlICJt
Z2I0X3Zpbi5oIgorCit1MzIgbWdiNF9jbXRfc2V0X3ZvdXQoc3RydWN0IG1nYjRfdm91dF9k
ZXYgKnZvdXRkZXYsIHVuc2lnbmVkIGludCBmcmVxKTsKK3ZvaWQgbWdiNF9jbXRfc2V0X3Zp
bihzdHJ1Y3QgbWdiNF92aW5fZGV2ICp2aW5kZXYsIHVuc2lnbmVkIGludCBmcmVxX3Jhbmdl
KTsKKworI2VuZGlmCmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3BjaS9tZ2I0L21nYjRf
Y29yZS5jIGIvZHJpdmVycy9tZWRpYS9wY2kvbWdiNC9tZ2I0X2NvcmUuYwpuZXcgZmlsZSBt
b2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLmMwOTg4MmMxNTI1YgotLS0gL2Rldi9u
dWxsCisrKyBiL2RyaXZlcnMvbWVkaWEvcGNpL21nYjQvbWdiNF9jb3JlLmMKQEAgLTAsMCAr
MSw2NTYgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9ubHkKKy8q
CisgKiBUaGlzIGlzIHRoZSBkcml2ZXIgZm9yIHRoZSBNR0I0IHZpZGVvIGdyYWJiZXIgY2Fy
ZCBieSBEaWdpdGVxIEF1dG9tb3RpdmUuCisgKgorICogQ29weXJpZ2h0IChDKSAyMDIxLTIw
MjIgRGlnaXRlcSBBdXRvbW90aXZlCisgKiAgICAgYXV0aG9yOiBNYXJ0aW4gVHVtYSA8bWFy
dGluLnR1bWFAZGlnaXRlcWF1dG9tb3RpdmUuY29tPgorICovCisKKyNpbmNsdWRlIDxsaW51
eC90eXBlcy5oPgorI2luY2x1ZGUgPGxpbnV4L3ZlcnNpb24uaD4KKyNpbmNsdWRlIDxsaW51
eC9tb2R1bGUuaD4KKyNpbmNsdWRlIDxsaW51eC9wY2kuaD4KKyNpbmNsdWRlIDxsaW51eC9w
bGF0Zm9ybV9kZXZpY2UuaD4KKyNpbmNsdWRlIDxsaW51eC9jbGsuaD4KKyNpbmNsdWRlIDxs
aW51eC9jbGstcHJvdmlkZXIuaD4KKyNpbmNsdWRlIDxsaW51eC9jbGtkZXYuaD4KKyNpbmNs
dWRlIDxsaW51eC9pMmMuaD4KKyNpbmNsdWRlIDxsaW51eC9kZWxheS5oPgorI2luY2x1ZGUg
PGxpbnV4L2RtYS9hbWRfeGRtYS5oPgorI2luY2x1ZGUgPGxpbnV4L3BsYXRmb3JtX2RhdGEv
YW1kX3hkbWEuaD4KKyNpbmNsdWRlIDxsaW51eC9zcGkveGlsaW54X3NwaS5oPgorI2luY2x1
ZGUgPGxpbnV4L210ZC9tdGQuaD4KKyNpbmNsdWRlICJtZ2I0X2RtYS5oIgorI2luY2x1ZGUg
Im1nYjRfaTJjLmgiCisjaW5jbHVkZSAibWdiNF9zeXNmcy5oIgorI2luY2x1ZGUgIm1nYjRf
dm91dC5oIgorI2luY2x1ZGUgIm1nYjRfdmluLmgiCisjaW5jbHVkZSAibWdiNF90cmlnZ2Vy
LmgiCisjaW5jbHVkZSAibWdiNF9jb3JlLmgiCisKKworI2RlZmluZSBNR0I0X1VTRVJfSVJR
UyAxNgorCitzdGF0aWMgaW50IGZsYXNoaWQ7CisKK3N0YXRpYyBzdHJ1Y3QgeGRtYV9jaGFu
X2luZm8gaDJjX2NoYW5faW5mbyA9IHsKKwkuZGlyID0gRE1BX01FTV9UT19ERVYsCit9Owor
CitzdGF0aWMgc3RydWN0IHhkbWFfY2hhbl9pbmZvIGMyaF9jaGFuX2luZm8gPSB7CisJLmRp
ciA9IERNQV9ERVZfVE9fTUVNLAorfTsKKworc3RhdGljIHN0cnVjdCB4c3BpX3BsYXRmb3Jt
X2RhdGEgc3BpX3BsYXRmb3JtX2RhdGEgPSB7CisJLm51bV9jaGlwc2VsZWN0ID0gMSwKKwku
Yml0c19wZXJfd29yZCA9IDgKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgaTJjX2JvYXJk
X2luZm8gZXh0ZW5kZXJfaW5mbyA9IHsKKwlJMkNfQk9BUkRfSU5GTygiZXh0ZW5kZXIiLCAw
eDIxKQorfTsKKworc3RhdGljIGludCBtYXRjaF9pMmNfYWRhcChzdHJ1Y3QgZGV2aWNlICpk
ZXYsIHZvaWQgKmRhdGEpCit7CisJcmV0dXJuIChpMmNfdmVyaWZ5X2FkYXB0ZXIoZGV2KSAh
PSBOVUxMKTsKK30KKworc3RhdGljIHN0cnVjdCBpMmNfYWRhcHRlciAqZ2V0X2kyY19hZGFw
KHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYpCit7CisJc3RydWN0IGRldmljZSAqZGV2
OworCWludCBpOworCisJZm9yIChpID0gMDsgaSA8IDEwOyBpKyspIHsKKwkJbXNsZWVwKDEw
MCk7CisJCW11dGV4X2xvY2soJnBkZXYtPmRldi5tdXRleCk7CisJCWRldiA9IGRldmljZV9m
aW5kX2NoaWxkKCZwZGV2LT5kZXYsIE5VTEwsIG1hdGNoX2kyY19hZGFwKTsKKwkJbXV0ZXhf
dW5sb2NrKCZwZGV2LT5kZXYubXV0ZXgpOworCQlpZiAoZGV2KQorCQkJcmV0dXJuIHRvX2ky
Y19hZGFwdGVyKGRldik7CisJfQorCisJcmV0dXJuIE5VTEw7Cit9CisKK3N0YXRpYyBpbnQg
bWF0Y2hfc3BpX2FkYXAoc3RydWN0IGRldmljZSAqZGV2LCB2b2lkICpkYXRhKQoreworCXJl
dHVybiAodG9fc3BpX2RldmljZShkZXYpICE9IE5VTEwpOworfQorCitzdGF0aWMgc3RydWN0
IHNwaV9tYXN0ZXIgKmdldF9zcGlfYWRhcChzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2
KQoreworCXN0cnVjdCBkZXZpY2UgKmRldjsKKwlpbnQgaTsKKworCWZvciAoaSA9IDA7IGkg
PCAxMDsgaSsrKSB7CisJCW1zbGVlcCgxMDApOworCQltdXRleF9sb2NrKCZwZGV2LT5kZXYu
bXV0ZXgpOworCQlkZXYgPSBkZXZpY2VfZmluZF9jaGlsZCgmcGRldi0+ZGV2LCBOVUxMLCBt
YXRjaF9zcGlfYWRhcCk7CisJCW11dGV4X3VubG9jaygmcGRldi0+ZGV2Lm11dGV4KTsKKwkJ
aWYgKGRldikKKwkJCXJldHVybiBjb250YWluZXJfb2YoZGV2LCBzdHJ1Y3Qgc3BpX21hc3Rl
ciwgZGV2KTsKKwl9CisKKwlyZXR1cm4gTlVMTDsKK30KKworc3RhdGljIGludCBpbml0X3Nw
aShzdHJ1Y3QgbWdiNF9kZXYgKm1nYmRldikKK3sKKwlzdHJ1Y3QgcmVzb3VyY2Ugc3BpX3Jl
c291cmNlc1tdID0geworCQl7CisJCQkuc3RhcnQJPSAweDQwMCwKKwkJCS5lbmQJPSAweDQ3
ZiwKKwkJCS5mbGFncwk9IElPUkVTT1VSQ0VfTUVNLAorCQkJLm5hbWUJPSAiaW8tbWVtb3J5
IiwKKwkJfSwKKwkJeworCQkJLnN0YXJ0CT0gMTQsCisJCQkuZW5kCT0gMTQsCisJCQkuZmxh
Z3MJPSBJT1JFU09VUkNFX0lSUSwKKwkJCS5uYW1lCT0gImlycSIsCisJCX0sCisJfTsKKwlz
dHJ1Y3Qgc3BpX2JvYXJkX2luZm8gc3BpX2luZm8gPSB7CisJCS5tYXhfc3BlZWRfaHogPSAx
MDAwMDAwMCwKKwkJLm1vZGFsaWFzID0gIm0yNXA4MCIsCisJCS5jaGlwX3NlbGVjdCA9IDAs
CisJCS5tb2RlID0gU1BJX01PREVfMywKKwl9OworCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0g
bWdiZGV2LT5wZGV2OworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZwZGV2LT5kZXY7CisJc3Ry
dWN0IHNwaV9tYXN0ZXIgKm1hc3RlcjsKKwlzdHJ1Y3Qgc3BpX2RldmljZSAqc3BpX2RldjsK
Kwl1MzIgaXJxOworCWludCBydiwgaWQ7CisJcmVzb3VyY2Vfc2l6ZV90IG1hcGJhc2UgPSBw
Y2lfcmVzb3VyY2Vfc3RhcnQocGRldiwgTUdCNF9NR0I0X0JBUl9JRCk7CisKKwlpcnEgPSB4
ZG1hX2dldF91c2VyX2lycShtZ2JkZXYtPnhkZXYsIDE0KTsKKwl4ZG1hX2VuYWJsZV91c2Vy
X2lycShtZ2JkZXYtPnhkZXYsIGlycSk7CisKKwlzcGlfcmVzb3VyY2VzWzBdLnBhcmVudCA9
ICZwZGV2LT5yZXNvdXJjZVtNR0I0X01HQjRfQkFSX0lEXTsKKwlzcGlfcmVzb3VyY2VzWzBd
LnN0YXJ0ICs9IG1hcGJhc2U7CisJc3BpX3Jlc291cmNlc1swXS5lbmQgKz0gbWFwYmFzZTsK
KwlzcGlfcmVzb3VyY2VzWzFdLnN0YXJ0ID0gaXJxOworCXNwaV9yZXNvdXJjZXNbMV0uZW5k
ID0gaXJxOworCisJaWQgPSBwY2lfZGV2X2lkKHBkZXYpOworCW1nYmRldi0+c3BpX3BkZXYg
PSBwbGF0Zm9ybV9kZXZpY2VfcmVnaXN0ZXJfcmVzbmRhdGEoZGV2LCAieGlsaW54X3NwaSIs
CisJCWlkLCBzcGlfcmVzb3VyY2VzLCBBUlJBWV9TSVpFKHNwaV9yZXNvdXJjZXMpLCAmc3Bp
X3BsYXRmb3JtX2RhdGEsCisJCXNpemVvZihzcGlfcGxhdGZvcm1fZGF0YSkpOworCWlmIChJ
U19FUlIobWdiZGV2LT5zcGlfcGRldikpIHsKKwkJZGV2X2VycihkZXYsICJmYWlsZWQgdG8g
cmVnaXN0ZXIgU1BJIGRldmljZVxuIik7CisJCXJldHVybiBQVFJfRVJSKG1nYmRldi0+c3Bp
X3BkZXYpOworCX0KKworCW1hc3RlciA9IGdldF9zcGlfYWRhcChtZ2JkZXYtPnNwaV9wZGV2
KTsKKwlpZiAoIW1hc3RlcikgeworCQlkZXZfZXJyKGRldiwgImZhaWxlZCB0byBnZXQgU1BJ
IGFkYXB0ZXJcbiIpOworCQlydiA9IC1FSU5WQUw7CisJCWdvdG8gZXJyX3BkZXY7CisJfQor
CisJc25wcmludGYobWdiZGV2LT5md19wYXJ0X25hbWUsIHNpemVvZihtZ2JkZXYtPmZ3X3Bh
cnRfbmFtZSksICJtZ2I0LWZ3LiVkIiwKKwkgIGZsYXNoaWQpOworCW1nYmRldi0+cGFydGl0
aW9uc1swXS5uYW1lID0gbWdiZGV2LT5md19wYXJ0X25hbWU7CisJbWdiZGV2LT5wYXJ0aXRp
b25zWzBdLnNpemUgPSAweDQwMDAwMDsKKwltZ2JkZXYtPnBhcnRpdGlvbnNbMF0ub2Zmc2V0
ID0gMHg0MDAwMDA7CisJbWdiZGV2LT5wYXJ0aXRpb25zWzBdLm1hc2tfZmxhZ3MgPSAwOwor
CisJc25wcmludGYobWdiZGV2LT5kYXRhX3BhcnRfbmFtZSwgc2l6ZW9mKG1nYmRldi0+ZGF0
YV9wYXJ0X25hbWUpLAorCSAgIm1nYjQtZGF0YS4lZCIsIGZsYXNoaWQpOworCW1nYmRldi0+
cGFydGl0aW9uc1sxXS5uYW1lID0gbWdiZGV2LT5kYXRhX3BhcnRfbmFtZTsKKwltZ2JkZXYt
PnBhcnRpdGlvbnNbMV0uc2l6ZSA9IDB4MTAwMDA7CisJbWdiZGV2LT5wYXJ0aXRpb25zWzFd
Lm9mZnNldCA9IDB4RkYwMDAwOworCW1nYmRldi0+cGFydGl0aW9uc1sxXS5tYXNrX2ZsYWdz
ID0gTVREX0NBUF9OT1JGTEFTSDsKKworCXNucHJpbnRmKG1nYmRldi0+Zmxhc2hfbmFtZSwg
c2l6ZW9mKG1nYmRldi0+Zmxhc2hfbmFtZSksICJtZ2I0LWZsYXNoLiVkIiwKKwkgIGZsYXNo
aWQpOworCW1nYmRldi0+Zmxhc2hfZGF0YS5uYW1lID0gbWdiZGV2LT5mbGFzaF9uYW1lOwor
CW1nYmRldi0+Zmxhc2hfZGF0YS5wYXJ0cyA9IG1nYmRldi0+cGFydGl0aW9uczsKKwltZ2Jk
ZXYtPmZsYXNoX2RhdGEubnJfcGFydHMgPSBBUlJBWV9TSVpFKG1nYmRldi0+cGFydGl0aW9u
cyk7CisJbWdiZGV2LT5mbGFzaF9kYXRhLnR5cGUgPSAic3BpLW5vciI7CisKKwlzcGlfaW5m
by5wbGF0Zm9ybV9kYXRhID0gJihtZ2JkZXYtPmZsYXNoX2RhdGEpOworCisJc3BpX2RldiA9
IHNwaV9uZXdfZGV2aWNlKG1hc3RlciwgJnNwaV9pbmZvKTsKKwlwdXRfZGV2aWNlKCZtYXN0
ZXItPmRldik7CisJaWYgKCFzcGlfZGV2KSB7CisJCWRldl9lcnIoZGV2LCAiZmFpbGVkIHRv
IGNyZWF0ZSBNVEQgZGV2aWNlXG4iKTsKKwkJcnYgPSAtRUlOVkFMOworCQlnb3RvIGVycl9w
ZGV2OworCX0KKworCXJldHVybiAwOworCitlcnJfcGRldjoKKwlwbGF0Zm9ybV9kZXZpY2Vf
dW5yZWdpc3RlcihtZ2JkZXYtPnNwaV9wZGV2KTsKKworCXJldHVybiBydjsKK30KKworc3Rh
dGljIHZvaWQgZnJlZV9zcGkoc3RydWN0IG1nYjRfZGV2ICptZ2JkZXYpCit7CisJcGxhdGZv
cm1fZGV2aWNlX3VucmVnaXN0ZXIobWdiZGV2LT5zcGlfcGRldik7Cit9CisKK3N0YXRpYyBp
bnQgaW5pdF9pMmMoc3RydWN0IG1nYjRfZGV2ICptZ2JkZXYpCit7CisJc3RydWN0IHJlc291
cmNlIGkyY19yZXNvdXJjZXNbXSA9IHsKKwkJeworCQkJLnN0YXJ0CT0gMHgyMDAsCisJCQku
ZW5kCT0gMHgzZmYsCisJCQkuZmxhZ3MJPSBJT1JFU09VUkNFX01FTSwKKwkJCS5uYW1lCT0g
ImlvLW1lbW9yeSIsCisJCX0sCisJCXsKKwkJCS5zdGFydAk9IDE1LAorCQkJLmVuZAk9IDE1
LAorCQkJLmZsYWdzCT0gSU9SRVNPVVJDRV9JUlEsCisJCQkubmFtZQk9ICJpcnEiLAorCQl9
LAorCX07CisJc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBtZ2JkZXYtPnBkZXY7CisJc3RydWN0
IGRldmljZSAqZGV2ID0gJnBkZXYtPmRldjsKKwljaGFyIGNsa19uYW1lWzE2XTsKKwl1MzIg
aXJxOworCWludCBydiwgaWQ7CisJcmVzb3VyY2Vfc2l6ZV90IG1hcGJhc2UgPSBwY2lfcmVz
b3VyY2Vfc3RhcnQocGRldiwgTUdCNF9NR0I0X0JBUl9JRCk7CisKKwlpcnEgPSB4ZG1hX2dl
dF91c2VyX2lycShtZ2JkZXYtPnhkZXYsIDE1KTsKKwl4ZG1hX2VuYWJsZV91c2VyX2lycSht
Z2JkZXYtPnhkZXYsIGlycSk7CisKKwlpMmNfcmVzb3VyY2VzWzBdLnBhcmVudCA9ICZwZGV2
LT5yZXNvdXJjZVtNR0I0X01HQjRfQkFSX0lEXTsKKwlpMmNfcmVzb3VyY2VzWzBdLnN0YXJ0
ICs9IG1hcGJhc2U7CisJaTJjX3Jlc291cmNlc1swXS5lbmQgKz0gbWFwYmFzZTsKKwlpMmNf
cmVzb3VyY2VzWzFdLnN0YXJ0ID0gaXJxOworCWkyY19yZXNvdXJjZXNbMV0uZW5kID0gaXJx
OworCisJaWQgPSBwY2lfZGV2X2lkKHBkZXYpOworCisJLy8gY3JlYXRlIGR1bW15IGNsb2Nr
IHJlcXVpcmVkIGJ5IHRoZSB4aWljLWkyYyBhZGFwdGVyCisJc25wcmludGYoY2xrX25hbWUs
IHNpemVvZihjbGtfbmFtZSksICJ4aWljLWkyYy4lZCIsIGlkKTsKKwltZ2JkZXYtPmkyY19j
bGsgPSBjbGtfaHdfcmVnaXN0ZXJfZml4ZWRfcmF0ZShOVUxMLCBjbGtfbmFtZSwgTlVMTCwg
MCwgMTI1MDAwMDAwKTsKKwlpZiAoSVNfRVJSKG1nYmRldi0+aTJjX2NsaykpIHsKKwkJZGV2
X2VycihkZXYsICJmYWlsZWQgdG8gcmVnaXN0ZXIgSTJDIGNsb2NrXG4iKTsKKwkJcmV0dXJu
IFBUUl9FUlIobWdiZGV2LT5pMmNfY2xrKTsKKwl9CisJbWdiZGV2LT5pMmNfY2wgPSBjbGtk
ZXZfaHdfY3JlYXRlKG1nYmRldi0+aTJjX2NsaywgTlVMTCwgInhpaWMtaTJjLiVkIiwgaWQp
OworCWlmICghbWdiZGV2LT5pMmNfY2wpIHsKKwkJZGV2X2VycihkZXYsICJmYWlsZWQgdG8g
cmVnaXN0ZXIgSTJDIGNsb2NrZGV2XG4iKTsKKwkJcnYgPSAtRU5PTUVNOworCQlnb3RvIGVy
cl9jbGs7CisJfQorCisJbWdiZGV2LT5pMmNfcGRldiA9IHBsYXRmb3JtX2RldmljZV9yZWdp
c3Rlcl9yZXNuZGF0YShkZXYsICJ4aWljLWkyYyIsCisJCWlkLCBpMmNfcmVzb3VyY2VzLCBB
UlJBWV9TSVpFKGkyY19yZXNvdXJjZXMpLCBOVUxMLCAwKTsKKwlpZiAoSVNfRVJSKG1nYmRl
di0+aTJjX3BkZXYpKSB7CisJCWRldl9lcnIoZGV2LCAiZmFpbGVkIHRvIHJlZ2lzdGVyIEky
QyBkZXZpY2VcbiIpOworCQlydiA9IFBUUl9FUlIobWdiZGV2LT5pMmNfcGRldik7CisJCWdv
dG8gZXJyX2Nsa2RldjsKKwl9CisKKwltZ2JkZXYtPmkyY19hZGFwID0gZ2V0X2kyY19hZGFw
KG1nYmRldi0+aTJjX3BkZXYpOworCWlmICghbWdiZGV2LT5pMmNfYWRhcCkgeworCQlkZXZf
ZXJyKGRldiwgImZhaWxlZCB0byBnZXQgSTJDIGFkYXB0ZXJcbiIpOworCQlydiA9IC1FSU5W
QUw7CisJCWdvdG8gZXJyX3BkZXY7CisJfQorCisJbXV0ZXhfaW5pdCgmbWdiZGV2LT5pMmNf
bG9jayk7CisKKwlyZXR1cm4gMDsKKworZXJyX3BkZXY6CisJcGxhdGZvcm1fZGV2aWNlX3Vu
cmVnaXN0ZXIobWdiZGV2LT5pMmNfcGRldik7CitlcnJfY2xrZGV2OgorCWNsa2Rldl9kcm9w
KG1nYmRldi0+aTJjX2NsKTsKK2Vycl9jbGs6CisJY2xrX2h3X3VucmVnaXN0ZXIobWdiZGV2
LT5pMmNfY2xrKTsKKworCXJldHVybiBydjsKK30KKworc3RhdGljIHZvaWQgZnJlZV9pMmMo
c3RydWN0IG1nYjRfZGV2ICptZ2JkZXYpCit7CisJcHV0X2RldmljZSgmbWdiZGV2LT5pMmNf
YWRhcC0+ZGV2KTsKKwlwbGF0Zm9ybV9kZXZpY2VfdW5yZWdpc3RlcihtZ2JkZXYtPmkyY19w
ZGV2KTsKKwljbGtkZXZfZHJvcChtZ2JkZXYtPmkyY19jbCk7CisJY2xrX2h3X3VucmVnaXN0
ZXIobWdiZGV2LT5pMmNfY2xrKTsKK30KKworc3RhdGljIGludCBpbml0X3N5c2ZzKHN0cnVj
dCBwY2lfZGV2ICpwZGV2KQoreworCXN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICoqYXR0ciwg
KiplYXR0cjsKKwlpbnQgcnY7CisKKwlmb3IgKGF0dHIgPSBtZ2I0X3BjaV9hdHRyczsgKmF0
dHI7IGF0dHIrKykgeworCQlydiA9IGRldmljZV9jcmVhdGVfZmlsZSgmcGRldi0+ZGV2LCAq
YXR0cik7CisJCWlmIChydiA8IDApCisJCQlnb3RvIGVycl9maWxlOworCX0KKworCXJldHVy
biAwOworCitlcnJfZmlsZToKKwlmb3IgKGVhdHRyID0gbWdiNF9wY2lfYXR0cnM7IGVhdHRy
ICE9IGF0dHI7IGVhdHRyKyspCisJCWRldmljZV9yZW1vdmVfZmlsZSgmcGRldi0+ZGV2LCAq
ZWF0dHIpOworCisJcmV0dXJuIHJ2OworfQorCitzdGF0aWMgdm9pZCBmcmVlX3N5c2ZzKHN0
cnVjdCBwY2lfZGV2ICpwZGV2KQoreworCXN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICoqYXR0
cjsKKworCWZvciAoYXR0ciA9IG1nYjRfcGNpX2F0dHJzOyAqYXR0cjsgYXR0cisrKQorCQlk
ZXZpY2VfcmVtb3ZlX2ZpbGUoJnBkZXYtPmRldiwgKmF0dHIpOworfQorCitzdGF0aWMgaW50
IGdldF9zZXJpYWxfbnVtYmVyKHN0cnVjdCBtZ2I0X2RldiAqbWdiZGV2KQoreworCXN0cnVj
dCBkZXZpY2UgKmRldiA9ICZtZ2JkZXYtPnBkZXYtPmRldjsKKwlzdHJ1Y3QgbXRkX2luZm8g
Km10ZDsKKwlzaXplX3QgcnM7CisJaW50IHJ2OworCisJbWdiZGV2LT5zZXJpYWxfbnVtYmVy
ID0gMDsKKworCW10ZCA9IGdldF9tdGRfZGV2aWNlX25tKG1nYmRldi0+ZGF0YV9wYXJ0X25h
bWUpOworCWlmIChJU19FUlIobXRkKSkgeworCQlkZXZfd2FybihkZXYsICJmYWlsZWQgdG8g
Z2V0IGRhdGEgTVREIGRldmljZVxuIik7CisJCXJldHVybiAtRU5PRU5UOworCX0KKwlydiA9
IG10ZF9yZWFkKG10ZCwgMCwgc2l6ZW9mKG1nYmRldi0+c2VyaWFsX251bWJlciksICZycywK
KwkgICh1X2NoYXIgKikmbWdiZGV2LT5zZXJpYWxfbnVtYmVyKTsKKwlwdXRfbXRkX2Rldmlj
ZShtdGQpOworCWlmIChydiA8IDAgfHwgcnMgIT0gc2l6ZW9mKG1nYmRldi0+c2VyaWFsX251
bWJlcikpIHsKKwkJZGV2X3dhcm4oZGV2LCAiZXJyb3IgcmVhZGluZyBNVEQgZGV2aWNlXG4i
KTsKKwkJcmV0dXJuIC1FSU87CisJfQorCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQg
Z2V0X21vZHVsZV92ZXJzaW9uKHN0cnVjdCBtZ2I0X2RldiAqbWdiZGV2KQoreworCXN0cnVj
dCBkZXZpY2UgKmRldiA9ICZtZ2JkZXYtPnBkZXYtPmRldjsKKwlzdHJ1Y3QgbWdiNF9pMmNf
Y2xpZW50IGV4dGVuZGVyOworCXMzMiB2ZXJzaW9uOworCXUzMiBmd192ZXJzaW9uOworCWlu
dCBydjsKKworCXJ2ID0gbWdiNF9pMmNfaW5pdCgmZXh0ZW5kZXIsIG1nYmRldi0+aTJjX2Fk
YXAsICZleHRlbmRlcl9pbmZvLCA4KTsKKwlpZiAocnYgPCAwKSB7CisJCWRldl9lcnIoZGV2
LCAiZmFpbGVkIHRvIGNyZWF0ZSBleHRlbmRlciBJMkMgZGV2aWNlXG4iKTsKKwkJcmV0dXJu
IHJ2OworCX0KKwl2ZXJzaW9uID0gbWdiNF9pMmNfcmVhZF9ieXRlKCZleHRlbmRlciwgMHgw
MCk7CisJbWdiNF9pMmNfZnJlZSgmZXh0ZW5kZXIpOworCWlmICh2ZXJzaW9uIDwgMCkgewor
CQlkZXZfZXJyKGRldiwgImVycm9yIHJlYWRpbmcgbW9kdWxlIHZlcnNpb25cbiIpOworCQly
ZXR1cm4gLUVJTzsKKwl9CisKKwltZ2JkZXYtPm1vZHVsZV92ZXJzaW9uID0gfigodTMyKXZl
cnNpb24pICYgMHhmZjsKKwlpZiAoIShNR0I0X0lTX0ZQREwzKG1nYmRldikgfHwgTUdCNF9J
U19HTVNMKG1nYmRldikpKSB7CisJCWRldl9lcnIoZGV2LCAidW5rbm93biBtb2R1bGUgdHlw
ZVxuIik7CisJCXJldHVybiAtRUlOVkFMOworCX0KKwlmd192ZXJzaW9uID0gbWdiNF9yZWFk
X3JlZygmbWdiZGV2LT52aWRlbywgMHhDNCk7CisJaWYgKGZ3X3ZlcnNpb24gPj4gMjQgIT0g
bWdiZGV2LT5tb2R1bGVfdmVyc2lvbiA+PiA0KSB7CisJCWRldl9lcnIoZGV2LCAibW9kdWxl
L2Zpcm13YXJlIHR5cGUgbWlzbWF0Y2hcbiIpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisK
KwlkZXZfaW5mbyhkZXYsICIlcyBtb2R1bGUgZGV0ZWN0ZWRcbiIsCisJCSBNR0I0X0lTX0ZQ
REwzKG1nYmRldikgPyAiRlBETDMiIDogIkdNU0wiKTsKKworCXJldHVybiAwOworfQorCitz
dGF0aWMgaW50IG1hcF9yZWdzKHN0cnVjdCBwY2lfZGV2ICpwZGV2LCBzdHJ1Y3QgcmVzb3Vy
Y2UgKnJlcywKKwkJICAgIHN0cnVjdCBtZ2I0X3JlZ3MgKnJlZ3MpCit7CisJaW50IHJ2Owor
CXJlc291cmNlX3NpemVfdCBtYXBiYXNlID0gcGNpX3Jlc291cmNlX3N0YXJ0KHBkZXYsIE1H
QjRfTUdCNF9CQVJfSUQpOworCisJcmVzLT5zdGFydCArPSBtYXBiYXNlOworCXJlcy0+ZW5k
ICs9IG1hcGJhc2U7CisKKwlydiA9IG1nYjRfcmVnc19tYXAocmVzLCByZWdzKTsKKwlpZiAo
cnYgPCAwKSB7CisJCWRldl9lcnIoJnBkZXYtPmRldiwgImZhaWxlZCB0byBtYXAgJXMgcmVn
aXN0ZXJzXG4iLCByZXMtPm5hbWUpOworCQlyZXR1cm4gcnY7CisJfQorCisJcmV0dXJuIDA7
Cit9CisKK3N0YXRpYyBpbnQgaW5pdF94ZG1hKHN0cnVjdCBtZ2I0X2RldiAqbWdiZGV2KQor
eworCXN0cnVjdCB4ZG1hX3BsYXRkYXRhIGRhdGE7CisJc3RydWN0IHJlc291cmNlIHJlc1sy
XSA9IHsgMCB9OworCXN0cnVjdCBkbWFfc2xhdmVfbWFwICptYXA7CisJc3RydWN0IHBjaV9k
ZXYgKnBkZXYgPSBtZ2JkZXYtPnBkZXY7CisJc3RydWN0IGRldmljZSAqZGV2ID0gJnBkZXYt
PmRldjsKKwlpbnQgaSwgcmV0OworCisJbWdiZGV2LT54ZGV2ID0gcGxhdGZvcm1fZGV2aWNl
X2FsbG9jKCJ4ZG1hIiwgUExBVEZPUk1fREVWSURfQVVUTyk7CisJaWYgKCFtZ2JkZXYtPnhk
ZXYpCisJCXJldHVybiAtRU5PTUVNOworCisJbWdiZGV2LT54ZGV2LT5kZXYucGFyZW50ID0g
ZGV2OworCisJcmVzWzBdLnN0YXJ0ID0gcGNpX3Jlc291cmNlX3N0YXJ0KHBkZXYsIE1HQjRf
WERNQV9CQVJfSUQpOworCXJlc1swXS5lbmQgPSBwY2lfcmVzb3VyY2VfZW5kKHBkZXYsIE1H
QjRfWERNQV9CQVJfSUQpOworCXJlc1swXS5mbGFncyA9IElPUkVTT1VSQ0VfTUVNOworCXJl
c1swXS5wYXJlbnQgPSAmcGRldi0+cmVzb3VyY2VbTUdCNF9YRE1BX0JBUl9JRF07CisJcmVz
WzFdLnN0YXJ0ID0gcGNpX2lycV92ZWN0b3IocGRldiwgMCk7CisJcmVzWzFdLmVuZCA9IHJl
c1sxXS5zdGFydCArIE1HQjRfVklOX0RFVklDRVMgKyBNR0I0X1ZPVVRfREVWSUNFUworCQkg
ICAgICsgTUdCNF9VU0VSX0lSUVMgLSAxOworCXJlc1sxXS5mbGFncyA9IElPUkVTT1VSQ0Vf
SVJROworCXJldCA9IHBsYXRmb3JtX2RldmljZV9hZGRfcmVzb3VyY2VzKG1nYmRldi0+eGRl
diwgcmVzLCAyKTsKKwlpZiAocmV0KSB7CisJCWRldl9lcnIoZGV2LCAiZmFpbGVkIHRvIGFk
ZCB4ZG1hIHJlc291cmNlczogJWQiLCByZXQpOworCQlnb3RvIGZhaWxlZDsKKwl9CisKKwlk
YXRhLm1heF9kbWFfY2hhbm5lbHMgPSBNR0I0X1ZJTl9ERVZJQ0VTICsgTUdCNF9WT1VUX0RF
VklDRVM7CisJZGF0YS5kZXZpY2VfbWFwID0gbWdiZGV2LT5zbGF2ZV9tYXA7CisJZGF0YS5k
ZXZpY2VfbWFwX2NudCA9IE1HQjRfVklOX0RFVklDRVMgKyBNR0I0X1ZPVVRfREVWSUNFUzsK
KworCWZvciAoaSA9IDA7IGkgPCBNR0I0X1ZJTl9ERVZJQ0VTOyBpKyspIHsKKwkJbWFwID0g
JmRhdGEuZGV2aWNlX21hcFtpXTsKKwkJbWFwLT5kZXZuYW1lID0gZGV2X25hbWUoZGV2KTsK
KwkJbWFwLT5zbGF2ZSA9IGthc3ByaW50ZihHRlBfS0VSTkVMLCAiYzJoJWQiLCBpKTsKKwkJ
aWYgKCFtYXAtPnNsYXZlKQorCQkJZ290byBmYWlsZWQ7CisJCW1hcC0+cGFyYW0gPSBYRE1B
X0ZJTFRFUl9QQVJBTSgmYzJoX2NoYW5faW5mbyk7CisJfQorCWZvciAoaSA9IDA7IGkgPCBN
R0I0X1ZPVVRfREVWSUNFUzsgaSsrKSB7CisJCW1hcCA9ICZkYXRhLmRldmljZV9tYXBbaSAr
IE1HQjRfVklOX0RFVklDRVNdOworCQltYXAtPmRldm5hbWUgPSBkZXZfbmFtZShkZXYpOwor
CQltYXAtPnNsYXZlID0ga2FzcHJpbnRmKEdGUF9LRVJORUwsICJoMmMlZCIsIGkpOworCQlp
ZiAoIW1hcC0+c2xhdmUpCisJCQlnb3RvIGZhaWxlZDsKKwkJbWFwLT5wYXJhbSA9IFhETUFf
RklMVEVSX1BBUkFNKCZoMmNfY2hhbl9pbmZvKTsKKwl9CisKKwlyZXQgPSBwbGF0Zm9ybV9k
ZXZpY2VfYWRkX2RhdGEobWdiZGV2LT54ZGV2LCAmZGF0YSwgc2l6ZW9mKGRhdGEpKTsKKwlp
ZiAocmV0KSB7CisJCWRldl9lcnIoZGV2LCAiZmFpbGVkIHRvIGFkZCB4ZG1hIGRhdGE6ICVk
IiwgcmV0KTsKKwkJZ290byBmYWlsZWQ7CisJfQorCisJcmV0ID0gcGxhdGZvcm1fZGV2aWNl
X2FkZChtZ2JkZXYtPnhkZXYpOworCWlmIChyZXQpIHsKKwkJZGV2X2VycihkZXYsICJmYWll
ZCB0byBhZGQgeGRtYSBkZXY6ICVkIiwgcmV0KTsKKwkJZ290byBmYWlsZWQ7CisJfQorCisJ
cmV0dXJuIDA7CisKK2ZhaWxlZDoKKwlwbGF0Zm9ybV9kZXZpY2VfcHV0KG1nYmRldi0+eGRl
dik7CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgdm9pZCBmcmVlX3hkbWEoc3RydWN0
IG1nYjRfZGV2ICptZ2JkZXYpCit7CisJaW50IGk7CisKKwlwbGF0Zm9ybV9kZXZpY2VfdW5y
ZWdpc3RlcihtZ2JkZXYtPnhkZXYpOworCisJZm9yIChpID0gMDsgaSA8IE1HQjRfVklOX0RF
VklDRVMgKyBNR0I0X1ZPVVRfREVWSUNFUzsgaSsrKQorCQlrZnJlZShtZ2JkZXYtPnNsYXZl
X21hcFtpXS5zbGF2ZSk7Cit9CisKK3N0YXRpYyBpbnQgbWdiNF9wcm9iZShzdHJ1Y3QgcGNp
X2RldiAqcGRldiwgY29uc3Qgc3RydWN0IHBjaV9kZXZpY2VfaWQgKmlkKQoreworCWludCBp
LCBydjsKKwlzdHJ1Y3QgbWdiNF9kZXYgKm1nYmRldjsKKwlzdHJ1Y3QgcmVzb3VyY2Ugdmlk
ZW8gPSB7CisJCS5zdGFydAk9IDB4MCwKKwkJLmVuZAk9IDB4MTAwLAorCQkuZmxhZ3MJPSBJ
T1JFU09VUkNFX01FTSwKKwkJLm5hbWUJPSAibWdiNC12aWRlbyIsCisJfTsKKwlzdHJ1Y3Qg
cmVzb3VyY2UgY210ID0geworCQkuc3RhcnQJPSAweDEwMDAsCisJCS5lbmQJPSAweDE4MDAs
CisJCS5mbGFncwk9IElPUkVTT1VSQ0VfTUVNLAorCQkubmFtZQk9ICJtZ2I0LWNtdCIsCisJ
fTsKKwlpbnQgaXJxcyA9IHBjaV9tc2l4X3ZlY19jb3VudChwZGV2KTsKKworCisJbWdiZGV2
ID0ga3phbGxvYyhzaXplb2YoKm1nYmRldiksIEdGUF9LRVJORUwpOworCWlmICghbWdiZGV2
KQorCQlyZXR1cm4gLUVOT01FTTsKKworCW1nYmRldi0+cGRldiA9IHBkZXY7CisJcGNpX3Nl
dF9kcnZkYXRhKHBkZXYsIG1nYmRldik7CisKKwkvKiBQQ0llIHJlbGF0ZWQgc3R1ZmYgKi8K
KwlydiA9IHBjaV9lbmFibGVfZGV2aWNlKHBkZXYpOworCWlmIChydikgeworCQlkZXZfZXJy
KCZwZGV2LT5kZXYsICJlcnJvciBlbmFibGluZyBQQ0kgZGV2aWNlXG4iKTsKKwkJZ290byBl
cnJfbWdiZGV2OworCX0KKworCXJ2ID0gcGNpZV9jYXBhYmlsaXR5X3NldF93b3JkKHBkZXYs
IFBDSV9FWFBfREVWQ1RMLCBQQ0lfRVhQX0RFVkNUTF9SRUxBWF9FTik7CisJaWYgKHJ2KQor
CQlkZXZfd2FybigmcGRldi0+ZGV2LCAiZXJyb3IgZW5hYmxpbmcgUENJZSByZWxheGVkIG9y
ZGVyaW5nXG4iKTsKKwlydiA9IHBjaWVfY2FwYWJpbGl0eV9zZXRfd29yZChwZGV2LCBQQ0lf
RVhQX0RFVkNUTCwgUENJX0VYUF9ERVZDVExfRVhUX1RBRyk7CisJaWYgKHJ2KQorCQlkZXZf
d2FybigmcGRldi0+ZGV2LCAiZXJyb3IgZW5hYmxpbmcgUENJZSBleHRlbmRlZCB0YWcgZmll
bGRcbiIpOworCXJ2ID0gcGNpZV9zZXRfcmVhZHJxKHBkZXYsIDUxMik7CisJaWYgKHJ2KQor
CQlkZXZfd2FybigmcGRldi0+ZGV2LCAiZXJyb3Igc2V0dGluZyBQQ0llIG1heC4gbWVtb3J5
IHJlYWQgc2l6ZVxuIik7CisJcGNpX3NldF9tYXN0ZXIocGRldik7CisKKwlydiA9IHBjaV9h
bGxvY19pcnFfdmVjdG9ycyhwZGV2LCBpcnFzLCBpcnFzLCBQQ0lfSVJRX01TSVgpOworCWlm
IChydiA8IDApIHsKKwkJZGV2X2VycigmcGRldi0+ZGV2LCAiZXJyb3IgYWxsb2NhdGluZyBN
U0ktWCBJUlFzXG4iKTsKKwkJZ290byBlcnJfZW5hYmxlX3BjaTsKKwl9CisKKwlydiA9IGRt
YV9zZXRfbWFza19hbmRfY29oZXJlbnQoJnBkZXYtPmRldiwgRE1BX0JJVF9NQVNLKDY0KSk7
CisJaWYgKHJ2KSB7CisJCWRldl9lcnIoJnBkZXYtPmRldiwgImVycm9yIHNldHRpbmcgRE1B
IG1hc2tcbiIpOworCQlnb3RvIGVycl9lbmFibGVfcGNpOworCX0KKworCS8qIERNQSArIElS
USBlbmdpbmUgKi8KKwlydiA9IGluaXRfeGRtYShtZ2JkZXYpOworCWlmIChydikKKwkJZ290
byBlcnJfYWxsb2NfaXJxOworCXJ2ID0gbWdiNF9kbWFfY2hhbm5lbF9pbml0KG1nYmRldik7
CisJaWYgKHJ2KQorCQlnb3RvIGVycl9kbWFfY2hhbjsKKworCS8qIG1nYjQgdmlkZW8gcmVn
aXN0ZXJzICovCisJcnYgPSBtYXBfcmVncyhwZGV2LCAmdmlkZW8sICZtZ2JkZXYtPnZpZGVv
KTsKKwlpZiAocnYgPCAwKQorCQlnb3RvIGVycl9kbWFfY2hhbjsKKwkvKiBtZ2I0IGNtdCBy
ZWdpc3RlcnMgKi8KKwlydiA9IG1hcF9yZWdzKHBkZXYsICZjbXQsICZtZ2JkZXYtPmNtdCk7
CisJaWYgKHJ2IDwgMCkKKwkJZ290byBlcnJfdmlkZW9fcmVnczsKKworCS8qIFNQSSBGTEFT
SCAqLworCXJ2ID0gaW5pdF9zcGkobWdiZGV2KTsKKwlpZiAocnYgPCAwKQorCQlnb3RvIGVy
cl9jbXRfcmVnczsKKworCS8qIEkyQyBjb250cm9sbGVyICovCisJcnYgPSBpbml0X2kyYyht
Z2JkZXYpOworCWlmIChydiA8IDApCisJCWdvdG8gZXJyX3NwaTsKKworCS8qIFBDSSBjYXJk
IHJlbGF0ZWQgc3lzZnMgYXR0cmlidXRlcyAqLworCXJ2ID0gaW5pdF9zeXNmcyhwZGV2KTsK
KwlpZiAocnYgPCAwKQorCQlnb3RvIGVycl9pMmM7CisKKwkvKiBHZXQgY2FyZCBzZXJpYWwg
bnVtYmVyLiBPbiBzeXN0ZW1zIHdpdGhvdXQgTVREIGZsYXNoIHN1cHBvcnQgd2UgbWF5CisJ
ICogZ2V0IGFuIGVycm9yIHRodXMgaWdub3JlIHRoZSByZXR1cm4gdmFsdWUuIEFuIGludmFs
aWQgc2VyaWFsIG51bWJlcgorCSAqIHNob3VsZCBub3QgYnJlYWsgYW55dGhpbmcuLi4KKwkg
Ki8KKwlpZiAoZ2V0X3NlcmlhbF9udW1iZXIobWdiZGV2KSA8IDApCisJCWRldl93YXJuKCZw
ZGV2LT5kZXYsICJlcnJvciByZWFkaW5nIGNhcmQgc2VyaWFsIG51bWJlclxuIik7CisKKwkv
KiBHZXQgbW9kdWxlIHR5cGUuIElmIG5vIHZhbGlkIG1vZHVsZSBpcyBmb3VuZCwgc2tpcCB0
aGUgdmlkZW8gZGV2aWNlCisJICogY3JlYXRpb24gcGFydCBidXQgZG8gbm90IGV4aXQgd2l0
aCBlcnJvciB0byBhbGxvdyBmbGFzaGluZyB0aGUgY2FyZC4KKwkgKi8KKwlydiA9IGdldF9t
b2R1bGVfdmVyc2lvbihtZ2JkZXYpOworCWlmIChydiA8IDApCisJCWdvdG8gZXhpdDsKKwor
CS8qIFZpZGVvIGlucHV0IHY0bDIgZGV2aWNlcyAqLworCWZvciAoaSA9IDA7IGkgPCBNR0I0
X1ZJTl9ERVZJQ0VTOyBpKyspCisJCW1nYmRldi0+dmluW2ldID0gbWdiNF92aW5fY3JlYXRl
KG1nYmRldiwgaSk7CisKKwkvKiBWaWRlbyBvdXRwdXQgdjRsMiBkZXZpY2VzICovCisJZm9y
IChpID0gMDsgaSA8IE1HQjRfVk9VVF9ERVZJQ0VTOyBpKyspCisJCW1nYmRldi0+dm91dFtp
XSA9IG1nYjRfdm91dF9jcmVhdGUobWdiZGV2LCBpKTsKKworCS8qIFRyaWdnZXJzICovCisJ
bWdiZGV2LT5pbmRpb19kZXYgPSBtZ2I0X3RyaWdnZXJfY3JlYXRlKG1nYmRldik7CisKK2V4
aXQ6CisJZmxhc2hpZCsrOworCisJcmV0dXJuIDA7CisKK2Vycl9pMmM6CisJZnJlZV9pMmMo
bWdiZGV2KTsKK2Vycl9zcGk6CisJZnJlZV9zcGkobWdiZGV2KTsKK2Vycl9jbXRfcmVnczoK
KwltZ2I0X3JlZ3NfZnJlZSgmbWdiZGV2LT5jbXQpOworZXJyX3ZpZGVvX3JlZ3M6CisJbWdi
NF9yZWdzX2ZyZWUoJm1nYmRldi0+dmlkZW8pOworZXJyX2RtYV9jaGFuOgorCW1nYjRfZG1h
X2NoYW5uZWxfZnJlZShtZ2JkZXYpOworCWZyZWVfeGRtYShtZ2JkZXYpOworZXJyX2FsbG9j
X2lycToKKwlwY2lfZGlzYWJsZV9tc2l4KHBkZXYpOworZXJyX2VuYWJsZV9wY2k6CisJcGNp
X2Rpc2FibGVfZGV2aWNlKHBkZXYpOworZXJyX21nYmRldjoKKwlrZnJlZShtZ2JkZXYpOwor
CisJcmV0dXJuIHJ2OworfQorCitzdGF0aWMgdm9pZCBtZ2I0X3JlbW92ZShzdHJ1Y3QgcGNp
X2RldiAqcGRldikKK3sKKwlzdHJ1Y3QgbWdiNF9kZXYgKm1nYmRldiA9IHBjaV9nZXRfZHJ2
ZGF0YShwZGV2KTsKKwlpbnQgaTsKKworCWlmIChtZ2JkZXYtPmluZGlvX2RldikKKwkJbWdi
NF90cmlnZ2VyX2ZyZWUobWdiZGV2LT5pbmRpb19kZXYpOworCisJZm9yIChpID0gMDsgaSA8
IE1HQjRfVk9VVF9ERVZJQ0VTOyBpKyspCisJCWlmIChtZ2JkZXYtPnZvdXRbaV0pCisJCQlt
Z2I0X3ZvdXRfZnJlZShtZ2JkZXYtPnZvdXRbaV0pOworCWZvciAoaSA9IDA7IGkgPCBNR0I0
X1ZJTl9ERVZJQ0VTOyBpKyspCisJCWlmIChtZ2JkZXYtPnZpbltpXSkKKwkJCW1nYjRfdmlu
X2ZyZWUobWdiZGV2LT52aW5baV0pOworCisJZnJlZV9zeXNmcyhtZ2JkZXYtPnBkZXYpOwor
CWZyZWVfc3BpKG1nYmRldik7CisJZnJlZV9pMmMobWdiZGV2KTsKKwltZ2I0X3JlZ3NfZnJl
ZSgmbWdiZGV2LT52aWRlbyk7CisJbWdiNF9yZWdzX2ZyZWUoJm1nYmRldi0+Y210KTsKKwor
CW1nYjRfZG1hX2NoYW5uZWxfZnJlZShtZ2JkZXYpOworCWZyZWVfeGRtYShtZ2JkZXYpOwor
CisJcGNpX2Rpc2FibGVfbXNpeChtZ2JkZXYtPnBkZXYpOworCXBjaV9kaXNhYmxlX2Rldmlj
ZShtZ2JkZXYtPnBkZXYpOworCisJa2ZyZWUobWdiZGV2KTsKK30KKworc3RhdGljIGNvbnN0
IHN0cnVjdCBwY2lfZGV2aWNlX2lkIG1nYjRfcGNpX2lkc1tdID0geworCXsgUENJX0RFVklD
RSgweDFlZDgsIDB4MDEwMSksIH0sCisJeyAwLCB9Cit9OworTU9EVUxFX0RFVklDRV9UQUJM
RShwY2ksIG1nYjRfcGNpX2lkcyk7CisKK3N0YXRpYyBzdHJ1Y3QgcGNpX2RyaXZlciBtZ2I0
X3BjaV9kcml2ZXIgPSB7CisJLm5hbWUgPSBLQlVJTERfTU9ETkFNRSwKKwkuaWRfdGFibGUg
PSBtZ2I0X3BjaV9pZHMsCisJLnByb2JlID0gbWdiNF9wcm9iZSwKKwkucmVtb3ZlID0gbWdi
NF9yZW1vdmUsCit9OworCittb2R1bGVfcGNpX2RyaXZlcihtZ2I0X3BjaV9kcml2ZXIpOwor
CitNT0RVTEVfQVVUSE9SKCJEaWdpdGVxIEF1dG9tb3RpdmUgcy5yLm8uIik7CitNT0RVTEVf
REVTQ1JJUFRJT04oIkRpZ2l0ZXEgQXV0b21vdGl2ZSBNR0I0IERyaXZlciIpOworTU9EVUxF
X0xJQ0VOU0UoIkdQTCIpOworTU9EVUxFX1NPRlRERVAoInByZTogcGxhdGZvcm06eGlpYy1p
MmMgcGxhdGZvcm06eGlsaW54X3NwaSBzcGktbm9yIik7CmRpZmYgLS1naXQgYS9kcml2ZXJz
L21lZGlhL3BjaS9tZ2I0L21nYjRfY29yZS5oIGIvZHJpdmVycy9tZWRpYS9wY2kvbWdiNC9t
Z2I0X2NvcmUuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjJk
MTYxYzNkYmU3YwotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvbWVkaWEvcGNpL21nYjQv
bWdiNF9jb3JlLmgKQEAgLTAsMCArMSw2NSBAQAorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZp
ZXI6IEdQTC0yLjAtb25seSAqLworLyoKKyAqIENvcHlyaWdodCAoQykgMjAyMS0yMDIyIERp
Z2l0ZXEgQXV0b21vdGl2ZQorICogICAgIGF1dGhvcjogTWFydGluIFR1bWEgPG1hcnRpbi50
dW1hQGRpZ2l0ZXFhdXRvbW90aXZlLmNvbT4KKyAqLworCisjaWZuZGVmIF9fTUdCNF9DT1JF
X0hfXworI2RlZmluZSBfX01HQjRfQ09SRV9IX18KKworI2luY2x1ZGUgPGxpbnV4L3NwaS9m
bGFzaC5oPgorI2luY2x1ZGUgPGxpbnV4L210ZC9wYXJ0aXRpb25zLmg+CisjaW5jbHVkZSA8
bGludXgvbXV0ZXguaD4KKyNpbmNsdWRlIDxsaW51eC9kbWFlbmdpbmUuaD4KKyNpbmNsdWRl
ICJtZ2I0X3JlZ3MuaCIKKworI2RlZmluZSBNR0I0X1ZJTl9ERVZJQ0VTICAyCisjZGVmaW5l
IE1HQjRfVk9VVF9ERVZJQ0VTIDIKKworI2RlZmluZSBNR0I0X01HQjRfQkFSX0lEICAwCisj
ZGVmaW5lIE1HQjRfWERNQV9CQVJfSUQgIDEKKworI2RlZmluZSBNR0I0X0lTX0dNU0wobWdi
ZGV2KSBcCisJKChtZ2JkZXYpLT5tb2R1bGVfdmVyc2lvbiA+PiA0ID09IDIpCisjZGVmaW5l
IE1HQjRfSVNfRlBETDMobWdiZGV2KSBcCisJKChtZ2JkZXYpLT5tb2R1bGVfdmVyc2lvbiA+
PiA0ID09IDEpCisKK3N0cnVjdCBtZ2I0X2RtYV9jaGFubmVsIHsKKwlzdHJ1Y3QgZG1hX2No
YW4gKmNoYW47CisJZG1hX2Nvb2tpZV90IGRtYV9jb29raWU7CisJc3RydWN0IGNvbXBsZXRp
b24gcmVxX2NvbXBsOworfTsKKworc3RydWN0IG1nYjRfZGV2IHsKKwlzdHJ1Y3QgcGNpX2Rl
diAqcGRldjsKKwlzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICp4ZGV2OworCXN0cnVjdCBtZ2I0
X3Zpbl9kZXYgKnZpbltNR0I0X1ZJTl9ERVZJQ0VTXTsKKwlzdHJ1Y3QgbWdiNF92b3V0X2Rl
diAqdm91dFtNR0I0X1ZPVVRfREVWSUNFU107CisKKwlzdHJ1Y3QgbWdiNF9kbWFfY2hhbm5l
bCBjMmhfY2hhbltNR0I0X1ZJTl9ERVZJQ0VTXTsKKwlzdHJ1Y3QgbWdiNF9kbWFfY2hhbm5l
bCBoMmNfY2hhbltNR0I0X1ZPVVRfREVWSUNFU107CisJc3RydWN0IGRtYV9zbGF2ZV9tYXAg
c2xhdmVfbWFwW01HQjRfVklOX0RFVklDRVMgKyBNR0I0X1ZPVVRfREVWSUNFU107CisKKwlz
dHJ1Y3QgbWdiNF9yZWdzIHZpZGVvOworCXN0cnVjdCBtZ2I0X3JlZ3MgY210OworCisJc3Ry
dWN0IGNsa19odyAqaTJjX2NsazsKKwlzdHJ1Y3QgY2xrX2xvb2t1cCAqaTJjX2NsOworCXN0
cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKmkyY19wZGV2OworCXN0cnVjdCBpMmNfYWRhcHRlciAq
aTJjX2FkYXA7CisJc3RydWN0IG11dGV4IGkyY19sb2NrOworCisJc3RydWN0IHBsYXRmb3Jt
X2RldmljZSAqc3BpX3BkZXY7CisJc3RydWN0IGZsYXNoX3BsYXRmb3JtX2RhdGEgZmxhc2hf
ZGF0YTsKKwljaGFyIGZsYXNoX25hbWVbMTZdOworCXN0cnVjdCBtdGRfcGFydGl0aW9uIHBh
cnRpdGlvbnNbMl07CisJY2hhciBmd19wYXJ0X25hbWVbMTZdOworCWNoYXIgZGF0YV9wYXJ0
X25hbWVbMTZdOworCisJc3RydWN0IGlpb19kZXYgKmluZGlvX2RldjsKKworCXU4IG1vZHVs
ZV92ZXJzaW9uOworCXUzMiBzZXJpYWxfbnVtYmVyOworfTsKKworI2VuZGlmCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL21lZGlhL3BjaS9tZ2I0L21nYjRfZG1hLmMgYi9kcml2ZXJzL21lZGlh
L3BjaS9tZ2I0L21nYjRfZG1hLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAw
MDAwMDAwLi45NWE0MWMwOWRiZjQKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL21lZGlh
L3BjaS9tZ2I0L21nYjRfZG1hLmMKQEAgLTAsMCArMSwxMTcgQEAKKy8vIFNQRFgtTGljZW5z
ZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9ubHkKKy8qCisgKiBDb3B5cmlnaHQgKEMpIDIwMjEt
MjAyMiBEaWdpdGVxIEF1dG9tb3RpdmUKKyAqICAgICBhdXRob3I6IE1hcnRpbiBUdW1hIDxt
YXJ0aW4udHVtYUBkaWdpdGVxYXV0b21vdGl2ZS5jb20+CisgKi8KKworI2luY2x1ZGUgPGxp
bnV4L3BjaS5oPgorI2luY2x1ZGUgPGxpbnV4L2RtYS1kaXJlY3Rpb24uaD4KKyNpbmNsdWRl
ICJtZ2I0X2NvcmUuaCIKKyNpbmNsdWRlICJtZ2I0X2RtYS5oIgorCitzdGF0aWMgdm9pZCBj
aGFuX2lycSh2b2lkICpwYXJhbSkKK3sKKwlzdHJ1Y3QgbWdiNF9kbWFfY2hhbm5lbCAqY2hh
biA9IHBhcmFtOworCisJY29tcGxldGUoJmNoYW4tPnJlcV9jb21wbCk7Cit9CisKK2ludCBt
Z2I0X2RtYV90cmFuc2ZlcihzdHJ1Y3QgbWdiNF9kZXYgKm1nYmRldiwgdTMyIGNoYW5uZWws
IGJvb2wgd3JpdGUsCisJCSAgICAgIHU2NCBwYWRkciwgc3RydWN0IHNnX3RhYmxlICpzZ3Qp
Cit7CisJc3RydWN0IGRtYV9zbGF2ZV9jb25maWcgY2ZnOworCXN0cnVjdCBtZ2I0X2RtYV9j
aGFubmVsICpjaGFuOworCXN0cnVjdCBkbWFfYXN5bmNfdHhfZGVzY3JpcHRvciAqdHg7CisJ
c3RydWN0IHBjaV9kZXYgKnBkZXYgPSBtZ2JkZXYtPnBkZXY7CisJaW50IHJldDsKKworCW1l
bXNldCgmY2ZnLCAwLCBzaXplb2YoY2ZnKSk7CisKKwlpZiAod3JpdGUpIHsKKwkJY2ZnLmRp
cmVjdGlvbiA9IERNQV9NRU1fVE9fREVWOworCQljZmcuZHN0X2FkZHIgPSBwYWRkcjsKKwkJ
Y2ZnLmRzdF9hZGRyX3dpZHRoID0gRE1BX1NMQVZFX0JVU1dJRFRIXzRfQllURVM7CisJCWNo
YW4gPSAmbWdiZGV2LT5oMmNfY2hhbltjaGFubmVsXTsKKwl9IGVsc2UgeworCQljZmcuZGly
ZWN0aW9uID0gRE1BX0RFVl9UT19NRU07CisJCWNmZy5zcmNfYWRkciA9IHBhZGRyOworCQlj
Zmcuc3JjX2FkZHJfd2lkdGggPSBETUFfU0xBVkVfQlVTV0lEVEhfNF9CWVRFUzsKKwkJY2hh
biA9ICZtZ2JkZXYtPmMyaF9jaGFuW2NoYW5uZWxdOworCX0KKworCXJldCA9IGRtYWVuZ2lu
ZV9zbGF2ZV9jb25maWcoY2hhbi0+Y2hhbiwgJmNmZyk7CisJaWYgKHJldCkgeworCQlkZXZf
ZXJyKCZwZGV2LT5kZXYsICJmYWlsZWQgdG8gY29uZmlnIGRtYTogJWQiLCByZXQpOworCQly
ZXR1cm4gcmV0OworCX0KKworCXR4ID0gZG1hZW5naW5lX3ByZXBfc2xhdmVfc2coY2hhbi0+
Y2hhbiwgc2d0LT5zZ2wsIHNndC0+bmVudHMsCisJCQkJICAgICBjZmcuZGlyZWN0aW9uLCAw
KTsKKwlpZiAoIXR4KSB7CisJCWRldl9lcnIoJnBkZXYtPmRldiwgImZhaWxlZCB0byBwcmVw
IHNsYXZlIHNnIik7CisJCXJldHVybiAtRUlPOworCX0KKworCXR4LT5jYWxsYmFjayA9IGNo
YW5faXJxOworCXR4LT5jYWxsYmFja19wYXJhbSA9IGNoYW47CisKKwljaGFuLT5kbWFfY29v
a2llID0gZG1hZW5naW5lX3N1Ym1pdCh0eCk7CisKKwlkbWFfYXN5bmNfaXNzdWVfcGVuZGlu
ZyhjaGFuLT5jaGFuKTsKKworCWlmICghd2FpdF9mb3JfY29tcGxldGlvbl90aW1lb3V0KCZj
aGFuLT5yZXFfY29tcGwsCisJCQkJCSBtc2Vjc190b19qaWZmaWVzKDEwMDAwKSkpIHsKKwkJ
ZGV2X2VycigmcGRldi0+ZGV2LCAiZG1hIHRpbWVvdXQiKTsKKwkJcmV0ID0gLUVJTzsKKwl9
IGVsc2UgeworCQlyZXQgPSAwOworCX0KKworCXJldHVybiByZXQ7Cit9CisKK2ludCBtZ2I0
X2RtYV9jaGFubmVsX2luaXQoc3RydWN0IG1nYjRfZGV2ICptZ2JkZXYpCit7CisJaW50IGks
IHJldDsKKwljaGFyIG5hbWVbMTZdOworCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gbWdiZGV2
LT5wZGV2OworCisJZm9yIChpID0gMDsgaSA8IE1HQjRfVklOX0RFVklDRVM7IGkrKykgewor
CQlzcHJpbnRmKG5hbWUsICJjMmglZCIsIGkpOworCQltZ2JkZXYtPmMyaF9jaGFuW2ldLmNo
YW4gPSBkbWFfcmVxdWVzdF9jaGFuKCZwZGV2LT5kZXYsIG5hbWUpOworCQlpZiAoSVNfRVJS
KG1nYmRldi0+YzJoX2NoYW5baV0uY2hhbikpIHsKKwkJCWRldl9lcnIoJnBkZXYtPmRldiwg
ImZhaWxlZCB0byBpbml0aWFsaXplICVzIiwgbmFtZSk7CisJCQlyZXQgPSBQVFJfRVJSKG1n
YmRldi0+YzJoX2NoYW5baV0uY2hhbik7CisJCQltZ2JkZXYtPmMyaF9jaGFuW2ldLmNoYW4g
PSBOVUxMOworCQkJcmV0dXJuIHJldDsKKwkJfQorCQlpbml0X2NvbXBsZXRpb24oJm1nYmRl
di0+YzJoX2NoYW5baV0ucmVxX2NvbXBsKTsKKwl9CisJZm9yIChpID0gMDsgaSA8IE1HQjRf
Vk9VVF9ERVZJQ0VTOyBpKyspIHsKKwkJc3ByaW50ZihuYW1lLCAiaDJjJWQiLCBpKTsKKwkJ
bWdiZGV2LT5oMmNfY2hhbltpXS5jaGFuID0gZG1hX3JlcXVlc3RfY2hhbigmcGRldi0+ZGV2
LCBuYW1lKTsKKwkJaWYgKElTX0VSUihtZ2JkZXYtPmgyY19jaGFuW2ldLmNoYW4pKSB7CisJ
CQlkZXZfZXJyKCZwZGV2LT5kZXYsICJmYWlsZWQgdG8gaW5pdGlhbGl6ZSAlcyIsIG5hbWUp
OworCQkJcmV0ID0gUFRSX0VSUihtZ2JkZXYtPmgyY19jaGFuW2ldLmNoYW4pOworCQkJbWdi
ZGV2LT5oMmNfY2hhbltpXS5jaGFuID0gTlVMTDsKKwkJCXJldHVybiByZXQ7CisJCX0KKwkJ
aW5pdF9jb21wbGV0aW9uKCZtZ2JkZXYtPmgyY19jaGFuW2ldLnJlcV9jb21wbCk7CisJfQor
CisJcmV0dXJuIDA7Cit9CisKK3ZvaWQgbWdiNF9kbWFfY2hhbm5lbF9mcmVlKHN0cnVjdCBt
Z2I0X2RldiAqbWdiZGV2KQoreworCWludCBpOworCisJZm9yIChpID0gMDsgaSA8IE1HQjRf
VklOX0RFVklDRVM7IGkrKykgeworCQlpZiAobWdiZGV2LT5jMmhfY2hhbltpXS5jaGFuKQor
CQkJZG1hX3JlbGVhc2VfY2hhbm5lbChtZ2JkZXYtPmMyaF9jaGFuW2ldLmNoYW4pOworCX0K
Kwlmb3IgKGkgPSAwOyBpIDwgTUdCNF9WT1VUX0RFVklDRVM7IGkrKykgeworCQlpZiAobWdi
ZGV2LT5oMmNfY2hhbltpXS5jaGFuKQorCQkJZG1hX3JlbGVhc2VfY2hhbm5lbChtZ2JkZXYt
PmgyY19jaGFuW2ldLmNoYW4pOworCX0KK30KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEv
cGNpL21nYjQvbWdiNF9kbWEuaCBiL2RyaXZlcnMvbWVkaWEvcGNpL21nYjQvbWdiNF9kbWEu
aApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjQ0M2UyYTExYjA1
NQotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvbWVkaWEvcGNpL21nYjQvbWdiNF9kbWEu
aApAQCAtMCwwICsxLDE4IEBACisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIu
MC1vbmx5ICovCisvKgorICogQ29weXJpZ2h0IChDKSAyMDIxLTIwMjIgRGlnaXRlcSBBdXRv
bW90aXZlCisgKiAgICAgYXV0aG9yOiBNYXJ0aW4gVHVtYSA8bWFydGluLnR1bWFAZGlnaXRl
cWF1dG9tb3RpdmUuY29tPgorICovCisKKyNpZm5kZWYgX19NR0I0X0RNQV9IX18KKyNkZWZp
bmUgX19NR0I0X0RNQV9IX18KKworI2luY2x1ZGUgIm1nYjRfY29yZS5oIgorCitleHRlcm4g
aW50IG1nYjRfZG1hX2NoYW5uZWxfaW5pdChzdHJ1Y3QgbWdiNF9kZXYgKm1nYmRldik7Citl
eHRlcm4gdm9pZCBtZ2I0X2RtYV9jaGFubmVsX2ZyZWUoc3RydWN0IG1nYjRfZGV2ICptZ2Jk
ZXYpOworCitleHRlcm4gaW50IG1nYjRfZG1hX3RyYW5zZmVyKHN0cnVjdCBtZ2I0X2RldiAq
bWdiZGV2LCB1MzIgY2hhbm5lbCwgYm9vbCB3cml0ZSwKKwkJCSAgICAgdTY0IHBhZGRyLCBz
dHJ1Y3Qgc2dfdGFibGUgKnNndCk7CisKKyNlbmRpZgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9t
ZWRpYS9wY2kvbWdiNC9tZ2I0X2kyYy5jIGIvZHJpdmVycy9tZWRpYS9wY2kvbWdiNC9tZ2I0
X2kyYy5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uNTM2ZGMz
NGI3ZjgyCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9tZWRpYS9wY2kvbWdiNC9tZ2I0
X2kyYy5jCkBAIC0wLDAgKzEsMTM5IEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjog
R1BMLTIuMC1vbmx5CisvKgorICogQ29weXJpZ2h0IChDKSAyMDIxLTIwMjIgRGlnaXRlcSBB
dXRvbW90aXZlCisgKiAgICAgYXV0aG9yOiBNYXJ0aW4gVHVtYSA8bWFydGluLnR1bWFAZGln
aXRlcWF1dG9tb3RpdmUuY29tPgorICovCisKKyNpbmNsdWRlIDxsaW51eC92ZXJzaW9uLmg+
CisjaW5jbHVkZSAibWdiNF9pMmMuaCIKKworc3RhdGljIGludCByZWFkX3IxNihzdHJ1Y3Qg
aTJjX2NsaWVudCAqY2xpZW50LCB1MTYgcmVnLCB1OCAqdmFsLCBpbnQgbGVuKQoreworCWlu
dCByZXQ7CisJdTggYnVmWzJdOworCXN0cnVjdCBpMmNfbXNnIG1zZ1syXSA9IHsKKwkJewor
CQkJLmFkZHIgPSBjbGllbnQtPmFkZHIsCisJCQkuZmxhZ3MgPSAwLAorCQkJLmxlbiA9IDIs
CisJCQkuYnVmID0gYnVmLAorCQl9LCB7CisJCQkuYWRkciA9IGNsaWVudC0+YWRkciwKKwkJ
CS5mbGFncyA9IEkyQ19NX1JELAorCQkJLmxlbiA9IGxlbiwKKwkJCS5idWYgPSB2YWwsCisJ
CX0KKwl9OworCisJYnVmWzBdID0gKHJlZyA+PiA4KSAmIDB4ZmY7CisJYnVmWzFdID0gKHJl
ZyA+PiAwKSAmIDB4ZmY7CisKKwlyZXQgPSBpMmNfdHJhbnNmZXIoY2xpZW50LT5hZGFwdGVy
LCBtc2csIDIpOworCWlmIChyZXQgPCAwKQorCQlyZXR1cm4gcmV0OworCWVsc2UgaWYgKHJl
dCAhPSAyKQorCQlyZXR1cm4gLUVSRU1PVEVJTzsKKwllbHNlCisJCXJldHVybiAwOworfQor
CitzdGF0aWMgaW50IHdyaXRlX3IxNihzdHJ1Y3QgaTJjX2NsaWVudCAqY2xpZW50LCB1MTYg
cmVnLCBjb25zdCB1OCAqdmFsLCBpbnQgbGVuKQoreworCWludCByZXQ7CisJdTggYnVmWzRd
OworCXN0cnVjdCBpMmNfbXNnIG1zZ1sxXSA9IHsKKwkJeworCQkJLmFkZHIgPSBjbGllbnQt
PmFkZHIsCisJCQkuZmxhZ3MgPSAwLAorCQkJLmxlbiA9IDIgKyBsZW4sCisJCQkuYnVmID0g
YnVmLAorCQl9CisJfTsKKworCWlmICgyICsgbGVuID4gc2l6ZW9mKGJ1ZikpCisJCXJldHVy
biAtRUlOVkFMOworCisJYnVmWzBdID0gKHJlZyA+PiA4KSAmIDB4ZmY7CisJYnVmWzFdID0g
KHJlZyA+PiAwKSAmIDB4ZmY7CisJbWVtY3B5KCZidWZbMl0sIHZhbCwgbGVuKTsKKworCXJl
dCA9IGkyY190cmFuc2ZlcihjbGllbnQtPmFkYXB0ZXIsIG1zZywgMSk7CisJaWYgKHJldCA8
IDApCisJCXJldHVybiByZXQ7CisJZWxzZSBpZiAocmV0ICE9IDEpCisJCXJldHVybiAtRVJF
TU9URUlPOworCWVsc2UKKwkJcmV0dXJuIDA7Cit9CisKKworaW50IG1nYjRfaTJjX2luaXQo
c3RydWN0IG1nYjRfaTJjX2NsaWVudCAqY2xpZW50LCBzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmFk
YXAsCisJCSAgc3RydWN0IGkyY19ib2FyZF9pbmZvIGNvbnN0ICppbmZvLCBpbnQgYWRkcl9z
aXplKQoreworCWNsaWVudC0+Y2xpZW50ID0gaTJjX25ld19jbGllbnRfZGV2aWNlKGFkYXAs
IGluZm8pOworCWlmIChJU19FUlIoY2xpZW50LT5jbGllbnQpKQorCQlyZXR1cm4gUFRSX0VS
UihjbGllbnQtPmNsaWVudCk7CisKKwljbGllbnQtPmFkZHJfc2l6ZSA9IGFkZHJfc2l6ZTsK
KworCXJldHVybiAwOworfQorCit2b2lkIG1nYjRfaTJjX2ZyZWUoc3RydWN0IG1nYjRfaTJj
X2NsaWVudCAqY2xpZW50KQoreworCWkyY191bnJlZ2lzdGVyX2RldmljZShjbGllbnQtPmNs
aWVudCk7Cit9CisKKworczMyIG1nYjRfaTJjX3JlYWRfYnl0ZShzdHJ1Y3QgbWdiNF9pMmNf
Y2xpZW50ICpjbGllbnQsIHUxNiByZWcpCit7CisJaW50IHJldDsKKwl1OCBiOworCisJaWYg
KGNsaWVudC0+YWRkcl9zaXplID09IDgpCisJCXJldHVybiBpMmNfc21idXNfcmVhZF9ieXRl
X2RhdGEoY2xpZW50LT5jbGllbnQsIHJlZyk7CisKKwlyZXQgPSByZWFkX3IxNihjbGllbnQt
PmNsaWVudCwgcmVnLCAmYiwgMSk7CisJaWYgKHJldCA8IDApCisJCXJldHVybiByZXQ7CisK
KwlyZXR1cm4gKHMzMiliOworfQorCitzMzIgbWdiNF9pMmNfd3JpdGVfYnl0ZShzdHJ1Y3Qg
bWdiNF9pMmNfY2xpZW50ICpjbGllbnQsIHUxNiByZWcsIHU4IHZhbCkKK3sKKwlpZiAoY2xp
ZW50LT5hZGRyX3NpemUgPT0gOCkKKwkJcmV0dXJuIGkyY19zbWJ1c193cml0ZV9ieXRlX2Rh
dGEoY2xpZW50LT5jbGllbnQsIHJlZywgdmFsKTsKKwllbHNlCisJCXJldHVybiB3cml0ZV9y
MTYoY2xpZW50LT5jbGllbnQsIHJlZywgJnZhbCwgMSk7Cit9CisKK3MzMiBtZ2I0X2kyY19t
YXNrX2J5dGUoc3RydWN0IG1nYjRfaTJjX2NsaWVudCAqY2xpZW50LCB1MTYgcmVnLCB1OCBt
YXNrLCB1OCB2YWwpCit7CisJczMyIHJldDsKKworCWlmIChtYXNrICE9IDB4RkYpIHsKKwkJ
cmV0ID0gbWdiNF9pMmNfcmVhZF9ieXRlKGNsaWVudCwgcmVnKTsKKwkJaWYgKHJldCA8IDAp
CisJCQlyZXR1cm4gcmV0OworCQl2YWwgfD0gKHU4KXJldCAmIH5tYXNrOworCX0KKworCXJl
dHVybiBtZ2I0X2kyY193cml0ZV9ieXRlKGNsaWVudCwgcmVnLCB2YWwpOworfQorCitpbnQg
bWdiNF9pMmNfY29uZmlndXJlKHN0cnVjdCBtZ2I0X2kyY19jbGllbnQgKmNsaWVudCwKKwkJ
ICAgICAgIGNvbnN0IHN0cnVjdCBtZ2I0X2kyY19rdiAqdmFsdWVzLCBzaXplX3QgY291bnQp
Cit7CisJc2l6ZV90IGk7CisJczMyIHJlczsKKworCWZvciAoaSA9IDA7IGkgPCBjb3VudDsg
aSsrKSB7CisJCXJlcyA9IG1nYjRfaTJjX21hc2tfYnl0ZShjbGllbnQsIHZhbHVlc1tpXS5y
ZWcsIHZhbHVlc1tpXS5tYXNrLAorCQkgIHZhbHVlc1tpXS52YWwpOworCQlpZiAocmVzIDwg
MCkKKwkJCXJldHVybiByZXM7CisJfQorCisJcmV0dXJuIDA7Cit9CmRpZmYgLS1naXQgYS9k
cml2ZXJzL21lZGlhL3BjaS9tZ2I0L21nYjRfaTJjLmggYi9kcml2ZXJzL21lZGlhL3BjaS9t
Z2I0L21nYjRfaTJjLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAw
Li5lNTAwMzkyNzUwOWYKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL21lZGlhL3BjaS9t
Z2I0L21nYjRfaTJjLmgKQEAgLTAsMCArMSwzNSBAQAorLyogU1BEWC1MaWNlbnNlLUlkZW50
aWZpZXI6IEdQTC0yLjAtb25seSAqLworLyoKKyAqIENvcHlyaWdodCAoQykgMjAyMS0yMDIy
IERpZ2l0ZXEgQXV0b21vdGl2ZQorICogICAgIGF1dGhvcjogTWFydGluIFR1bWEgPG1hcnRp
bi50dW1hQGRpZ2l0ZXFhdXRvbW90aXZlLmNvbT4KKyAqLworCisjaWZuZGVmIF9fTUdCNF9J
MkNfSF9fCisjZGVmaW5lIF9fTUdCNF9JMkNfSF9fCisKKyNpbmNsdWRlIDxsaW51eC9pMmMu
aD4KKworc3RydWN0IG1nYjRfaTJjX2NsaWVudCB7CisJc3RydWN0IGkyY19jbGllbnQgKmNs
aWVudDsKKwlpbnQgYWRkcl9zaXplOworfTsKKworc3RydWN0IG1nYjRfaTJjX2t2IHsKKwl1
MTYgcmVnOworCXU4IG1hc2s7CisJdTggdmFsOworfTsKKworZXh0ZXJuIGludCBtZ2I0X2ky
Y19pbml0KHN0cnVjdCBtZ2I0X2kyY19jbGllbnQgKmNsaWVudCwgc3RydWN0IGkyY19hZGFw
dGVyICphZGFwLAorCQkJIHN0cnVjdCBpMmNfYm9hcmRfaW5mbyBjb25zdCAqaW5mbywgaW50
IGFkZHJfc2l6ZSk7CitleHRlcm4gdm9pZCBtZ2I0X2kyY19mcmVlKHN0cnVjdCBtZ2I0X2ky
Y19jbGllbnQgKmNsaWVudCk7CisKK2V4dGVybiBzMzIgbWdiNF9pMmNfcmVhZF9ieXRlKHN0
cnVjdCBtZ2I0X2kyY19jbGllbnQgKmNsaWVudCwgdTE2IHJlZyk7CitleHRlcm4gczMyIG1n
YjRfaTJjX3dyaXRlX2J5dGUoc3RydWN0IG1nYjRfaTJjX2NsaWVudCAqY2xpZW50LCB1MTYg
cmVnLCB1OCB2YWwpOworZXh0ZXJuIHMzMiBtZ2I0X2kyY19tYXNrX2J5dGUoc3RydWN0IG1n
YjRfaTJjX2NsaWVudCAqY2xpZW50LCB1MTYgcmVnLCB1OCBtYXNrLAorCQkJICAgICAgdTgg
dmFsKTsKKworZXh0ZXJuIGludCBtZ2I0X2kyY19jb25maWd1cmUoc3RydWN0IG1nYjRfaTJj
X2NsaWVudCAqY2xpZW50LAorCQkJICAgICAgY29uc3Qgc3RydWN0IG1nYjRfaTJjX2t2ICp2
YWx1ZXMsIHNpemVfdCBjb3VudCk7CisKKyNlbmRpZgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9t
ZWRpYS9wY2kvbWdiNC9tZ2I0X2lvLmggYi9kcml2ZXJzL21lZGlhL3BjaS9tZ2I0L21nYjRf
aW8uaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLmRmZjkyMDY1
ZjJjMAotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvbWVkaWEvcGNpL21nYjQvbWdiNF9p
by5oCkBAIC0wLDAgKzEsMzYgQEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwt
Mi4wLW9ubHkgKi8KKy8qCisgKiBDb3B5cmlnaHQgKEMpIDIwMjEtMjAyMiBEaWdpdGVxIEF1
dG9tb3RpdmUKKyAqICAgICBhdXRob3I6IE1hcnRpbiBUdW1hIDxtYXJ0aW4udHVtYUBkaWdp
dGVxYXV0b21vdGl2ZS5jb20+CisgKi8KKworI2lmbmRlZiBfX01HQjRfSU9fSF9fCisjZGVm
aW5lIF9fTUdCNF9JT19IX18KKworI2luY2x1ZGUgPG1lZGlhL3Y0bDItZGV2Lmg+CisKKyNp
Zm5kZWYgVkZMX1RZUEVfR1JBQkJFUgorI2RlZmluZSBWRkxfVFlQRV9HUkFCQkVSIFZGTF9U
WVBFX1ZJREVPCisjZW5kaWYKKworI2RlZmluZSBFUlJfTk9fUkVHICAgICAgICAweEZGRkZG
RkZFCisjZGVmaW5lIEVSUl9RVUVVRV9USU1FT1VUIDB4RkZGRkZGRkQKKyNkZWZpbmUgRVJS
X1FVRVVFX0VNUFRZICAgMHhGRkZGRkZGQworI2RlZmluZSBFUlJfUVVFVUVfRlVMTCAgICAw
eEZGRkZGRkZCCisKKyNkZWZpbmUgQllURVNQRVJMSU5FKHdpZHRoLCBhbGlnbm1lbnQpIFwK
KwkoKCgoKHdpZHRoKSAqIDQpIC0gMSkgfCAoKGFsaWdubWVudCkgLSAxKSkgKyAxKQorI2Rl
ZmluZSBQQURESU5HKHdpZHRoLCBhbGlnbm1lbnQpIFwKKwkoKEJZVEVTUEVSTElORSgod2lk
dGgpLCAoYWxpZ25tZW50KSkgLSAoKHdpZHRoKSAqIDQpKSAvIDQpCisKK3N0cnVjdCBmcmFt
ZV9idWZmZXIgeworCXN0cnVjdCB2YjJfdjRsMl9idWZmZXIgdmI7CisJc3RydWN0IGxpc3Rf
aGVhZCBsaXN0OworfTsKKworZXh0ZXJuIGlubGluZSBzdHJ1Y3QgZnJhbWVfYnVmZmVyICp0
b19mcmFtZV9idWZmZXIoc3RydWN0IHZiMl92NGwyX2J1ZmZlciAqdmJ1ZikKK3sKKwlyZXR1
cm4gY29udGFpbmVyX29mKHZidWYsIHN0cnVjdCBmcmFtZV9idWZmZXIsIHZiKTsKK30KKwor
I2VuZGlmCmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3BjaS9tZ2I0L21nYjRfcmVncy5j
IGIvZHJpdmVycy9tZWRpYS9wY2kvbWdiNC9tZ2I0X3JlZ3MuYwpuZXcgZmlsZSBtb2RlIDEw
MDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjUzZDRlNDUwM2E3NAotLS0gL2Rldi9udWxsCisr
KyBiL2RyaXZlcnMvbWVkaWEvcGNpL21nYjQvbWdiNF9yZWdzLmMKQEAgLTAsMCArMSwzMCBA
QAorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb25seQorLyoKKyAqIENv
cHlyaWdodCAoQykgMjAyMS0yMDIyIERpZ2l0ZXEgQXV0b21vdGl2ZQorICogICAgIGF1dGhv
cjogTWFydGluIFR1bWEgPG1hcnRpbi50dW1hQGRpZ2l0ZXFhdXRvbW90aXZlLmNvbT4KKyAq
LworCisjaW5jbHVkZSA8bGludXgvaW9wb3J0Lmg+CisjaW5jbHVkZSAibWdiNF9yZWdzLmgi
CisKK2ludCBtZ2I0X3JlZ3NfbWFwKHN0cnVjdCByZXNvdXJjZSAqcmVzLCBzdHJ1Y3QgbWdi
NF9yZWdzICpyZWdzKQoreworCXJlZ3MtPm1hcGJhc2UgPSByZXMtPnN0YXJ0OworCXJlZ3Mt
Pm1hcHNpemUgPSByZXMtPmVuZCAtIHJlcy0+c3RhcnQ7CisKKwlpZiAoIXJlcXVlc3RfbWVt
X3JlZ2lvbihyZWdzLT5tYXBiYXNlLCByZWdzLT5tYXBzaXplLCByZXMtPm5hbWUpKQorCQly
ZXR1cm4gLUVJTlZBTDsKKwlyZWdzLT5tZW1iYXNlID0gaW9yZW1hcChyZWdzLT5tYXBiYXNl
LCByZWdzLT5tYXBzaXplKTsKKwlpZiAoIXJlZ3MtPm1lbWJhc2UpIHsKKwkJcmVsZWFzZV9t
ZW1fcmVnaW9uKHJlZ3MtPm1hcGJhc2UsIHJlZ3MtPm1hcHNpemUpOworCQlyZXR1cm4gLUVJ
TlZBTDsKKwl9CisKKwlyZXR1cm4gMDsKK30KKwordm9pZCBtZ2I0X3JlZ3NfZnJlZShzdHJ1
Y3QgbWdiNF9yZWdzICpyZWdzKQoreworCWlvdW5tYXAocmVncy0+bWVtYmFzZSk7CisJcmVs
ZWFzZV9tZW1fcmVnaW9uKHJlZ3MtPm1hcGJhc2UsIHJlZ3MtPm1hcHNpemUpOworfQpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wY2kvbWdiNC9tZ2I0X3JlZ3MuaCBiL2RyaXZlcnMv
bWVkaWEvcGNpL21nYjQvbWdiNF9yZWdzLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXgg
MDAwMDAwMDAwMDAwLi4xY2MxNjk0MWVhNDUKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJz
L21lZGlhL3BjaS9tZ2I0L21nYjRfcmVncy5oCkBAIC0wLDAgKzEsMzUgQEAKKy8qIFNQRFgt
TGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9ubHkgKi8KKy8qCisgKiBDb3B5cmlnaHQg
KEMpIDIwMjEtMjAyMiBEaWdpdGVxIEF1dG9tb3RpdmUKKyAqICAgICBhdXRob3I6IE1hcnRp
biBUdW1hIDxtYXJ0aW4udHVtYUBkaWdpdGVxYXV0b21vdGl2ZS5jb20+CisgKi8KKworI2lm
bmRlZiBfX01HQjRfUkVHU19IX18KKyNkZWZpbmUgX19NR0I0X1JFR1NfSF9fCisKKyNpbmNs
dWRlIDxsaW51eC9pby5oPgorCitzdHJ1Y3QgbWdiNF9yZWdzIHsKKwlyZXNvdXJjZV9zaXpl
X3QgbWFwYmFzZTsKKwlyZXNvdXJjZV9zaXplX3QgbWFwc2l6ZTsKKwl2b2lkIF9faW9tZW0g
Km1lbWJhc2U7Cit9OworCisjZGVmaW5lIG1nYjRfd3JpdGVfcmVnKHJlZ3MsIG9mZnNldCwg
dmFsKSBcCisJaW93cml0ZTMyKHZhbCwgKHJlZ3MpLT5tZW1iYXNlICsgKG9mZnNldCkpCisj
ZGVmaW5lICBtZ2I0X3JlYWRfcmVnKHJlZ3MsIG9mZnNldCkgXAorCWlvcmVhZDMyKChyZWdz
KS0+bWVtYmFzZSArIChvZmZzZXQpKQorCitzdGF0aWMgaW5saW5lIHZvaWQgbWdiNF9tYXNr
X3JlZyhzdHJ1Y3QgbWdiNF9yZWdzICpyZWdzLCB1MzIgcmVnLCB1MzIgbWFzaywKKwkJCQkg
dTMyIHZhbCkKK3sKKwl1MzIgcmV0ID0gbWdiNF9yZWFkX3JlZyhyZWdzLCByZWcpOworCisJ
dmFsIHw9IHJldCAmIH5tYXNrOworCW1nYjRfd3JpdGVfcmVnKHJlZ3MsIHJlZywgdmFsKTsK
K30KKworZXh0ZXJuIGludCBtZ2I0X3JlZ3NfbWFwKHN0cnVjdCByZXNvdXJjZSAqcmVzLCBz
dHJ1Y3QgbWdiNF9yZWdzICpyZWdzKTsKK2V4dGVybiB2b2lkIG1nYjRfcmVnc19mcmVlKHN0
cnVjdCBtZ2I0X3JlZ3MgKnJlZ3MpOworCisjZW5kaWYKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
bWVkaWEvcGNpL21nYjQvbWdiNF9zeXNmcy5oIGIvZHJpdmVycy9tZWRpYS9wY2kvbWdiNC9t
Z2I0X3N5c2ZzLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi4y
YjQyYThiYTM3ZjcKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL21lZGlhL3BjaS9tZ2I0
L21nYjRfc3lzZnMuaApAQCAtMCwwICsxLDE4IEBACisvKiBTUERYLUxpY2Vuc2UtSWRlbnRp
ZmllcjogR1BMLTIuMC1vbmx5ICovCisvKgorICogQ29weXJpZ2h0IChDKSAyMDIxLTIwMjIg
RGlnaXRlcSBBdXRvbW90aXZlCisgKiAgICAgYXV0aG9yOiBNYXJ0aW4gVHVtYSA8bWFydGlu
LnR1bWFAZGlnaXRlcWF1dG9tb3RpdmUuY29tPgorICovCisKKyNpZm5kZWYgX19NR0I0X1NZ
U0ZTX0hfXworI2RlZmluZSBfX01HQjRfU1lTRlNfSF9fCisKKyNpbmNsdWRlIDxsaW51eC9z
eXNmcy5oPgorCitleHRlcm4gc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKm1nYjRfcGNpX2F0
dHJzW107CitleHRlcm4gc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKm1nYjRfZnBkbDNfaW5f
YXR0cnNbXTsKK2V4dGVybiBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqbWdiNF9nbXNsX2lu
X2F0dHJzW107CitleHRlcm4gc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKm1nYjRfZnBkbDNf
b3V0X2F0dHJzW107CitleHRlcm4gc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKm1nYjRfZ21z
bF9vdXRfYXR0cnNbXTsKKworI2VuZGlmCmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3Bj
aS9tZ2I0L21nYjRfc3lzZnNfaW4uYyBiL2RyaXZlcnMvbWVkaWEvcGNpL21nYjQvbWdiNF9z
eXNmc19pbi5jCm5ldyBmaWxlIG1vZGUgMTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMC4uZmMw
MjQzOTNjN2JhCi0tLSAvZGV2L251bGwKKysrIGIvZHJpdmVycy9tZWRpYS9wY2kvbWdiNC9t
Z2I0X3N5c2ZzX2luLmMKQEAgLTAsMCArMSw3NTAgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVu
dGlmaWVyOiBHUEwtMi4wLW9ubHkKKy8qCisgKiBDb3B5cmlnaHQgKEMpIDIwMjEtMjAyMiBE
aWdpdGVxIEF1dG9tb3RpdmUKKyAqICAgICBhdXRob3I6IE1hcnRpbiBUdW1hIDxtYXJ0aW4u
dHVtYUBkaWdpdGVxYXV0b21vdGl2ZS5jb20+CisgKi8KKworI2luY2x1ZGUgPGxpbnV4L2Rl
dmljZS5oPgorI2luY2x1ZGUgIm1nYjRfY29yZS5oIgorI2luY2x1ZGUgIm1nYjRfaTJjLmgi
CisjaW5jbHVkZSAibWdiNF92aW4uaCIKKyNpbmNsdWRlICJtZ2I0X2NtdC5oIgorI2luY2x1
ZGUgIm1nYjRfc3lzZnMuaCIKKworLyogQ29tbW9uIGZvciBib3RoIEZQREwzIGFuZCBHTVNM
ICovCisKK3N0YXRpYyBzc2l6ZV90IHJlYWRfaW5wdXRfaWQoc3RydWN0IGRldmljZSAqZGV2
LAorCQkJICAgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQor
eworCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYgPSB0b192aWRlb19kZXZpY2UoZGV2KTsK
KwlzdHJ1Y3QgbWdiNF92aW5fZGV2ICp2aW5kZXYgPSB2aWRlb19nZXRfZHJ2ZGF0YSh2ZGV2
KTsKKworCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiVkXG4iLCB2aW5kZXYtPmNvbmZpZy0+aWQp
OworfQorCitzdGF0aWMgc3NpemVfdCByZWFkX29sZGlfbGFuZV93aWR0aChzdHJ1Y3QgZGV2
aWNlICpkZXYsCisJCQkJICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBjaGFy
ICpidWYpCit7CisJc3RydWN0IHZpZGVvX2RldmljZSAqdmRldiA9IHRvX3ZpZGVvX2Rldmlj
ZShkZXYpOworCXN0cnVjdCBtZ2I0X3Zpbl9kZXYgKnZpbmRldiA9IHZpZGVvX2dldF9kcnZk
YXRhKHZkZXYpOworCXUxNiBpMmNfcmVnOworCXU4IGkyY19tYXNrLCBpMmNfc2luZ2xlX3Zh
bCwgaTJjX2R1YWxfdmFsOworCXUzMiBjb25maWc7CisJaW50IHJldDsKKworCWkyY19yZWcg
PSBNR0I0X0lTX0dNU0wodmluZGV2LT5tZ2JkZXYpID8gMHgxQ0UgOiAweDQ5OworCWkyY19t
YXNrID0gTUdCNF9JU19HTVNMKHZpbmRldi0+bWdiZGV2KSA/IDB4MEUgOiAweDAzOworCWky
Y19zaW5nbGVfdmFsID0gTUdCNF9JU19HTVNMKHZpbmRldi0+bWdiZGV2KSA/IDB4MDAgOiAw
eDAyOworCWkyY19kdWFsX3ZhbCA9IE1HQjRfSVNfR01TTCh2aW5kZXYtPm1nYmRldikgPyAw
eDBFIDogMHgwMDsKKworCW11dGV4X2xvY2soJnZpbmRldi0+bWdiZGV2LT5pMmNfbG9jayk7
CisJcmV0ID0gbWdiNF9pMmNfcmVhZF9ieXRlKCZ2aW5kZXYtPmRlc2VyLCBpMmNfcmVnKTsK
KwltdXRleF91bmxvY2soJnZpbmRldi0+bWdiZGV2LT5pMmNfbG9jayk7CisJaWYgKHJldCA8
IDApCisJCXJldHVybiAtRUlPOworCisJY29uZmlnID0gbWdiNF9yZWFkX3JlZygmdmluZGV2
LT5tZ2JkZXYtPnZpZGVvLCB2aW5kZXYtPmNvbmZpZy0+cmVncy5jb25maWcpOworCisJaWYg
KCgoY29uZmlnICYgKDFVPDw5KSkgJiYgKChyZXQgJiBpMmNfbWFzaykgIT0gaTJjX2R1YWxf
dmFsKSkKKwkgIHx8ICghKGNvbmZpZyAmICgxVTw8OSkpICYmICgocmV0ICYgaTJjX21hc2sp
ICE9IGkyY19zaW5nbGVfdmFsKSkpIHsKKwkJZGV2X2VycihkZXYsICJJMkMvRlBHQSByZWdp
c3RlciB2YWx1ZSBtaXNtYXRjaFxuIik7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCXJl
dHVybiBzcHJpbnRmKGJ1ZiwgIiVzXG4iLCBjb25maWcgJiAoMVU8PDkpID8gIjEiIDogIjAi
KTsKK30KKworc3RhdGljIHNzaXplX3Qgd3JpdGVfb2xkaV9sYW5lX3dpZHRoKHN0cnVjdCBk
ZXZpY2UgKmRldiwKKwkJCQkgICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLAor
CQkJCSAgICAgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgY291bnQpCit7CisJc3RydWN0IHZp
ZGVvX2RldmljZSAqdmRldiA9IHRvX3ZpZGVvX2RldmljZShkZXYpOworCXN0cnVjdCBtZ2I0
X3Zpbl9kZXYgKnZpbmRldiA9IHZpZGVvX2dldF9kcnZkYXRhKHZkZXYpOworCXUzMiBmcGdh
X2RhdGE7CisJdTE2IGkyY19yZWc7CisJdTggaTJjX21hc2ssIGkyY19kYXRhOworCXVuc2ln
bmVkIGxvbmcgdmFsOworCWludCByZXQ7CisKKwlyZXQgPSBrc3RydG91bChidWYsIDEwLCAm
dmFsKTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0OworCisJc3dpdGNoICh2YWwpIHsKKwlj
YXNlIDA6IC8qIHNpbmdsZSAqLworCQlmcGdhX2RhdGEgPSAwOworCQlpMmNfZGF0YSA9IE1H
QjRfSVNfR01TTCh2aW5kZXYtPm1nYmRldikgPyAweDAwIDogMHgwMjsKKwkJYnJlYWs7CisJ
Y2FzZSAxOiAvKiBkdWFsICovCisJCWZwZ2FfZGF0YSA9IDFVPDw5OworCQlpMmNfZGF0YSA9
IE1HQjRfSVNfR01TTCh2aW5kZXYtPm1nYmRldikgPyAweDBFIDogMHgwMDsKKwkJYnJlYWs7
CisJZGVmYXVsdDoKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJaTJjX3JlZyA9IE1HQjRf
SVNfR01TTCh2aW5kZXYtPm1nYmRldikgPyAweDFDRSA6IDB4NDk7CisJaTJjX21hc2sgPSBN
R0I0X0lTX0dNU0wodmluZGV2LT5tZ2JkZXYpID8gMHgwRSA6IDB4MDM7CisKKwltdXRleF9s
b2NrKCZ2aW5kZXYtPm1nYmRldi0+aTJjX2xvY2spOworCXJldCA9IG1nYjRfaTJjX21hc2tf
Ynl0ZSgmdmluZGV2LT5kZXNlciwgaTJjX3JlZywgaTJjX21hc2ssIGkyY19kYXRhKTsKKwlt
dXRleF91bmxvY2soJnZpbmRldi0+bWdiZGV2LT5pMmNfbG9jayk7CisJaWYgKHJldCA8IDAp
CisJCXJldHVybiAtRUlPOworCW1nYjRfbWFza19yZWcoJnZpbmRldi0+bWdiZGV2LT52aWRl
bywgdmluZGV2LT5jb25maWctPnJlZ3MuY29uZmlnLCAxVTw8OSwKKwkgIGZwZ2FfZGF0YSk7
CisJaWYgKE1HQjRfSVNfR01TTCh2aW5kZXYtPm1nYmRldikpIHsKKwkJLyogcmVzZXQgaW5w
dXQgbGluayAqLworCQltdXRleF9sb2NrKCZ2aW5kZXYtPm1nYmRldi0+aTJjX2xvY2spOwor
CQlyZXQgPSBtZ2I0X2kyY19tYXNrX2J5dGUoJnZpbmRldi0+ZGVzZXIsIDB4MTAsIDFVPDw1
LCAxVTw8NSk7CisJCW11dGV4X3VubG9jaygmdmluZGV2LT5tZ2JkZXYtPmkyY19sb2NrKTsK
KwkJaWYgKHJldCA8IDApCisJCQlyZXR1cm4gLUVJTzsKKwl9CisKKwlyZXR1cm4gY291bnQ7
Cit9CisKK3N0YXRpYyBzc2l6ZV90IHJlYWRfY29sb3JfbWFwcGluZyhzdHJ1Y3QgZGV2aWNl
ICpkZXYsCisJCQkJICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVm
KQoreworCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYgPSB0b192aWRlb19kZXZpY2UoZGV2
KTsKKwlzdHJ1Y3QgbWdiNF92aW5fZGV2ICp2aW5kZXYgPSB2aWRlb19nZXRfZHJ2ZGF0YSh2
ZGV2KTsKKwl1MzIgY29uZmlnID0gbWdiNF9yZWFkX3JlZygmdmluZGV2LT5tZ2JkZXYtPnZp
ZGVvLAorCSAgdmluZGV2LT5jb25maWctPnJlZ3MuY29uZmlnKTsKKworCXJldHVybiBzcHJp
bnRmKGJ1ZiwgIiVzXG4iLCBjb25maWcgJiAoMVU8PDgpID8gIjAiIDogIjEiKTsKK30KKwor
c3RhdGljIHNzaXplX3Qgd3JpdGVfY29sb3JfbWFwcGluZyhzdHJ1Y3QgZGV2aWNlICpkZXYs
CisJCQkJICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsCisJCQkJICAgY29uc3Qg
Y2hhciAqYnVmLCBzaXplX3QgY291bnQpCit7CisJc3RydWN0IHZpZGVvX2RldmljZSAqdmRl
diA9IHRvX3ZpZGVvX2RldmljZShkZXYpOworCXN0cnVjdCBtZ2I0X3Zpbl9kZXYgKnZpbmRl
diA9IHZpZGVvX2dldF9kcnZkYXRhKHZkZXYpOworCXUzMiBmcGdhX2RhdGE7CisJdW5zaWdu
ZWQgbG9uZyB2YWw7CisJaW50IHJldDsKKworCXJldCA9IGtzdHJ0b3VsKGJ1ZiwgMTAsICZ2
YWwpOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisKKwlzd2l0Y2ggKHZhbCkgeworCWNh
c2UgMDogLyogT0xESS9KRUlEQSAqLworCQlmcGdhX2RhdGEgPSAoMVU8PDgpOworCQlicmVh
azsKKwljYXNlIDE6IC8qIFNQV0cvVkVTQSAqLworCQlmcGdhX2RhdGEgPSAwOworCQlicmVh
azsKKwlkZWZhdWx0OgorCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwltZ2I0X21hc2tfcmVn
KCZ2aW5kZXYtPm1nYmRldi0+dmlkZW8sIHZpbmRldi0+Y29uZmlnLT5yZWdzLmNvbmZpZywg
MVU8PDgsCisJICBmcGdhX2RhdGEpOworCisJcmV0dXJuIGNvdW50OworfQorCitzdGF0aWMg
c3NpemVfdCByZWFkX2xpbmtfc3RhdHVzKHN0cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0IGRl
dmljZV9hdHRyaWJ1dGUgKmF0dHIsCisJCQkJY2hhciAqYnVmKQoreworCXN0cnVjdCB2aWRl
b19kZXZpY2UgKnZkZXYgPSB0b192aWRlb19kZXZpY2UoZGV2KTsKKwlzdHJ1Y3QgbWdiNF92
aW5fZGV2ICp2aW5kZXYgPSB2aWRlb19nZXRfZHJ2ZGF0YSh2ZGV2KTsKKwl1MzIgc3RhdHVz
ID0gbWdiNF9yZWFkX3JlZygmdmluZGV2LT5tZ2JkZXYtPnZpZGVvLCB2aW5kZXYtPmNvbmZp
Zy0+cmVncy5zdGF0dXMpOworCisJcmV0dXJuIHNwcmludGYoYnVmLCAiJXNcbiIsIHN0YXR1
cyAmICgxVTw8MikgPyAiMSIgOiAiMCIpOworfQorCitzdGF0aWMgc3NpemVfdCByZWFkX3N0
cmVhbV9zdGF0dXMoc3RydWN0IGRldmljZSAqZGV2LCBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0
ZSAqYXR0ciwKKwkJCQkgIGNoYXIgKmJ1ZikKK3sKKwlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2
ZGV2ID0gdG9fdmlkZW9fZGV2aWNlKGRldik7CisJc3RydWN0IG1nYjRfdmluX2RldiAqdmlu
ZGV2ID0gdmlkZW9fZ2V0X2RydmRhdGEodmRldik7CisJdTMyIHN0YXR1cyA9IG1nYjRfcmVh
ZF9yZWcoJnZpbmRldi0+bWdiZGV2LT52aWRlbywgdmluZGV2LT5jb25maWctPnJlZ3Muc3Rh
dHVzKTsKKworCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiVzXG4iLCAoKHN0YXR1cyAmICgxPDwx
NCkpICYmIChzdGF0dXMgJiAoMTw8MikpCisJICAmJiAoc3RhdHVzICYgKDM8PDkpKSkgPyAi
MSIgOiAiMCIpOworfQorCitzdGF0aWMgc3NpemVfdCByZWFkX2hzeW5jX3N0YXR1cyhzdHJ1
Y3QgZGV2aWNlICpkZXYsIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLAorCQkJCSBj
aGFyICpidWYpCit7CisJc3RydWN0IHZpZGVvX2RldmljZSAqdmRldiA9IHRvX3ZpZGVvX2Rl
dmljZShkZXYpOworCXN0cnVjdCBtZ2I0X3Zpbl9kZXYgKnZpbmRldiA9IHZpZGVvX2dldF9k
cnZkYXRhKHZkZXYpOworCXUzMiBzdGF0dXMgPSBtZ2I0X3JlYWRfcmVnKCZ2aW5kZXYtPm1n
YmRldi0+dmlkZW8sIHZpbmRldi0+Y29uZmlnLT5yZWdzLnN0YXR1cyk7CisJdTMyIHJlczsK
KworCWlmICghKHN0YXR1cyAmICgxVTw8MTEpKSkKKwkJcmVzID0gMHgwMjsgLy8gbm90IGF2
YWlsYWJsZQorCWVsc2UgaWYgKHN0YXR1cyAmICgxVTw8MTIpKQorCQlyZXMgPSAweDAxOyAv
LyBhY3RpdmUgaGlnaAorCWVsc2UKKwkJcmVzID0gMHgwMDsgLy8gYWN0aXZlIGxvdworCisJ
cmV0dXJuIHNwcmludGYoYnVmLCAiJXVcbiIsIHJlcyk7Cit9CisKK3N0YXRpYyBzc2l6ZV90
IHJlYWRfdnN5bmNfc3RhdHVzKHN0cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0IGRldmljZV9h
dHRyaWJ1dGUgKmF0dHIsCisJCQkJIGNoYXIgKmJ1ZikKK3sKKwlzdHJ1Y3QgdmlkZW9fZGV2
aWNlICp2ZGV2ID0gdG9fdmlkZW9fZGV2aWNlKGRldik7CisJc3RydWN0IG1nYjRfdmluX2Rl
diAqdmluZGV2ID0gdmlkZW9fZ2V0X2RydmRhdGEodmRldik7CisJdTMyIHN0YXR1cyA9IG1n
YjRfcmVhZF9yZWcoJnZpbmRldi0+bWdiZGV2LT52aWRlbywgdmluZGV2LT5jb25maWctPnJl
Z3Muc3RhdHVzKTsKKwl1MzIgcmVzOworCisJaWYgKCEoc3RhdHVzICYgKDFVPDwxMSkpKQor
CQlyZXMgPSAweDAyOyAvLyBub3QgYXZhaWxhYmxlCisJZWxzZSBpZiAoc3RhdHVzICYgKDFV
PDwxMykpCisJCXJlcyA9IDB4MDE7IC8vIGFjdGl2ZSBoaWdoCisJZWxzZQorCQlyZXMgPSAw
eDAwOyAvLyBhY3RpdmUgbG93CisKKwlyZXR1cm4gc3ByaW50ZihidWYsICIldVxuIiwgcmVz
KTsKK30KKworc3RhdGljIHNzaXplX3QgcmVhZF9oc3luY19nYXAoc3RydWN0IGRldmljZSAq
ZGV2LCBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwKKwkJCSAgICAgIGNoYXIgKmJ1
ZikKK3sKKwlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0gdG9fdmlkZW9fZGV2aWNlKGRl
dik7CisJc3RydWN0IG1nYjRfdmluX2RldiAqdmluZGV2ID0gdmlkZW9fZ2V0X2RydmRhdGEo
dmRldik7CisJdTMyIHN5bmMgPSBtZ2I0X3JlYWRfcmVnKCZ2aW5kZXYtPm1nYmRldi0+dmlk
ZW8sIHZpbmRldi0+Y29uZmlnLT5yZWdzLnN5bmMpOworCisJcmV0dXJuIHNwcmludGYoYnVm
LCAiJXVcbiIsIHN5bmMgPj4gMTYpOworfQorCitzdGF0aWMgc3NpemVfdCB3cml0ZV9oc3lu
Y19nYXAoc3RydWN0IGRldmljZSAqZGV2LAorCQkJICAgICAgIHN0cnVjdCBkZXZpY2VfYXR0
cmlidXRlICphdHRyLCBjb25zdCBjaGFyICpidWYsCisJCQkgICAgICAgc2l6ZV90IGNvdW50
KQoreworCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYgPSB0b192aWRlb19kZXZpY2UoZGV2
KTsKKwlzdHJ1Y3QgbWdiNF92aW5fZGV2ICp2aW5kZXYgPSB2aWRlb19nZXRfZHJ2ZGF0YSh2
ZGV2KTsKKwl1bnNpZ25lZCBsb25nIHZhbDsKKwlpbnQgcmV0OworCisJcmV0ID0ga3N0cnRv
dWwoYnVmLCAxMCwgJnZhbCk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKwlpZiAodmFs
ID4gMHhGRkZGKQorCQlyZXR1cm4gLUVJTlZBTDsKKworCW1nYjRfbWFza19yZWcoJnZpbmRl
di0+bWdiZGV2LT52aWRlbywgdmluZGV2LT5jb25maWctPnJlZ3Muc3luYywgMHhGRkZGMDAw
MCwKKwkgIHZhbCA8PCAxNik7CisKKwlyZXR1cm4gY291bnQ7Cit9CisKK3N0YXRpYyBzc2l6
ZV90IHJlYWRfdnN5bmNfZ2FwKHN0cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0IGRldmljZV9h
dHRyaWJ1dGUgKmF0dHIsCisJCQkgICAgICBjaGFyICpidWYpCit7CisJc3RydWN0IHZpZGVv
X2RldmljZSAqdmRldiA9IHRvX3ZpZGVvX2RldmljZShkZXYpOworCXN0cnVjdCBtZ2I0X3Zp
bl9kZXYgKnZpbmRldiA9IHZpZGVvX2dldF9kcnZkYXRhKHZkZXYpOworCXUzMiBzeW5jID0g
bWdiNF9yZWFkX3JlZygmdmluZGV2LT5tZ2JkZXYtPnZpZGVvLCB2aW5kZXYtPmNvbmZpZy0+
cmVncy5zeW5jKTsKKworCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiV1XG4iLCBzeW5jICYgMHhG
RkZGKTsKK30KKworc3RhdGljIHNzaXplX3Qgd3JpdGVfdnN5bmNfZ2FwKHN0cnVjdCBkZXZp
Y2UgKmRldiwKKwkJCSAgICAgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY29u
c3QgY2hhciAqYnVmLAorCQkJICAgICAgIHNpemVfdCBjb3VudCkKK3sKKwlzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlICp2ZGV2ID0gdG9fdmlkZW9fZGV2aWNlKGRldik7CisJc3RydWN0IG1nYjRf
dmluX2RldiAqdmluZGV2ID0gdmlkZW9fZ2V0X2RydmRhdGEodmRldik7CisJdW5zaWduZWQg
bG9uZyB2YWw7CisJaW50IHJldDsKKworCXJldCA9IGtzdHJ0b3VsKGJ1ZiwgMTAsICZ2YWwp
OworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisJaWYgKHZhbCA+IDB4RkZGRikKKwkJcmV0
dXJuIC1FSU5WQUw7CisKKwltZ2I0X21hc2tfcmVnKCZ2aW5kZXYtPm1nYmRldi0+dmlkZW8s
IHZpbmRldi0+Y29uZmlnLT5yZWdzLnN5bmMsIDB4RkZGRiwgdmFsKTsKKworCXJldHVybiBj
b3VudDsKK30KKworc3RhdGljIHNzaXplX3QgcmVhZF9wY2xrX2ZyZXF1ZW5jeShzdHJ1Y3Qg
ZGV2aWNlICpkZXYsCisJCQkJICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNo
YXIgKmJ1ZikKK3sKKwlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0gdG9fdmlkZW9fZGV2
aWNlKGRldik7CisJc3RydWN0IG1nYjRfdmluX2RldiAqdmluZGV2ID0gdmlkZW9fZ2V0X2Ry
dmRhdGEodmRldik7CisJdTMyIGZyZXEgPSBtZ2I0X3JlYWRfcmVnKCZ2aW5kZXYtPm1nYmRl
di0+dmlkZW8sIHZpbmRldi0+Y29uZmlnLT5yZWdzLnBjbGspOworCisJcmV0dXJuIHNwcmlu
dGYoYnVmLCAiJXVcbiIsIGZyZXEpOworfQorCitzdGF0aWMgc3NpemVfdCByZWFkX2hzeW5j
X3dpZHRoKHN0cnVjdCBkZXZpY2UgKmRldiwKKwkJCQlzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0
ZSAqYXR0ciwgY2hhciAqYnVmKQoreworCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYgPSB0
b192aWRlb19kZXZpY2UoZGV2KTsKKwlzdHJ1Y3QgbWdiNF92aW5fZGV2ICp2aW5kZXYgPSB2
aWRlb19nZXRfZHJ2ZGF0YSh2ZGV2KTsKKwl1MzIgc2lnID0gbWdiNF9yZWFkX3JlZygmdmlu
ZGV2LT5tZ2JkZXYtPnZpZGVvLCB2aW5kZXYtPmNvbmZpZy0+cmVncy5zaWduYWwpOworCisJ
cmV0dXJuIHNwcmludGYoYnVmLCAiJXVcbiIsIChzaWcgJiAweDAwRkYwMDAwKSA+PiAxNik7
Cit9CisKK3N0YXRpYyBzc2l6ZV90IHJlYWRfdnN5bmNfd2lkdGgoc3RydWN0IGRldmljZSAq
ZGV2LAorCQkJCXN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBjaGFyICpidWYpCit7
CisJc3RydWN0IHZpZGVvX2RldmljZSAqdmRldiA9IHRvX3ZpZGVvX2RldmljZShkZXYpOwor
CXN0cnVjdCBtZ2I0X3Zpbl9kZXYgKnZpbmRldiA9IHZpZGVvX2dldF9kcnZkYXRhKHZkZXYp
OworCXUzMiBzaWcgPSBtZ2I0X3JlYWRfcmVnKCZ2aW5kZXYtPm1nYmRldi0+dmlkZW8sIHZp
bmRldi0+Y29uZmlnLT5yZWdzLnNpZ25hbDIpOworCisJcmV0dXJuIHNwcmludGYoYnVmLCAi
JXVcbiIsIChzaWcgJiAweDAwRkYwMDAwKSA+PiAxNik7Cit9CisKK3N0YXRpYyBzc2l6ZV90
IHJlYWRfaGJhY2tfcG9yY2goc3RydWN0IGRldmljZSAqZGV2LAorCQkJCXN0cnVjdCBkZXZp
Y2VfYXR0cmlidXRlICphdHRyLCBjaGFyICpidWYpCit7CisJc3RydWN0IHZpZGVvX2Rldmlj
ZSAqdmRldiA9IHRvX3ZpZGVvX2RldmljZShkZXYpOworCXN0cnVjdCBtZ2I0X3Zpbl9kZXYg
KnZpbmRldiA9IHZpZGVvX2dldF9kcnZkYXRhKHZkZXYpOworCXUzMiBzaWcgPSBtZ2I0X3Jl
YWRfcmVnKCZ2aW5kZXYtPm1nYmRldi0+dmlkZW8sIHZpbmRldi0+Y29uZmlnLT5yZWdzLnNp
Z25hbCk7CisKKwlyZXR1cm4gc3ByaW50ZihidWYsICIldVxuIiwgKHNpZyAmIDB4MDAwMEZG
MDApID4+IDgpOworfQorCitzdGF0aWMgc3NpemVfdCByZWFkX2hmcm9udF9wb3JjaChzdHJ1
Y3QgZGV2aWNlICpkZXYsCisJCQkJIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBj
aGFyICpidWYpCit7CisJc3RydWN0IHZpZGVvX2RldmljZSAqdmRldiA9IHRvX3ZpZGVvX2Rl
dmljZShkZXYpOworCXN0cnVjdCBtZ2I0X3Zpbl9kZXYgKnZpbmRldiA9IHZpZGVvX2dldF9k
cnZkYXRhKHZkZXYpOworCXUzMiBzaWcgPSBtZ2I0X3JlYWRfcmVnKCZ2aW5kZXYtPm1nYmRl
di0+dmlkZW8sIHZpbmRldi0+Y29uZmlnLT5yZWdzLnNpZ25hbCk7CisKKwlyZXR1cm4gc3By
aW50ZihidWYsICIldVxuIiwgKHNpZyAmIDB4MDAwMDAwRkYpKTsKK30KKworc3RhdGljIHNz
aXplX3QgcmVhZF92YmFja19wb3JjaChzdHJ1Y3QgZGV2aWNlICpkZXYsCisJCQkJc3RydWN0
IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikKK3sKKwlzdHJ1Y3QgdmlkZW9f
ZGV2aWNlICp2ZGV2ID0gdG9fdmlkZW9fZGV2aWNlKGRldik7CisJc3RydWN0IG1nYjRfdmlu
X2RldiAqdmluZGV2ID0gdmlkZW9fZ2V0X2RydmRhdGEodmRldik7CisJdTMyIHNpZyA9IG1n
YjRfcmVhZF9yZWcoJnZpbmRldi0+bWdiZGV2LT52aWRlbywgdmluZGV2LT5jb25maWctPnJl
Z3Muc2lnbmFsMik7CisKKwlyZXR1cm4gc3ByaW50ZihidWYsICIldVxuIiwgKHNpZyAmIDB4
MDAwMEZGMDApID4+IDgpOworfQorCitzdGF0aWMgc3NpemVfdCByZWFkX3Zmcm9udF9wb3Jj
aChzdHJ1Y3QgZGV2aWNlICpkZXYsCisJCQkJIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICph
dHRyLCBjaGFyICpidWYpCit7CisJc3RydWN0IHZpZGVvX2RldmljZSAqdmRldiA9IHRvX3Zp
ZGVvX2RldmljZShkZXYpOworCXN0cnVjdCBtZ2I0X3Zpbl9kZXYgKnZpbmRldiA9IHZpZGVv
X2dldF9kcnZkYXRhKHZkZXYpOworCXUzMiBzaWcgPSBtZ2I0X3JlYWRfcmVnKCZ2aW5kZXYt
Pm1nYmRldi0+dmlkZW8sIHZpbmRldi0+Y29uZmlnLT5yZWdzLnNpZ25hbDIpOworCisJcmV0
dXJuIHNwcmludGYoYnVmLCAiJXVcbiIsIChzaWcgJiAweDAwMDAwMEZGKSk7Cit9CisKK3N0
YXRpYyBzc2l6ZV90IHJlYWRfZnJlcXVlbmN5X3JhbmdlKHN0cnVjdCBkZXZpY2UgKmRldiwK
KwkJCQkgICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikKK3sK
KwlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0gdG9fdmlkZW9fZGV2aWNlKGRldik7CisJ
c3RydWN0IG1nYjRfdmluX2RldiAqdmluZGV2ID0gdmlkZW9fZ2V0X2RydmRhdGEodmRldik7
CisKKwlyZXR1cm4gc3ByaW50ZihidWYsICIlZFxuIiwgdmluZGV2LT5mcmVxX3JhbmdlKTsK
K30KKworc3RhdGljIHNzaXplX3Qgd3JpdGVfZnJlcXVlbmN5X3JhbmdlKHN0cnVjdCBkZXZp
Y2UgKmRldiwKKwkJCQkgICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLAorCQkJ
CSAgICAgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgY291bnQpCit7CisJc3RydWN0IHZpZGVv
X2RldmljZSAqdmRldiA9IHRvX3ZpZGVvX2RldmljZShkZXYpOworCXN0cnVjdCBtZ2I0X3Zp
bl9kZXYgKnZpbmRldiA9IHZpZGVvX2dldF9kcnZkYXRhKHZkZXYpOworCXVuc2lnbmVkIGxv
bmcgdmFsLCBmbGFnczsKKwlpbnQgcmV0OworCisJcmV0ID0ga3N0cnRvdWwoYnVmLCAxMCwg
JnZhbCk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKwlpZiAodmFsID4gMSkKKwkJcmV0
dXJuIC1FSU5WQUw7CisKKwlzcGluX2xvY2tfaXJxc2F2ZSgmKHZpbmRldi0+dmRldi5maF9s
b2NrKSwgZmxhZ3MpOworCWlmICghbGlzdF9lbXB0eSgmKHZpbmRldi0+dmRldi5maF9saXN0
KSkpIHsKKwkJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmKHZpbmRldi0+dmRldi5maF9sb2Nr
KSwgZmxhZ3MpOworCQlyZXR1cm4gLUVCVVNZOworCX0KKworCW1nYjRfY210X3NldF92aW4o
dmluZGV2LCB2YWwpOworCXZpbmRldi0+ZnJlcV9yYW5nZSA9IHZhbDsKKworCXNwaW5fdW5s
b2NrX2lycXJlc3RvcmUoJih2aW5kZXYtPnZkZXYuZmhfbG9jayksIGZsYWdzKTsKKworCXJl
dHVybiBjb3VudDsKK30KKworc3RhdGljIHNzaXplX3QgcmVhZF9hbGlnbm1lbnQoc3RydWN0
IGRldmljZSAqZGV2LAorCQkJICAgICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIs
IGNoYXIgKmJ1ZikKK3sKKwlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0gdG9fdmlkZW9f
ZGV2aWNlKGRldik7CisJc3RydWN0IG1nYjRfdmluX2RldiAqdmluZGV2ID0gdmlkZW9fZ2V0
X2RydmRhdGEodmRldik7CisKKwlyZXR1cm4gc3ByaW50ZihidWYsICIlZFxuIiwgdmluZGV2
LT5hbGlnbm1lbnQpOworfQorCitzdGF0aWMgc3NpemVfdCB3cml0ZV9hbGlnbm1lbnQoc3Ry
dWN0IGRldmljZSAqZGV2LAorCQkJICAgICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICph
dHRyLCBjb25zdCBjaGFyICpidWYsCisJCQkgICAgICAgc2l6ZV90IGNvdW50KQoreworCXN0
cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYgPSB0b192aWRlb19kZXZpY2UoZGV2KTsKKwlzdHJ1
Y3QgbWdiNF92aW5fZGV2ICp2aW5kZXYgPSB2aWRlb19nZXRfZHJ2ZGF0YSh2ZGV2KTsKKwl1
bnNpZ25lZCBsb25nIHZhbCwgZmxhZ3M7CisJaW50IHJldDsKKworCXJldCA9IGtzdHJ0b3Vs
KGJ1ZiwgMTAsICZ2YWwpOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisJaWYgKCF2YWwg
fHwgKHZhbCAmICh2YWwgLSAxKSkpCisJCXJldHVybiAtRUlOVkFMOworCisJc3Bpbl9sb2Nr
X2lycXNhdmUoJih2aW5kZXYtPnZkZXYuZmhfbG9jayksIGZsYWdzKTsKKwlpZiAoIWxpc3Rf
ZW1wdHkoJih2aW5kZXYtPnZkZXYuZmhfbGlzdCkpKSB7CisJCXNwaW5fdW5sb2NrX2lycXJl
c3RvcmUoJih2aW5kZXYtPnZkZXYuZmhfbG9jayksIGZsYWdzKTsKKwkJcmV0dXJuIC1FQlVT
WTsKKwl9CisKKwl2aW5kZXYtPmFsaWdubWVudCA9IHZhbDsKKworCXNwaW5fdW5sb2NrX2ly
cXJlc3RvcmUoJih2aW5kZXYtPnZkZXYuZmhfbG9jayksIGZsYWdzKTsKKworCXJldHVybiBj
b3VudDsKK30KKworLyogRlBETDMgb25seSAqLworCitzdGF0aWMgc3NpemVfdCByZWFkX2Zw
ZGwzX2lucHV0X3dpZHRoKHN0cnVjdCBkZXZpY2UgKmRldiwKKwkJCQkgICAgICBzdHJ1Y3Qg
ZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQoreworCXN0cnVjdCB2aWRlb19k
ZXZpY2UgKnZkZXYgPSB0b192aWRlb19kZXZpY2UoZGV2KTsKKwlzdHJ1Y3QgbWdiNF92aW5f
ZGV2ICp2aW5kZXYgPSB2aWRlb19nZXRfZHJ2ZGF0YSh2ZGV2KTsKKwlzMzIgcmV0OworCisJ
bXV0ZXhfbG9jaygmdmluZGV2LT5tZ2JkZXYtPmkyY19sb2NrKTsKKwlyZXQgPSBtZ2I0X2ky
Y19yZWFkX2J5dGUoJnZpbmRldi0+ZGVzZXIsIDB4MzQpOworCW11dGV4X3VubG9jaygmdmlu
ZGV2LT5tZ2JkZXYtPmkyY19sb2NrKTsKKwlpZiAocmV0IDwgMCkKKwkJcmV0dXJuIC1FSU87
CisKKwlzd2l0Y2ggKCh1OClyZXQgJiAweDE4KSB7CisJY2FzZSAwOgorCQlyZXR1cm4gc3By
aW50ZihidWYsICIwXG4iKTsKKwljYXNlIDB4MTA6CisJCXJldHVybiBzcHJpbnRmKGJ1Ziwg
IjFcbiIpOworCWNhc2UgMHgwODoKKwkJcmV0dXJuIHNwcmludGYoYnVmLCAiMlxuIik7CisJ
ZGVmYXVsdDoKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorfQorCitzdGF0aWMgc3NpemVfdCB3
cml0ZV9mcGRsM19pbnB1dF93aWR0aChzdHJ1Y3QgZGV2aWNlICpkZXYsCisJCQkJICAgICAg
IHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLAorCQkJCSAgICAgICBjb25zdCBjaGFy
ICpidWYsIHNpemVfdCBjb3VudCkKK3sKKwlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0g
dG9fdmlkZW9fZGV2aWNlKGRldik7CisJc3RydWN0IG1nYjRfdmluX2RldiAqdmluZGV2ID0g
dmlkZW9fZ2V0X2RydmRhdGEodmRldik7CisJdTggaTJjX2RhdGE7CisJdW5zaWduZWQgbG9u
ZyB2YWw7CisJaW50IHJldDsKKworCXJldCA9IGtzdHJ0b3VsKGJ1ZiwgMTAsICZ2YWwpOwor
CWlmIChyZXQpCisJCXJldHVybiByZXQ7CisKKwlzd2l0Y2ggKHZhbCkgeworCWNhc2UgMDog
LyogYXV0byAqLworCQlpMmNfZGF0YSA9IDB4MDA7CisJCWJyZWFrOworCWNhc2UgMTogLyog
c2luZ2xlICovCisJCWkyY19kYXRhID0gMHgxMDsKKwkJYnJlYWs7CisJY2FzZSAyOiAvKiBk
dWFsICovCisJCWkyY19kYXRhID0gMHgwODsKKwkJYnJlYWs7CisJZGVmYXVsdDoKKwkJcmV0
dXJuIC1FSU5WQUw7CisJfQorCisJbXV0ZXhfbG9jaygmdmluZGV2LT5tZ2JkZXYtPmkyY19s
b2NrKTsKKwlyZXQgPSBtZ2I0X2kyY19tYXNrX2J5dGUoJnZpbmRldi0+ZGVzZXIsIDB4MzQs
IDB4MTgsIGkyY19kYXRhKTsKKwltdXRleF91bmxvY2soJnZpbmRldi0+bWdiZGV2LT5pMmNf
bG9jayk7CisJaWYgKHJldCA8IDApCisJCXJldHVybiAtRUlPOworCisJcmV0dXJuIGNvdW50
OworfQorCisKKy8qIEdNU0wgb25seSAqLworCitzdGF0aWMgc3NpemVfdCByZWFkX2dtc2xf
bW9kZShzdHJ1Y3QgZGV2aWNlICpkZXYsCisJCQkgICAgICBzdHJ1Y3QgZGV2aWNlX2F0dHJp
YnV0ZSAqYXR0ciwgY2hhciAqYnVmKQoreworCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYg
PSB0b192aWRlb19kZXZpY2UoZGV2KTsKKwlzdHJ1Y3QgbWdiNF92aW5fZGV2ICp2aW5kZXYg
PSB2aWRlb19nZXRfZHJ2ZGF0YSh2ZGV2KTsKKwlzMzIgcjEsIHIzMDAsIHIzOworCisJbXV0
ZXhfbG9jaygmdmluZGV2LT5tZ2JkZXYtPmkyY19sb2NrKTsKKwlyMSA9IG1nYjRfaTJjX3Jl
YWRfYnl0ZSgmdmluZGV2LT5kZXNlciwgMHgwMSk7CisJcjMwMCA9IG1nYjRfaTJjX3JlYWRf
Ynl0ZSgmdmluZGV2LT5kZXNlciwgMHgzMDApOworCXIzID0gbWdiNF9pMmNfcmVhZF9ieXRl
KCZ2aW5kZXYtPmRlc2VyLCAweDAzKTsKKwltdXRleF91bmxvY2soJnZpbmRldi0+bWdiZGV2
LT5pMmNfbG9jayk7CisJaWYgKHIxIDwgMCB8fCByMzAwIDwgMCB8fCByMyA8IDApCisJCXJl
dHVybiAtRUlPOworCisJaWYgKChyMSAmIDB4MDMpID09IDB4MDMgJiYgKHIzMDAgJiAweDBD
KSA9PSAweDBDICYmIChyMyAmIDB4QzApID09IDB4QzApCisJCXJldHVybiBzcHJpbnRmKGJ1
ZiwgIjBcbiIpOworCWVsc2UgaWYgKChyMSAmIDB4MDMpID09IDB4MDIgJiYgKHIzMDAgJiAw
eDBDKSA9PSAweDA4ICYmIChyMyAmIDB4QzApID09IDB4MDApCisJCXJldHVybiBzcHJpbnRm
KGJ1ZiwgIjFcbiIpOworCWVsc2UgaWYgKChyMSAmIDB4MDMpID09IDB4MDEgJiYgKHIzMDAg
JiAweDBDKSA9PSAweDA0ICYmIChyMyAmIDB4QzApID09IDB4MDApCisJCXJldHVybiBzcHJp
bnRmKGJ1ZiwgIjJcbiIpOworCWVsc2UgaWYgKChyMSAmIDB4MDMpID09IDB4MDAgJiYgKHIz
MDAgJiAweDBDKSA9PSAweDAwICYmIChyMyAmIDB4QzApID09IDB4MDApCisJCXJldHVybiBz
cHJpbnRmKGJ1ZiwgIjNcbiIpOworCWVsc2UKKwkJcmV0dXJuIC1FSU5WQUw7Cit9CisKK3N0
YXRpYyBzc2l6ZV90IHdyaXRlX2dtc2xfbW9kZShzdHJ1Y3QgZGV2aWNlICpkZXYsCisJCQkg
ICAgICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNvbnN0IGNoYXIgKmJ1ZiwK
KwkJCSAgICAgICBzaXplX3QgY291bnQpCit7CisJc3RhdGljIGNvbnN0IHN0cnVjdCBtZ2I0
X2kyY19rdiBHMTJbXSA9IHsKKwkJezB4MDEsIDB4MDMsIDB4MDN9LCB7MHgzMDAsIDB4MEMs
IDB4MEN9LCB7MHgwMywgMHhDMCwgMHhDMH19OworCXN0YXRpYyBjb25zdCBzdHJ1Y3QgbWdi
NF9pMmNfa3YgRzZbXSA9IHsKKwkJezB4MDEsIDB4MDMsIDB4MDJ9LCB7MHgzMDAsIDB4MEMs
IDB4MDh9LCB7MHgwMywgMHhDMCwgMHgwMH19OworCXN0YXRpYyBjb25zdCBzdHJ1Y3QgbWdi
NF9pMmNfa3YgRzNbXSA9IHsKKwkJezB4MDEsIDB4MDMsIDB4MDF9LCB7MHgzMDAsIDB4MEMs
IDB4MDR9LCB7MHgwMywgMHhDMCwgMHgwMH19OworCXN0YXRpYyBjb25zdCBzdHJ1Y3QgbWdi
NF9pMmNfa3YgRzFbXSA9IHsKKwkJezB4MDEsIDB4MDMsIDB4MDB9LCB7MHgzMDAsIDB4MEMs
IDB4MDB9LCB7MHgwMywgMHhDMCwgMHgwMH19OworCXN0YXRpYyBjb25zdCBzdHJ1Y3QgbWdi
NF9pMmNfa3YgcmVzZXRbXSA9IHsKKwkJezB4MTAsIDFVPDw1LCAxVTw8NX0sIHsweDMwMCwg
MVU8PDYsIDFVPDw2fX07CisJc3RydWN0IHZpZGVvX2RldmljZSAqdmRldiA9IHRvX3ZpZGVv
X2RldmljZShkZXYpOworCXN0cnVjdCBtZ2I0X3Zpbl9kZXYgKnZpbmRldiA9IHZpZGVvX2dl
dF9kcnZkYXRhKHZkZXYpOworCWNvbnN0IHN0cnVjdCBtZ2I0X2kyY19rdiAqdmFsdWVzOwor
CXVuc2lnbmVkIGxvbmcgdmFsOworCWludCByZXQ7CisKKwlyZXQgPSBrc3RydG91bChidWYs
IDEwLCAmdmFsKTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0OworCisJc3dpdGNoICh2YWwp
IHsKKwljYXNlIDA6IC8qIDEyR2IvcyAqLworCQl2YWx1ZXMgPSBHMTI7CisJCWJyZWFrOwor
CWNhc2UgMTogLyogNkdiL3MgKi8KKwkJdmFsdWVzID0gRzY7CisJCWJyZWFrOworCWNhc2Ug
MjogLyogM0diL3MgKi8KKwkJdmFsdWVzID0gRzM7CisJCWJyZWFrOworCWNhc2UgMzogLyog
MS41R2IvcyAqLworCQl2YWx1ZXMgPSBHMTsKKwkJYnJlYWs7CisJZGVmYXVsdDoKKwkJcmV0
dXJuIC1FSU5WQUw7CisJfQorCisJbXV0ZXhfbG9jaygmdmluZGV2LT5tZ2JkZXYtPmkyY19s
b2NrKTsKKwlyZXQgPSBtZ2I0X2kyY19jb25maWd1cmUoJnZpbmRldi0+ZGVzZXIsIHZhbHVl
cywgMyk7CisJcmV0IHw9IG1nYjRfaTJjX2NvbmZpZ3VyZSgmdmluZGV2LT5kZXNlciwgcmVz
ZXQsIDIpOworCW11dGV4X3VubG9jaygmdmluZGV2LT5tZ2JkZXYtPmkyY19sb2NrKTsKKwlp
ZiAocmV0IDwgMCkKKwkJcmV0dXJuIC1FSU87CisKKwlyZXR1cm4gY291bnQ7Cit9CisKK3N0
YXRpYyBzc2l6ZV90IHJlYWRfZ21zbF9zdHJlYW1faWQoc3RydWN0IGRldmljZSAqZGV2LAor
CQkJCSAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBjaGFyICpidWYpCit7CisJ
c3RydWN0IHZpZGVvX2RldmljZSAqdmRldiA9IHRvX3ZpZGVvX2RldmljZShkZXYpOworCXN0
cnVjdCBtZ2I0X3Zpbl9kZXYgKnZpbmRldiA9IHZpZGVvX2dldF9kcnZkYXRhKHZkZXYpOwor
CXMzMiByZXQ7CisKKwltdXRleF9sb2NrKCZ2aW5kZXYtPm1nYmRldi0+aTJjX2xvY2spOwor
CXJldCA9IG1nYjRfaTJjX3JlYWRfYnl0ZSgmdmluZGV2LT5kZXNlciwgMHhBMCk7CisJbXV0
ZXhfdW5sb2NrKCZ2aW5kZXYtPm1nYmRldi0+aTJjX2xvY2spOworCWlmIChyZXQgPCAwKQor
CQlyZXR1cm4gLUVJTzsKKworCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiVkXG4iLCByZXQgJiAw
eDAzKTsKK30KKworc3RhdGljIHNzaXplX3Qgd3JpdGVfZ21zbF9zdHJlYW1faWQoc3RydWN0
IGRldmljZSAqZGV2LAorCQkJCSAgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwK
KwkJCQkgICAgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgY291bnQpCit7CisJc3RydWN0IHZp
ZGVvX2RldmljZSAqdmRldiA9IHRvX3ZpZGVvX2RldmljZShkZXYpOworCXN0cnVjdCBtZ2I0
X3Zpbl9kZXYgKnZpbmRldiA9IHZpZGVvX2dldF9kcnZkYXRhKHZkZXYpOworCXVuc2lnbmVk
IGxvbmcgdmFsLCBmbGFnczsKKwlpbnQgcmV0OworCisJcmV0ID0ga3N0cnRvdWwoYnVmLCAx
MCwgJnZhbCk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKwlpZiAodmFsID4gMykKKwkJ
cmV0dXJuIC1FSU5WQUw7CisKKwlzcGluX2xvY2tfaXJxc2F2ZSgmKHZpbmRldi0+dmRldi5m
aF9sb2NrKSwgZmxhZ3MpOworCXJldCA9IGxpc3RfZW1wdHkoJih2aW5kZXYtPnZkZXYuZmhf
bGlzdCkpOworCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJih2aW5kZXYtPnZkZXYuZmhfbG9j
ayksIGZsYWdzKTsKKwlpZiAoIXJldCkKKwkJcmV0dXJuIC1FQlVTWTsKKworCS8qIEZvcm1h
bHksIHRoZXJlIGlzIGEgcmFjZSBjb25kaXRpb24gaGVyZSBhcyB0aGUgY2hhbmdlIHNob3Vs
ZCBiZSBmb3JtYWx5CisJICogZG9uZSB1bmRlciB0aGUgc3BpbmxvY2ssIGJ1dCB3ZSBvbmx5
IHdhbnQgdG8gcHJldmVudCBhIHJlc29sdXRpb24gY2hhbmdlCisJICogd2hlcmUgcG9zc2li
bGUuIEhvd2V2ZXIsIHJlc29sdXRpb24gY2hhbmdlcyBjYW4gaGFwcGVuIGFueXdheSBhbmQg
dGhlCisJICogZHJpdmVyIGNhbiBoYW5kbGUgdGhlbSAodGhleSBvbmx5IGJyZWFrIHRoZSBp
bWFnZSwgbm90IHRoZSBzeXN0ZW0pLgorCSAqCisJICogU28gaW5zdGVhZCBvZiB0cnlpbmcg
dG8gd29ya2Fyb3VuZCB0aGUgc3BpbmxvY2sgLSBtZ2I0X2kyY19tYXNrX2J5dGUoKQorCSAq
IGRvZXMgc2xlZXAgLSB3ZSBzaW1wbHkgbGV0IHRoZSByYXJlIHJhY2UgY29uZGl0aW9uIGhh
cHBlbi4uLgorCSAqLworCW11dGV4X2xvY2soJnZpbmRldi0+bWdiZGV2LT5pMmNfbG9jayk7
CisJcmV0ID0gbWdiNF9pMmNfbWFza19ieXRlKCZ2aW5kZXYtPmRlc2VyLCAweEEwLCAweDAz
LCAodTgpdmFsKTsKKwltdXRleF91bmxvY2soJnZpbmRldi0+bWdiZGV2LT5pMmNfbG9jayk7
CisJaWYgKHJldCA8IDApCisJCXJldHVybiAtRUlPOworCisJcmV0dXJuIGNvdW50OworfQor
CitzdGF0aWMgc3NpemVfdCByZWFkX2dtc2xfZmVjKHN0cnVjdCBkZXZpY2UgKmRldiwgc3Ry
dWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsCisJCQkgICAgIGNoYXIgKmJ1ZikKK3sKKwlz
dHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0gdG9fdmlkZW9fZGV2aWNlKGRldik7CisJc3Ry
dWN0IG1nYjRfdmluX2RldiAqdmluZGV2ID0gdmlkZW9fZ2V0X2RydmRhdGEodmRldik7CisJ
czMyIHIzZTAsIHIzMDg7CisKKwltdXRleF9sb2NrKCZ2aW5kZXYtPm1nYmRldi0+aTJjX2xv
Y2spOworCXIzZTAgPSBtZ2I0X2kyY19yZWFkX2J5dGUoJnZpbmRldi0+ZGVzZXIsIDB4M0Uw
KTsKKwlyMzA4ID0gbWdiNF9pMmNfcmVhZF9ieXRlKCZ2aW5kZXYtPmRlc2VyLCAweDMwOCk7
CisJbXV0ZXhfdW5sb2NrKCZ2aW5kZXYtPm1nYmRldi0+aTJjX2xvY2spOworCWlmIChyM2Uw
IDwgMCB8fCByMzA4IDwgMCkKKwkJcmV0dXJuIC1FSU87CisKKwlpZiAoKHIzZTAgJiAweDA3
KSA9PSAweDAwICYmIChyMzA4ICYgMHgwMSkgPT0gMHgwMCkKKwkJcmV0dXJuIHNwcmludGYo
YnVmLCAiMFxuIik7CisJZWxzZSBpZiAoKHIzZTAgJiAweDA3KSA9PSAweDA3ICYmIChyMzA4
ICYgMHgwMSkgPT0gMHgwMSkKKwkJcmV0dXJuIHNwcmludGYoYnVmLCAiMVxuIik7CisJZWxz
ZQorCQlyZXR1cm4gLUVJTlZBTDsKK30KKworc3RhdGljIHNzaXplX3Qgd3JpdGVfZ21zbF9m
ZWMoc3RydWN0IGRldmljZSAqZGV2LCBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwK
KwkJCSAgICAgIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGNvdW50KQoreworCXN0cnVjdCB2
aWRlb19kZXZpY2UgKnZkZXYgPSB0b192aWRlb19kZXZpY2UoZGV2KTsKKwlzdHJ1Y3QgbWdi
NF92aW5fZGV2ICp2aW5kZXYgPSB2aWRlb19nZXRfZHJ2ZGF0YSh2ZGV2KTsKKwlzdGF0aWMg
Y29uc3Qgc3RydWN0IG1nYjRfaTJjX2t2IGVuYWJsZVtdID0geworCQl7MHgzRTAsIDB4MDcs
IDB4MDd9LCB7MHgzMDgsIDB4MDEsIDB4MDF9fTsKKwlzdGF0aWMgY29uc3Qgc3RydWN0IG1n
YjRfaTJjX2t2IGRpc2FibGVbXSA9IHsKKwkJezB4M0UwLCAweDA3LCAweDAwfSwgezB4MzA4
LCAweDAxLCAweDAwfX07CisJc3RhdGljIGNvbnN0IHN0cnVjdCBtZ2I0X2kyY19rdiByZXNl
dFtdID0geworCQl7MHgxMCwgMVU8PDUsIDFVPDw1fSwgezB4MzAwLCAxVTw8NiwgMVU8PDZ9
fTsKKwljb25zdCBzdHJ1Y3QgbWdiNF9pMmNfa3YgKnZhbHVlczsKKwl1bnNpZ25lZCBsb25n
IHZhbDsKKwlpbnQgcmV0OworCisJcmV0ID0ga3N0cnRvdWwoYnVmLCAxMCwgJnZhbCk7CisJ
aWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKworCXN3aXRjaCAodmFsKSB7CisJY2FzZSAwOiAv
KiBkaXNhYmxlZCAqLworCQl2YWx1ZXMgPSBkaXNhYmxlOworCQlicmVhazsKKwljYXNlIDE6
IC8qIGVuYWJsZWQgKi8KKwkJdmFsdWVzID0gZW5hYmxlOworCQlicmVhazsKKwlkZWZhdWx0
OgorCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisKKwltdXRleF9sb2NrKCZ2aW5kZXYtPm1nYmRl
di0+aTJjX2xvY2spOworCXJldCA9IG1nYjRfaTJjX2NvbmZpZ3VyZSgmdmluZGV2LT5kZXNl
ciwgdmFsdWVzLCAyKTsKKwlyZXQgfD0gbWdiNF9pMmNfY29uZmlndXJlKCZ2aW5kZXYtPmRl
c2VyLCByZXNldCwgMik7CisJbXV0ZXhfdW5sb2NrKCZ2aW5kZXYtPm1nYmRldi0+aTJjX2xv
Y2spOworCWlmIChyZXQgPCAwKQorCQlyZXR1cm4gLUVJTzsKKworCXJldHVybiBjb3VudDsK
K30KKworc3RhdGljIERFVklDRV9BVFRSKGlucHV0X2lkLCAwNDQ0LCByZWFkX2lucHV0X2lk
LCBOVUxMKTsKK3N0YXRpYyBERVZJQ0VfQVRUUihvbGRpX2xhbmVfd2lkdGgsIDA2NDQsIHJl
YWRfb2xkaV9sYW5lX3dpZHRoLAorCQkgICB3cml0ZV9vbGRpX2xhbmVfd2lkdGgpOworc3Rh
dGljIERFVklDRV9BVFRSKGNvbG9yX21hcHBpbmcsIDA2NDQsIHJlYWRfY29sb3JfbWFwcGlu
ZywKKwkJICAgd3JpdGVfY29sb3JfbWFwcGluZyk7CitzdGF0aWMgREVWSUNFX0FUVFIobGlu
a19zdGF0dXMsIDA0NDQsIHJlYWRfbGlua19zdGF0dXMsIE5VTEwpOworc3RhdGljIERFVklD
RV9BVFRSKHN0cmVhbV9zdGF0dXMsIDA0NDQsIHJlYWRfc3RyZWFtX3N0YXR1cywgTlVMTCk7
CitzdGF0aWMgREVWSUNFX0FUVFIoaHN5bmNfc3RhdHVzLCAwNDQ0LCByZWFkX2hzeW5jX3N0
YXR1cywgTlVMTCk7CitzdGF0aWMgREVWSUNFX0FUVFIodnN5bmNfc3RhdHVzLCAwNDQ0LCBy
ZWFkX3ZzeW5jX3N0YXR1cywgTlVMTCk7CitzdGF0aWMgREVWSUNFX0FUVFIoaHN5bmNfZ2Fw
X2xlbmd0aCwgMDY0NCwgcmVhZF9oc3luY19nYXAsIHdyaXRlX2hzeW5jX2dhcCk7CitzdGF0
aWMgREVWSUNFX0FUVFIodnN5bmNfZ2FwX2xlbmd0aCwgMDY0NCwgcmVhZF92c3luY19nYXAs
IHdyaXRlX3ZzeW5jX2dhcCk7CitzdGF0aWMgREVWSUNFX0FUVFIocGNsa19mcmVxdWVuY3ks
IDA0NDQsIHJlYWRfcGNsa19mcmVxdWVuY3ksIE5VTEwpOworc3RhdGljIERFVklDRV9BVFRS
KGhzeW5jX3dpZHRoLCAwNDQ0LCByZWFkX2hzeW5jX3dpZHRoLCBOVUxMKTsKK3N0YXRpYyBE
RVZJQ0VfQVRUUih2c3luY193aWR0aCwgMDQ0NCwgcmVhZF92c3luY193aWR0aCwgTlVMTCk7
CitzdGF0aWMgREVWSUNFX0FUVFIoaGJhY2tfcG9yY2gsIDA0NDQsIHJlYWRfaGJhY2tfcG9y
Y2gsIE5VTEwpOworc3RhdGljIERFVklDRV9BVFRSKGhmcm9udF9wb3JjaCwgMDQ0NCwgcmVh
ZF9oZnJvbnRfcG9yY2gsIE5VTEwpOworc3RhdGljIERFVklDRV9BVFRSKHZiYWNrX3BvcmNo
LCAwNDQ0LCByZWFkX3ZiYWNrX3BvcmNoLCBOVUxMKTsKK3N0YXRpYyBERVZJQ0VfQVRUUih2
ZnJvbnRfcG9yY2gsIDA0NDQsIHJlYWRfdmZyb250X3BvcmNoLCBOVUxMKTsKK3N0YXRpYyBE
RVZJQ0VfQVRUUihmcmVxdWVuY3lfcmFuZ2UsIDA2NDQsIHJlYWRfZnJlcXVlbmN5X3Jhbmdl
LAorCQkgICB3cml0ZV9mcmVxdWVuY3lfcmFuZ2UpOworc3RhdGljIERFVklDRV9BVFRSKGFs
aWdubWVudCwgMDY0NCwgcmVhZF9hbGlnbm1lbnQsIHdyaXRlX2FsaWdubWVudCk7CisKK3N0
YXRpYyBERVZJQ0VfQVRUUihmcGRsM19pbnB1dF93aWR0aCwgMDY0NCwgcmVhZF9mcGRsM19p
bnB1dF93aWR0aCwKKwkJICAgd3JpdGVfZnBkbDNfaW5wdXRfd2lkdGgpOworCitzdGF0aWMg
REVWSUNFX0FUVFIoZ21zbF9tb2RlLCAwNjQ0LCByZWFkX2dtc2xfbW9kZSwgd3JpdGVfZ21z
bF9tb2RlKTsKK3N0YXRpYyBERVZJQ0VfQVRUUihnbXNsX3N0cmVhbV9pZCwgMDY0NCwgcmVh
ZF9nbXNsX3N0cmVhbV9pZCwKKwkJICAgd3JpdGVfZ21zbF9zdHJlYW1faWQpOworc3RhdGlj
IERFVklDRV9BVFRSKGdtc2xfZmVjLCAwNjQ0LCByZWFkX2dtc2xfZmVjLCB3cml0ZV9nbXNs
X2ZlYyk7CisKK3N0cnVjdCBkZXZpY2VfYXR0cmlidXRlICptZ2I0X2ZwZGwzX2luX2F0dHJz
W10gPSB7CisJJmRldl9hdHRyX2lucHV0X2lkLAorCSZkZXZfYXR0cl9saW5rX3N0YXR1cywK
KwkmZGV2X2F0dHJfc3RyZWFtX3N0YXR1cywKKwkmZGV2X2F0dHJfaHN5bmNfc3RhdHVzLAor
CSZkZXZfYXR0cl92c3luY19zdGF0dXMsCisJJmRldl9hdHRyX29sZGlfbGFuZV93aWR0aCwK
KwkmZGV2X2F0dHJfY29sb3JfbWFwcGluZywKKwkmZGV2X2F0dHJfaHN5bmNfZ2FwX2xlbmd0
aCwKKwkmZGV2X2F0dHJfdnN5bmNfZ2FwX2xlbmd0aCwKKwkmZGV2X2F0dHJfcGNsa19mcmVx
dWVuY3ksCisJJmRldl9hdHRyX2hzeW5jX3dpZHRoLAorCSZkZXZfYXR0cl92c3luY193aWR0
aCwKKwkmZGV2X2F0dHJfaGJhY2tfcG9yY2gsCisJJmRldl9hdHRyX2hmcm9udF9wb3JjaCwK
KwkmZGV2X2F0dHJfdmJhY2tfcG9yY2gsCisJJmRldl9hdHRyX3Zmcm9udF9wb3JjaCwKKwkm
ZGV2X2F0dHJfZnJlcXVlbmN5X3JhbmdlLAorCSZkZXZfYXR0cl9hbGlnbm1lbnQsCisJJmRl
dl9hdHRyX2ZwZGwzX2lucHV0X3dpZHRoLAorCU5VTEwKK307CisKK3N0cnVjdCBkZXZpY2Vf
YXR0cmlidXRlICptZ2I0X2dtc2xfaW5fYXR0cnNbXSA9IHsKKwkmZGV2X2F0dHJfaW5wdXRf
aWQsCisJJmRldl9hdHRyX2xpbmtfc3RhdHVzLAorCSZkZXZfYXR0cl9zdHJlYW1fc3RhdHVz
LAorCSZkZXZfYXR0cl9oc3luY19zdGF0dXMsCisJJmRldl9hdHRyX3ZzeW5jX3N0YXR1cywK
KwkmZGV2X2F0dHJfb2xkaV9sYW5lX3dpZHRoLAorCSZkZXZfYXR0cl9jb2xvcl9tYXBwaW5n
LAorCSZkZXZfYXR0cl9oc3luY19nYXBfbGVuZ3RoLAorCSZkZXZfYXR0cl92c3luY19nYXBf
bGVuZ3RoLAorCSZkZXZfYXR0cl9wY2xrX2ZyZXF1ZW5jeSwKKwkmZGV2X2F0dHJfaHN5bmNf
d2lkdGgsCisJJmRldl9hdHRyX3ZzeW5jX3dpZHRoLAorCSZkZXZfYXR0cl9oYmFja19wb3Jj
aCwKKwkmZGV2X2F0dHJfaGZyb250X3BvcmNoLAorCSZkZXZfYXR0cl92YmFja19wb3JjaCwK
KwkmZGV2X2F0dHJfdmZyb250X3BvcmNoLAorCSZkZXZfYXR0cl9mcmVxdWVuY3lfcmFuZ2Us
CisJJmRldl9hdHRyX2FsaWdubWVudCwKKwkmZGV2X2F0dHJfZ21zbF9tb2RlLAorCSZkZXZf
YXR0cl9nbXNsX3N0cmVhbV9pZCwKKwkmZGV2X2F0dHJfZ21zbF9mZWMsCisJTlVMTAorfTsK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGNpL21nYjQvbWdiNF9zeXNmc19vdXQuYyBi
L2RyaXZlcnMvbWVkaWEvcGNpL21nYjQvbWdiNF9zeXNmc19vdXQuYwpuZXcgZmlsZSBtb2Rl
IDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLmJlODBiNjM1ZDFkNwotLS0gL2Rldi9udWxs
CisrKyBiL2RyaXZlcnMvbWVkaWEvcGNpL21nYjQvbWdiNF9zeXNmc19vdXQuYwpAQCAtMCww
ICsxLDczNCBAQAorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb25seQor
LyoKKyAqIENvcHlyaWdodCAoQykgMjAyMS0yMDIyIERpZ2l0ZXEgQXV0b21vdGl2ZQorICog
ICAgIGF1dGhvcjogTWFydGluIFR1bWEgPG1hcnRpbi50dW1hQGRpZ2l0ZXFhdXRvbW90aXZl
LmNvbT4KKyAqLworCisjaW5jbHVkZSA8bGludXgvZGV2aWNlLmg+CisjaW5jbHVkZSAibWdi
NF9jb3JlLmgiCisjaW5jbHVkZSAibWdiNF9pMmMuaCIKKyNpbmNsdWRlICJtZ2I0X3ZvdXQu
aCIKKyNpbmNsdWRlICJtZ2I0X3Zpbi5oIgorI2luY2x1ZGUgIm1nYjRfY210LmgiCisjaW5j
bHVkZSAibWdiNF9zeXNmcy5oIgorCitzdGF0aWMgaW50IGxvb3Bpbl9jbnQoc3RydWN0IG1n
YjRfdmluX2RldiAqdmluZGV2KQoreworCXN0cnVjdCBtZ2I0X3ZvdXRfZGV2ICp2b3V0ZGV2
OworCXUzMiBjb25maWc7CisJaW50IGksIGNudCA9IDA7CisKKwlmb3IgKGkgPSAwOyBpIDwg
TUdCNF9WT1VUX0RFVklDRVM7IGkrKykgeworCQl2b3V0ZGV2ID0gdmluZGV2LT5tZ2JkZXYt
PnZvdXRbaV07CisJCWlmICghdm91dGRldikKKwkJCWNvbnRpbnVlOworCisJCWNvbmZpZyA9
IG1nYjRfcmVhZF9yZWcoJnZvdXRkZXYtPm1nYmRldi0+dmlkZW8sCisJCSAgdm91dGRldi0+
Y29uZmlnLT5yZWdzLmNvbmZpZyk7CisJCWlmICgoY29uZmlnICYgMHhjKSA+PiAyID09IHZp
bmRldi0+Y29uZmlnLT5pZCkKKwkJCWNudCsrOworCX0KKworCXJldHVybiBjbnQ7Cit9CisK
KworLyogQ29tbW9uIGZvciBib3RoIEZQREwzIGFuZCBHTVNMICovCisKK3N0YXRpYyBzc2l6
ZV90IHJlYWRfb3V0cHV0X2lkKHN0cnVjdCBkZXZpY2UgKmRldiwKKwkJCSAgICAgIHN0cnVj
dCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBjaGFyICpidWYpCit7CisJc3RydWN0IHZpZGVv
X2RldmljZSAqdmRldiA9IHRvX3ZpZGVvX2RldmljZShkZXYpOworCXN0cnVjdCBtZ2I0X3Zv
dXRfZGV2ICp2b3V0ZGV2ID0gdmlkZW9fZ2V0X2RydmRhdGEodmRldik7CisKKwlyZXR1cm4g
c3ByaW50ZihidWYsICIlZFxuIiwgdm91dGRldi0+Y29uZmlnLT5pZCk7Cit9CisKK3N0YXRp
YyBzc2l6ZV90IHJlYWRfdmlkZW9fc291cmNlKHN0cnVjdCBkZXZpY2UgKmRldiwKKwkJCQkg
c3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikKK3sKKwlzdHJ1Y3Qg
dmlkZW9fZGV2aWNlICp2ZGV2ID0gdG9fdmlkZW9fZGV2aWNlKGRldik7CisJc3RydWN0IG1n
YjRfdm91dF9kZXYgKnZvdXRkZXYgPSB2aWRlb19nZXRfZHJ2ZGF0YSh2ZGV2KTsKKwl1MzIg
Y29uZmlnID0gbWdiNF9yZWFkX3JlZygmdm91dGRldi0+bWdiZGV2LT52aWRlbywKKwkgIHZv
dXRkZXYtPmNvbmZpZy0+cmVncy5jb25maWcpOworCisJcmV0dXJuIHNwcmludGYoYnVmLCAi
JXVcbiIsIChjb25maWcgJiAweGMpID4+IDIpOworfQorCitzdGF0aWMgc3NpemVfdCB3cml0
ZV92aWRlb19zb3VyY2Uoc3RydWN0IGRldmljZSAqZGV2LAorCQkJCSAgc3RydWN0IGRldmlj
ZV9hdHRyaWJ1dGUgKmF0dHIsCisJCQkJICBjb25zdCBjaGFyICpidWYsIHNpemVfdCBjb3Vu
dCkKK3sKKwlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0gdG9fdmlkZW9fZGV2aWNlKGRl
dik7CisJc3RydWN0IG1nYjRfdm91dF9kZXYgKnZvdXRkZXYgPSB2aWRlb19nZXRfZHJ2ZGF0
YSh2ZGV2KTsKKwlzdHJ1Y3QgbWdiNF9kZXYgKm1nYmRldiA9IHZvdXRkZXYtPm1nYmRldjsK
KwlzdHJ1Y3QgbWdiNF92aW5fZGV2ICpsb29waW5fbmV3ID0gMCwgKmxvb3Bpbl9vbGQgPSAw
OworCXVuc2lnbmVkIGxvbmcgdmFsOworCXVuc2lnbmVkIGxvbmcgZmxhZ3NfaW5bTUdCNF9W
SU5fREVWSUNFU10sIGZsYWdzX291dFtNR0I0X1ZPVVRfREVWSUNFU107CisJc3NpemVfdCBy
ZXQ7CisJdTMyIGNvbmZpZzsKKwlpbnQgaTsKKworCisJbWVtc2V0KGZsYWdzX2luLCAwLCBz
aXplb2YoZmxhZ3NfaW4pKTsKKwltZW1zZXQoZmxhZ3Nfb3V0LCAwLCBzaXplb2YoZmxhZ3Nf
b3V0KSk7CisKKwlyZXQgPSBrc3RydG91bChidWYsIDEwLCAmdmFsKTsKKwlpZiAocmV0KQor
CQlyZXR1cm4gcmV0OworCWlmICh2YWwgPiAzKQorCQlyZXR1cm4gLUVJTlZBTDsKKworCWZv
ciAoaSA9IDA7IGkgPCBNR0I0X1ZJTl9ERVZJQ0VTOyBpKyspCisJCWlmIChtZ2JkZXYtPnZp
bltpXSkKKwkJCXNwaW5fbG9ja19pcnFzYXZlKCYobWdiZGV2LT52aW5baV0tPnZkZXYuZmhf
bG9jayksIGZsYWdzX2luW2ldKTsKKwlmb3IgKGkgPSAwOyBpIDwgTUdCNF9WT1VUX0RFVklD
RVM7IGkrKykKKwkJaWYgKG1nYmRldi0+dm91dFtpXSkKKwkJCXNwaW5fbG9ja19pcnFzYXZl
KCYobWdiZGV2LT52b3V0W2ldLT52ZGV2LmZoX2xvY2spLCBmbGFnc19vdXRbaV0pOworCisJ
cmV0ID0gLUVCVVNZOworCWZvciAoaSA9IDA7IGkgPCBNR0I0X1ZJTl9ERVZJQ0VTOyBpKysp
CisJCWlmIChtZ2JkZXYtPnZpbltpXSAmJiAhbGlzdF9lbXB0eSgmKG1nYmRldi0+dmluW2ld
LT52ZGV2LmZoX2xpc3QpKSkKKwkJCWdvdG8gZXJyb3I7CisJZm9yIChpID0gMDsgaSA8IE1H
QjRfVk9VVF9ERVZJQ0VTOyBpKyspCisJCWlmIChtZ2JkZXYtPnZvdXRbaV0gJiYgIWxpc3Rf
ZW1wdHkoJihtZ2JkZXYtPnZvdXRbaV0tPnZkZXYuZmhfbGlzdCkpKQorCQkJZ290byBlcnJv
cjsKKworCWNvbmZpZyA9IG1nYjRfcmVhZF9yZWcoJm1nYmRldi0+dmlkZW8sIHZvdXRkZXYt
PmNvbmZpZy0+cmVncy5jb25maWcpOworCisJaWYgKCgoY29uZmlnICYgMHhjKSA+PiAyKSA8
IE1HQjRfVklOX0RFVklDRVMpCisJCWxvb3Bpbl9vbGQgPSBtZ2JkZXYtPnZpblsoY29uZmln
ICYgMHhjKSA+PiAyXTsKKwlpZiAodmFsIDwgTUdCNF9WSU5fREVWSUNFUykKKwkJbG9vcGlu
X25ldyA9IG1nYmRldi0+dmluW3ZhbF07CisJaWYgKGxvb3Bpbl9vbGQgJiYgbG9vcGluX2Nu
dChsb29waW5fb2xkKSA9PSAxKQorCQltZ2I0X21hc2tfcmVnKCZtZ2JkZXYtPnZpZGVvLCBs
b29waW5fb2xkLT5jb25maWctPnJlZ3MuY29uZmlnLCAweDIsIDB4MCk7CisJaWYgKGxvb3Bp
bl9uZXcpCisJCW1nYjRfbWFza19yZWcoJm1nYmRldi0+dmlkZW8sIGxvb3Bpbl9uZXctPmNv
bmZpZy0+cmVncy5jb25maWcsIDB4MiwgMHgyKTsKKworCWlmICh2YWwgPT0gdm91dGRldi0+
Y29uZmlnLT5pZCArIE1HQjRfVklOX0RFVklDRVMpCisJCW1nYjRfd3JpdGVfcmVnKCZtZ2Jk
ZXYtPnZpZGVvLCB2b3V0ZGV2LT5jb25maWctPnJlZ3MuY29uZmlnLAorCQkgIGNvbmZpZyAm
IH4oMTw8MSkpOworCWVsc2UKKwkJbWdiNF93cml0ZV9yZWcoJm1nYmRldi0+dmlkZW8sIHZv
dXRkZXYtPmNvbmZpZy0+cmVncy5jb25maWcsCisJCSAgY29uZmlnIHwgKDFVPDwxKSk7CisK
KwltZ2I0X21hc2tfcmVnKCZtZ2JkZXYtPnZpZGVvLCB2b3V0ZGV2LT5jb25maWctPnJlZ3Mu
Y29uZmlnLCAweGMsIHZhbCA8PCAyKTsKKworCXJldCA9IGNvdW50OworCitlcnJvcjoKKwlm
b3IgKGkgPSBNR0I0X1ZPVVRfREVWSUNFUyAtIDE7IGkgPj0gMDsgaS0tKQorCQlpZiAobWdi
ZGV2LT52b3V0W2ldKQorCQkJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmKG1nYmRldi0+dm91
dFtpXS0+dmRldi5maF9sb2NrKSwgZmxhZ3Nfb3V0W2ldKTsKKwlmb3IgKGkgPSBNR0I0X1ZJ
Tl9ERVZJQ0VTIC0gMTsgaSA+PSAwOyBpLS0pCisJCWlmIChtZ2JkZXYtPnZpbltpXSkKKwkJ
CXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJihtZ2JkZXYtPnZpbltpXS0+dmRldi5maF9sb2Nr
KSwgZmxhZ3NfaW5baV0pOworCisJcmV0dXJuIHJldDsKK30KKworc3RhdGljIHNzaXplX3Qg
cmVhZF9kaXNwbGF5X3dpZHRoKHN0cnVjdCBkZXZpY2UgKmRldiwKKwkJCQkgIHN0cnVjdCBk
ZXZpY2VfYXR0cmlidXRlICphdHRyLCBjaGFyICpidWYpCit7CisJc3RydWN0IHZpZGVvX2Rl
dmljZSAqdmRldiA9IHRvX3ZpZGVvX2RldmljZShkZXYpOworCXN0cnVjdCBtZ2I0X3ZvdXRf
ZGV2ICp2b3V0ZGV2ID0gdmlkZW9fZ2V0X2RydmRhdGEodmRldik7CisJdTMyIGNvbmZpZyA9
IG1nYjRfcmVhZF9yZWcoJnZvdXRkZXYtPm1nYmRldi0+dmlkZW8sCisJICB2b3V0ZGV2LT5j
b25maWctPnJlZ3MucmVzb2x1dGlvbik7CisKKwlyZXR1cm4gc3ByaW50ZihidWYsICIldVxu
IiwgY29uZmlnID4+IDE2KTsKK30KKworc3RhdGljIHNzaXplX3Qgd3JpdGVfZGlzcGxheV93
aWR0aChzdHJ1Y3QgZGV2aWNlICpkZXYsCisJCQkJICAgc3RydWN0IGRldmljZV9hdHRyaWJ1
dGUgKmF0dHIsCisJCQkJICAgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgY291bnQpCit7CisJ
c3RydWN0IHZpZGVvX2RldmljZSAqdmRldiA9IHRvX3ZpZGVvX2RldmljZShkZXYpOworCXN0
cnVjdCBtZ2I0X3ZvdXRfZGV2ICp2b3V0ZGV2ID0gdmlkZW9fZ2V0X2RydmRhdGEodmRldik7
CisJdW5zaWduZWQgbG9uZyB2YWwsIGZsYWdzOworCWludCByZXQsIGJ1c3k7CisKKwlyZXQg
PSBrc3RydG91bChidWYsIDEwLCAmdmFsKTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0Owor
CWlmICh2YWwgPiAweEZGRkYpCisJCXJldHVybiAtRUlOVkFMOworCisJc3Bpbl9sb2NrX2ly
cXNhdmUoJih2b3V0ZGV2LT52ZGV2LmZoX2xvY2spLCBmbGFncyk7CisJYnVzeSA9ICFsaXN0
X2VtcHR5KCYodm91dGRldi0+dmRldi5maF9saXN0KSk7CisJaWYgKGJ1c3kpIHsKKwkJc3Bp
bl91bmxvY2tfaXJxcmVzdG9yZSgmKHZvdXRkZXYtPnZkZXYuZmhfbG9jayksIGZsYWdzKTsK
KwkJcmV0dXJuIC1FQlVTWTsKKwl9CisKKwltZ2I0X21hc2tfcmVnKCZ2b3V0ZGV2LT5tZ2Jk
ZXYtPnZpZGVvLCB2b3V0ZGV2LT5jb25maWctPnJlZ3MucmVzb2x1dGlvbiwKKwkgIDB4RkZG
RjAwMDAsIHZhbCA8PCAxNik7CisKKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCYodm91dGRl
di0+dmRldi5maF9sb2NrKSwgZmxhZ3MpOworCisJcmV0dXJuIGNvdW50OworfQorCitzdGF0
aWMgc3NpemVfdCByZWFkX2Rpc3BsYXlfaGVpZ2h0KHN0cnVjdCBkZXZpY2UgKmRldiwKKwkJ
CQkgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQoreworCXN0
cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYgPSB0b192aWRlb19kZXZpY2UoZGV2KTsKKwlzdHJ1
Y3QgbWdiNF92b3V0X2RldiAqdm91dGRldiA9IHZpZGVvX2dldF9kcnZkYXRhKHZkZXYpOwor
CXUzMiBjb25maWcgPSBtZ2I0X3JlYWRfcmVnKCZ2b3V0ZGV2LT5tZ2JkZXYtPnZpZGVvLAor
CSAgdm91dGRldi0+Y29uZmlnLT5yZWdzLnJlc29sdXRpb24pOworCisJcmV0dXJuIHNwcmlu
dGYoYnVmLCAiJXVcbiIsIGNvbmZpZyAmIDB4RkZGRik7Cit9CisKK3N0YXRpYyBzc2l6ZV90
IHdyaXRlX2Rpc3BsYXlfaGVpZ2h0KHN0cnVjdCBkZXZpY2UgKmRldiwKKwkJCQkgICAgc3Ry
dWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsCisJCQkJICAgIGNvbnN0IGNoYXIgKmJ1Ziwg
c2l6ZV90IGNvdW50KQoreworCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYgPSB0b192aWRl
b19kZXZpY2UoZGV2KTsKKwlzdHJ1Y3QgbWdiNF92b3V0X2RldiAqdm91dGRldiA9IHZpZGVv
X2dldF9kcnZkYXRhKHZkZXYpOworCXVuc2lnbmVkIGxvbmcgdmFsLCBmbGFnczsKKwlpbnQg
cmV0LCBidXN5OworCisJcmV0ID0ga3N0cnRvdWwoYnVmLCAxMCwgJnZhbCk7CisJaWYgKHJl
dCkKKwkJcmV0dXJuIHJldDsKKwlpZiAodmFsID4gMHhGRkZGKQorCQlyZXR1cm4gLUVJTlZB
TDsKKworCXNwaW5fbG9ja19pcnFzYXZlKCYodm91dGRldi0+dmRldi5maF9sb2NrKSwgZmxh
Z3MpOworCWJ1c3kgPSAhbGlzdF9lbXB0eSgmKHZvdXRkZXYtPnZkZXYuZmhfbGlzdCkpOwor
CWlmIChidXN5KSB7CisJCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJih2b3V0ZGV2LT52ZGV2
LmZoX2xvY2spLCBmbGFncyk7CisJCXJldHVybiAtRUJVU1k7CisJfQorCisJbWdiNF9tYXNr
X3JlZygmdm91dGRldi0+bWdiZGV2LT52aWRlbywgdm91dGRldi0+Y29uZmlnLT5yZWdzLnJl
c29sdXRpb24sCisJICAweEZGRkYsIHZhbCk7CisKKwlzcGluX3VubG9ja19pcnFyZXN0b3Jl
KCYodm91dGRldi0+dmRldi5maF9sb2NrKSwgZmxhZ3MpOworCisJcmV0dXJuIGNvdW50Owor
fQorCitzdGF0aWMgc3NpemVfdCByZWFkX2ZyYW1lX3JhdGUoc3RydWN0IGRldmljZSAqZGV2
LAorCQkJICAgICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBjaGFyICpidWYp
Cit7CisJc3RydWN0IHZpZGVvX2RldmljZSAqdmRldiA9IHRvX3ZpZGVvX2RldmljZShkZXYp
OworCXN0cnVjdCBtZ2I0X3ZvdXRfZGV2ICp2b3V0ZGV2ID0gdmlkZW9fZ2V0X2RydmRhdGEo
dmRldik7CisJdTMyIHBlcmlvZCA9IG1nYjRfcmVhZF9yZWcoJnZvdXRkZXYtPm1nYmRldi0+
dmlkZW8sCisJICB2b3V0ZGV2LT5jb25maWctPnJlZ3MuZnJhbWVfcGVyaW9kKTsKKworCXJl
dHVybiBzcHJpbnRmKGJ1ZiwgIiV1XG4iLCAxMjUwMDAwMDAgLyBwZXJpb2QpOworfQorCitz
dGF0aWMgc3NpemVfdCB3cml0ZV9mcmFtZV9yYXRlKHN0cnVjdCBkZXZpY2UgKmRldiwKKwkJ
CQlzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY29uc3QgY2hhciAqYnVmLAorCQkJ
CXNpemVfdCBjb3VudCkKK3sKKwlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0gdG9fdmlk
ZW9fZGV2aWNlKGRldik7CisJc3RydWN0IG1nYjRfdm91dF9kZXYgKnZvdXRkZXYgPSB2aWRl
b19nZXRfZHJ2ZGF0YSh2ZGV2KTsKKwl1bnNpZ25lZCBsb25nIHZhbDsKKwlpbnQgcmV0Owor
CisJcmV0ID0ga3N0cnRvdWwoYnVmLCAxMCwgJnZhbCk7CisJaWYgKHJldCkKKwkJcmV0dXJu
IHJldDsKKworCW1nYjRfd3JpdGVfcmVnKCZ2b3V0ZGV2LT5tZ2JkZXYtPnZpZGVvLCB2b3V0
ZGV2LT5jb25maWctPnJlZ3MuZnJhbWVfcGVyaW9kLAorCSAgMTI1MDAwMDAwIC8gdmFsKTsK
KworCXJldHVybiBjb3VudDsKK30KKworc3RhdGljIHNzaXplX3QgcmVhZF9oc3luY193aWR0
aChzdHJ1Y3QgZGV2aWNlICpkZXYsCisJCQkJc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0
dHIsIGNoYXIgKmJ1ZikKK3sKKwlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0gdG9fdmlk
ZW9fZGV2aWNlKGRldik7CisJc3RydWN0IG1nYjRfdm91dF9kZXYgKnZvdXRkZXYgPSB2aWRl
b19nZXRfZHJ2ZGF0YSh2ZGV2KTsKKwl1MzIgc2lnID0gbWdiNF9yZWFkX3JlZygmdm91dGRl
di0+bWdiZGV2LT52aWRlbywgdm91dGRldi0+Y29uZmlnLT5yZWdzLmhzeW5jKTsKKworCXJl
dHVybiBzcHJpbnRmKGJ1ZiwgIiV1XG4iLCAoc2lnICYgMHgwMEZGMDAwMCkgPj4gMTYpOwor
fQorCitzdGF0aWMgc3NpemVfdCB3cml0ZV9oc3luY193aWR0aChzdHJ1Y3QgZGV2aWNlICpk
ZXYsCisJCQkJIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBjb25zdCBjaGFyICpi
dWYsCisJCQkJIHNpemVfdCBjb3VudCkKK3sKKwlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2
ID0gdG9fdmlkZW9fZGV2aWNlKGRldik7CisJc3RydWN0IG1nYjRfdm91dF9kZXYgKnZvdXRk
ZXYgPSB2aWRlb19nZXRfZHJ2ZGF0YSh2ZGV2KTsKKwl1bnNpZ25lZCBsb25nIHZhbDsKKwlp
bnQgcmV0OworCisJcmV0ID0ga3N0cnRvdWwoYnVmLCAxMCwgJnZhbCk7CisJaWYgKHJldCkK
KwkJcmV0dXJuIHJldDsKKwlpZiAodmFsID4gMHhGRikKKwkJcmV0dXJuIC1FSU5WQUw7CisK
KwltZ2I0X21hc2tfcmVnKCZ2b3V0ZGV2LT5tZ2JkZXYtPnZpZGVvLCB2b3V0ZGV2LT5jb25m
aWctPnJlZ3MuaHN5bmMsCisJICAweDAwRkYwMDAwLCB2YWwgPDwgMTYpOworCisJcmV0dXJu
IGNvdW50OworfQorCitzdGF0aWMgc3NpemVfdCByZWFkX3ZzeW5jX3dpZHRoKHN0cnVjdCBk
ZXZpY2UgKmRldiwKKwkJCQlzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAq
YnVmKQoreworCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYgPSB0b192aWRlb19kZXZpY2Uo
ZGV2KTsKKwlzdHJ1Y3QgbWdiNF92b3V0X2RldiAqdm91dGRldiA9IHZpZGVvX2dldF9kcnZk
YXRhKHZkZXYpOworCXUzMiBzaWcgPSBtZ2I0X3JlYWRfcmVnKCZ2b3V0ZGV2LT5tZ2JkZXYt
PnZpZGVvLCB2b3V0ZGV2LT5jb25maWctPnJlZ3MudnN5bmMpOworCisJcmV0dXJuIHNwcmlu
dGYoYnVmLCAiJXVcbiIsIChzaWcgJiAweDAwRkYwMDAwKSA+PiAxNik7Cit9CisKK3N0YXRp
YyBzc2l6ZV90IHdyaXRlX3ZzeW5jX3dpZHRoKHN0cnVjdCBkZXZpY2UgKmRldiwKKwkJCQkg
c3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNvbnN0IGNoYXIgKmJ1ZiwKKwkJCQkg
c2l6ZV90IGNvdW50KQoreworCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYgPSB0b192aWRl
b19kZXZpY2UoZGV2KTsKKwlzdHJ1Y3QgbWdiNF92b3V0X2RldiAqdm91dGRldiA9IHZpZGVv
X2dldF9kcnZkYXRhKHZkZXYpOworCXVuc2lnbmVkIGxvbmcgdmFsOworCWludCByZXQ7CisK
KwlyZXQgPSBrc3RydG91bChidWYsIDEwLCAmdmFsKTsKKwlpZiAocmV0KQorCQlyZXR1cm4g
cmV0OworCWlmICh2YWwgPiAweEZGKQorCQlyZXR1cm4gLUVJTlZBTDsKKworCW1nYjRfbWFz
a19yZWcoJnZvdXRkZXYtPm1nYmRldi0+dmlkZW8sIHZvdXRkZXYtPmNvbmZpZy0+cmVncy52
c3luYywKKwkgIDB4MDBGRjAwMDAsIHZhbCA8PCAxNik7CisKKwlyZXR1cm4gY291bnQ7Cit9
CisKK3N0YXRpYyBzc2l6ZV90IHJlYWRfaGJhY2tfcG9yY2goc3RydWN0IGRldmljZSAqZGV2
LAorCQkJCXN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBjaGFyICpidWYpCit7CisJ
c3RydWN0IHZpZGVvX2RldmljZSAqdmRldiA9IHRvX3ZpZGVvX2RldmljZShkZXYpOworCXN0
cnVjdCBtZ2I0X3ZvdXRfZGV2ICp2b3V0ZGV2ID0gdmlkZW9fZ2V0X2RydmRhdGEodmRldik7
CisJdTMyIHNpZyA9IG1nYjRfcmVhZF9yZWcoJnZvdXRkZXYtPm1nYmRldi0+dmlkZW8sIHZv
dXRkZXYtPmNvbmZpZy0+cmVncy5oc3luYyk7CisKKwlyZXR1cm4gc3ByaW50ZihidWYsICIl
dVxuIiwgKHNpZyAmIDB4MDAwMEZGMDApID4+IDgpOworfQorCitzdGF0aWMgc3NpemVfdCB3
cml0ZV9oYmFja19wb3JjaChzdHJ1Y3QgZGV2aWNlICpkZXYsCisJCQkJIHN0cnVjdCBkZXZp
Y2VfYXR0cmlidXRlICphdHRyLCBjb25zdCBjaGFyICpidWYsCisJCQkJIHNpemVfdCBjb3Vu
dCkKK3sKKwlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0gdG9fdmlkZW9fZGV2aWNlKGRl
dik7CisJc3RydWN0IG1nYjRfdm91dF9kZXYgKnZvdXRkZXYgPSB2aWRlb19nZXRfZHJ2ZGF0
YSh2ZGV2KTsKKwl1bnNpZ25lZCBsb25nIHZhbDsKKwlpbnQgcmV0OworCisJcmV0ID0ga3N0
cnRvdWwoYnVmLCAxMCwgJnZhbCk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKwlpZiAo
dmFsID4gMHhGRikKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwltZ2I0X21hc2tfcmVnKCZ2b3V0
ZGV2LT5tZ2JkZXYtPnZpZGVvLCB2b3V0ZGV2LT5jb25maWctPnJlZ3MuaHN5bmMsCisJICAw
eDAwMDBGRjAwLCB2YWwgPDwgOCk7CisKKwlyZXR1cm4gY291bnQ7Cit9CisKK3N0YXRpYyBz
c2l6ZV90IHJlYWRfdmJhY2tfcG9yY2goc3RydWN0IGRldmljZSAqZGV2LAorCQkJCXN0cnVj
dCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBjaGFyICpidWYpCit7CisJc3RydWN0IHZpZGVv
X2RldmljZSAqdmRldiA9IHRvX3ZpZGVvX2RldmljZShkZXYpOworCXN0cnVjdCBtZ2I0X3Zv
dXRfZGV2ICp2b3V0ZGV2ID0gdmlkZW9fZ2V0X2RydmRhdGEodmRldik7CisJdTMyIHNpZyA9
IG1nYjRfcmVhZF9yZWcoJnZvdXRkZXYtPm1nYmRldi0+dmlkZW8sIHZvdXRkZXYtPmNvbmZp
Zy0+cmVncy52c3luYyk7CisKKwlyZXR1cm4gc3ByaW50ZihidWYsICIldVxuIiwgKHNpZyAm
IDB4MDAwMEZGMDApID4+IDgpOworfQorCitzdGF0aWMgc3NpemVfdCB3cml0ZV92YmFja19w
b3JjaChzdHJ1Y3QgZGV2aWNlICpkZXYsCisJCQkJIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRl
ICphdHRyLCBjb25zdCBjaGFyICpidWYsCisJCQkJIHNpemVfdCBjb3VudCkKK3sKKwlzdHJ1
Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0gdG9fdmlkZW9fZGV2aWNlKGRldik7CisJc3RydWN0
IG1nYjRfdm91dF9kZXYgKnZvdXRkZXYgPSB2aWRlb19nZXRfZHJ2ZGF0YSh2ZGV2KTsKKwl1
bnNpZ25lZCBsb25nIHZhbDsKKwlpbnQgcmV0OworCisJcmV0ID0ga3N0cnRvdWwoYnVmLCAx
MCwgJnZhbCk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKwlpZiAodmFsID4gMHhGRikK
KwkJcmV0dXJuIC1FSU5WQUw7CisKKwltZ2I0X21hc2tfcmVnKCZ2b3V0ZGV2LT5tZ2JkZXYt
PnZpZGVvLCB2b3V0ZGV2LT5jb25maWctPnJlZ3MudnN5bmMsCisJICAweDAwMDBGRjAwLCB2
YWwgPDwgOCk7CisKKwlyZXR1cm4gY291bnQ7Cit9CisKK3N0YXRpYyBzc2l6ZV90IHJlYWRf
aGZyb250X3BvcmNoKHN0cnVjdCBkZXZpY2UgKmRldiwKKwkJCQkgc3RydWN0IGRldmljZV9h
dHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikKK3sKKwlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2
ZGV2ID0gdG9fdmlkZW9fZGV2aWNlKGRldik7CisJc3RydWN0IG1nYjRfdm91dF9kZXYgKnZv
dXRkZXYgPSB2aWRlb19nZXRfZHJ2ZGF0YSh2ZGV2KTsKKwl1MzIgc2lnID0gbWdiNF9yZWFk
X3JlZygmdm91dGRldi0+bWdiZGV2LT52aWRlbywgdm91dGRldi0+Y29uZmlnLT5yZWdzLmhz
eW5jKTsKKworCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiV1XG4iLCAoc2lnICYgMHgwMDAwMDBG
RikpOworfQorCitzdGF0aWMgc3NpemVfdCB3cml0ZV9oZnJvbnRfcG9yY2goc3RydWN0IGRl
dmljZSAqZGV2LAorCQkJCSAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsCisJCQkJ
ICBjb25zdCBjaGFyICpidWYsIHNpemVfdCBjb3VudCkKK3sKKwlzdHJ1Y3QgdmlkZW9fZGV2
aWNlICp2ZGV2ID0gdG9fdmlkZW9fZGV2aWNlKGRldik7CisJc3RydWN0IG1nYjRfdm91dF9k
ZXYgKnZvdXRkZXYgPSB2aWRlb19nZXRfZHJ2ZGF0YSh2ZGV2KTsKKwl1bnNpZ25lZCBsb25n
IHZhbDsKKwlpbnQgcmV0OworCisJcmV0ID0ga3N0cnRvdWwoYnVmLCAxMCwgJnZhbCk7CisJ
aWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKwlpZiAodmFsID4gMHhGRikKKwkJcmV0dXJuIC1F
SU5WQUw7CisKKwltZ2I0X21hc2tfcmVnKCZ2b3V0ZGV2LT5tZ2JkZXYtPnZpZGVvLCB2b3V0
ZGV2LT5jb25maWctPnJlZ3MuaHN5bmMsCisJICAweDAwMDAwMEZGLCB2YWwpOworCisJcmV0
dXJuIGNvdW50OworfQorCitzdGF0aWMgc3NpemVfdCByZWFkX3Zmcm9udF9wb3JjaChzdHJ1
Y3QgZGV2aWNlICpkZXYsCisJCQkJIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBj
aGFyICpidWYpCit7CisJc3RydWN0IHZpZGVvX2RldmljZSAqdmRldiA9IHRvX3ZpZGVvX2Rl
dmljZShkZXYpOworCXN0cnVjdCBtZ2I0X3ZvdXRfZGV2ICp2b3V0ZGV2ID0gdmlkZW9fZ2V0
X2RydmRhdGEodmRldik7CisJdTMyIHNpZyA9IG1nYjRfcmVhZF9yZWcoJnZvdXRkZXYtPm1n
YmRldi0+dmlkZW8sIHZvdXRkZXYtPmNvbmZpZy0+cmVncy52c3luYyk7CisKKwlyZXR1cm4g
c3ByaW50ZihidWYsICIldVxuIiwgKHNpZyAmIDB4MDAwMDAwRkYpKTsKK30KKworc3RhdGlj
IHNzaXplX3Qgd3JpdGVfdmZyb250X3BvcmNoKHN0cnVjdCBkZXZpY2UgKmRldiwKKwkJCQkg
IHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBjb25zdCBjaGFyICpidWYsCisJCQkJ
ICBzaXplX3QgY291bnQpCit7CisJc3RydWN0IHZpZGVvX2RldmljZSAqdmRldiA9IHRvX3Zp
ZGVvX2RldmljZShkZXYpOworCXN0cnVjdCBtZ2I0X3ZvdXRfZGV2ICp2b3V0ZGV2ID0gdmlk
ZW9fZ2V0X2RydmRhdGEodmRldik7CisJdW5zaWduZWQgbG9uZyB2YWw7CisJaW50IHJldDsK
KworCXJldCA9IGtzdHJ0b3VsKGJ1ZiwgMTAsICZ2YWwpOworCWlmIChyZXQpCisJCXJldHVy
biByZXQ7CisJaWYgKHZhbCA+IDB4RkYpCisJCXJldHVybiAtRUlOVkFMOworCisJbWdiNF9t
YXNrX3JlZygmdm91dGRldi0+bWdiZGV2LT52aWRlbywgdm91dGRldi0+Y29uZmlnLT5yZWdz
LnZzeW5jLAorCSAgMHgwMDAwMDBGRiwgdmFsKTsKKworCXJldHVybiBjb3VudDsKK30KKwor
c3RhdGljIHNzaXplX3QgcmVhZF9hbGlnbm1lbnQoc3RydWN0IGRldmljZSAqZGV2LAorCQkJ
ICAgICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikKK3sKKwlz
dHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0gdG9fdmlkZW9fZGV2aWNlKGRldik7CisJc3Ry
dWN0IG1nYjRfdm91dF9kZXYgKnZvdXRkZXYgPSB2aWRlb19nZXRfZHJ2ZGF0YSh2ZGV2KTsK
KworCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiVkXG4iLCB2b3V0ZGV2LT5hbGlnbm1lbnQpOwor
fQorCitzdGF0aWMgc3NpemVfdCB3cml0ZV9hbGlnbm1lbnQoc3RydWN0IGRldmljZSAqZGV2
LAorCQkJICAgICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBjb25zdCBjaGFy
ICpidWYsCisJCQkgICAgICAgc2l6ZV90IGNvdW50KQoreworCXN0cnVjdCB2aWRlb19kZXZp
Y2UgKnZkZXYgPSB0b192aWRlb19kZXZpY2UoZGV2KTsKKwlzdHJ1Y3QgbWdiNF92b3V0X2Rl
diAqdm91dGRldiA9IHZpZGVvX2dldF9kcnZkYXRhKHZkZXYpOworCXVuc2lnbmVkIGxvbmcg
dmFsLCBmbGFnczsKKwl1MzIgY29uZmlnOworCWludCByZXQ7CisKKwlyZXQgPSBrc3RydG91
bChidWYsIDEwLCAmdmFsKTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0OworCWlmICghdmFs
IHx8ICh2YWwgJiAodmFsIC0gMSkpKQorCQlyZXR1cm4gLUVJTlZBTDsKKworCXNwaW5fbG9j
a19pcnFzYXZlKCYodm91dGRldi0+dmRldi5maF9sb2NrKSwgZmxhZ3MpOworCWlmICghbGlz
dF9lbXB0eSgmKHZvdXRkZXYtPnZkZXYuZmhfbGlzdCkpKSB7CisJCXNwaW5fdW5sb2NrX2ly
cXJlc3RvcmUoJih2b3V0ZGV2LT52ZGV2LmZoX2xvY2spLCBmbGFncyk7CisJCXJldHVybiAt
RUJVU1k7CisJfQorCS8qIERvIG5vdCBhbGxvdyB0aGUgY2hhbmdlIGlmIGxvb3BiYWNrIGlz
IGFjdGl2ZSAqLworCWNvbmZpZyA9IG1nYjRfcmVhZF9yZWcoJnZvdXRkZXYtPm1nYmRldi0+
dmlkZW8sIHZvdXRkZXYtPmNvbmZpZy0+cmVncy5jb25maWcpOworCWlmICgoKGNvbmZpZyAm
IDB4YykgPj4gMikgPCAyKSB7CisJCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJih2b3V0ZGV2
LT52ZGV2LmZoX2xvY2spLCBmbGFncyk7CisJCXJldHVybiAtRVBFUk07CisJfQorCisJdm91
dGRldi0+YWxpZ25tZW50ID0gdmFsOworCisJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmKHZv
dXRkZXYtPnZkZXYuZmhfbG9jayksIGZsYWdzKTsKKworCXJldHVybiBjb3VudDsKK30KKwor
LyogRlBETDMgb25seSAqLworCitzdGF0aWMgc3NpemVfdCByZWFkX2hzeW5jX3BvbGFyaXR5
KHN0cnVjdCBkZXZpY2UgKmRldiwKKwkJCQkgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAq
YXR0ciwgY2hhciAqYnVmKQoreworCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYgPSB0b192
aWRlb19kZXZpY2UoZGV2KTsKKwlzdHJ1Y3QgbWdiNF92b3V0X2RldiAqdm91dGRldiA9IHZp
ZGVvX2dldF9kcnZkYXRhKHZkZXYpOworCXUzMiBjb25maWcgPSBtZ2I0X3JlYWRfcmVnKCZ2
b3V0ZGV2LT5tZ2JkZXYtPnZpZGVvLAorCSAgdm91dGRldi0+Y29uZmlnLT5yZWdzLmhzeW5j
KTsKKworCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiV1XG4iLCAoY29uZmlnICYgKDE8PDMxKSkg
Pj4gMzEpOworfQorCitzdGF0aWMgc3NpemVfdCB3cml0ZV9oc3luY19wb2xhcml0eShzdHJ1
Y3QgZGV2aWNlICpkZXYsCisJCQkJICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRy
LAorCQkJCSAgICBjb25zdCBjaGFyICpidWYsIHNpemVfdCBjb3VudCkKK3sKKwlzdHJ1Y3Qg
dmlkZW9fZGV2aWNlICp2ZGV2ID0gdG9fdmlkZW9fZGV2aWNlKGRldik7CisJc3RydWN0IG1n
YjRfdm91dF9kZXYgKnZvdXRkZXYgPSB2aWRlb19nZXRfZHJ2ZGF0YSh2ZGV2KTsKKwl1bnNp
Z25lZCBsb25nIHZhbDsKKwlpbnQgcmV0OworCisJcmV0ID0ga3N0cnRvdWwoYnVmLCAxMCwg
JnZhbCk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKwlpZiAodmFsID4gMSkKKwkJcmV0
dXJuIC1FSU5WQUw7CisKKwltZ2I0X21hc2tfcmVnKCZ2b3V0ZGV2LT5tZ2JkZXYtPnZpZGVv
LCB2b3V0ZGV2LT5jb25maWctPnJlZ3MuaHN5bmMsICgxPDwzMSksCisJICB2YWwgPDwgMzEp
OworCisJcmV0dXJuIGNvdW50OworfQorCitzdGF0aWMgc3NpemVfdCByZWFkX3ZzeW5jX3Bv
bGFyaXR5KHN0cnVjdCBkZXZpY2UgKmRldiwKKwkJCQkgICBzdHJ1Y3QgZGV2aWNlX2F0dHJp
YnV0ZSAqYXR0ciwgY2hhciAqYnVmKQoreworCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYg
PSB0b192aWRlb19kZXZpY2UoZGV2KTsKKwlzdHJ1Y3QgbWdiNF92b3V0X2RldiAqdm91dGRl
diA9IHZpZGVvX2dldF9kcnZkYXRhKHZkZXYpOworCXUzMiBjb25maWcgPSBtZ2I0X3JlYWRf
cmVnKCZ2b3V0ZGV2LT5tZ2JkZXYtPnZpZGVvLAorCSAgdm91dGRldi0+Y29uZmlnLT5yZWdz
LnZzeW5jKTsKKworCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiV1XG4iLCAoY29uZmlnICYgKDE8
PDMxKSkgPj4gMzEpOworfQorCitzdGF0aWMgc3NpemVfdCB3cml0ZV92c3luY19wb2xhcml0
eShzdHJ1Y3QgZGV2aWNlICpkZXYsCisJCQkJICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRl
ICphdHRyLAorCQkJCSAgICBjb25zdCBjaGFyICpidWYsIHNpemVfdCBjb3VudCkKK3sKKwlz
dHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0gdG9fdmlkZW9fZGV2aWNlKGRldik7CisJc3Ry
dWN0IG1nYjRfdm91dF9kZXYgKnZvdXRkZXYgPSB2aWRlb19nZXRfZHJ2ZGF0YSh2ZGV2KTsK
Kwl1bnNpZ25lZCBsb25nIHZhbDsKKwlpbnQgcmV0OworCisJcmV0ID0ga3N0cnRvdWwoYnVm
LCAxMCwgJnZhbCk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKwlpZiAodmFsID4gMSkK
KwkJcmV0dXJuIC1FSU5WQUw7CisKKwltZ2I0X21hc2tfcmVnKCZ2b3V0ZGV2LT5tZ2JkZXYt
PnZpZGVvLCB2b3V0ZGV2LT5jb25maWctPnJlZ3MudnN5bmMsICgxPDwzMSksCisJICB2YWwg
PDwgMzEpOworCisJcmV0dXJuIGNvdW50OworfQorCitzdGF0aWMgc3NpemVfdCByZWFkX2Rl
X3BvbGFyaXR5KHN0cnVjdCBkZXZpY2UgKmRldiwKKwkJCQlzdHJ1Y3QgZGV2aWNlX2F0dHJp
YnV0ZSAqYXR0ciwgY2hhciAqYnVmKQoreworCXN0cnVjdCB2aWRlb19kZXZpY2UgKnZkZXYg
PSB0b192aWRlb19kZXZpY2UoZGV2KTsKKwlzdHJ1Y3QgbWdiNF92b3V0X2RldiAqdm91dGRl
diA9IHZpZGVvX2dldF9kcnZkYXRhKHZkZXYpOworCXUzMiBjb25maWcgPSBtZ2I0X3JlYWRf
cmVnKCZ2b3V0ZGV2LT5tZ2JkZXYtPnZpZGVvLAorCSAgdm91dGRldi0+Y29uZmlnLT5yZWdz
LnZzeW5jKTsKKworCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiV1XG4iLCAoY29uZmlnICYgKDE8
PDMwKSkgPj4gMzApOworfQorCitzdGF0aWMgc3NpemVfdCB3cml0ZV9kZV9wb2xhcml0eShz
dHJ1Y3QgZGV2aWNlICpkZXYsCisJCQkJIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRy
LCBjb25zdCBjaGFyICpidWYsCisJCQkJIHNpemVfdCBjb3VudCkKK3sKKwlzdHJ1Y3Qgdmlk
ZW9fZGV2aWNlICp2ZGV2ID0gdG9fdmlkZW9fZGV2aWNlKGRldik7CisJc3RydWN0IG1nYjRf
dm91dF9kZXYgKnZvdXRkZXYgPSB2aWRlb19nZXRfZHJ2ZGF0YSh2ZGV2KTsKKwl1bnNpZ25l
ZCBsb25nIHZhbDsKKwlpbnQgcmV0OworCisJcmV0ID0ga3N0cnRvdWwoYnVmLCAxMCwgJnZh
bCk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKwlpZiAodmFsID4gMSkKKwkJcmV0dXJu
IC1FSU5WQUw7CisKKwltZ2I0X21hc2tfcmVnKCZ2b3V0ZGV2LT5tZ2JkZXYtPnZpZGVvLCB2
b3V0ZGV2LT5jb25maWctPnJlZ3MudnN5bmMsICgxPDwzMCksCisJICB2YWwgPDwgMzApOwor
CisJcmV0dXJuIGNvdW50OworfQorCitzdGF0aWMgc3NpemVfdCByZWFkX2ZwZGwzX291dHB1
dF93aWR0aChzdHJ1Y3QgZGV2aWNlICpkZXYsCisJCQkJICAgICAgIHN0cnVjdCBkZXZpY2Vf
YXR0cmlidXRlICphdHRyLCBjaGFyICpidWYpCit7CisJc3RydWN0IHZpZGVvX2RldmljZSAq
dmRldiA9IHRvX3ZpZGVvX2RldmljZShkZXYpOworCXN0cnVjdCBtZ2I0X3ZvdXRfZGV2ICp2
b3V0ZGV2ID0gdmlkZW9fZ2V0X2RydmRhdGEodmRldik7CisJczMyIHJldDsKKworCW11dGV4
X2xvY2soJnZvdXRkZXYtPm1nYmRldi0+aTJjX2xvY2spOworCXJldCA9IG1nYjRfaTJjX3Jl
YWRfYnl0ZSgmdm91dGRldi0+c2VyLCAweDVCKTsKKwltdXRleF91bmxvY2soJnZvdXRkZXYt
Pm1nYmRldi0+aTJjX2xvY2spOworCWlmIChyZXQgPCAwKQorCQlyZXR1cm4gLUVJTzsKKwor
CXN3aXRjaCAoKHU4KXJldCAmIDB4MDMpIHsKKwljYXNlIDA6CisJCXJldHVybiBzcHJpbnRm
KGJ1ZiwgIjBcbiIpOworCWNhc2UgMToKKwkJcmV0dXJuIHNwcmludGYoYnVmLCAiMVxuIik7
CisJY2FzZSAzOgorCQlyZXR1cm4gc3ByaW50ZihidWYsICIyXG4iKTsKKwlkZWZhdWx0Ogor
CQlyZXR1cm4gLUVJTlZBTDsKKwl9Cit9CisKK3N0YXRpYyBzc2l6ZV90IHdyaXRlX2ZwZGwz
X291dHB1dF93aWR0aChzdHJ1Y3QgZGV2aWNlICpkZXYsCisJCQkJCXN0cnVjdCBkZXZpY2Vf
YXR0cmlidXRlICphdHRyLAorCQkJCQljb25zdCBjaGFyICpidWYsIHNpemVfdCBjb3VudCkK
K3sKKwlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0gdG9fdmlkZW9fZGV2aWNlKGRldik7
CisJc3RydWN0IG1nYjRfdm91dF9kZXYgKnZvdXRkZXYgPSB2aWRlb19nZXRfZHJ2ZGF0YSh2
ZGV2KTsKKwl1OCBpMmNfZGF0YTsKKwl1bnNpZ25lZCBsb25nIHZhbDsKKwlpbnQgcmV0Owor
CisJcmV0ID0ga3N0cnRvdWwoYnVmLCAxMCwgJnZhbCk7CisJaWYgKHJldCkKKwkJcmV0dXJu
IHJldDsKKworCXN3aXRjaCAodmFsKSB7CisJY2FzZSAwOiAvKiBhdXRvICovCisJCWkyY19k
YXRhID0gMHgwMDsKKwkJYnJlYWs7CisJY2FzZSAxOiAvKiBzaW5nbGUgKi8KKwkJaTJjX2Rh
dGEgPSAweDAxOworCQlicmVhazsKKwljYXNlIDI6IC8qIGR1YWwgKi8KKwkJaTJjX2RhdGEg
PSAweDAzOworCQlicmVhazsKKwlkZWZhdWx0OgorCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisK
KwltdXRleF9sb2NrKCZ2b3V0ZGV2LT5tZ2JkZXYtPmkyY19sb2NrKTsKKwlyZXQgPSBtZ2I0
X2kyY19tYXNrX2J5dGUoJnZvdXRkZXYtPnNlciwgMHg1QiwgMHgwMywgaTJjX2RhdGEpOwor
CW11dGV4X3VubG9jaygmdm91dGRldi0+bWdiZGV2LT5pMmNfbG9jayk7CisJaWYgKHJldCA8
IDApCisJCXJldHVybiAtRUlPOworCisJcmV0dXJuIGNvdW50OworfQorCitzdGF0aWMgc3Np
emVfdCByZWFkX3BjbGtfZnJlcXVlbmN5KHN0cnVjdCBkZXZpY2UgKmRldiwKKwkJCQkgICBz
dHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQoreworCXN0cnVjdCB2
aWRlb19kZXZpY2UgKnZkZXYgPSB0b192aWRlb19kZXZpY2UoZGV2KTsKKwlzdHJ1Y3QgbWdi
NF92b3V0X2RldiAqdm91dGRldiA9IHZpZGVvX2dldF9kcnZkYXRhKHZkZXYpOworCisJcmV0
dXJuIHNwcmludGYoYnVmLCAiJXVcbiIsIHZvdXRkZXYtPmZyZXEpOworfQorCitzdGF0aWMg
c3NpemVfdCB3cml0ZV9wY2xrX2ZyZXF1ZW5jeShzdHJ1Y3QgZGV2aWNlICpkZXYsCisJCQkJ
ICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLAorCQkJCSAgICBjb25zdCBjaGFy
ICpidWYsIHNpemVfdCBjb3VudCkKK3sKKwlzdHJ1Y3QgdmlkZW9fZGV2aWNlICp2ZGV2ID0g
dG9fdmlkZW9fZGV2aWNlKGRldik7CisJc3RydWN0IG1nYjRfdm91dF9kZXYgKnZvdXRkZXYg
PSB2aWRlb19nZXRfZHJ2ZGF0YSh2ZGV2KTsKKwl1bnNpZ25lZCBsb25nIHZhbCwgZmxhZ3M7
CisJaW50IHJldCwgYnVzeTsKKwl1bnNpZ25lZCBpbnQgZHA7CisKKwlyZXQgPSBrc3RydG91
bChidWYsIDEwLCAmdmFsKTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0OworCisJc3Bpbl9s
b2NrX2lycXNhdmUoJih2b3V0ZGV2LT52ZGV2LmZoX2xvY2spLCBmbGFncyk7CisJYnVzeSA9
ICFsaXN0X2VtcHR5KCYodm91dGRldi0+dmRldi5maF9saXN0KSk7CisJaWYgKGJ1c3kpIHsK
KwkJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmKHZvdXRkZXYtPnZkZXYuZmhfbG9jayksIGZs
YWdzKTsKKwkJcmV0dXJuIC1FQlVTWTsKKwl9CisKKwlkcCA9ICh2YWwgPiA1MDAwMCkgPyAx
IDogMDsKKwl2b3V0ZGV2LT5mcmVxID0gbWdiNF9jbXRfc2V0X3ZvdXQodm91dGRldiwgdmFs
ID4+IGRwKSA8PCBkcDsKKworCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJih2b3V0ZGV2LT52
ZGV2LmZoX2xvY2spLCBmbGFncyk7CisKKwltZ2I0X21hc2tfcmVnKCZ2b3V0ZGV2LT5tZ2Jk
ZXYtPnZpZGVvLCB2b3V0ZGV2LT5jb25maWctPnJlZ3MuY29uZmlnLAorCSAgMHgxMCwgZHAg
PDwgNCk7CisJbXV0ZXhfbG9jaygmdm91dGRldi0+bWdiZGV2LT5pMmNfbG9jayk7CisJcmV0
ID0gbWdiNF9pMmNfbWFza19ieXRlKCZ2b3V0ZGV2LT5zZXIsIDB4NEYsIDE8PDYsICgofmRw
KSYxKTw8Nik7CisJbXV0ZXhfdW5sb2NrKCZ2b3V0ZGV2LT5tZ2JkZXYtPmkyY19sb2NrKTsK
KwlpZiAocmV0IDwgMCkKKwkJcmV0dXJuIC1FSU87CisKKwlyZXR1cm4gY291bnQ7Cit9CisK
Kworc3RhdGljIERFVklDRV9BVFRSKG91dHB1dF9pZCwgMDQ0NCwgcmVhZF9vdXRwdXRfaWQs
IE5VTEwpOworc3RhdGljIERFVklDRV9BVFRSKHZpZGVvX3NvdXJjZSwgMDY0NCwgcmVhZF92
aWRlb19zb3VyY2UsIHdyaXRlX3ZpZGVvX3NvdXJjZSk7CitzdGF0aWMgREVWSUNFX0FUVFIo
ZGlzcGxheV93aWR0aCwgMDY0NCwgcmVhZF9kaXNwbGF5X3dpZHRoLAorCQkgICB3cml0ZV9k
aXNwbGF5X3dpZHRoKTsKK3N0YXRpYyBERVZJQ0VfQVRUUihkaXNwbGF5X2hlaWdodCwgMDY0
NCwgcmVhZF9kaXNwbGF5X2hlaWdodCwKKwkJICAgd3JpdGVfZGlzcGxheV9oZWlnaHQpOwor
c3RhdGljIERFVklDRV9BVFRSKGZyYW1lX3JhdGUsIDA2NDQsIHJlYWRfZnJhbWVfcmF0ZSwg
d3JpdGVfZnJhbWVfcmF0ZSk7CitzdGF0aWMgREVWSUNFX0FUVFIoaHN5bmNfcG9sYXJpdHks
IDA2NDQsIHJlYWRfaHN5bmNfcG9sYXJpdHksCisJCSAgIHdyaXRlX2hzeW5jX3BvbGFyaXR5
KTsKK3N0YXRpYyBERVZJQ0VfQVRUUih2c3luY19wb2xhcml0eSwgMDY0NCwgcmVhZF92c3lu
Y19wb2xhcml0eSwKKwkJICAgd3JpdGVfdnN5bmNfcG9sYXJpdHkpOworc3RhdGljIERFVklD
RV9BVFRSKGRlX3BvbGFyaXR5LCAwNjQ0LCByZWFkX2RlX3BvbGFyaXR5LAorCQkgICB3cml0
ZV9kZV9wb2xhcml0eSk7CitzdGF0aWMgREVWSUNFX0FUVFIocGNsa19mcmVxdWVuY3ksIDA2
NDQsIHJlYWRfcGNsa19mcmVxdWVuY3ksCisJCSAgIHdyaXRlX3BjbGtfZnJlcXVlbmN5KTsK
K3N0YXRpYyBERVZJQ0VfQVRUUihoc3luY193aWR0aCwgMDY0NCwgcmVhZF9oc3luY193aWR0
aCwgd3JpdGVfaHN5bmNfd2lkdGgpOworc3RhdGljIERFVklDRV9BVFRSKHZzeW5jX3dpZHRo
LCAwNjQ0LCByZWFkX3ZzeW5jX3dpZHRoLCB3cml0ZV92c3luY193aWR0aCk7CitzdGF0aWMg
REVWSUNFX0FUVFIoaGJhY2tfcG9yY2gsIDA2NDQsIHJlYWRfaGJhY2tfcG9yY2gsIHdyaXRl
X2hiYWNrX3BvcmNoKTsKK3N0YXRpYyBERVZJQ0VfQVRUUihoZnJvbnRfcG9yY2gsIDA2NDQs
IHJlYWRfaGZyb250X3BvcmNoLCB3cml0ZV9oZnJvbnRfcG9yY2gpOworc3RhdGljIERFVklD
RV9BVFRSKHZiYWNrX3BvcmNoLCAwNjQ0LCByZWFkX3ZiYWNrX3BvcmNoLCB3cml0ZV92YmFj
a19wb3JjaCk7CitzdGF0aWMgREVWSUNFX0FUVFIodmZyb250X3BvcmNoLCAwNjQ0LCByZWFk
X3Zmcm9udF9wb3JjaCwgd3JpdGVfdmZyb250X3BvcmNoKTsKK3N0YXRpYyBERVZJQ0VfQVRU
UihhbGlnbm1lbnQsIDA2NDQsIHJlYWRfYWxpZ25tZW50LCB3cml0ZV9hbGlnbm1lbnQpOwor
CitzdGF0aWMgREVWSUNFX0FUVFIoZnBkbDNfb3V0cHV0X3dpZHRoLCAwNjQ0LCByZWFkX2Zw
ZGwzX291dHB1dF93aWR0aCwKKwkJICAgd3JpdGVfZnBkbDNfb3V0cHV0X3dpZHRoKTsKKwor
CitzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqbWdiNF9mcGRsM19vdXRfYXR0cnNbXSA9IHsK
KwkmZGV2X2F0dHJfb3V0cHV0X2lkLAorCSZkZXZfYXR0cl92aWRlb19zb3VyY2UsCisJJmRl
dl9hdHRyX2Rpc3BsYXlfd2lkdGgsCisJJmRldl9hdHRyX2Rpc3BsYXlfaGVpZ2h0LAorCSZk
ZXZfYXR0cl9mcmFtZV9yYXRlLAorCSZkZXZfYXR0cl9oc3luY19wb2xhcml0eSwKKwkmZGV2
X2F0dHJfdnN5bmNfcG9sYXJpdHksCisJJmRldl9hdHRyX2RlX3BvbGFyaXR5LAorCSZkZXZf
YXR0cl9wY2xrX2ZyZXF1ZW5jeSwKKwkmZGV2X2F0dHJfaHN5bmNfd2lkdGgsCisJJmRldl9h
dHRyX3ZzeW5jX3dpZHRoLAorCSZkZXZfYXR0cl9oYmFja19wb3JjaCwKKwkmZGV2X2F0dHJf
aGZyb250X3BvcmNoLAorCSZkZXZfYXR0cl92YmFja19wb3JjaCwKKwkmZGV2X2F0dHJfdmZy
b250X3BvcmNoLAorCSZkZXZfYXR0cl9hbGlnbm1lbnQsCisJJmRldl9hdHRyX2ZwZGwzX291
dHB1dF93aWR0aCwKKwlOVUxMCit9OworCitzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqbWdi
NF9nbXNsX291dF9hdHRyc1tdID0geworCSZkZXZfYXR0cl9vdXRwdXRfaWQsCisJJmRldl9h
dHRyX3ZpZGVvX3NvdXJjZSwKKwkmZGV2X2F0dHJfZGlzcGxheV93aWR0aCwKKwkmZGV2X2F0
dHJfZGlzcGxheV9oZWlnaHQsCisJJmRldl9hdHRyX2ZyYW1lX3JhdGUsCisJTlVMTAorfTsK
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGNpL21nYjQvbWdiNF9zeXNmc19wY2kuYyBi
L2RyaXZlcnMvbWVkaWEvcGNpL21nYjQvbWdiNF9zeXNmc19wY2kuYwpuZXcgZmlsZSBtb2Rl
IDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLmE3ZjU5Y2Q5Y2ZjOQotLS0gL2Rldi9udWxs
CisrKyBiL2RyaXZlcnMvbWVkaWEvcGNpL21nYjQvbWdiNF9zeXNmc19wY2kuYwpAQCAtMCww
ICsxLDgzIEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5Cisv
KgorICogQ29weXJpZ2h0IChDKSAyMDIxLTIwMjIgRGlnaXRlcSBBdXRvbW90aXZlCisgKiAg
ICAgYXV0aG9yOiBNYXJ0aW4gVHVtYSA8bWFydGluLnR1bWFAZGlnaXRlcWF1dG9tb3RpdmUu
Y29tPgorICovCisKKyNpbmNsdWRlIDxsaW51eC9kZXZpY2UuaD4KKyNpbmNsdWRlICJtZ2I0
X2NvcmUuaCIKKyNpbmNsdWRlICJtZ2I0X3N5c2ZzLmgiCisKK3N0YXRpYyBzc2l6ZV90IHJl
YWRfbW9kdWxlX3ZlcnNpb24oc3RydWN0IGRldmljZSAqZGV2LAorCQkJCSAgIHN0cnVjdCBk
ZXZpY2VfYXR0cmlidXRlICphdHRyLCBjaGFyICpidWYpCit7CisJc3RydWN0IG1nYjRfZGV2
ICptZ2JkZXYgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKKworCXJldHVybiBzcHJpbnRmKGJ1
ZiwgIiV1XG4iLCBtZ2JkZXYtPm1vZHVsZV92ZXJzaW9uICYgMHgwRik7Cit9CisKK3N0YXRp
YyBzc2l6ZV90IHJlYWRfbW9kdWxlX3R5cGUoc3RydWN0IGRldmljZSAqZGV2LAorCQkJCXN0
cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBjaGFyICpidWYpCit7CisJc3RydWN0IG1n
YjRfZGV2ICptZ2JkZXYgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKKworCXJldHVybiBzcHJp
bnRmKGJ1ZiwgIiV1XG4iLCBtZ2JkZXYtPm1vZHVsZV92ZXJzaW9uID4+IDQpOworfQorCitz
dGF0aWMgc3NpemVfdCByZWFkX2Z3X3ZlcnNpb24oc3RydWN0IGRldmljZSAqZGV2LAorCQkJ
ICAgICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBjaGFyICpidWYpCit7CisJ
c3RydWN0IG1nYjRfZGV2ICptZ2JkZXYgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKKwl1MzIg
Y29uZmlnID0gbWdiNF9yZWFkX3JlZygmbWdiZGV2LT52aWRlbywgMHhDNCk7CisKKwlyZXR1
cm4gc3ByaW50ZihidWYsICIldVxuIiwgY29uZmlnICYgMHhGRkZGKTsKK30KKworc3RhdGlj
IHNzaXplX3QgcmVhZF9md190eXBlKHN0cnVjdCBkZXZpY2UgKmRldiwKKwkJCSAgICBzdHJ1
Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQoreworCXN0cnVjdCBtZ2I0
X2RldiAqbWdiZGV2ID0gZGV2X2dldF9kcnZkYXRhKGRldik7CisJdTMyIGNvbmZpZyA9IG1n
YjRfcmVhZF9yZWcoJm1nYmRldi0+dmlkZW8sIDB4QzQpOworCisJcmV0dXJuIHNwcmludGYo
YnVmLCAiJXVcbiIsIGNvbmZpZyA+PiAyNCk7Cit9CisKK3N0YXRpYyBzc2l6ZV90IHJlYWRf
c2VyaWFsX251bWJlcihzdHJ1Y3QgZGV2aWNlICpkZXYsCisJCQkJICBzdHJ1Y3QgZGV2aWNl
X2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQoreworCXN0cnVjdCBtZ2I0X2RldiAqbWdi
ZGV2ID0gZGV2X2dldF9kcnZkYXRhKGRldik7CisJdTMyIHNuID0gbWdiZGV2LT5zZXJpYWxf
bnVtYmVyOworCisJcmV0dXJuIHNwcmludGYoYnVmLCAiJTAzZC0lMDNkLSUwM2QtJTAzZFxu
Iiwgc24gPj4gMjQsIChzbiA+PiAxNikgJiAweEZGLAorCSAgKHNuID4+IDgpICYgMHhGRiwg
c24gJiAweEZGKTsKK30KKworc3RhdGljIHNzaXplX3QgcmVhZF90ZW1wZXJhdHVyZShzdHJ1
Y3QgZGV2aWNlICpkZXYsCisJCQkJc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNo
YXIgKmJ1ZikKK3sKKwlzdHJ1Y3QgbWdiNF9kZXYgKm1nYmRldiA9IGRldl9nZXRfZHJ2ZGF0
YShkZXYpOworCXUzMiB2YWwxMCwgdmFsOworCisJdmFsICA9IG1nYjRfcmVhZF9yZWcoJm1n
YmRldi0+dmlkZW8sIDB4RDApOworCXZhbDEwID0gKCgoKHZhbCA+PiAyMCkgJiAweEZGRikg
KiA1MDM5NzUpIC0gMTExODgyMjQwMCkgLyA0MDk2MDA7CisKKwlyZXR1cm4gc3ByaW50Zihi
dWYsICIldVxuIiwgKCh2YWwxMCAlIDEwKSA+IDQpCisJICA/ICh2YWwxMCAvIDEwKSArIDEg
OiB2YWwxMCAvIDEwKTsKK30KKworc3RhdGljIERFVklDRV9BVFRSKG1vZHVsZV92ZXJzaW9u
LCAwNDQ0LCByZWFkX21vZHVsZV92ZXJzaW9uLCBOVUxMKTsKK3N0YXRpYyBERVZJQ0VfQVRU
Uihtb2R1bGVfdHlwZSwgMDQ0NCwgcmVhZF9tb2R1bGVfdHlwZSwgTlVMTCk7CitzdGF0aWMg
REVWSUNFX0FUVFIoZndfdmVyc2lvbiwgMDQ0NCwgcmVhZF9md192ZXJzaW9uLCBOVUxMKTsK
K3N0YXRpYyBERVZJQ0VfQVRUUihmd190eXBlLCAwNDQ0LCByZWFkX2Z3X3R5cGUsIE5VTEwp
Oworc3RhdGljIERFVklDRV9BVFRSKHNlcmlhbF9udW1iZXIsIDA0NDQsIHJlYWRfc2VyaWFs
X251bWJlciwgTlVMTCk7CitzdGF0aWMgREVWSUNFX0FUVFIodGVtcGVyYXR1cmUsIDA0NDQs
IHJlYWRfdGVtcGVyYXR1cmUsIE5VTEwpOworCitzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAq
bWdiNF9wY2lfYXR0cnNbXSA9IHsKKwkmZGV2X2F0dHJfbW9kdWxlX3R5cGUsCisJJmRldl9h
dHRyX21vZHVsZV92ZXJzaW9uLAorCSZkZXZfYXR0cl9md190eXBlLAorCSZkZXZfYXR0cl9m
d192ZXJzaW9uLAorCSZkZXZfYXR0cl9zZXJpYWxfbnVtYmVyLAorCSZkZXZfYXR0cl90ZW1w
ZXJhdHVyZSwKKwlOVUxMCit9OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wY2kvbWdi
NC9tZ2I0X3RyaWdnZXIuYyBiL2RyaXZlcnMvbWVkaWEvcGNpL21nYjQvbWdiNF90cmlnZ2Vy
LmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi42MDdjYTMzMTA0
YzIKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL21lZGlhL3BjaS9tZ2I0L21nYjRfdHJp
Z2dlci5jCkBAIC0wLDAgKzEsMjAzIEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjog
R1BMLTIuMC1vbmx5CisvKgorICogQ29weXJpZ2h0IChDKSAyMDIxLTIwMjIgRGlnaXRlcSBB
dXRvbW90aXZlCisgKiAgICAgYXV0aG9yOiBNYXJ0aW4gVHVtYSA8bWFydGluLnR1bWFAZGln
aXRlcWF1dG9tb3RpdmUuY29tPgorICovCisKKyNpbmNsdWRlIDxsaW51eC92ZXJzaW9uLmg+
CisjaW5jbHVkZSA8bGludXgvaWlvL2lpby5oPgorI2luY2x1ZGUgPGxpbnV4L2lpby9idWZm
ZXIuaD4KKyNpbmNsdWRlIDxsaW51eC9paW8vdHJpZ2dlci5oPgorI2luY2x1ZGUgPGxpbnV4
L2lpby90cmlnZ2VyX2NvbnN1bWVyLmg+CisjaW5jbHVkZSA8bGludXgvaWlvL3RyaWdnZXJl
ZF9idWZmZXIuaD4KKyNpbmNsdWRlIDxsaW51eC9wY2kuaD4KKyNpbmNsdWRlIDxsaW51eC9k
bWEvYW1kX3hkbWEuaD4KKyNpbmNsdWRlICJtZ2I0X2NvcmUuaCIKKyNpbmNsdWRlICJtZ2I0
X3RyaWdnZXIuaCIKKworc3RydWN0IHRyaWdnZXJfZGF0YSB7CisJc3RydWN0IG1nYjRfZGV2
ICptZ2JkZXY7CisJc3RydWN0IGlpb190cmlnZ2VyICp0cmlnOworfTsKKworc3RhdGljIGlu
dCB0cmlnZ2VyX3JlYWRfcmF3KHN0cnVjdCBpaW9fZGV2ICppbmRpb19kZXYsCisJCQkgICAg
c3RydWN0IGlpb19jaGFuX3NwZWMgY29uc3QgKmNoYW4sIGludCAqdmFsLAorCQkJICAgIGlu
dCAqdmFsMiwgbG9uZyBtYXNrKQoreworCXN0cnVjdCB0cmlnZ2VyX2RhdGEgKnN0ID0gaWlv
X3ByaXYoaW5kaW9fZGV2KTsKKworCXN3aXRjaCAobWFzaykgeworCWNhc2UgSUlPX0NIQU5f
SU5GT19SQVc6CisJCWlmIChpaW9fYnVmZmVyX2VuYWJsZWQoaW5kaW9fZGV2KSkKKwkJCXJl
dHVybiAtRUJVU1k7CisJCSp2YWwgPSBtZ2I0X3JlYWRfcmVnKCZzdC0+bWdiZGV2LT52aWRl
bywgMHhBMCk7CisKKwkJcmV0dXJuIElJT19WQUxfSU5UOworCX0KKworCXJldHVybiAtRUlO
VkFMOworfQorCitzdGF0aWMgaW50IHRyaWdnZXJfc2V0X3N0YXRlKHN0cnVjdCBpaW9fdHJp
Z2dlciAqdHJpZywgYm9vbCBzdGF0ZSkKK3sKKwlzdHJ1Y3QgaWlvX2RldiAqaW5kaW9fZGV2
ID0gaWlvX3RyaWdnZXJfZ2V0X2RydmRhdGEodHJpZyk7CisJc3RydWN0IHRyaWdnZXJfZGF0
YSAqc3QgPSBpaW9fcHJpdihpbmRpb19kZXYpOworCWludCBpcnEgPSB4ZG1hX2dldF91c2Vy
X2lycShzdC0+bWdiZGV2LT54ZGV2LCAxMSk7CisKKwlpZiAoc3RhdGUpCisJCXhkbWFfZW5h
YmxlX3VzZXJfaXJxKHN0LT5tZ2JkZXYtPnhkZXYsIGlycSk7CisJZWxzZQorCQl4ZG1hX2Rp
c2FibGVfdXNlcl9pcnEoc3QtPm1nYmRldi0+eGRldiwgaXJxKTsKKworCXJldHVybiAwOwor
fQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGlpb190cmlnZ2VyX29wcyB0cmlnZ2VyX29wcyA9
IHsKKwkuc2V0X3RyaWdnZXJfc3RhdGUgPSAmdHJpZ2dlcl9zZXRfc3RhdGUsCit9OworCitz
dGF0aWMgY29uc3Qgc3RydWN0IGlpb19pbmZvIHRyaWdnZXJfaW5mbyA9IHsKKwkucmVhZF9y
YXcgICAgICAgICA9IHRyaWdnZXJfcmVhZF9yYXcsCit9OworCisjZGVmaW5lIFRSSUdHRVJf
Q0hBTk5FTChfc2kpIHsgICAgICAgICAgICAgICAgICAgIFwKKwkudHlwZSA9IElJT19BQ1RJ
VklUWSwgICAgICAgICAgICAgICAgICAgICAgICAgXAorCS5pbmZvX21hc2tfc2VwYXJhdGUg
PSBCSVQoSUlPX0NIQU5fSU5GT19SQVcpLCBcCisJLnNjYW5faW5kZXggPSBfc2ksICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFwKKwkuc2Nhbl90eXBlID0geyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgXAorCQkuc2lnbiA9ICd1JywgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBcCisJCS5yZWFsYml0cyA9IDMyLCAgICAgICAgICAgICAgICAgICAgICAg
ICAgIFwKKwkJLnN0b3JhZ2ViaXRzID0gMzIsICAgICAgICAgICAgICAgICAgICAgICAgXAor
CQkuc2hpZnQgPSAwLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCisJCS5lbmRp
YW5uZXNzID0gSUlPX0NQVSAgICAgICAgICAgICAgICAgICAgIFwKKwl9LCAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAorfQorCitzdGF0aWMgY29uc3Qg
c3RydWN0IGlpb19jaGFuX3NwZWMgdHJpZ2dlcl9jaGFubmVsc1tdID0geworCVRSSUdHRVJf
Q0hBTk5FTCgwKSwKKwlJSU9fQ0hBTl9TT0ZUX1RJTUVTVEFNUCgxKSwKK307CisKK3N0YXRp
YyBpcnFyZXR1cm5fdCB0cmlnZ2VyX2hhbmRsZXIoaW50IGlycSwgdm9pZCAqcCkKK3sKKwlz
dHJ1Y3QgaWlvX3BvbGxfZnVuYyAqcGYgPSBwOworCXN0cnVjdCBpaW9fZGV2ICppbmRpb19k
ZXYgPSBwZi0+aW5kaW9fZGV2OworCXN0cnVjdCB0cmlnZ2VyX2RhdGEgKnN0ID0gaWlvX3By
aXYoaW5kaW9fZGV2KTsKKwlzdHJ1Y3QgeworCQl1MzIgZGF0YTsKKwkJczY0IHRzIF9fYWxp
Z25lZCg4KTsKKwl9IHNjYW47CisKKwlzY2FuLmRhdGEgPSBtZ2I0X3JlYWRfcmVnKCZzdC0+
bWdiZGV2LT52aWRlbywgMHhBMCk7CisJbWdiNF93cml0ZV9yZWcoJnN0LT5tZ2JkZXYtPnZp
ZGVvLCAweEEwLCBzY2FuLmRhdGEpOworCisJaWlvX3B1c2hfdG9fYnVmZmVyc193aXRoX3Rp
bWVzdGFtcChpbmRpb19kZXYsICZzY2FuLCBwZi0+dGltZXN0YW1wKTsKKwlpaW9fdHJpZ2dl
cl9ub3RpZnlfZG9uZShpbmRpb19kZXYtPnRyaWcpOworCisJbWdiNF93cml0ZV9yZWcoJnN0
LT5tZ2JkZXYtPnZpZGVvLCAweEI0LCAxVTw8MTEpOworCisJcmV0dXJuIElSUV9IQU5ETEVE
OworfQorCitzdGF0aWMgaW50IHByb2JlX3RyaWdnZXIoc3RydWN0IGlpb19kZXYgKmluZGlv
X2RldiwgaW50IGlycSkKK3sKKwlpbnQgcmV0OworCXN0cnVjdCB0cmlnZ2VyX2RhdGEgKnN0
ID0gaWlvX3ByaXYoaW5kaW9fZGV2KTsKKworCXN0LT50cmlnID0gaWlvX3RyaWdnZXJfYWxs
b2MoJnN0LT5tZ2JkZXYtPnBkZXYtPmRldiwgIiVzLWRldiVkIiwKKwkgIGluZGlvX2Rldi0+
bmFtZSwgaWlvX2RldmljZV9pZChpbmRpb19kZXYpKTsKKwlpZiAoIXN0LT50cmlnKQorCQly
ZXR1cm4gLUVOT01FTTsKKworCXJldCA9IHJlcXVlc3RfaXJxKGlycSwgJmlpb190cmlnZ2Vy
X2dlbmVyaWNfZGF0YV9yZHlfcG9sbCwKKwkgMCwgIm1nYjQtdHJpZ2dlciIsIHN0LT50cmln
KTsKKwlpZiAocmV0KQorCQlnb3RvIGVycm9yX2ZyZWVfdHJpZzsKKworCXN0LT50cmlnLT5v
cHMgPSAmdHJpZ2dlcl9vcHM7CisJaWlvX3RyaWdnZXJfc2V0X2RydmRhdGEoc3QtPnRyaWcs
IGluZGlvX2Rldik7CisJcmV0ID0gaWlvX3RyaWdnZXJfcmVnaXN0ZXIoc3QtPnRyaWcpOwor
CWlmIChyZXQpCisJCWdvdG8gZXJyb3JfZnJlZV9pcnE7CisKKwlpbmRpb19kZXYtPnRyaWcg
PSBpaW9fdHJpZ2dlcl9nZXQoc3QtPnRyaWcpOworCisJcmV0dXJuIDA7CisKK2Vycm9yX2Zy
ZWVfaXJxOgorCWZyZWVfaXJxKGlycSwgc3QtPnRyaWcpOworZXJyb3JfZnJlZV90cmlnOgor
CWlpb190cmlnZ2VyX2ZyZWUoc3QtPnRyaWcpOworCisJcmV0dXJuIHJldDsKK30KKworc3Rh
dGljIHZvaWQgcmVtb3ZlX3RyaWdnZXIoc3RydWN0IGlpb19kZXYgKmluZGlvX2RldiwgaW50
IGlycSkKK3sKKwlzdHJ1Y3QgdHJpZ2dlcl9kYXRhICpzdCA9IGlpb19wcml2KGluZGlvX2Rl
dik7CisKKwlpaW9fdHJpZ2dlcl91bnJlZ2lzdGVyKHN0LT50cmlnKTsKKwlmcmVlX2lycShp
cnEsIHN0LT50cmlnKTsKKwlpaW9fdHJpZ2dlcl9mcmVlKHN0LT50cmlnKTsKK30KKworc3Ry
dWN0IGlpb19kZXYgKm1nYjRfdHJpZ2dlcl9jcmVhdGUoc3RydWN0IG1nYjRfZGV2ICptZ2Jk
ZXYpCit7CisJc3RydWN0IGlpb19kZXYgKmluZGlvX2RldjsKKwlzdHJ1Y3QgdHJpZ2dlcl9k
YXRhICpkYXRhOworCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gbWdiZGV2LT5wZGV2OworCXN0
cnVjdCBkZXZpY2UgKmRldiA9ICZwZGV2LT5kZXY7CisJaW50IHJ2LCBpcnE7CisKKwlpbmRp
b19kZXYgPSBpaW9fZGV2aWNlX2FsbG9jKGRldiwgc2l6ZW9mKCpkYXRhKSk7CisJaWYgKCFp
bmRpb19kZXYpCisJCXJldHVybiBOVUxMOworCisJaW5kaW9fZGV2LT5pbmZvID0gJnRyaWdn
ZXJfaW5mbzsKKwlpbmRpb19kZXYtPm5hbWUgPSAibWdiNCI7CisJaW5kaW9fZGV2LT5tb2Rl
cyA9IElORElPX0RJUkVDVF9NT0RFOworCWluZGlvX2Rldi0+Y2hhbm5lbHMgPSB0cmlnZ2Vy
X2NoYW5uZWxzOworCWluZGlvX2Rldi0+bnVtX2NoYW5uZWxzID0gQVJSQVlfU0laRSh0cmln
Z2VyX2NoYW5uZWxzKTsKKworCWRhdGEgPSBpaW9fcHJpdihpbmRpb19kZXYpOworCWRhdGEt
Pm1nYmRldiA9IG1nYmRldjsKKworCWlycSA9IHhkbWFfZ2V0X3VzZXJfaXJxKG1nYmRldi0+
eGRldiwgMTEpOworCXJ2ID0gcHJvYmVfdHJpZ2dlcihpbmRpb19kZXYsIGlycSk7CisJaWYg
KHJ2IDwgMCkgeworCQlkZXZfZXJyKGRldiwgImlpbyB0cmlnZ2VyZWQgc2V0dXAgZmFpbGVk
XG4iKTsKKwkJZ290byBlcnJvcl9hbGxvYzsKKwl9CisJcnYgPSBpaW9fdHJpZ2dlcmVkX2J1
ZmZlcl9zZXR1cChpbmRpb19kZXYsICZpaW9fcG9sbGZ1bmNfc3RvcmVfdGltZSwKKwkgIHRy
aWdnZXJfaGFuZGxlciwgTlVMTCk7CisJaWYgKHJ2IDwgMCkgeworCQlkZXZfZXJyKGRldiwg
ImlpbyB0cmlnZ2VyZWQgYnVmZmVyIHNldHVwIGZhaWxlZFxuIik7CisJCWdvdG8gZXJyb3Jf
dHJpZ2dlcjsKKwl9CisJcnYgPSBpaW9fZGV2aWNlX3JlZ2lzdGVyKGluZGlvX2Rldik7CisJ
aWYgKHJ2IDwgMCkgeworCQlkZXZfZXJyKGRldiwgImlpbyBkZXZpY2UgcmVnaXN0ZXIgZmFp
bGVkXG4iKTsKKwkJZ290byBlcnJvcl9idWZmZXI7CisJfQorCisJcmV0dXJuIGluZGlvX2Rl
djsKKworZXJyb3JfYnVmZmVyOgorCWlpb190cmlnZ2VyZWRfYnVmZmVyX2NsZWFudXAoaW5k
aW9fZGV2KTsKK2Vycm9yX3RyaWdnZXI6CisJcmVtb3ZlX3RyaWdnZXIoaW5kaW9fZGV2LCBp
cnEpOworZXJyb3JfYWxsb2M6CisJaWlvX2RldmljZV9mcmVlKGluZGlvX2Rldik7CisKKwly
ZXR1cm4gTlVMTDsKK30KKwordm9pZCBtZ2I0X3RyaWdnZXJfZnJlZShzdHJ1Y3QgaWlvX2Rl
diAqaW5kaW9fZGV2KQoreworCXN0cnVjdCB0cmlnZ2VyX2RhdGEgKnN0ID0gaWlvX3ByaXYo
aW5kaW9fZGV2KTsKKworCWlpb19kZXZpY2VfdW5yZWdpc3RlcihpbmRpb19kZXYpOworCWlp
b190cmlnZ2VyZWRfYnVmZmVyX2NsZWFudXAoaW5kaW9fZGV2KTsKKwlyZW1vdmVfdHJpZ2dl
cihpbmRpb19kZXYsIHhkbWFfZ2V0X3VzZXJfaXJxKHN0LT5tZ2JkZXYtPnhkZXYsIDExKSk7
CisJaWlvX2RldmljZV9mcmVlKGluZGlvX2Rldik7Cit9CmRpZmYgLS1naXQgYS9kcml2ZXJz
L21lZGlhL3BjaS9tZ2I0L21nYjRfdHJpZ2dlci5oIGIvZHJpdmVycy9tZWRpYS9wY2kvbWdi
NC9tZ2I0X3RyaWdnZXIuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAw
MDAuLjllNmE2NTE4MTdkNQotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvbWVkaWEvcGNp
L21nYjQvbWdiNF90cmlnZ2VyLmgKQEAgLTAsMCArMSw4IEBACisvKiBTUERYLUxpY2Vuc2Ut
SWRlbnRpZmllcjogR1BMLTIuMC1vbmx5ICovCisvKgorICogQ29weXJpZ2h0IChDKSAyMDIx
LTIwMjIgRGlnaXRlcSBBdXRvbW90aXZlCisgKiAgICAgYXV0aG9yOiBNYXJ0aW4gVHVtYSA8
bWFydGluLnR1bWFAZGlnaXRlcWF1dG9tb3RpdmUuY29tPgorICovCisKK2V4dGVybiBzdHJ1
Y3QgaWlvX2RldiAqbWdiNF90cmlnZ2VyX2NyZWF0ZShzdHJ1Y3QgbWdiNF9kZXYgKm1nYmRl
dik7CitleHRlcm4gdm9pZCBtZ2I0X3RyaWdnZXJfZnJlZShzdHJ1Y3QgaWlvX2RldiAqaW5k
aW9fZGV2KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvcGNpL21nYjQvbWdiNF92aW4u
YyBiL2RyaXZlcnMvbWVkaWEvcGNpL21nYjQvbWdiNF92aW4uYwpuZXcgZmlsZSBtb2RlIDEw
MDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjQyMzhlMmMwNDQ5ZAotLS0gL2Rldi9udWxsCisr
KyBiL2RyaXZlcnMvbWVkaWEvcGNpL21nYjQvbWdiNF92aW4uYwpAQCAtMCwwICsxLDY2MyBA
QAorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb25seQorLyoKKyAqIENv
cHlyaWdodCAoQykgMjAyMS0yMDIyIERpZ2l0ZXEgQXV0b21vdGl2ZQorICogICAgIGF1dGhv
cjogTWFydGluIFR1bWEgPG1hcnRpbi50dW1hQGRpZ2l0ZXFhdXRvbW90aXZlLmNvbT4KKyAq
LworCisjaW5jbHVkZSA8bGludXgvcGNpLmg+CisjaW5jbHVkZSA8bGludXgvd29ya3F1ZXVl
Lmg+CisjaW5jbHVkZSA8bWVkaWEvdjRsMi1pb2N0bC5oPgorI2luY2x1ZGUgPG1lZGlhL3Zp
ZGVvYnVmMi12NGwyLmg+CisjaW5jbHVkZSA8bWVkaWEvdmlkZW9idWYyLWRtYS1zZy5oPgor
I2luY2x1ZGUgPGxpbnV4L2RtYS9hbWRfeGRtYS5oPgorI2luY2x1ZGUgIm1nYjRfY29yZS5o
IgorI2luY2x1ZGUgIm1nYjRfZG1hLmgiCisjaW5jbHVkZSAibWdiNF9zeXNmcy5oIgorI2lu
Y2x1ZGUgIm1nYjRfaW8uaCIKKyNpbmNsdWRlICJtZ2I0X3ZvdXQuaCIKKyNpbmNsdWRlICJt
Z2I0X3Zpbi5oIgorCitzdGF0aWMgY29uc3Qgc3RydWN0IG1nYjRfdmluX2NvbmZpZyB2aW5f
Y2ZnW10gPSB7CisJezAsIDAsIDAsIDYsIHsweDEwLCAweDAwLCAweDA0LCAweDA4LCAweDFD
LCAweDE0LCAweDE4LCAweDIwLCAweDI0LCAweDI4fX0sCisJezEsIDEsIDEsIDcsIHsweDQw
LCAweDMwLCAweDM0LCAweDM4LCAweDRDLCAweDQ0LCAweDQ4LCAweDUwLCAweDU0LCAweDU4
fX0KK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgaTJjX2JvYXJkX2luZm8gZnBkbDNfZGVz
ZXJfaW5mb1tdID0geworCXtJMkNfQk9BUkRfSU5GTygiZGVzZXJpYWxpemVyMSIsIDB4MzYp
fSwKKwl7STJDX0JPQVJEX0lORk8oImRlc2VyaWFsaXplcjIiLCAweDM4KX0sCit9Oworc3Rh
dGljIGNvbnN0IHN0cnVjdCBpMmNfYm9hcmRfaW5mbyBnbXNsX2Rlc2VyX2luZm9bXSA9IHsK
Kwl7STJDX0JPQVJEX0lORk8oImRlc2VyaWFsaXplcjEiLCAweDRDKX0sCisJe0kyQ19CT0FS
RF9JTkZPKCJkZXNlcmlhbGl6ZXIyIiwgMHgyQSl9LAorfTsKKworc3RhdGljIGNvbnN0IHN0
cnVjdCBtZ2I0X2kyY19rdiBmcGRsM19pMmNbXSA9IHsKKwl7MHgwNiwgMHhGRiwgMHgwNH0s
IHsweDA3LCAweEZGLCAweDAxfSwgezB4NDUsIDB4RkYsIDB4RTh9LAorCXsweDQ5LCAweEZG
LCAweDAwfSwgezB4MzQsIDB4RkYsIDB4MDB9LCB7MHgyMywgMHhGRiwgMHgwMH0KK307CisK
K3N0YXRpYyBjb25zdCBzdHJ1Y3QgbWdiNF9pMmNfa3YgZ21zbF9pMmNbXSA9IHsKKwl7MHgw
MSwgMHgwMywgMHgwM30sIHsweDMwMCwgMHgwQywgMHgwQ30sIHsweDAzLCAweEMwLCAweEMw
fSwKKwl7MHgxQ0UsIDB4MEUsIDB4MEV9LCB7MHgxMSwgMHgwNSwgMHgwMH0sIHsweDA1LCAw
eEMwLCAweDQwfSwKKwl7MHgzMDcsIDB4MEYsIDB4MDB9LCB7MHhBMCwgMHgwMywgMHgwMH0s
IHsweDNFMCwgMHgwNywgMHgwN30sCisJezB4MzA4LCAweDAxLCAweDAxfSwgezB4MTAsIDB4
MjAsIDB4MjB9LCB7MHgzMDAsIDB4NDAsIDB4NDB9Cit9OworCisKK3N0YXRpYyBzdHJ1Y3Qg
bWdiNF92b3V0X2RldiAqbG9vcGJhY2tfZGV2KHN0cnVjdCBtZ2I0X3Zpbl9kZXYgKnZpbmRl
diwgaW50IGkpCit7CisJc3RydWN0IG1nYjRfdm91dF9kZXYgKnZvdXRkZXY7CisJdTMyIGNv
bmZpZzsKKworCXZvdXRkZXYgPSB2aW5kZXYtPm1nYmRldi0+dm91dFtpXTsKKwlpZiAoIXZv
dXRkZXYpCisJCXJldHVybiBOVUxMOworCisJY29uZmlnID0gbWdiNF9yZWFkX3JlZygmdm91
dGRldi0+bWdiZGV2LT52aWRlbywgdm91dGRldi0+Y29uZmlnLT5yZWdzLmNvbmZpZyk7CisJ
aWYgKChjb25maWcgJiAweGMpID4+IDIgPT0gdmluZGV2LT5jb25maWctPmlkKQorCQlyZXR1
cm4gdm91dGRldjsKKworCXJldHVybiBOVUxMOworfQorCitzdGF0aWMgaW50IGxvb3BiYWNr
X2FjdGl2ZShzdHJ1Y3QgbWdiNF92aW5fZGV2ICp2aW5kZXYpCit7CisJaW50IGk7CisKKwlm
b3IgKGkgPSAwOyBpIDwgTUdCNF9WT1VUX0RFVklDRVM7IGkrKykKKwkJaWYgKGxvb3BiYWNr
X2Rldih2aW5kZXYsIGkpKQorCQkJcmV0dXJuIDE7CisKKwlyZXR1cm4gMDsKK30KKworc3Rh
dGljIHZvaWQgc2V0X2xvb3BiYWNrX3BhZGRpbmcoc3RydWN0IG1nYjRfdmluX2RldiAqdmlu
ZGV2LCB1MzIgcGFkZGluZykKK3sKKwlzdHJ1Y3QgbWdiNF9yZWdzICp2aWRlbyA9ICZ2aW5k
ZXYtPm1nYmRldi0+dmlkZW87CisJc3RydWN0IG1nYjRfdm91dF9kZXYgKnZvdXRkZXY7CisJ
aW50IGk7CisKKwlmb3IgKGkgPSAwOyBpIDwgTUdCNF9WT1VUX0RFVklDRVM7IGkrKykgewor
CQl2b3V0ZGV2ID0gbG9vcGJhY2tfZGV2KHZpbmRldiwgaSk7CisJCWlmICh2b3V0ZGV2KQor
CQkJbWdiNF93cml0ZV9yZWcodmlkZW8sIHZvdXRkZXYtPmNvbmZpZy0+cmVncy5wYWRkaW5n
LCBwYWRkaW5nKTsKKwl9Cit9CisKK3N0YXRpYyB2b2lkIHJldHVybl9hbGxfYnVmZmVycyhz
dHJ1Y3QgbWdiNF92aW5fZGV2ICp2aW5kZXYsCisJCQkgICAgICAgZW51bSB2YjJfYnVmZmVy
X3N0YXRlIHN0YXRlKQoreworCXN0cnVjdCBmcmFtZV9idWZmZXIgKmJ1ZiwgKm5vZGU7CisJ
dW5zaWduZWQgbG9uZyBmbGFnczsKKworCXNwaW5fbG9ja19pcnFzYXZlKCZ2aW5kZXYtPnFs
b2NrLCBmbGFncyk7CisJbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKGJ1Ziwgbm9kZSwgJnZp
bmRldi0+YnVmX2xpc3QsIGxpc3QpIHsKKwkJdmIyX2J1ZmZlcl9kb25lKCZidWYtPnZiLnZi
Ml9idWYsIHN0YXRlKTsKKwkJbGlzdF9kZWwoJmJ1Zi0+bGlzdCk7CisJfQorCXNwaW5fdW5s
b2NrX2lycXJlc3RvcmUoJnZpbmRldi0+cWxvY2ssIGZsYWdzKTsKK30KKworc3RhdGljIGlu
dCBxdWV1ZV9zZXR1cChzdHJ1Y3QgdmIyX3F1ZXVlICpxLCB1bnNpZ25lZCBpbnQgKm5idWZm
ZXJzLAorCQkgICAgICAgdW5zaWduZWQgaW50ICpucGxhbmVzLCB1bnNpZ25lZCBpbnQgc2l6
ZXNbXSwKKwkJICAgICAgIHN0cnVjdCBkZXZpY2UgKmFsbG9jX2RldnNbXSkKK3sKKwlzdHJ1
Y3QgbWdiNF92aW5fZGV2ICp2aW5kZXYgPSB2YjJfZ2V0X2Rydl9wcml2KHEpOworCXVuc2ln
bmVkIGludCBzaXplID0gQllURVNQRVJMSU5FKHZpbmRldi0+d2lkdGgsIHZpbmRldi0+YWxp
Z25tZW50KQorCSAgKiB2aW5kZXYtPmhlaWdodDsKKworCWlmICgqbmJ1ZmZlcnMgPCAyKQor
CQkqbmJ1ZmZlcnMgPSAyOworCisJaWYgKCpucGxhbmVzKQorCQlyZXR1cm4gc2l6ZXNbMF0g
PCBzaXplID8gLUVJTlZBTCA6IDA7CisJKm5wbGFuZXMgPSAxOworCXNpemVzWzBdID0gc2l6
ZTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IGJ1ZmZlcl9pbml0KHN0cnVjdCB2
YjJfYnVmZmVyICp2YikKK3sKKwlzdHJ1Y3QgdmIyX3Y0bDJfYnVmZmVyICp2YnVmID0gdG9f
dmIyX3Y0bDJfYnVmZmVyKHZiKTsKKwlzdHJ1Y3QgZnJhbWVfYnVmZmVyICpidWYgPSB0b19m
cmFtZV9idWZmZXIodmJ1Zik7CisKKwlJTklUX0xJU1RfSEVBRCgmYnVmLT5saXN0KTsKKwor
CXJldHVybiAwOworfQorCitzdGF0aWMgaW50IGJ1ZmZlcl9wcmVwYXJlKHN0cnVjdCB2YjJf
YnVmZmVyICp2YikKK3sKKwlzdHJ1Y3QgbWdiNF92aW5fZGV2ICp2aW5kZXYgPSB2YjJfZ2V0
X2Rydl9wcml2KHZiLT52YjJfcXVldWUpOworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZ2aW5k
ZXYtPm1nYmRldi0+cGRldi0+ZGV2OworCXVuc2lnbmVkIGludCBzaXplID0gQllURVNQRVJM
SU5FKHZpbmRldi0+d2lkdGgsIHZpbmRldi0+YWxpZ25tZW50KQorCSAgKiB2aW5kZXYtPmhl
aWdodDsKKworCWlmICh2YjJfcGxhbmVfc2l6ZSh2YiwgMCkgPCBzaXplKSB7CisJCWRldl9l
cnIoZGV2LCAiYnVmZmVyIHRvbyBzbWFsbCAoJWx1IDwgJXUpXG4iLAorCQkJdmIyX3BsYW5l
X3NpemUodmIsIDApLCBzaXplKTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJdmIyX3Nl
dF9wbGFuZV9wYXlsb2FkKHZiLCAwLCBzaXplKTsKKworCXJldHVybiAwOworfQorCitzdGF0
aWMgdm9pZCBidWZmZXJfcXVldWUoc3RydWN0IHZiMl9idWZmZXIgKnZiKQoreworCXN0cnVj
dCBtZ2I0X3Zpbl9kZXYgKnZpbmRldiA9IHZiMl9nZXRfZHJ2X3ByaXYodmItPnZiMl9xdWV1
ZSk7CisJc3RydWN0IHZiMl92NGwyX2J1ZmZlciAqdmJ1ZiA9IHRvX3ZiMl92NGwyX2J1ZmZl
cih2Yik7CisJc3RydWN0IGZyYW1lX2J1ZmZlciAqYnVmID0gdG9fZnJhbWVfYnVmZmVyKHZi
dWYpOworCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CisKKwlzcGluX2xvY2tfaXJxc2F2ZSgmdmlu
ZGV2LT5xbG9jaywgZmxhZ3MpOworCWxpc3RfYWRkX3RhaWwoJmJ1Zi0+bGlzdCwgJnZpbmRl
di0+YnVmX2xpc3QpOworCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJnZpbmRldi0+cWxvY2ss
IGZsYWdzKTsKK30KKworc3RhdGljIHZvaWQgc3RvcF9zdHJlYW1pbmcoc3RydWN0IHZiMl9x
dWV1ZSAqdnEpCit7CisJc3RydWN0IG1nYjRfdmluX2RldiAqdmluZGV2ID0gdmIyX2dldF9k
cnZfcHJpdih2cSk7CisJaW50IGlycSA9IHhkbWFfZ2V0X3VzZXJfaXJxKHZpbmRldi0+bWdi
ZGV2LT54ZGV2LCB2aW5kZXYtPmNvbmZpZy0+dmluX2lycSk7CisKKwl4ZG1hX2Rpc2FibGVf
dXNlcl9pcnEodmluZGV2LT5tZ2JkZXYtPnhkZXYsIGlycSk7CisKKwlpZiAoIWxvb3BiYWNr
X2FjdGl2ZSh2aW5kZXYpKQorCQltZ2I0X21hc2tfcmVnKCZ2aW5kZXYtPm1nYmRldi0+dmlk
ZW8sIHZpbmRldi0+Y29uZmlnLT5yZWdzLmNvbmZpZywKKwkJICAweDIsIDB4MCk7CisKKwlj
YW5jZWxfd29ya19zeW5jKCZ2aW5kZXYtPmRtYV93b3JrKTsKKwlyZXR1cm5fYWxsX2J1ZmZl
cnModmluZGV2LCBWQjJfQlVGX1NUQVRFX0VSUk9SKTsKK30KKworc3RhdGljIGludCBzdGFy
dF9zdHJlYW1pbmcoc3RydWN0IHZiMl9xdWV1ZSAqdnEsIHVuc2lnbmVkIGludCBjb3VudCkK
K3sKKwlzdHJ1Y3QgbWdiNF92aW5fZGV2ICp2aW5kZXYgPSB2YjJfZ2V0X2Rydl9wcml2KHZx
KTsKKwl1MzIgcmVzb2x1dGlvbiA9IG1nYjRfcmVhZF9yZWcoJnZpbmRldi0+bWdiZGV2LT52
aWRlbywKKwkgIHZpbmRldi0+Y29uZmlnLT5yZWdzLnJlc29sdXRpb24pOworCWludCBpcnEg
PSB4ZG1hX2dldF91c2VyX2lycSh2aW5kZXYtPm1nYmRldi0+eGRldiwgdmluZGV2LT5jb25m
aWctPnZpbl9pcnEpOworCisJaWYgKCh2aW5kZXYtPndpZHRoICE9IChyZXNvbHV0aW9uID4+
IDE2KSkKKwkgIHx8ICh2aW5kZXYtPmhlaWdodCAhPSAocmVzb2x1dGlvbiAmIDB4RkZGRikp
KSB7CisJCXJldHVybl9hbGxfYnVmZmVycyh2aW5kZXYsIFZCMl9CVUZfU1RBVEVfRVJST1Ip
OworCQlyZXR1cm4gLUVJTzsKKwl9CisKKwl2aW5kZXYtPnNlcXVlbmNlID0gMDsKKworCWlm
ICghbG9vcGJhY2tfYWN0aXZlKHZpbmRldikpCisJCW1nYjRfbWFza19yZWcoJnZpbmRldi0+
bWdiZGV2LT52aWRlbywgdmluZGV2LT5jb25maWctPnJlZ3MuY29uZmlnLAorCQkgIDB4Miwg
MHgyKTsKKworCXhkbWFfZW5hYmxlX3VzZXJfaXJxKHZpbmRldi0+bWdiZGV2LT54ZGV2LCBp
cnEpOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgdmIyX29wcyBx
dWV1ZV9vcHMgPSB7CisJLnF1ZXVlX3NldHVwID0gcXVldWVfc2V0dXAsCisJLmJ1Zl9pbml0
ID0gYnVmZmVyX2luaXQsCisJLmJ1Zl9wcmVwYXJlID0gYnVmZmVyX3ByZXBhcmUsCisJLmJ1
Zl9xdWV1ZSA9IGJ1ZmZlcl9xdWV1ZSwKKwkuc3RhcnRfc3RyZWFtaW5nID0gc3RhcnRfc3Ry
ZWFtaW5nLAorCS5zdG9wX3N0cmVhbWluZyA9IHN0b3Bfc3RyZWFtaW5nLAorCS53YWl0X3By
ZXBhcmUgPSB2YjJfb3BzX3dhaXRfcHJlcGFyZSwKKwkud2FpdF9maW5pc2ggPSB2YjJfb3Bz
X3dhaXRfZmluaXNoCit9OworCitzdGF0aWMgaW50IGZoX29wZW4oc3RydWN0IGZpbGUgKmZp
bGUpCit7CisJc3RydWN0IG1nYjRfdmluX2RldiAqdmluZGV2ID0gdmlkZW9fZHJ2ZGF0YShm
aWxlKTsKKwlzdHJ1Y3QgbWdiNF9yZWdzICp2aWRlbyA9ICZ2aW5kZXYtPm1nYmRldi0+dmlk
ZW87CisJdTMyIHJlc29sdXRpb24sIHBhZGRpbmc7CisJaW50IHJldCwgaXJxOworCisJcmV0
ID0gdjRsMl9maF9vcGVuKGZpbGUpOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisKKwly
ZXNvbHV0aW9uID0gbWdiNF9yZWFkX3JlZyh2aWRlbywgdmluZGV2LT5jb25maWctPnJlZ3Mu
cmVzb2x1dGlvbik7CisJaWYgKHJlc29sdXRpb24gPj0gRVJSX05PX1JFRykKKwkJZ290byBl
cnJvcjsKKworCXZpbmRldi0+d2lkdGggPSByZXNvbHV0aW9uID4+IDE2OworCXZpbmRldi0+
aGVpZ2h0ID0gcmVzb2x1dGlvbiAmIDB4RkZGRjsKKwlpZiAoIXZpbmRldi0+d2lkdGggfHwg
IXZpbmRldi0+aGVpZ2h0KQorCQlnb3RvIGVycm9yOworCisJaXJxID0geGRtYV9nZXRfdXNl
cl9pcnEodmluZGV2LT5tZ2JkZXYtPnhkZXYsIHZpbmRldi0+Y29uZmlnLT5lcnJfaXJxKTsK
Kwl4ZG1hX2VuYWJsZV91c2VyX2lycSh2aW5kZXYtPm1nYmRldi0+eGRldiwgaXJxKTsKKwor
CXZpbmRldi0+cGVyaW9kID0gbWdiNF9yZWFkX3JlZyh2aWRlbywgdmluZGV2LT5jb25maWct
PnJlZ3MuZnJhbWVfcGVyaW9kKTsKKworCXBhZGRpbmcgPSBQQURESU5HKHZpbmRldi0+d2lk
dGgsIHZpbmRldi0+YWxpZ25tZW50KTsKKwltZ2I0X3dyaXRlX3JlZyh2aWRlbywgdmluZGV2
LT5jb25maWctPnJlZ3MucGFkZGluZywgcGFkZGluZyk7CisJc2V0X2xvb3BiYWNrX3BhZGRp
bmcodmluZGV2LCBwYWRkaW5nKTsKKworCXJldHVybiAwOworCitlcnJvcjoKKwl2NGwyX2Zo
X3JlbGVhc2UoZmlsZSk7CisJcmV0dXJuIC1FSU87Cit9CisKK3N0YXRpYyBpbnQgZmhfcmVs
ZWFzZShzdHJ1Y3QgZmlsZSAqZmlsZSkKK3sKKwlzdHJ1Y3QgbWdiNF92aW5fZGV2ICp2aW5k
ZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOworCXN0cnVjdCBtZ2I0X3JlZ3MgKnZpZGVvID0g
JnZpbmRldi0+bWdiZGV2LT52aWRlbzsKKwlpbnQgaXJxID0geGRtYV9nZXRfdXNlcl9pcnEo
dmluZGV2LT5tZ2JkZXYtPnhkZXYsIHZpbmRldi0+Y29uZmlnLT5lcnJfaXJxKTsKKworCXhk
bWFfZGlzYWJsZV91c2VyX2lycSh2aW5kZXYtPm1nYmRldi0+eGRldiwgaXJxKTsKKworCW1n
YjRfd3JpdGVfcmVnKHZpZGVvLCB2aW5kZXYtPmNvbmZpZy0+cmVncy5wYWRkaW5nLCAwKTsK
KwlzZXRfbG9vcGJhY2tfcGFkZGluZyh2aW5kZXYsIDApOworCisJcmV0dXJuIHZiMl9mb3Bf
cmVsZWFzZShmaWxlKTsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCB2NGwyX2ZpbGVfb3Bl
cmF0aW9ucyB2aWRlb19mb3BzID0geworCS5vd25lciA9IFRISVNfTU9EVUxFLAorCS5vcGVu
ID0gZmhfb3BlbiwKKwkucmVsZWFzZSA9IGZoX3JlbGVhc2UsCisJLnVubG9ja2VkX2lvY3Rs
ID0gdmlkZW9faW9jdGwyLAorCS5yZWFkID0gdmIyX2ZvcF9yZWFkLAorCS5tbWFwID0gdmIy
X2ZvcF9tbWFwLAorCS5wb2xsID0gdmIyX2ZvcF9wb2xsLAorfTsKKworc3RhdGljIGludCB2
aWRpb2NfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCisJCQkgICBz
dHJ1Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCit7CisJc3RydWN0IG1nYjRfdmluX2RldiAq
dmluZGV2ID0gdmlkZW9fZHJ2ZGF0YShmaWxlKTsKKworCXN0cnNjcHkoY2FwLT5kcml2ZXIs
IEtCVUlMRF9NT0ROQU1FLCBzaXplb2YoY2FwLT5kcml2ZXIpKTsKKwlzdHJzY3B5KGNhcC0+
Y2FyZCwgIk1HQjQgUENJZSBDYXJkIiwgc2l6ZW9mKGNhcC0+Y2FyZCkpOworCXNucHJpbnRm
KGNhcC0+YnVzX2luZm8sIHNpemVvZihjYXAtPmJ1c19pbmZvKSwgIlBDSTolcyIsCisJICBw
Y2lfbmFtZSh2aW5kZXYtPm1nYmRldi0+cGRldikpOworCisJcmV0dXJuIDA7Cit9CisKK3N0
YXRpYyBpbnQgdmlkaW9jX2VudW1fZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2
LAorCQkJICAgc3RydWN0IHY0bDJfZm10ZGVzYyAqZikKK3sKKwlpZiAoZi0+aW5kZXggIT0g
MCkKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwlmLT5waXhlbGZvcm1hdCA9IFY0TDJfUElYX0ZN
VF9BQkdSMzI7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCB2aWRpb2NfZW51bV9m
cmFtZWludGVydmFscyhzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKKwkJCQkgICAg
ICBzdHJ1Y3QgdjRsMl9mcm1pdmFsZW51bSAqaXZhbCkKK3sKKwlzdHJ1Y3QgbWdiNF92aW5f
ZGV2ICp2aW5kZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOworCisJaWYgKGl2YWwtPmluZGV4
ICE9IDApCisJCXJldHVybiAtRUlOVkFMOworCWlmIChpdmFsLT5waXhlbF9mb3JtYXQgIT0g
VjRMMl9QSVhfRk1UX0FCR1IzMikKKwkJcmV0dXJuIC1FSU5WQUw7CisJaWYgKGl2YWwtPndp
ZHRoICE9IHZpbmRldi0+d2lkdGggfHwgaXZhbC0+aGVpZ2h0ICE9IHZpbmRldi0+aGVpZ2h0
KQorCQlyZXR1cm4gLUVJTlZBTDsKKworCWl2YWwtPnR5cGUgPSBWNEwyX0ZSTUlWQUxfVFlQ
RV9ESVNDUkVURTsKKwlpdmFsLT5kaXNjcmV0ZS5udW1lcmF0b3IgPSB2aW5kZXYtPnBlcmlv
ZDsKKwlpdmFsLT5kaXNjcmV0ZS5kZW5vbWluYXRvciA9IDEyNTAwMDAwMDsKKworCXJldHVy
biAwOworfQorCitzdGF0aWMgaW50IHZpZGlvY19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikKK3sKKwlzdHJ1Y3QgbWdiNF92aW5f
ZGV2ICp2aW5kZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOworCisJZi0+Zm10LnBpeC5waXhl
bGZvcm1hdCA9IFY0TDJfUElYX0ZNVF9BQkdSMzI7CisJZi0+Zm10LnBpeC53aWR0aCA9IHZp
bmRldi0+d2lkdGg7CisJZi0+Zm10LnBpeC5oZWlnaHQgPSB2aW5kZXYtPmhlaWdodDsKKwlm
LT5mbXQucGl4LmZpZWxkID0gVjRMMl9GSUVMRF9OT05FOworCWYtPmZtdC5waXguY29sb3Jz
cGFjZSA9IFY0TDJfQ09MT1JTUEFDRV9SQVc7CisJZi0+Zm10LnBpeC5ieXRlc3BlcmxpbmUg
PSBCWVRFU1BFUkxJTkUodmluZGV2LT53aWR0aCwgdmluZGV2LT5hbGlnbm1lbnQpOworCWYt
PmZtdC5waXguc2l6ZWltYWdlID0gZi0+Zm10LnBpeC5ieXRlc3BlcmxpbmUgKiBmLT5mbXQu
cGl4LmhlaWdodDsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IHZpZGlvY19lbnVt
X2lucHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorCQkJICAgICBzdHJ1Y3Qg
djRsMl9pbnB1dCAqaSkKK3sKKwlpZiAoaS0+aW5kZXggIT0gMCkKKwkJcmV0dXJuIC1FSU5W
QUw7CisKKwlpLT50eXBlID0gVjRMMl9JTlBVVF9UWVBFX0NBTUVSQTsKKwlzdHJzY3B5KGkt
Pm5hbWUsICJNR0I0Iiwgc2l6ZW9mKGktPm5hbWUpKTsKKworCXJldHVybiAwOworfQorCitz
dGF0aWMgaW50IHZpZGlvY19lbnVtX2ZyYW1lc2l6ZXMoc3RydWN0IGZpbGUgKmZpbGUsIHZv
aWQgKmZoLAorCQkJCSAgc3RydWN0IHY0bDJfZnJtc2l6ZWVudW0gKmZzaXplKQoreworCXN0
cnVjdCBtZ2I0X3Zpbl9kZXYgKnZpbmRldiA9IHZpZGVvX2RydmRhdGEoZmlsZSk7CisKKwlp
ZiAoZnNpemUtPmluZGV4ICE9IDAgfHwgZnNpemUtPnBpeGVsX2Zvcm1hdCAhPSBWNEwyX1BJ
WF9GTVRfQUJHUjMyKQorCQlyZXR1cm4gLUVJTlZBTDsKKworCWZzaXplLT5kaXNjcmV0ZS53
aWR0aCA9IHZpbmRldi0+d2lkdGg7CisJZnNpemUtPmRpc2NyZXRlLmhlaWdodCA9IHZpbmRl
di0+aGVpZ2h0OworCWZzaXplLT50eXBlID0gVjRMMl9GUk1TSVpFX1RZUEVfRElTQ1JFVEU7
CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCB2aWRpb2Nfc19pbnB1dChzdHJ1Y3Qg
ZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwgdW5zaWduZWQgaW50IGkpCit7CisJcmV0dXJuIChp
ID09IDApID8gMCA6IC1FSU5WQUw7Cit9CisKK3N0YXRpYyBpbnQgdmlkaW9jX2dfaW5wdXQo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHVuc2lnbmVkIGludCAqaSkKK3sKKwkq
aSA9IDA7CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgdmlkaW9jX3F1ZXJ5Y3RybChz
dHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqcHJpdiwKKwkJCSAgICBzdHJ1Y3QgdjRsMl9xdWVy
eWN0cmwgKnFjKQoreworCXJldHVybiAtRUlOVkFMOworfQorCitzdGF0aWMgaW50IHZpZGlv
Y19wYXJtKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpwcml2LAorCQkJIHN0cnVjdCB2NGwy
X3N0cmVhbXBhcm0gKnBhcm0pCit7CisJc3RydWN0IG1nYjRfdmluX2RldiAqdmluZGV2ID0g
dmlkZW9fZHJ2ZGF0YShmaWxlKTsKKwlzdHJ1Y3QgdjRsMl9mcmFjdCB0aW1lcGVyZnJhbWUg
PSB7CisJCS5udW1lcmF0b3IgPSB2aW5kZXYtPnBlcmlvZCwKKwkJLmRlbm9taW5hdG9yID0g
MTI1MDAwMDAwLAorCX07CisKKwlpZiAocGFybS0+dHlwZSAhPSBWNEwyX0JVRl9UWVBFX1ZJ
REVPX0NBUFRVUkUpCisJCXJldHVybiAtRUlOVkFMOworCisJcGFybS0+cGFybS5jYXB0dXJl
LnJlYWRidWZmZXJzID0gMjsKKwlwYXJtLT5wYXJtLmNhcHR1cmUuY2FwYWJpbGl0eSA9IFY0
TDJfQ0FQX1RJTUVQRVJGUkFNRTsKKwlwYXJtLT5wYXJtLmNhcHR1cmUudGltZXBlcmZyYW1l
ID0gdGltZXBlcmZyYW1lOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1
Y3QgdjRsMl9pb2N0bF9vcHMgdmlkZW9faW9jdGxfb3BzID0geworCS52aWRpb2NfcXVlcnlj
YXAgPSB2aWRpb2NfcXVlcnljYXAsCisJLnZpZGlvY19lbnVtX2ZtdF92aWRfY2FwID0gdmlk
aW9jX2VudW1fZm10LAorCS52aWRpb2NfdHJ5X2ZtdF92aWRfY2FwID0gdmlkaW9jX2ZtdCwK
KwkudmlkaW9jX3NfZm10X3ZpZF9jYXAgPSB2aWRpb2NfZm10LAorCS52aWRpb2NfZ19mbXRf
dmlkX2NhcCA9IHZpZGlvY19mbXQsCisJLnZpZGlvY19lbnVtX2ZyYW1lc2l6ZXMgPSB2aWRp
b2NfZW51bV9mcmFtZXNpemVzLAorCS52aWRpb2NfZW51bV9mcmFtZWludGVydmFscyA9IHZp
ZGlvY19lbnVtX2ZyYW1laW50ZXJ2YWxzLAorCS52aWRpb2NfZW51bV9pbnB1dCA9IHZpZGlv
Y19lbnVtX2lucHV0LAorCS52aWRpb2NfZ19pbnB1dCA9IHZpZGlvY19nX2lucHV0LAorCS52
aWRpb2Nfc19pbnB1dCA9IHZpZGlvY19zX2lucHV0LAorCS52aWRpb2NfcXVlcnljdHJsID0g
dmlkaW9jX3F1ZXJ5Y3RybCwKKwkudmlkaW9jX3JlcWJ1ZnMgPSB2YjJfaW9jdGxfcmVxYnVm
cywKKwkudmlkaW9jX2NyZWF0ZV9idWZzID0gdmIyX2lvY3RsX2NyZWF0ZV9idWZzLAorCS52
aWRpb2NfcXVlcnlidWYgPSB2YjJfaW9jdGxfcXVlcnlidWYsCisJLnZpZGlvY19xYnVmID0g
dmIyX2lvY3RsX3FidWYsCisJLnZpZGlvY19kcWJ1ZiA9IHZiMl9pb2N0bF9kcWJ1ZiwKKwku
dmlkaW9jX2V4cGJ1ZiA9IHZiMl9pb2N0bF9leHBidWYsCisJLnZpZGlvY19zdHJlYW1vbiA9
IHZiMl9pb2N0bF9zdHJlYW1vbiwKKwkudmlkaW9jX3N0cmVhbW9mZiA9IHZiMl9pb2N0bF9z
dHJlYW1vZmYsCisJLnZpZGlvY19nX3Bhcm0gPSB2aWRpb2NfcGFybSwKKwkudmlkaW9jX3Nf
cGFybSA9IHZpZGlvY19wYXJtCit9OworCitzdGF0aWMgdm9pZCBkbWFfdHJhbnNmZXIoc3Ry
dWN0IHdvcmtfc3RydWN0ICp3b3JrKQoreworCXN0cnVjdCBtZ2I0X3Zpbl9kZXYgKnZpbmRl
diA9IGNvbnRhaW5lcl9vZih3b3JrLCBzdHJ1Y3QgbWdiNF92aW5fZGV2LCBkbWFfd29yayk7
CisJc3RydWN0IGRldmljZSAqZGV2ID0gJnZpbmRldi0+bWdiZGV2LT5wZGV2LT5kZXY7CisJ
c3RydWN0IGZyYW1lX2J1ZmZlciAqYnVmID0gMDsKKwl1bnNpZ25lZCBsb25nIGZsYWdzOwor
CXUzMiBhZGRyOworCisKKwlzcGluX2xvY2tfaXJxc2F2ZSgmdmluZGV2LT5xbG9jaywgZmxh
Z3MpOworCWlmICghbGlzdF9lbXB0eSgmdmluZGV2LT5idWZfbGlzdCkpIHsKKwkJYnVmID0g
bGlzdF9maXJzdF9lbnRyeSgmdmluZGV2LT5idWZfbGlzdCwgc3RydWN0IGZyYW1lX2J1ZmZl
ciwgbGlzdCk7CisJCWxpc3RfZGVsX2luaXQodmluZGV2LT5idWZfbGlzdC5uZXh0KTsKKwl9
CisJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmdmluZGV2LT5xbG9jaywgZmxhZ3MpOworCisJ
aWYgKCFidWYpCisJCXJldHVybjsKKworCisJYWRkciA9IG1nYjRfcmVhZF9yZWcoJnZpbmRl
di0+bWdiZGV2LT52aWRlbywgdmluZGV2LT5jb25maWctPnJlZ3MuYWRkcmVzcyk7CisJaWYg
KGFkZHIgPj0gRVJSX1FVRVVFX0ZVTEwpIHsKKwkJZGV2X3dhcm4oZGV2LCAiZnJhbWUgcXVl
dWUgZXJyb3IgKCVkKVxuIiwgKGludClhZGRyKTsKKwkJdmIyX2J1ZmZlcl9kb25lKCZidWYt
PnZiLnZiMl9idWYsIFZCMl9CVUZfU1RBVEVfRVJST1IpOworCQlyZXR1cm47CisJfQorCisJ
aWYgKG1nYjRfZG1hX3RyYW5zZmVyKHZpbmRldi0+bWdiZGV2LCB2aW5kZXYtPmNvbmZpZy0+
ZG1hX2NoYW5uZWwsCisJICBmYWxzZSwgYWRkciwgdmIyX2RtYV9zZ19wbGFuZV9kZXNjKCZi
dWYtPnZiLnZiMl9idWYsIDApKSA8IDApIHsKKwkJZGV2X3dhcm4oZGV2LCAiRE1BIHRyYW5z
ZmVyIGVycm9yXG4iKTsKKwkJdmIyX2J1ZmZlcl9kb25lKCZidWYtPnZiLnZiMl9idWYsIFZC
Ml9CVUZfU1RBVEVfRVJST1IpOworCX0gZWxzZSB7CisJCWJ1Zi0+dmIudmIyX2J1Zi50aW1l
c3RhbXAgPSBrdGltZV9nZXRfbnMoKTsKKwkJYnVmLT52Yi5zZXF1ZW5jZSA9IHZpbmRldi0+
c2VxdWVuY2UrKzsKKwkJYnVmLT52Yi5maWVsZCA9IFY0TDJfRklFTERfTk9ORTsKKwkJdmIy
X2J1ZmZlcl9kb25lKCZidWYtPnZiLnZiMl9idWYsIFZCMl9CVUZfU1RBVEVfRE9ORSk7CisJ
fQorfQorCitzdGF0aWMgaXJxcmV0dXJuX3QgdmluX2hhbmRsZXIoaW50IGlycSwgdm9pZCAq
Y3R4KQoreworCXN0cnVjdCBtZ2I0X3Zpbl9kZXYgKnZpbmRldiA9IChzdHJ1Y3QgbWdiNF92
aW5fZGV2ICopY3R4OworCisJc2NoZWR1bGVfd29yaygmdmluZGV2LT5kbWFfd29yayk7CisK
KwltZ2I0X3dyaXRlX3JlZygmdmluZGV2LT5tZ2JkZXYtPnZpZGVvLCAweEI0LCAxVTw8dmlu
ZGV2LT5jb25maWctPnZpbl9pcnEpOworCisJcmV0dXJuIElSUV9IQU5ETEVEOworfQorCitz
dGF0aWMgaXJxcmV0dXJuX3QgZXJyX2hhbmRsZXIoaW50IGlycSwgdm9pZCAqY3R4KQorewor
CXN0cnVjdCBtZ2I0X3Zpbl9kZXYgKnZpbmRldiA9IChzdHJ1Y3QgbWdiNF92aW5fZGV2ICop
Y3R4OworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZ2aW5kZXYtPm1nYmRldi0+cGRldi0+ZGV2
OworCXN0cnVjdCB2YjJfcXVldWUgKnZxID0gJih2aW5kZXYtPnF1ZXVlKTsKKworCXUzMiBy
ZXNvbHV0aW9uID0gbWdiNF9yZWFkX3JlZygmdmluZGV2LT5tZ2JkZXYtPnZpZGVvLAorCSAg
dmluZGV2LT5jb25maWctPnJlZ3MucmVzb2x1dGlvbik7CisKKwlpZiAoKHZpbmRldi0+d2lk
dGggIT0gKHJlc29sdXRpb24gPj4gMTYpKQorCSAgfHwgKHZpbmRldi0+aGVpZ2h0ICE9IChy
ZXNvbHV0aW9uICYgMHhGRkZGKSkpIHsKKwkJZGV2X3dhcm4oZGV2LCAic3RyZWFtIGNoYW5n
ZWQgKCV1eCV1IC0+ICV1eCV1KVxuIiwKKwkJCSB2aW5kZXYtPndpZHRoLCB2aW5kZXYtPmhl
aWdodCwgcmVzb2x1dGlvbj4+MTYsCisJCQkgcmVzb2x1dGlvbiAmIDB4RkZGRik7CisKKwkJ
aWYgKHZiMl9pc19zdHJlYW1pbmcodnEpKSB7CisJCQlyZXR1cm5fYWxsX2J1ZmZlcnModmlu
ZGV2LCBWQjJfQlVGX1NUQVRFX0VSUk9SKTsKKwkJCXZiMl9xdWV1ZV9lcnJvcih2cSk7CisJ
CX0KKwl9CisKKwltZ2I0X3dyaXRlX3JlZygmdmluZGV2LT5tZ2JkZXYtPnZpZGVvLCAweEI0
LCAxVTw8dmluZGV2LT5jb25maWctPmVycl9pcnEpOworCisJcmV0dXJuIElSUV9IQU5ETEVE
OworfQorCitzdGF0aWMgaW50IGRlc2VyX2luaXQoc3RydWN0IG1nYjRfdmluX2RldiAqdmlu
ZGV2LCBpbnQgaWQpCit7CisJaW50IHJ2LCBhZGRyX3NpemU7CisJc2l6ZV90IHZhbHVlc19j
b3VudDsKKwljb25zdCBzdHJ1Y3QgbWdiNF9pMmNfa3YgKnZhbHVlczsKKwljb25zdCBzdHJ1
Y3QgaTJjX2JvYXJkX2luZm8gKmluZm87CisJc3RydWN0IGRldmljZSAqZGV2ID0gJnZpbmRl
di0+bWdiZGV2LT5wZGV2LT5kZXY7CisKKworCWlmIChNR0I0X0lTX0dNU0wodmluZGV2LT5t
Z2JkZXYpKSB7CisJCWluZm8gPSAmZ21zbF9kZXNlcl9pbmZvW2lkXTsKKwkJYWRkcl9zaXpl
ID0gMTY7CisJCXZhbHVlcyA9IGdtc2xfaTJjOworCQl2YWx1ZXNfY291bnQgPSBBUlJBWV9T
SVpFKGdtc2xfaTJjKTsKKwl9IGVsc2UgeworCQlpbmZvID0gJmZwZGwzX2Rlc2VyX2luZm9b
aWRdOworCQlhZGRyX3NpemUgPSA4OworCQl2YWx1ZXMgPSBmcGRsM19pMmM7CisJCXZhbHVl
c19jb3VudCA9IEFSUkFZX1NJWkUoZnBkbDNfaTJjKTsKKwl9CisKKwlydiA9IG1nYjRfaTJj
X2luaXQoJnZpbmRldi0+ZGVzZXIsIHZpbmRldi0+bWdiZGV2LT5pMmNfYWRhcCwgaW5mbywg
YWRkcl9zaXplKTsKKwlpZiAocnYgPCAwKSB7CisJCWRldl9lcnIoZGV2LCAiZmFpbGVkIHRv
IGNyZWF0ZSBkZXNlcmlhbGl6ZXJcbiIpOworCQlyZXR1cm4gcnY7CisJfQorCXJ2ID0gbWdi
NF9pMmNfY29uZmlndXJlKCZ2aW5kZXYtPmRlc2VyLCB2YWx1ZXMsIHZhbHVlc19jb3VudCk7
CisJaWYgKHJ2IDwgMCkgeworCQlkZXZfZXJyKGRldiwgImZhaWxlZCB0byBjb25maWd1cmUg
ZGVzZXJpYWxpemVyXG4iKTsKKwkJZ290byBlcnJfaTJjX2RldjsKKwl9CisKKwlyZXR1cm4g
MDsKKworZXJyX2kyY19kZXY6CisJbWdiNF9pMmNfZnJlZSgmdmluZGV2LT5kZXNlcik7CisK
KwlyZXR1cm4gcnY7Cit9CisKK3N0cnVjdCBtZ2I0X3Zpbl9kZXYgKm1nYjRfdmluX2NyZWF0
ZShzdHJ1Y3QgbWdiNF9kZXYgKm1nYmRldiwgaW50IGlkKQoreworCWludCBydjsKKwlzdHJ1
Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqKmF0dHIsICoqbW9kdWxlX2F0dHI7CisJc3RydWN0IG1n
YjRfdmluX2RldiAqdmluZGV2OworCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gbWdiZGV2LT5w
ZGV2OworCXN0cnVjdCBkZXZpY2UgKmRldiA9ICZwZGV2LT5kZXY7CisJaW50IHZpbl9pcnEs
IGVycl9pcnE7CisKKwl2aW5kZXYgPSBremFsbG9jKHNpemVvZihzdHJ1Y3QgbWdiNF92aW5f
ZGV2KSwgR0ZQX0tFUk5FTCk7CisJaWYgKCF2aW5kZXYpCisJCXJldHVybiBOVUxMOworCisJ
dmluZGV2LT5tZ2JkZXYgPSBtZ2JkZXY7CisJdmluZGV2LT5jb25maWcgPSAmKHZpbl9jZmdb
aWRdKTsKKworCS8qIEZyYW1lIHF1ZXVlKi8KKwlJTklUX0xJU1RfSEVBRCgmdmluZGV2LT5i
dWZfbGlzdCk7CisJc3Bpbl9sb2NrX2luaXQoJnZpbmRldi0+cWxvY2spOworCisJLyogRE1B
IHRyYW5zZmVyIHN0dWZmICovCisJSU5JVF9XT1JLKCZ2aW5kZXYtPmRtYV93b3JrLCBkbWFf
dHJhbnNmZXIpOworCisJLyogSVJRIGNhbGxiYWNrICovCisJdmluX2lycSA9IHhkbWFfZ2V0
X3VzZXJfaXJxKG1nYmRldi0+eGRldiwgdmluZGV2LT5jb25maWctPnZpbl9pcnEpOworCXJ2
ID0gcmVxdWVzdF9pcnEodmluX2lycSwgdmluX2hhbmRsZXIsIDAsICJtZ2I0LXZpbiIsIHZp
bmRldik7CisJaWYgKHJ2KSB7CisJCWRldl9lcnIoZGV2LCAiZmFpbGVkIHRvIHJlZ2lzdGVy
IHZpbiBpcnEgaGFuZGxlclxuIik7CisJCWdvdG8gZXJyX2FsbG9jOworCX0KKwkvKiBFcnJv
ciBJUlEgY2FsbGJhY2sgKi8KKwllcnJfaXJxID0geGRtYV9nZXRfdXNlcl9pcnEobWdiZGV2
LT54ZGV2LCB2aW5kZXYtPmNvbmZpZy0+ZXJyX2lycSk7CisJcnYgPSByZXF1ZXN0X2lycShl
cnJfaXJxLCBlcnJfaGFuZGxlciwgMCwgIm1nYjQtZXJyIiwgdmluZGV2KTsKKwlpZiAocnYp
IHsKKwkJZGV2X2VycihkZXYsICJmYWlsZWQgdG8gcmVnaXN0ZXIgZXJyIGlycSBoYW5kbGVy
XG4iKTsKKwkJZ290byBlcnJfdmluX2lycTsKKwl9CisKKwkvKiBWNEwyICovCisJcnYgPSB2
NGwyX2RldmljZV9yZWdpc3RlcihkZXYsICZ2aW5kZXYtPnY0bDJkZXYpOworCWlmIChydikg
eworCQlkZXZfZXJyKGRldiwgImZhaWxlZCB0byByZWdpc3RlciB2NGwyIGRldmljZVxuIik7
CisJCWdvdG8gZXJyX2Vycl9pcnE7CisJfQorCisJbXV0ZXhfaW5pdCgmdmluZGV2LT5sb2Nr
KTsKKworCXZpbmRldi0+cXVldWUudHlwZSA9IFY0TDJfQlVGX1RZUEVfVklERU9fQ0FQVFVS
RTsKKwl2aW5kZXYtPnF1ZXVlLmlvX21vZGVzID0gVkIyX01NQVAgfCBWQjJfVVNFUlBUUiB8
IFZCMl9ETUFCVUYgfCBWQjJfUkVBRDsKKwl2aW5kZXYtPnF1ZXVlLmJ1Zl9zdHJ1Y3Rfc2l6
ZSA9IHNpemVvZihzdHJ1Y3QgZnJhbWVfYnVmZmVyKTsKKwl2aW5kZXYtPnF1ZXVlLm9wcyA9
ICZxdWV1ZV9vcHM7CisJdmluZGV2LT5xdWV1ZS5tZW1fb3BzID0gJnZiMl9kbWFfc2dfbWVt
b3BzOworCXZpbmRldi0+cXVldWUuZ2ZwX2ZsYWdzID0gR0ZQX0RNQTMyOworCXZpbmRldi0+
cXVldWUudGltZXN0YW1wX2ZsYWdzID0gVjRMMl9CVUZfRkxBR19USU1FU1RBTVBfTU9OT1RP
TklDOworCXZpbmRldi0+cXVldWUubWluX2J1ZmZlcnNfbmVlZGVkID0gMjsKKwl2aW5kZXYt
PnF1ZXVlLmRydl9wcml2ID0gdmluZGV2OworCXZpbmRldi0+cXVldWUubG9jayA9ICZ2aW5k
ZXYtPmxvY2s7CisJdmluZGV2LT5xdWV1ZS5kZXYgPSBkZXY7CisJcnYgPSB2YjJfcXVldWVf
aW5pdCgmdmluZGV2LT5xdWV1ZSk7CisJaWYgKHJ2KSB7CisJCWRldl9lcnIoZGV2LCAiZmFp
bGVkIHRvIGluaXRpYWxpemUgdmIyIHF1ZXVlXG4iKTsKKwkJZ290byBlcnJfdjRsMl9kZXY7
CisJfQorCisJc25wcmludGYodmluZGV2LT52ZGV2Lm5hbWUsIHNpemVvZih2aW5kZXYtPnZk
ZXYubmFtZSksICJtZ2I0LWluJWQiLCBpZCsxKTsKKwl2aW5kZXYtPnZkZXYuZGV2aWNlX2Nh
cHMgPSBWNEwyX0NBUF9WSURFT19DQVBUVVJFIHwgVjRMMl9DQVBfUkVBRFdSSVRFCisJICB8
IFY0TDJfQ0FQX1NUUkVBTUlORzsKKwl2aW5kZXYtPnZkZXYuZm9wcyA9ICZ2aWRlb19mb3Bz
OworCXZpbmRldi0+dmRldi5pb2N0bF9vcHMgPSAmdmlkZW9faW9jdGxfb3BzOworCXZpbmRl
di0+dmRldi5yZWxlYXNlID0gdmlkZW9fZGV2aWNlX3JlbGVhc2VfZW1wdHk7CisJdmluZGV2
LT52ZGV2LnY0bDJfZGV2ID0gJnZpbmRldi0+djRsMmRldjsKKwl2aW5kZXYtPnZkZXYubG9j
ayA9ICZ2aW5kZXYtPmxvY2s7CisJdmluZGV2LT52ZGV2LnF1ZXVlID0gJnZpbmRldi0+cXVl
dWU7CisJdmlkZW9fc2V0X2RydmRhdGEoJnZpbmRldi0+dmRldiwgdmluZGV2KTsKKworCXJ2
ID0gdmlkZW9fcmVnaXN0ZXJfZGV2aWNlKCZ2aW5kZXYtPnZkZXYsIFZGTF9UWVBFX0dSQUJC
RVIsIC0xKTsKKwlpZiAocnYpIHsKKwkJZGV2X2VycihkZXYsICJmYWlsZWQgdG8gcmVnaXN0
ZXIgdmlkZW8gZGV2aWNlXG4iKTsKKwkJZ290byBlcnJfdjRsMl9kZXY7CisJfQorCisJLyog
RGVzZXJpYWxpemVyICovCisJcnYgPSBkZXNlcl9pbml0KHZpbmRldiwgaWQpOworCWlmIChy
dikKKwkJZ290byBlcnJfdmlkZW9fZGV2OworCisJLyogU2V0IEZQR0EgcmVncyB0byBjb21w
bHkgd2l0aCB0aGUgZGVzZXJpYWxpemVyIHN0YXRlICovCisJbWdiNF9tYXNrX3JlZygmdmlu
ZGV2LT5tZ2JkZXYtPnZpZGVvLCB2aW5kZXYtPmNvbmZpZy0+cmVncy5jb25maWcsCisJICAx
VTw8OSwgMVU8PDkpOworCisJLyogTW9kdWxlIHN5c2ZzIGF0dHJpYnV0ZXMgKi8KKwl2aW5k
ZXYtPmFsaWdubWVudCA9IDE7CisJbW9kdWxlX2F0dHIgPSBNR0I0X0lTX0dNU0wobWdiZGV2
KQorCSAgPyBtZ2I0X2dtc2xfaW5fYXR0cnMgOiBtZ2I0X2ZwZGwzX2luX2F0dHJzOworCWZv
ciAoYXR0ciA9IG1vZHVsZV9hdHRyOyAqYXR0cjsgYXR0cisrKQorCQlkZXZpY2VfY3JlYXRl
X2ZpbGUoJnZpbmRldi0+dmRldi5kZXYsICphdHRyKTsKKworCXJldHVybiB2aW5kZXY7CisK
K2Vycl92aWRlb19kZXY6CisJdmlkZW9fdW5yZWdpc3Rlcl9kZXZpY2UoJnZpbmRldi0+dmRl
dik7CitlcnJfdjRsMl9kZXY6CisJdjRsMl9kZXZpY2VfdW5yZWdpc3RlcigmdmluZGV2LT52
NGwyZGV2KTsKK2Vycl9lcnJfaXJxOgorCWZyZWVfaXJxKGVycl9pcnEsIHZpbmRldik7Citl
cnJfdmluX2lycToKKwlmcmVlX2lycSh2aW5faXJxLCB2aW5kZXYpOworZXJyX2FsbG9jOgor
CWtmcmVlKHZpbmRldik7CisKKwlyZXR1cm4gTlVMTDsKK30KKwordm9pZCBtZ2I0X3Zpbl9m
cmVlKHN0cnVjdCBtZ2I0X3Zpbl9kZXYgKnZpbmRldikKK3sKKwlzdHJ1Y3QgZGV2aWNlX2F0
dHJpYnV0ZSAqKmF0dHIsICoqbW9kdWxlX2F0dHI7CisJaW50IHZpbl9pcnEgPSB4ZG1hX2dl
dF91c2VyX2lycSh2aW5kZXYtPm1nYmRldi0+eGRldiwKKwkJCQkJdmluZGV2LT5jb25maWct
PnZpbl9pcnEpOworCWludCBlcnJfaXJxID0geGRtYV9nZXRfdXNlcl9pcnEodmluZGV2LT5t
Z2JkZXYtPnhkZXYsCisJCQkJCXZpbmRldi0+Y29uZmlnLT5lcnJfaXJxKTsKKworCWZyZWVf
aXJxKHZpbl9pcnEsIHZpbmRldik7CisJZnJlZV9pcnEoZXJyX2lycSwgdmluZGV2KTsKKwor
CW1vZHVsZV9hdHRyID0gTUdCNF9JU19HTVNMKHZpbmRldi0+bWdiZGV2KQorCSAgPyBtZ2I0
X2dtc2xfaW5fYXR0cnMgOiBtZ2I0X2ZwZGwzX2luX2F0dHJzOworCWZvciAoYXR0ciA9IG1v
ZHVsZV9hdHRyOyAqYXR0cjsgYXR0cisrKQorCQlkZXZpY2VfcmVtb3ZlX2ZpbGUoJnZpbmRl
di0+dmRldi5kZXYsICphdHRyKTsKKworCW1nYjRfaTJjX2ZyZWUoJnZpbmRldi0+ZGVzZXIp
OworCXZpZGVvX3VucmVnaXN0ZXJfZGV2aWNlKCZ2aW5kZXYtPnZkZXYpOworCXY0bDJfZGV2
aWNlX3VucmVnaXN0ZXIoJnZpbmRldi0+djRsMmRldik7Cit9CmRpZmYgLS1naXQgYS9kcml2
ZXJzL21lZGlhL3BjaS9tZ2I0L21nYjRfdmluLmggYi9kcml2ZXJzL21lZGlhL3BjaS9tZ2I0
L21nYjRfdmluLmgKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi40
YjAxYjYxYzNmOTAKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL21lZGlhL3BjaS9tZ2I0
L21nYjRfdmluLmgKQEAgLTAsMCArMSw2NCBAQAorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZp
ZXI6IEdQTC0yLjAtb25seSAqLworLyoKKyAqIENvcHlyaWdodCAoQykgMjAyMS0yMDIyIERp
Z2l0ZXEgQXV0b21vdGl2ZQorICogICAgIGF1dGhvcjogTWFydGluIFR1bWEgPG1hcnRpbi50
dW1hQGRpZ2l0ZXFhdXRvbW90aXZlLmNvbT4KKyAqLworCisjaWZuZGVmIF9fTUdCNF9WSU5f
SF9fCisjZGVmaW5lIF9fTUdCNF9WSU5fSF9fCisKKyNpbmNsdWRlIDxtZWRpYS92NGwyLWRl
dmljZS5oPgorI2luY2x1ZGUgPG1lZGlhL3Y0bDItZGV2Lmg+CisjaW5jbHVkZSA8bWVkaWEv
djRsMi1jdHJscy5oPgorI2luY2x1ZGUgPG1lZGlhL3ZpZGVvYnVmMi1jb3JlLmg+CisjaW5j
bHVkZSAibWdiNF9pMmMuaCIKKworc3RydWN0IG1nYjRfdmluX3JlZ3MgeworCXUzMiBhZGRy
ZXNzOworCXUzMiBjb25maWc7CisJdTMyIHN0YXR1czsKKwl1MzIgcmVzb2x1dGlvbjsKKwl1
MzIgZnJhbWVfcGVyaW9kOworCXUzMiBzeW5jOworCXUzMiBwY2xrOworCXUzMiBzaWduYWw7
CisJdTMyIHNpZ25hbDI7CisJdTMyIHBhZGRpbmc7Cit9OworCitzdHJ1Y3QgbWdiNF92aW5f
Y29uZmlnIHsKKwlpbnQgaWQ7CisJaW50IGRtYV9jaGFubmVsOworCWludCB2aW5faXJxOwor
CWludCBlcnJfaXJxOworCXN0cnVjdCBtZ2I0X3Zpbl9yZWdzIHJlZ3M7Cit9OworCitzdHJ1
Y3QgbWdiNF92aW5fZGV2IHsKKwlzdHJ1Y3QgbWdiNF9kZXYgKm1nYmRldjsKKwlzdHJ1Y3Qg
djRsMl9kZXZpY2UgdjRsMmRldjsKKwlzdHJ1Y3QgdmlkZW9fZGV2aWNlIHZkZXY7CisJc3Ry
dWN0IHZiMl9xdWV1ZSBxdWV1ZTsKKwlzdHJ1Y3QgbXV0ZXggbG9jazsKKworCXNwaW5sb2Nr
X3QgcWxvY2s7CisJc3RydWN0IGxpc3RfaGVhZCBidWZfbGlzdDsKKwlzdHJ1Y3Qgd29ya19z
dHJ1Y3QgZG1hX3dvcms7CisKKwl1bnNpZ25lZCBpbnQgc2VxdWVuY2U7CisKKwl1MzIgd2lk
dGg7CisJdTMyIGhlaWdodDsKKwl1MzIgcGVyaW9kOworCXUzMiBmcmVxX3JhbmdlOworCXUz
MiBhbGlnbm1lbnQ7CisKKwlzdHJ1Y3QgbWdiNF9pMmNfY2xpZW50IGRlc2VyOworCisJY29u
c3Qgc3RydWN0IG1nYjRfdmluX2NvbmZpZyAqY29uZmlnOworfTsKKworZXh0ZXJuIHN0cnVj
dCBtZ2I0X3Zpbl9kZXYgKm1nYjRfdmluX2NyZWF0ZShzdHJ1Y3QgbWdiNF9kZXYgKm1nYmRl
diwgaW50IGlkKTsKK2V4dGVybiB2b2lkIG1nYjRfdmluX2ZyZWUoc3RydWN0IG1nYjRfdmlu
X2RldiAqdmluZGV2KTsKKworI2VuZGlmCmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL3Bj
aS9tZ2I0L21nYjRfdm91dC5jIGIvZHJpdmVycy9tZWRpYS9wY2kvbWdiNC9tZ2I0X3ZvdXQu
YwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLmEzMjAyM2Y1Njg0
MQotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvbWVkaWEvcGNpL21nYjQvbWdiNF92b3V0
LmMKQEAgLTAsMCArMSw1MDUgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwt
Mi4wLW9ubHkKKy8qCisgKiBDb3B5cmlnaHQgKEMpIDIwMjEtMjAyMiBEaWdpdGVxIEF1dG9t
b3RpdmUKKyAqICAgICBhdXRob3I6IE1hcnRpbiBUdW1hIDxtYXJ0aW4udHVtYUBkaWdpdGVx
YXV0b21vdGl2ZS5jb20+CisgKi8KKworI2luY2x1ZGUgPGxpbnV4L3BjaS5oPgorI2luY2x1
ZGUgPG1lZGlhL3Y0bDItaW9jdGwuaD4KKyNpbmNsdWRlIDxtZWRpYS92aWRlb2J1ZjItdjRs
Mi5oPgorI2luY2x1ZGUgPG1lZGlhL3ZpZGVvYnVmMi1kbWEtc2cuaD4KKyNpbmNsdWRlIDxs
aW51eC9kbWEvYW1kX3hkbWEuaD4KKyNpbmNsdWRlICJtZ2I0X2NvcmUuaCIKKyNpbmNsdWRl
ICJtZ2I0X2RtYS5oIgorI2luY2x1ZGUgIm1nYjRfc3lzZnMuaCIKKyNpbmNsdWRlICJtZ2I0
X2lvLmgiCisjaW5jbHVkZSAibWdiNF92b3V0LmgiCisKKyNkZWZpbmUgREVGQVVMVF9XSURU
SCAgICAgMTI4MAorI2RlZmluZSBERUZBVUxUX0hFSUdIVCAgICA2NDAKKyNkZWZpbmUgREVG
QVVMVF9QRVJJT0QgICAgKDEyNTAwMDAwMCAvIDYwKQorCitzdGF0aWMgY29uc3Qgc3RydWN0
IG1nYjRfdm91dF9jb25maWcgdm91dF9jZmdbXSA9IHsKKwl7MCwgMCwgOCwgezB4NzgsIDB4
NjAsIDB4NjQsIDB4NjgsIDB4NzQsIDB4NkMsIDB4NzAsIDB4N2N9fSwKKwl7MSwgMSwgOSwg
ezB4OTgsIDB4ODAsIDB4ODQsIDB4ODgsIDB4OTQsIDB4OGMsIDB4OTAsIDB4OWN9fQorfTsK
Kworc3RhdGljIGNvbnN0IHN0cnVjdCBpMmNfYm9hcmRfaW5mbyBmcGRsM19zZXJfaW5mb1td
ID0geworCXtJMkNfQk9BUkRfSU5GTygic2VyaWFsaXplcjEiLCAweDE0KX0sCisJe0kyQ19C
T0FSRF9JTkZPKCJzZXJpYWxpemVyMiIsIDB4MTYpfSwKK307CisKK3N0YXRpYyBjb25zdCBz
dHJ1Y3QgbWdiNF9pMmNfa3YgZnBkbDNfaTJjW10gPSB7CisJezB4MDUsIDB4RkYsIDB4MDR9
LCB7MHgwNiwgMHhGRiwgMHgwMX0sIHsweEMyLCAweEZGLCAweDgwfQorfTsKKworc3RhdGlj
IGludCBxdWV1ZV9zZXR1cChzdHJ1Y3QgdmIyX3F1ZXVlICpxLCB1bnNpZ25lZCBpbnQgKm5i
dWZmZXJzLAorCQkgICAgICAgdW5zaWduZWQgaW50ICpucGxhbmVzLCB1bnNpZ25lZCBpbnQg
c2l6ZXNbXSwKKwkJICAgICAgIHN0cnVjdCBkZXZpY2UgKmFsbG9jX2RldnNbXSkKK3sKKwlz
dHJ1Y3QgbWdiNF92b3V0X2RldiAqdm91dGRldiA9IHZiMl9nZXRfZHJ2X3ByaXYocSk7CisJ
dW5zaWduZWQgbG9uZyBzaXplID0gQllURVNQRVJMSU5FKHZvdXRkZXYtPndpZHRoLCB2b3V0
ZGV2LT5hbGlnbm1lbnQpCisJICAqIHZvdXRkZXYtPmhlaWdodDsKKworCWlmICgqbmJ1ZmZl
cnMgPCAyKQorCQkqbmJ1ZmZlcnMgPSAyOworCisJaWYgKCpucGxhbmVzKQorCQlyZXR1cm4g
c2l6ZXNbMF0gPCBzaXplID8gLUVJTlZBTCA6IDA7CisJKm5wbGFuZXMgPSAxOworCXNpemVz
WzBdID0gc2l6ZTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IGJ1ZmZlcl9pbml0
KHN0cnVjdCB2YjJfYnVmZmVyICp2YikKK3sKKwlzdHJ1Y3QgdmIyX3Y0bDJfYnVmZmVyICp2
YnVmID0gdG9fdmIyX3Y0bDJfYnVmZmVyKHZiKTsKKwlzdHJ1Y3QgZnJhbWVfYnVmZmVyICpi
dWYgPSB0b19mcmFtZV9idWZmZXIodmJ1Zik7CisKKwlJTklUX0xJU1RfSEVBRCgmYnVmLT5s
aXN0KTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IGJ1ZmZlcl9wcmVwYXJlKHN0
cnVjdCB2YjJfYnVmZmVyICp2YikKK3sKKwlzdHJ1Y3QgbWdiNF92b3V0X2RldiAqdm91dGRl
diA9IHZiMl9nZXRfZHJ2X3ByaXYodmItPnZiMl9xdWV1ZSk7CisJc3RydWN0IGRldmljZSAq
ZGV2ID0gJnZvdXRkZXYtPm1nYmRldi0+cGRldi0+ZGV2OworCXVuc2lnbmVkIGxvbmcgc2l6
ZSA9IEJZVEVTUEVSTElORSh2b3V0ZGV2LT53aWR0aCwgdm91dGRldi0+YWxpZ25tZW50KQor
CSAgKiB2b3V0ZGV2LT5oZWlnaHQ7CisKKwlpZiAodmIyX3BsYW5lX3NpemUodmIsIDApIDwg
c2l6ZSkgeworCQlkZXZfZXJyKGRldiwgImJ1ZmZlciB0b28gc21hbGwgKCVsdSA8ICVsdSlc
biIsCisJCQl2YjJfcGxhbmVfc2l6ZSh2YiwgMCksIHNpemUpOworCQlyZXR1cm4gLUVJTlZB
TDsKKwl9CisKKwl2YjJfc2V0X3BsYW5lX3BheWxvYWQodmIsIDAsIHNpemUpOworCisJcmV0
dXJuIDA7Cit9CisKK3N0YXRpYyB2b2lkIGJ1ZmZlcl9xdWV1ZShzdHJ1Y3QgdmIyX2J1ZmZl
ciAqdmIpCit7CisJc3RydWN0IG1nYjRfdm91dF9kZXYgKnZpbmRldiA9IHZiMl9nZXRfZHJ2
X3ByaXYodmItPnZiMl9xdWV1ZSk7CisJc3RydWN0IHZiMl92NGwyX2J1ZmZlciAqdmJ1ZiA9
IHRvX3ZiMl92NGwyX2J1ZmZlcih2Yik7CisJc3RydWN0IGZyYW1lX2J1ZmZlciAqYnVmID0g
dG9fZnJhbWVfYnVmZmVyKHZidWYpOworCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CisKKwlzcGlu
X2xvY2tfaXJxc2F2ZSgmdmluZGV2LT5xbG9jaywgZmxhZ3MpOworCWxpc3RfYWRkX3RhaWwo
JmJ1Zi0+bGlzdCwgJnZpbmRldi0+YnVmX2xpc3QpOworCXNwaW5fdW5sb2NrX2lycXJlc3Rv
cmUoJnZpbmRldi0+cWxvY2ssIGZsYWdzKTsKK30KKworc3RhdGljIHZvaWQgc3RvcF9zdHJl
YW1pbmcoc3RydWN0IHZiMl9xdWV1ZSAqdnEpCit7CisJc3RydWN0IG1nYjRfdm91dF9kZXYg
KnZvdXRkZXYgPSB2YjJfZ2V0X2Rydl9wcml2KHZxKTsKKwlzdHJ1Y3QgZnJhbWVfYnVmZmVy
ICpidWYsICpub2RlOworCWludCBpcnEgPSB4ZG1hX2dldF91c2VyX2lycSh2b3V0ZGV2LT5t
Z2JkZXYtPnhkZXYsIHZvdXRkZXYtPmNvbmZpZy0+aXJxKTsKKwl1bnNpZ25lZCBsb25nIGZs
YWdzOworCisJeGRtYV9kaXNhYmxlX3VzZXJfaXJxKHZvdXRkZXYtPm1nYmRldi0+eGRldiwg
aXJxKTsKKworCWNhbmNlbF93b3JrX3N5bmMoJnZvdXRkZXYtPmRtYV93b3JrKTsKKworCW1n
YjRfbWFza19yZWcoJnZvdXRkZXYtPm1nYmRldi0+dmlkZW8sIHZvdXRkZXYtPmNvbmZpZy0+
cmVncy5jb25maWcsCisJICAweDIsIDB4MCk7CisKKwlzcGluX2xvY2tfaXJxc2F2ZSgmdm91
dGRldi0+cWxvY2ssIGZsYWdzKTsKKwlsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUoYnVmLCBu
b2RlLCAmdm91dGRldi0+YnVmX2xpc3QsIGxpc3QpIHsKKwkJdmIyX2J1ZmZlcl9kb25lKCZi
dWYtPnZiLnZiMl9idWYsIFZCMl9CVUZfU1RBVEVfRVJST1IpOworCQlsaXN0X2RlbCgmYnVm
LT5saXN0KTsKKwl9CisJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmdm91dGRldi0+cWxvY2ss
IGZsYWdzKTsKK30KKworc3RhdGljIGludCBzdGFydF9zdHJlYW1pbmcoc3RydWN0IHZiMl9x
dWV1ZSAqdnEsIHVuc2lnbmVkIGludCBjb3VudCkKK3sKKwlzdHJ1Y3QgbWdiNF92b3V0X2Rl
diAqdm91dGRldiA9IHZiMl9nZXRfZHJ2X3ByaXYodnEpOworCXN0cnVjdCBkZXZpY2UgKmRl
diA9ICZ2b3V0ZGV2LT5tZ2JkZXYtPnBkZXYtPmRldjsKKwlzdHJ1Y3QgZnJhbWVfYnVmZmVy
ICpidWYgPSAwOworCXN0cnVjdCBtZ2I0X3JlZ3MgKnZpZGVvID0gJnZvdXRkZXYtPm1nYmRl
di0+dmlkZW87CisJaW50IGlycSA9IHhkbWFfZ2V0X3VzZXJfaXJxKHZvdXRkZXYtPm1nYmRl
di0+eGRldiwgdm91dGRldi0+Y29uZmlnLT5pcnEpOworCXUzMiBhZGRyOworCisJbWdiNF9t
YXNrX3JlZyh2aWRlbywgdm91dGRldi0+Y29uZmlnLT5yZWdzLmNvbmZpZywgMHgyLCAweDIp
OworCisJYWRkciA9IG1nYjRfcmVhZF9yZWcodmlkZW8sIHZvdXRkZXYtPmNvbmZpZy0+cmVn
cy5hZGRyZXNzKTsKKwlpZiAoYWRkciA+PSBFUlJfUVVFVUVfRlVMTCkgeworCQlkZXZfZXJy
KGRldiwgImZyYW1lIHF1ZXVlIGVycm9yICglZClcbiIsIChpbnQpYWRkcik7CisJCXJldHVy
biAtRUlPOworCX0KKworCWlmICghbGlzdF9lbXB0eSgmdm91dGRldi0+YnVmX2xpc3QpKSB7
CisJCWJ1ZiA9IGxpc3RfZmlyc3RfZW50cnkoJnZvdXRkZXYtPmJ1Zl9saXN0LCBzdHJ1Y3Qg
ZnJhbWVfYnVmZmVyLCBsaXN0KTsKKwkJbGlzdF9kZWxfaW5pdCh2b3V0ZGV2LT5idWZfbGlz
dC5uZXh0KTsKKwl9CisJaWYgKCFidWYpIHsKKwkJZGV2X2VycihkZXYsICJlbXB0eSB2NGwy
IHF1ZXVlXG4iKTsKKwkJcmV0dXJuIC1FSU87CisJfQorCisJaWYgKG1nYjRfZG1hX3RyYW5z
ZmVyKHZvdXRkZXYtPm1nYmRldiwgdm91dGRldi0+Y29uZmlnLT5kbWFfY2hhbm5lbCwKKwkg
IHRydWUsIGFkZHIsIHZiMl9kbWFfc2dfcGxhbmVfZGVzYygmYnVmLT52Yi52YjJfYnVmLCAw
KSkgPCAwKSB7CisJCWRldl93YXJuKGRldiwgIkRNQSB0cmFuc2ZlciBlcnJvclxuIik7CisJ
CXZiMl9idWZmZXJfZG9uZSgmYnVmLT52Yi52YjJfYnVmLCBWQjJfQlVGX1NUQVRFX0VSUk9S
KTsKKwl9IGVsc2UgeworCQl2YjJfYnVmZmVyX2RvbmUoJmJ1Zi0+dmIudmIyX2J1ZiwgVkIy
X0JVRl9TVEFURV9ET05FKTsKKwl9CisKKwl4ZG1hX2VuYWJsZV91c2VyX2lycSh2b3V0ZGV2
LT5tZ2JkZXYtPnhkZXYsIGlycSk7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGNvbnN0
IHN0cnVjdCB2YjJfb3BzIHF1ZXVlX29wcyA9IHsKKwkucXVldWVfc2V0dXAgPSBxdWV1ZV9z
ZXR1cCwKKwkuYnVmX2luaXQgPSBidWZmZXJfaW5pdCwKKwkuYnVmX3ByZXBhcmUgPSBidWZm
ZXJfcHJlcGFyZSwKKwkuYnVmX3F1ZXVlID0gYnVmZmVyX3F1ZXVlLAorCS5zdGFydF9zdHJl
YW1pbmcgPSBzdGFydF9zdHJlYW1pbmcsCisJLnN0b3Bfc3RyZWFtaW5nID0gc3RvcF9zdHJl
YW1pbmcsCisJLndhaXRfcHJlcGFyZSA9IHZiMl9vcHNfd2FpdF9wcmVwYXJlLAorCS53YWl0
X2ZpbmlzaCA9IHZiMl9vcHNfd2FpdF9maW5pc2gKK307CisKKworc3RhdGljIGludCB2aWRp
b2NfcXVlcnljYXAoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCisJCQkgICBzdHJ1
Y3QgdjRsMl9jYXBhYmlsaXR5ICpjYXApCit7CisJc3RydWN0IG1nYjRfdm91dF9kZXYgKnZv
dXRkZXYgPSB2aWRlb19kcnZkYXRhKGZpbGUpOworCisJc3Ryc2NweShjYXAtPmRyaXZlciwg
S0JVSUxEX01PRE5BTUUsIHNpemVvZihjYXAtPmRyaXZlcikpOworCXN0cnNjcHkoY2FwLT5j
YXJkLCAiTUdCNCBQQ0llIENhcmQiLCBzaXplb2YoY2FwLT5jYXJkKSk7CisJc25wcmludGYo
Y2FwLT5idXNfaW5mbywgc2l6ZW9mKGNhcC0+YnVzX2luZm8pLCAiUENJOiVzIiwKKwkgIHBj
aV9uYW1lKHZvdXRkZXYtPm1nYmRldi0+cGRldikpOworCisJcmV0dXJuIDA7Cit9CisKKwor
c3RhdGljIGludCB2aWRpb2NfZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsCisJCQkgICBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQoreworCWlmIChmLT5pbmRleCAh
PSAwKQorCQlyZXR1cm4gLUVJTlZBTDsKKworCWYtPnBpeGVsZm9ybWF0ID0gVjRMMl9QSVhf
Rk1UX0FCR1IzMjsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IHZpZGlvY19mbXQo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikK
K3sKKwlzdHJ1Y3QgbWdiNF92b3V0X2RldiAqdm91dGRldiA9IHZpZGVvX2RydmRhdGEoZmls
ZSk7CisKKwlmLT5mbXQucGl4LnBpeGVsZm9ybWF0ID0gVjRMMl9QSVhfRk1UX0FCR1IzMjsK
KwlmLT5mbXQucGl4LndpZHRoID0gdm91dGRldi0+d2lkdGg7CisJZi0+Zm10LnBpeC5oZWln
aHQgPSB2b3V0ZGV2LT5oZWlnaHQ7CisJZi0+Zm10LnBpeC5maWVsZCA9IFY0TDJfRklFTERf
Tk9ORTsKKwlmLT5mbXQucGl4LmNvbG9yc3BhY2UgPSBWNEwyX0NPTE9SU1BBQ0VfUkFXOwor
CWYtPmZtdC5waXguYnl0ZXNwZXJsaW5lID0gQllURVNQRVJMSU5FKHZvdXRkZXYtPndpZHRo
LCB2b3V0ZGV2LT5hbGlnbm1lbnQpOworCWYtPmZtdC5waXguc2l6ZWltYWdlID0gZi0+Zm10
LnBpeC53aWR0aCAqIDQgKiBmLT5mbXQucGl4LmhlaWdodDsKKworCXJldHVybiAwOworfQor
CitzdGF0aWMgaW50IHZpZGlvY19nX291dHB1dChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAq
cHJpdiwgdW5zaWduZWQgaW50ICppKQoreworCSppID0gMDsKKwlyZXR1cm4gMDsKK30KKwor
c3RhdGljIGludCB2aWRpb2Nfc19vdXRwdXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnBy
aXYsIHVuc2lnbmVkIGludCBpKQoreworCXJldHVybiBpID8gLUVJTlZBTCA6IDA7Cit9CisK
K3N0YXRpYyBpbnQgdmlkaW9jX2VudW1fb3V0cHV0KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lk
ICpwcml2LCBzdHJ1Y3QgdjRsMl9vdXRwdXQgKm91dCkKK3sKKwlpZiAob3V0LT5pbmRleCAh
PSAwKQorCQlyZXR1cm4gLUVJTlZBTDsKKworCW91dC0+dHlwZSA9IFY0TDJfT1VUUFVUX1RZ
UEVfQU5BTE9HOworCXN0cnNjcHkob3V0LT5uYW1lLCAiTUdCNCIsIHNpemVvZihvdXQtPm5h
bWUpKTsKKworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50IHZpZGlvY19xdWVyeWN0cmwo
c3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKnByaXYsCisJCQkgICAgc3RydWN0IHY0bDJfcXVl
cnljdHJsICpxYykKK3sKKwlyZXR1cm4gLUVJTlZBTDsKK30KKworc3RhdGljIGNvbnN0IHN0
cnVjdCB2NGwyX2lvY3RsX29wcyB2aWRlb19pb2N0bF9vcHMgPSB7CisJLnZpZGlvY19xdWVy
eWNhcCA9IHZpZGlvY19xdWVyeWNhcCwKKwkudmlkaW9jX2VudW1fZm10X3ZpZF9vdXQgPSB2
aWRpb2NfZW51bV9mbXQsCisJLnZpZGlvY190cnlfZm10X3ZpZF9vdXQgPSB2aWRpb2NfZm10
LAorCS52aWRpb2Nfc19mbXRfdmlkX291dCA9IHZpZGlvY19mbXQsCisJLnZpZGlvY19nX2Zt
dF92aWRfb3V0ID0gdmlkaW9jX2ZtdCwKKwkudmlkaW9jX2VudW1fb3V0cHV0ID0gdmlkaW9j
X2VudW1fb3V0cHV0LAorCS52aWRpb2NfZ19vdXRwdXQgPSB2aWRpb2NfZ19vdXRwdXQsCisJ
LnZpZGlvY19zX291dHB1dCA9IHZpZGlvY19zX291dHB1dCwKKwkudmlkaW9jX3F1ZXJ5Y3Ry
bCA9IHZpZGlvY19xdWVyeWN0cmwsCisJLnZpZGlvY19yZXFidWZzID0gdmIyX2lvY3RsX3Jl
cWJ1ZnMsCisJLnZpZGlvY19jcmVhdGVfYnVmcyA9IHZiMl9pb2N0bF9jcmVhdGVfYnVmcywK
KwkudmlkaW9jX3F1ZXJ5YnVmID0gdmIyX2lvY3RsX3F1ZXJ5YnVmLAorCS52aWRpb2NfcWJ1
ZiA9IHZiMl9pb2N0bF9xYnVmLAorCS52aWRpb2NfZHFidWYgPSB2YjJfaW9jdGxfZHFidWYs
CisJLnZpZGlvY19leHBidWYgPSB2YjJfaW9jdGxfZXhwYnVmLAorCS52aWRpb2Nfc3RyZWFt
b24gPSB2YjJfaW9jdGxfc3RyZWFtb24sCisJLnZpZGlvY19zdHJlYW1vZmYgPSB2YjJfaW9j
dGxfc3RyZWFtb2ZmLAorfTsKKworc3RhdGljIGludCBmaF9vcGVuKHN0cnVjdCBmaWxlICpm
aWxlKQoreworCXN0cnVjdCBtZ2I0X3ZvdXRfZGV2ICp2b3V0ZGV2ID0gdmlkZW9fZHJ2ZGF0
YShmaWxlKTsKKwlzdHJ1Y3QgbWdiNF9yZWdzICp2aWRlbyA9ICZ2b3V0ZGV2LT5tZ2JkZXYt
PnZpZGVvOworCXUzMiBjb25maWcsIHJlc29sdXRpb247CisJaW50IHJldDsKKworCXJldCA9
IHY0bDJfZmhfb3BlbihmaWxlKTsKKwlpZiAocmV0KQorCQlyZXR1cm4gcmV0OworCisJY29u
ZmlnID0gbWdiNF9yZWFkX3JlZyh2aWRlbywgdm91dGRldi0+Y29uZmlnLT5yZWdzLmNvbmZp
Zyk7CisJaWYgKChjb25maWcgJiAweGMpID4+IDIgIT0gdm91dGRldi0+Y29uZmlnLT5pZCAr
IE1HQjRfVklOX0RFVklDRVMpCisJCWdvdG8gZXJyb3I7CisKKwlyZXNvbHV0aW9uID0gbWdi
NF9yZWFkX3JlZyh2aWRlbywgdm91dGRldi0+Y29uZmlnLT5yZWdzLnJlc29sdXRpb24pOwor
CXZvdXRkZXYtPndpZHRoID0gcmVzb2x1dGlvbiA+PiAxNjsKKwl2b3V0ZGV2LT5oZWlnaHQg
PSByZXNvbHV0aW9uICYgMHhGRkZGOworCisJbWdiNF93cml0ZV9yZWcodmlkZW8sIHZvdXRk
ZXYtPmNvbmZpZy0+cmVncy5wYWRkaW5nLAorCSAgUEFERElORyh2b3V0ZGV2LT53aWR0aCwg
dm91dGRldi0+YWxpZ25tZW50KSk7CisKKwlyZXR1cm4gMDsKKworZXJyb3I6CisJdjRsMl9m
aF9yZWxlYXNlKGZpbGUpOworCXJldHVybiAtRUJVU1k7Cit9CisKK3N0YXRpYyBjb25zdCBz
dHJ1Y3QgdjRsMl9maWxlX29wZXJhdGlvbnMgdmlkZW9fZm9wcyA9IHsKKwkub3duZXIgPSBU
SElTX01PRFVMRSwKKwkub3BlbiA9IGZoX29wZW4sCisJLnJlbGVhc2UgPSB2YjJfZm9wX3Jl
bGVhc2UsCisJLnVubG9ja2VkX2lvY3RsID0gdmlkZW9faW9jdGwyLAorCS53cml0ZSA9IHZi
Ml9mb3Bfd3JpdGUsCisJLm1tYXAgPSB2YjJfZm9wX21tYXAsCisJLnBvbGwgPSB2YjJfZm9w
X3BvbGwsCit9OworCitzdGF0aWMgdm9pZCBkbWFfdHJhbnNmZXIoc3RydWN0IHdvcmtfc3Ry
dWN0ICp3b3JrKQoreworCXN0cnVjdCBtZ2I0X3ZvdXRfZGV2ICp2b3V0ZGV2ID0gY29udGFp
bmVyX29mKHdvcmssIHN0cnVjdCBtZ2I0X3ZvdXRfZGV2LAorCSAgZG1hX3dvcmspOworCXN0
cnVjdCBkZXZpY2UgKmRldiA9ICZ2b3V0ZGV2LT5tZ2JkZXYtPnBkZXYtPmRldjsKKwlzdHJ1
Y3QgZnJhbWVfYnVmZmVyICpidWYgPSAwOworCXVuc2lnbmVkIGxvbmcgZmxhZ3M7CisJdTMy
IGFkZHI7CisKKwlzcGluX2xvY2tfaXJxc2F2ZSgmdm91dGRldi0+cWxvY2ssIGZsYWdzKTsK
KwlpZiAoIWxpc3RfZW1wdHkoJnZvdXRkZXYtPmJ1Zl9saXN0KSkgeworCQlidWYgPSBsaXN0
X2ZpcnN0X2VudHJ5KCZ2b3V0ZGV2LT5idWZfbGlzdCwgc3RydWN0IGZyYW1lX2J1ZmZlciwg
bGlzdCk7CisJCWxpc3RfZGVsX2luaXQodm91dGRldi0+YnVmX2xpc3QubmV4dCk7CisJfQor
CXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJnZvdXRkZXYtPnFsb2NrLCBmbGFncyk7CisKKwlp
ZiAoIWJ1ZikKKwkJcmV0dXJuOworCisJYWRkciA9IG1nYjRfcmVhZF9yZWcoJnZvdXRkZXYt
Pm1nYmRldi0+dmlkZW8sIHZvdXRkZXYtPmNvbmZpZy0+cmVncy5hZGRyZXNzKTsKKwlpZiAo
YWRkciA+PSBFUlJfUVVFVUVfRlVMTCkgeworCQlkZXZfd2FybihkZXYsICJmcmFtZSBxdWV1
ZSBlcnJvciAoJWQpXG4iLCAoaW50KWFkZHIpOworCQl2YjJfYnVmZmVyX2RvbmUoJmJ1Zi0+
dmIudmIyX2J1ZiwgVkIyX0JVRl9TVEFURV9FUlJPUik7CisJCXJldHVybjsKKwl9CisKKwlp
ZiAobWdiNF9kbWFfdHJhbnNmZXIodm91dGRldi0+bWdiZGV2LCB2b3V0ZGV2LT5jb25maWct
PmRtYV9jaGFubmVsLAorCSAgdHJ1ZSwgYWRkciwgdmIyX2RtYV9zZ19wbGFuZV9kZXNjKCZi
dWYtPnZiLnZiMl9idWYsIDApKSA8IDApIHsKKwkJZGV2X3dhcm4oZGV2LCAiRE1BIHRyYW5z
ZmVyIGVycm9yXG4iKTsKKwkJdmIyX2J1ZmZlcl9kb25lKCZidWYtPnZiLnZiMl9idWYsIFZC
Ml9CVUZfU1RBVEVfRVJST1IpOworCX0gZWxzZSB7CisJCXZiMl9idWZmZXJfZG9uZSgmYnVm
LT52Yi52YjJfYnVmLCBWQjJfQlVGX1NUQVRFX0RPTkUpOworCX0KK30KKworc3RhdGljIGly
cXJldHVybl90IGhhbmRsZXIoaW50IGlycSwgdm9pZCAqY3R4KQoreworCXN0cnVjdCBtZ2I0
X3ZvdXRfZGV2ICp2b3V0ZGV2ID0gKHN0cnVjdCBtZ2I0X3ZvdXRfZGV2ICopY3R4OworCisJ
c2NoZWR1bGVfd29yaygmdm91dGRldi0+ZG1hX3dvcmspOworCisJbWdiNF93cml0ZV9yZWco
JnZvdXRkZXYtPm1nYmRldi0+dmlkZW8sIDB4QjQsIDFVPDx2b3V0ZGV2LT5jb25maWctPmly
cSk7CisKKwlyZXR1cm4gSVJRX0hBTkRMRUQ7Cit9CisKK3N0YXRpYyBpbnQgc2VyX2luaXQo
c3RydWN0IG1nYjRfdm91dF9kZXYgKnZvdXRkZXYsIGludCBpZCkKK3sKKwlpbnQgcnYsIGFk
ZHJfc2l6ZTsKKwlzaXplX3QgdmFsdWVzX2NvdW50OworCWNvbnN0IHN0cnVjdCBtZ2I0X2ky
Y19rdiAqdmFsdWVzOworCWNvbnN0IHN0cnVjdCBpMmNfYm9hcmRfaW5mbyAqaW5mbzsKKwlz
dHJ1Y3QgZGV2aWNlICpkZXYgPSAmdm91dGRldi0+bWdiZGV2LT5wZGV2LT5kZXY7CisKKwor
CWlmIChNR0I0X0lTX0dNU0wodm91dGRldi0+bWdiZGV2KSkKKwkJcmV0dXJuIDA7CisKKwlp
bmZvID0gJmZwZGwzX3Nlcl9pbmZvW2lkXTsKKwlhZGRyX3NpemUgPSA4OworCXZhbHVlcyA9
IGZwZGwzX2kyYzsKKwl2YWx1ZXNfY291bnQgPSBBUlJBWV9TSVpFKGZwZGwzX2kyYyk7CisK
KwlydiA9IG1nYjRfaTJjX2luaXQoJnZvdXRkZXYtPnNlciwgdm91dGRldi0+bWdiZGV2LT5p
MmNfYWRhcCwgaW5mbywgYWRkcl9zaXplKTsKKwlpZiAocnYgPCAwKSB7CisJCWRldl9lcnIo
ZGV2LCAiZmFpbGVkIHRvIGNyZWF0ZSBzZXJpYWxpemVyXG4iKTsKKwkJcmV0dXJuIHJ2Owor
CX0KKwlydiA9IG1nYjRfaTJjX2NvbmZpZ3VyZSgmdm91dGRldi0+c2VyLCB2YWx1ZXMsIHZh
bHVlc19jb3VudCk7CisJaWYgKHJ2IDwgMCkgeworCQlkZXZfZXJyKGRldiwgImZhaWxlZCB0
byBjb25maWd1cmUgc2VyaWFsaXplclxuIik7CisJCWdvdG8gZXJyX2kyY19kZXY7CisJfQor
CisJcmV0dXJuIDA7CisKK2Vycl9pMmNfZGV2OgorCW1nYjRfaTJjX2ZyZWUoJnZvdXRkZXYt
PnNlcik7CisKKwlyZXR1cm4gcnY7Cit9CisKK3N0cnVjdCBtZ2I0X3ZvdXRfZGV2ICptZ2I0
X3ZvdXRfY3JlYXRlKHN0cnVjdCBtZ2I0X2RldiAqbWdiZGV2LCBpbnQgaWQpCit7CisJaW50
IHJ2LCBpcnE7CisJc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKiphdHRyLCAqKm1vZHVsZV9h
dHRyOworCXN0cnVjdCBtZ2I0X3ZvdXRfZGV2ICp2b3V0ZGV2OworCXN0cnVjdCBtZ2I0X3Jl
Z3MgKnZpZGVvOworCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gbWdiZGV2LT5wZGV2OworCXN0
cnVjdCBkZXZpY2UgKmRldiA9ICZwZGV2LT5kZXY7CisKKwl2b3V0ZGV2ID0ga3phbGxvYyhz
aXplb2Yoc3RydWN0IG1nYjRfdm91dF9kZXYpLCBHRlBfS0VSTkVMKTsKKwlpZiAoIXZvdXRk
ZXYpCisJCXJldHVybiBOVUxMOworCisJdm91dGRldi0+bWdiZGV2ID0gbWdiZGV2OworCXZv
dXRkZXYtPmNvbmZpZyA9ICYodm91dF9jZmdbaWRdKTsKKwl2aWRlbyA9ICZ2b3V0ZGV2LT5t
Z2JkZXYtPnZpZGVvOworCisJLyogRnJhbWUgcXVldWUqLworCUlOSVRfTElTVF9IRUFEKCZ2
b3V0ZGV2LT5idWZfbGlzdCk7CisJc3Bpbl9sb2NrX2luaXQoJnZvdXRkZXYtPnFsb2NrKTsK
KworCS8qIERNQSB0cmFuc2ZlciBzdHVmZiAqLworCUlOSVRfV09SSygmdm91dGRldi0+ZG1h
X3dvcmssIGRtYV90cmFuc2Zlcik7CisKKwkvKiBJUlEgY2FsbGJhY2sgKi8KKwlpcnEgPSB4
ZG1hX2dldF91c2VyX2lycShtZ2JkZXYtPnhkZXYsIHZvdXRkZXYtPmNvbmZpZy0+aXJxKTsK
KwlydiA9IHJlcXVlc3RfaXJxKGlycSwgaGFuZGxlciwgMCwgIm1nYjQtdm91dCIsIHZvdXRk
ZXYpOworCWlmIChydikgeworCQlkZXZfZXJyKGRldiwgImZhaWxlZCB0byByZWdpc3RlciBp
cnEgaGFuZGxlclxuIik7CisJCWdvdG8gZXJyX2FsbG9jOworCX0KKworCS8qIFY0TDIgKi8K
KwlydiA9IHY0bDJfZGV2aWNlX3JlZ2lzdGVyKGRldiwgJnZvdXRkZXYtPnY0bDJkZXYpOwor
CWlmIChydikgeworCQlkZXZfZXJyKGRldiwgImZhaWxlZCB0byByZWdpc3RlciB2NGwyIGRl
dmljZVxuIik7CisJCWdvdG8gZXJyX2lycTsKKwl9CisKKwltdXRleF9pbml0KCZ2b3V0ZGV2
LT5sb2NrKTsKKworCXZvdXRkZXYtPnF1ZXVlLnR5cGUgPSBWNEwyX0JVRl9UWVBFX1ZJREVP
X09VVFBVVDsKKwl2b3V0ZGV2LT5xdWV1ZS5pb19tb2RlcyA9IFZCMl9NTUFQIHwgVkIyX1VT
RVJQVFIgfCBWQjJfRE1BQlVGIHwgVkIyX1dSSVRFOworCXZvdXRkZXYtPnF1ZXVlLmJ1Zl9z
dHJ1Y3Rfc2l6ZSA9IHNpemVvZihzdHJ1Y3QgZnJhbWVfYnVmZmVyKTsKKwl2b3V0ZGV2LT5x
dWV1ZS5vcHMgPSAmcXVldWVfb3BzOworCXZvdXRkZXYtPnF1ZXVlLm1lbV9vcHMgPSAmdmIy
X2RtYV9zZ19tZW1vcHM7CisJdm91dGRldi0+cXVldWUuZ2ZwX2ZsYWdzID0gR0ZQX0RNQTMy
OworCXZvdXRkZXYtPnF1ZXVlLnRpbWVzdGFtcF9mbGFncyA9IFY0TDJfQlVGX0ZMQUdfVElN
RVNUQU1QX01PTk9UT05JQzsKKwl2b3V0ZGV2LT5xdWV1ZS5taW5fYnVmZmVyc19uZWVkZWQg
PSAyOworCXZvdXRkZXYtPnF1ZXVlLmRydl9wcml2ID0gdm91dGRldjsKKwl2b3V0ZGV2LT5x
dWV1ZS5sb2NrID0gJnZvdXRkZXYtPmxvY2s7CisJdm91dGRldi0+cXVldWUuZGV2ID0gZGV2
OworCXJ2ID0gdmIyX3F1ZXVlX2luaXQoJnZvdXRkZXYtPnF1ZXVlKTsKKwlpZiAocnYpIHsK
KwkJZGV2X2VycihkZXYsICJmYWlsZWQgdG8gaW5pdGlhbGl6ZSB2YjIgcXVldWVcbiIpOwor
CQlnb3RvIGVycl92NGwyX2RldjsKKwl9CisKKwlzbnByaW50Zih2b3V0ZGV2LT52ZGV2Lm5h
bWUsIHNpemVvZih2b3V0ZGV2LT52ZGV2Lm5hbWUpLCAibWdiNC1vdXQlZCIsIGlkKzEpOwor
CXZvdXRkZXYtPnZkZXYuZGV2aWNlX2NhcHMgPSBWNEwyX0NBUF9WSURFT19PVVRQVVQgfCBW
NEwyX0NBUF9SRUFEV1JJVEUKKwkgIHwgVjRMMl9DQVBfU1RSRUFNSU5HOworCXZvdXRkZXYt
PnZkZXYudmZsX2RpciA9IFZGTF9ESVJfVFg7CisJdm91dGRldi0+dmRldi5mb3BzID0gJnZp
ZGVvX2ZvcHM7CisJdm91dGRldi0+dmRldi5pb2N0bF9vcHMgPSAmdmlkZW9faW9jdGxfb3Bz
OworCXZvdXRkZXYtPnZkZXYucmVsZWFzZSA9IHZpZGVvX2RldmljZV9yZWxlYXNlX2VtcHR5
OworCXZvdXRkZXYtPnZkZXYudjRsMl9kZXYgPSAmdm91dGRldi0+djRsMmRldjsKKwl2b3V0
ZGV2LT52ZGV2LmxvY2sgPSAmdm91dGRldi0+bG9jazsKKwl2b3V0ZGV2LT52ZGV2LnF1ZXVl
ID0gJnZvdXRkZXYtPnF1ZXVlOworCXZpZGVvX3NldF9kcnZkYXRhKCZ2b3V0ZGV2LT52ZGV2
LCB2b3V0ZGV2KTsKKworCXJ2ID0gdmlkZW9fcmVnaXN0ZXJfZGV2aWNlKCZ2b3V0ZGV2LT52
ZGV2LCBWRkxfVFlQRV9HUkFCQkVSLCAtMSk7CisJaWYgKHJ2KSB7CisJCWRldl9lcnIoZGV2
LCAiZmFpbGVkIHRvIHJlZ2lzdGVyIHZpZGVvIGRldmljZVxuIik7CisJCWdvdG8gZXJyX3Y0
bDJfZGV2OworCX0KKworCS8qIFNlcmlhbGl6ZXIgKi8KKwlydiA9IHNlcl9pbml0KHZvdXRk
ZXYsIGlkKTsKKwlpZiAocnYpCisJCWdvdG8gZXJyX3ZpZGVvX2RldjsKKworCS8qIFNldCB0
aGUgRlBHQSByZWdpc3RlcnMgZGVmYXVsdCB2YWx1ZXMgKi8KKwltZ2I0X21hc2tfcmVnKHZp
ZGVvLCB2b3V0ZGV2LT5jb25maWctPnJlZ3MuY29uZmlnLCAweGMsCisJICAodm91dGRldi0+
Y29uZmlnLT5pZCArIE1HQjRfVklOX0RFVklDRVMpIDw8IDIpOworCW1nYjRfd3JpdGVfcmVn
KHZpZGVvLCB2b3V0ZGV2LT5jb25maWctPnJlZ3MucmVzb2x1dGlvbiwKKwkgIChERUZBVUxU
X1dJRFRIIDw8IDE2KSB8IERFRkFVTFRfSEVJR0hUKTsKKwltZ2I0X3dyaXRlX3JlZyh2aWRl
bywgdm91dGRldi0+Y29uZmlnLT5yZWdzLmZyYW1lX3BlcmlvZCwKKwkgIERFRkFVTFRfUEVS
SU9EKTsKKworCS8qIE1vZHVsZSBzeXNmcyBhdHRyaWJ1dGVzICovCisJdm91dGRldi0+YWxp
Z25tZW50ID0gMTsKKwltb2R1bGVfYXR0ciA9IE1HQjRfSVNfR01TTChtZ2JkZXYpCisJICA/
IG1nYjRfZ21zbF9vdXRfYXR0cnMgOiBtZ2I0X2ZwZGwzX291dF9hdHRyczsKKwlmb3IgKGF0
dHIgPSBtb2R1bGVfYXR0cjsgKmF0dHI7IGF0dHIrKykKKwkJZGV2aWNlX2NyZWF0ZV9maWxl
KCZ2b3V0ZGV2LT52ZGV2LmRldiwgKmF0dHIpOworCisJLyogU2V0IHRoZSBvdXRwdXQgZnJl
cXVlbmN5IGFjY29yZGluZyB0byB0aGUgRlBHQSBkZWZhdWx0cyAqLworCXZvdXRkZXYtPmZy
ZXEgPSA3MDAwMDsKKworCXJldHVybiB2b3V0ZGV2OworCitlcnJfdmlkZW9fZGV2OgorCXZp
ZGVvX3VucmVnaXN0ZXJfZGV2aWNlKCZ2b3V0ZGV2LT52ZGV2KTsKK2Vycl92NGwyX2RldjoK
Kwl2NGwyX2RldmljZV91bnJlZ2lzdGVyKCZ2b3V0ZGV2LT52NGwyZGV2KTsKK2Vycl9pcnE6
CisJZnJlZV9pcnEoaXJxLCB2b3V0ZGV2KTsKK2Vycl9hbGxvYzoKKwlrZnJlZSh2b3V0ZGV2
KTsKKworCXJldHVybiBOVUxMOworfQorCit2b2lkIG1nYjRfdm91dF9mcmVlKHN0cnVjdCBt
Z2I0X3ZvdXRfZGV2ICp2b3V0ZGV2KQoreworCXN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICoq
YXR0ciwgKiptb2R1bGVfYXR0cjsKKwlpbnQgaXJxID0geGRtYV9nZXRfdXNlcl9pcnEodm91
dGRldi0+bWdiZGV2LT54ZGV2LCB2b3V0ZGV2LT5jb25maWctPmlycSk7CisKKwlmcmVlX2ly
cShpcnEsIHZvdXRkZXYpOworCisJbW9kdWxlX2F0dHIgPSBNR0I0X0lTX0dNU0wodm91dGRl
di0+bWdiZGV2KQorCSAgPyBtZ2I0X2dtc2xfb3V0X2F0dHJzIDogbWdiNF9mcGRsM19vdXRf
YXR0cnM7CisJZm9yIChhdHRyID0gbW9kdWxlX2F0dHI7ICphdHRyOyBhdHRyKyspCisJCWRl
dmljZV9yZW1vdmVfZmlsZSgmdm91dGRldi0+dmRldi5kZXYsICphdHRyKTsKKworCW1nYjRf
aTJjX2ZyZWUoJnZvdXRkZXYtPnNlcik7CisJdmlkZW9fdW5yZWdpc3Rlcl9kZXZpY2UoJnZv
dXRkZXYtPnZkZXYpOworCXY0bDJfZGV2aWNlX3VucmVnaXN0ZXIoJnZvdXRkZXYtPnY0bDJk
ZXYpOworfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9wY2kvbWdiNC9tZ2I0X3ZvdXQu
aCBiL2RyaXZlcnMvbWVkaWEvcGNpL21nYjQvbWdiNF92b3V0LmgKbmV3IGZpbGUgbW9kZSAx
MDA2NDQKaW5kZXggMDAwMDAwMDAwMDAwLi45MDJiNmI4ZGViMjEKLS0tIC9kZXYvbnVsbAor
KysgYi9kcml2ZXJzL21lZGlhL3BjaS9tZ2I0L21nYjRfdm91dC5oCkBAIC0wLDAgKzEsNTgg
QEAKKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9ubHkgKi8KKy8qCisg
KiBDb3B5cmlnaHQgKEMpIDIwMjEtMjAyMiBEaWdpdGVxIEF1dG9tb3RpdmUKKyAqICAgICBh
dXRob3I6IE1hcnRpbiBUdW1hIDxtYXJ0aW4udHVtYUBkaWdpdGVxYXV0b21vdGl2ZS5jb20+
CisgKi8KKworI2lmbmRlZiBfX01HQjRfVk9VVF9IX18KKyNkZWZpbmUgX19NR0I0X1ZPVVRf
SF9fCisKKyNpbmNsdWRlIDxtZWRpYS92NGwyLWRldmljZS5oPgorI2luY2x1ZGUgPG1lZGlh
L3Y0bDItZGV2Lmg+CisjaW5jbHVkZSA8bWVkaWEvdjRsMi1jdHJscy5oPgorI2luY2x1ZGUg
PG1lZGlhL3ZpZGVvYnVmMi1jb3JlLmg+CisjaW5jbHVkZSAibWdiNF9pMmMuaCIKKworc3Ry
dWN0IG1nYjRfdm91dF9yZWdzIHsKKwl1MzIgYWRkcmVzczsKKwl1MzIgY29uZmlnOworCXUz
MiBzdGF0dXM7CisJdTMyIHJlc29sdXRpb247CisJdTMyIGZyYW1lX3BlcmlvZDsKKwl1MzIg
aHN5bmM7CisJdTMyIHZzeW5jOworCXUzMiBwYWRkaW5nOworfTsKKworc3RydWN0IG1nYjRf
dm91dF9jb25maWcgeworCWludCBpZDsKKwlpbnQgZG1hX2NoYW5uZWw7CisJaW50IGlycTsK
KwlzdHJ1Y3QgbWdiNF92b3V0X3JlZ3MgcmVnczsKK307CisKK3N0cnVjdCBtZ2I0X3ZvdXRf
ZGV2IHsKKwlzdHJ1Y3QgbWdiNF9kZXYgKm1nYmRldjsKKwlzdHJ1Y3QgdjRsMl9kZXZpY2Ug
djRsMmRldjsKKwlzdHJ1Y3QgdmlkZW9fZGV2aWNlIHZkZXY7CisJc3RydWN0IHZiMl9xdWV1
ZSBxdWV1ZTsKKwlzdHJ1Y3QgbXV0ZXggbG9jazsKKworCXNwaW5sb2NrX3QgcWxvY2s7CisJ
c3RydWN0IGxpc3RfaGVhZCBidWZfbGlzdDsKKwlzdHJ1Y3Qgd29ya19zdHJ1Y3QgZG1hX3dv
cms7CisKKwl1MzIgd2lkdGg7CisJdTMyIGhlaWdodDsKKwl1MzIgZnJlcTsKKwl1MzIgYWxp
Z25tZW50OworCisJc3RydWN0IG1nYjRfaTJjX2NsaWVudCBzZXI7CisKKwljb25zdCBzdHJ1
Y3QgbWdiNF92b3V0X2NvbmZpZyAqY29uZmlnOworfTsKKworZXh0ZXJuIHN0cnVjdCBtZ2I0
X3ZvdXRfZGV2ICptZ2I0X3ZvdXRfY3JlYXRlKHN0cnVjdCBtZ2I0X2RldiAqbWdiZGV2LCBp
bnQgaWQpOworZXh0ZXJuIHZvaWQgbWdiNF92b3V0X2ZyZWUoc3RydWN0IG1nYjRfdm91dF9k
ZXYgKnZvdXRkZXYpOworCisjZW5kaWYK

--------------A3EY0LQxb1Rn0VPJLv1kXqq3--
