Return-Path: <linux-kernel-owner@vger.kernel.org>
X-Original-To: lists+linux-kernel@lfdr.de
Delivered-To: lists+linux-kernel@lfdr.de
Received: from out1.vger.email (out1.vger.email [IPv6:2620:137:e000::1:20])
	by mail.lfdr.de (Postfix) with ESMTP id F22945BB9FC
	for <lists+linux-kernel@lfdr.de>; Sat, 17 Sep 2022 20:48:17 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S229648AbiIQSsD (ORCPT <rfc822;lists+linux-kernel@lfdr.de>);
        Sat, 17 Sep 2022 14:48:03 -0400
Received: from lindbergh.monkeyblade.net ([23.128.96.19]:48912 "EHLO
        lindbergh.monkeyblade.net" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S229632AbiIQSsB (ORCPT
        <rfc822;linux-kernel@vger.kernel.org>);
        Sat, 17 Sep 2022 14:48:01 -0400
Received: from ams.source.kernel.org (ams.source.kernel.org [IPv6:2604:1380:4601:e00::1])
        by lindbergh.monkeyblade.net (Postfix) with ESMTPS id 68D3C2B1B9;
        Sat, 17 Sep 2022 11:48:00 -0700 (PDT)
Received: from smtp.kernel.org (relay.kernel.org [52.25.139.140])
        (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
        (No client certificate requested)
        by ams.source.kernel.org (Postfix) with ESMTPS id 18914B80C94;
        Sat, 17 Sep 2022 18:47:58 +0000 (UTC)
Received: by smtp.kernel.org (Postfix) with ESMTPSA id B161DC433D6;
        Sat, 17 Sep 2022 18:47:56 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=kernel.org;
        s=k20201202; t=1663440476;
        bh=he5mmwC82r4pXuqJjWuYbjHr1LVIrfZ/VIoQhX53oEU=;
        h=Date:From:To:Cc:Subject:In-Reply-To:References:From;
        b=BNFWkpgmN/WUKXEz6GzHXIU7igDURvYF5yxqlZbUNCTPOHhtoqYRJZ+PGuEJTCpg9
         QnKg/jkcBzU7TlA0urvWk+QbNtpJ5calUkxACWLydAlYUO1ZTEweQzVuzoO6iCZvxb
         VB5hlxuT1PbKHiHPnA6fFDfSMyyvtQLgDSp8dj6Bjid9vWYwo57oJMrpwTGsXnJ7Te
         YLxcLmWZo8P4rvje9bLPLxpWfpxIeJixDoHHO8Wx55svg2oVw5vJIoGex53T3Pj0KA
         Yax7Du07sj3wP/cRO5xF46aXl+aXDnYQgnYzKQ/yE/EgCIZVlk1busHSR54+JeDURJ
         ATb/C2gwpxyYA==
Received: from 185-176-101-241.host.sccbroadband.ie ([185.176.101.241] helo=wait-a-minute.misterjones.org)
        by disco-boy.misterjones.org with esmtpsa  (TLS1.3) tls TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
        (Exim 4.95)
        (envelope-from <maz@kernel.org>)
        id 1oZcr4-00AodO-Do;
        Sat, 17 Sep 2022 19:47:54 +0100
Date:   Sat, 17 Sep 2022 19:47:53 +0100
Message-ID: <87mtaxltwm.wl-maz@kernel.org>
From:   Marc Zyngier <maz@kernel.org>
To:     Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org>
Cc:     Jean-Philippe Brucker <jean-philippe@linaro.org>,
        mark.rutland@arm.com, robh+dt@kernel.org,
        krzysztof.kozlowski+dt@linaro.org, linux-kernel@vger.kernel.org,
        devicetree@vger.kernel.org
Subject: Re: [PATCH] dt-bindings: timer: Add QEMU compatible strings
In-Reply-To: <0acc2a21-27c2-ec85-0335-263d70c24469@linaro.org>
References: <20220916132959.1910374-1-jean-philippe@linaro.org>
        <0acc2a21-27c2-ec85-0335-263d70c24469@linaro.org>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) SEMI-EPG/1.14.7 (Harue)
 FLIM-LB/1.14.9 (=?UTF-8?B?R29qxY0=?=) APEL-LB/10.8 EasyPG/1.0.0 Emacs/27.1
 (x86_64-pc-linux-gnu) MULE/6.0 (HANACHIRUSATO)
MIME-Version: 1.0 (generated by SEMI-EPG 1.14.7 - "Harue")
Content-Type: text/plain; charset=US-ASCII
X-SA-Exim-Connect-IP: 185.176.101.241
X-SA-Exim-Rcpt-To: krzysztof.kozlowski@linaro.org, jean-philippe@linaro.org, mark.rutland@arm.com, robh+dt@kernel.org, krzysztof.kozlowski+dt@linaro.org, linux-kernel@vger.kernel.org, devicetree@vger.kernel.org
X-SA-Exim-Mail-From: maz@kernel.org
X-SA-Exim-Scanned: No (on disco-boy.misterjones.org); SAEximRunCond expanded to false
X-Spam-Status: No, score=-3.8 required=5.0 tests=BAYES_00,DKIMWL_WL_HIGH,
        DKIM_SIGNED,DKIM_VALID,DKIM_VALID_AU,DKIM_VALID_EF,RCVD_IN_DNSWL_HI,
        RCVD_IN_SBL_CSS,SPF_HELO_NONE,SPF_PASS autolearn=ham
        autolearn_force=no version=3.4.6
X-Spam-Checker-Version: SpamAssassin 3.4.6 (2021-04-09) on
        lindbergh.monkeyblade.net
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

On Sat, 17 Sep 2022 17:51:20 +0100,
Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org> wrote:
> 
> On 16/09/2022 14:30, Jean-Philippe Brucker wrote:
> > QEMU uses both "arm,armv8-timer" and "arm,armv7-timer" as compatible
> > string. Although it is unlikely that any guest relies on this, we can't
> > be certain of that. Therefore, add these to the schema. Clean up the
> > compatible list a little while at it.
> > 
> > Signed-off-by: Jean-Philippe Brucker <jean-philippe@linaro.org>
> 
> I guess you wanted to say QEMU uses "arm,armv8-timer" followed by
> "arm,armv7-timer", because otherwise I would understand it that either
> that or that. Anyway, is it a valid (virtualized) hardware? Is ARMv8
> timer really, really compatible with ARMv7 one?

Yes. There isn't a shred of difference between the two in the earlier
revisions of the ARMv8 architecture, and none of the differences
introduced in later revisions are exposed to DT anyway.

> I don't think we should document invalid setups out-of-tree, just
> because they are there, and something like this was also expressed by Rob:
> https://lore.kernel.org/all/20220518163255.GE3302100-robh@kernel.org/

This is, on the contrary, something that is perfectly valid. For
example, a system running a 32bit OS on a 64bit system is perfectly
entitled to expose both (v8 because that's what the HW is, v7 because
that's what the OS is the most likely to understand).

You may find it odd, but that:

- expresses something that is actually required

- is what I, as the original author of this binding, have always
  considered valid

- has been valid for a long time (10+ years) before you decided it
  suddenly wasn't

I understand that the "DT police" has high standards, but this has
been around for much longer, and it isn't because the conversion to
schema is imperfect that you can rewrite history.

As for the patch, I'd remove the QEMU reference and the deprecation.
This format is perfectly allowed, and is in use in most VMMs out
there. Yes, DT is an ABI.

Thanks,

	M.

-- 
Without deviation from the norm, progress is not possible.
