Return-Path: <linux-kernel-owner@vger.kernel.org>
X-Original-To: lists+linux-kernel@lfdr.de
Delivered-To: lists+linux-kernel@lfdr.de
Received: from out1.vger.email (out1.vger.email [IPv6:2620:137:e000::1:20])
	by mail.lfdr.de (Postfix) with ESMTP id 13F1B6E5736
	for <lists+linux-kernel@lfdr.de>; Tue, 18 Apr 2023 03:57:54 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S231126AbjDRB53 (ORCPT <rfc822;lists+linux-kernel@lfdr.de>);
        Mon, 17 Apr 2023 21:57:29 -0400
Received: from lindbergh.monkeyblade.net ([23.128.96.19]:43950 "EHLO
        lindbergh.monkeyblade.net" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S229930AbjDRB5Z (ORCPT
        <rfc822;linux-kernel@vger.kernel.org>);
        Mon, 17 Apr 2023 21:57:25 -0400
Received: from EUR05-DB8-obe.outbound.protection.outlook.com (mail-db8eur05on2067.outbound.protection.outlook.com [40.107.20.67])
        by lindbergh.monkeyblade.net (Postfix) with ESMTPS id D24679D;
        Mon, 17 Apr 2023 18:56:51 -0700 (PDT)
ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;
 b=BH9F5qCKW4IjWMeSBhjYbRTUaBYyYJMIqHaHA2kAFTo4/bBTlmO0ad8oJIv7Kz2sZIR+QDRR8P0HA9Cw9YIiSTfhLEJA97Y0VrMsXHmSuDOJUD2thnynbwrP2flxDW4Cj64YDP3ccBpw284CQ0Stui1pyxrX5T0mXOpUWoY/i38+RTL4WL+kRUU6fPozccOo6UgyqMDZJ9jYK1pI8V2yzejGRSL14FV1YuaueGSuPkZg/RSDPa1mbQYDGeDgCqiL/eHWrMm5aLnueG3cQ+wCCe05vl1aSrOBNgEDT0KseayQQ1I8ywylLPHwMKxubmj9bbhi9rdtHLej8vp1bID/9Q==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;
 s=arcselector9901;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-AntiSpam-MessageData-ChunkCount:X-MS-Exchange-AntiSpam-MessageData-0:X-MS-Exchange-AntiSpam-MessageData-1;
 bh=Q9B6yu467xAyn5zGtQn537KOKugfVQf5Imxoglrzm/Q=;
 b=jApAs99mmcHfJSO58iF/75Mc/PiuVjfDDN9wXzRPuvMbY3sqM9npCbLmuAAZ/YfQfrK+5PjhA8eO0wK/6lSZzevF+exRO+fbf8MDhz0rVU7ow6v7BN0R7+37EK53xH4oQsaf8yfm3qqrsQKAoBffNRft/5N/5ibBIeRP1cPOtKB7FI8d9j04OifI+MgATwzDQNY6R3BeXSTnb+YkL1NsuXjNz9uGw/BBS6Pef+aZNexcTbwKCpfzD4v+PhJaHtYX3t7Zd60ySNPxtloIyHxTOq7e8IBzgWM7aIrMcPIA1aD/WWeHHiNlQ3t1Ccp3mK5Nwg6D4g64esz/OZXZUpdY1Q==
ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass
 smtp.mailfrom=nxp.com; dmarc=pass action=none header.from=nxp.com; dkim=pass
 header.d=nxp.com; arc=none
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=nxp.com; s=selector2;
 h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;
 bh=Q9B6yu467xAyn5zGtQn537KOKugfVQf5Imxoglrzm/Q=;
 b=R7ANlYnsicVcdQSqTRyMRf5mfJLC7U6t14XfWK0f/vDrmyOrBmZPNKoJP1JZT71YiIYpe0mgBUu7DgMs9q2/4quMWqkzCYZB0vcJELk6HsGDailjdeLKLsm9IW9R74TLO4EE9WKH7lXF8vYEDy+kNt4AcL2LNQMyNT/uks1Hxf4=
Received: from AM6PR04MB6341.eurprd04.prod.outlook.com (2603:10a6:20b:d8::14)
 by VE1PR04MB7358.eurprd04.prod.outlook.com (2603:10a6:800:1a5::9) with
 Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.6298.45; Tue, 18 Apr
 2023 01:56:39 +0000
Received: from AM6PR04MB6341.eurprd04.prod.outlook.com
 ([fe80::79eb:7c7b:70df:e941]) by AM6PR04MB6341.eurprd04.prod.outlook.com
 ([fe80::79eb:7c7b:70df:e941%3]) with mapi id 15.20.6298.045; Tue, 18 Apr 2023
 01:56:39 +0000
From:   Ming Qian <ming.qian@nxp.com>
To:     Nicolas Dufresne <nicolas@ndufresne.ca>,
        "mchehab@kernel.org" <mchehab@kernel.org>,
        "shawnguo@kernel.org" <shawnguo@kernel.org>,
        "robh+dt@kernel.org" <robh+dt@kernel.org>,
        "s.hauer@pengutronix.de" <s.hauer@pengutronix.de>
CC:     "hverkuil-cisco@xs4all.nl" <hverkuil-cisco@xs4all.nl>,
        "kernel@pengutronix.de" <kernel@pengutronix.de>,
        "festevam@gmail.com" <festevam@gmail.com>,
        dl-linux-imx <linux-imx@nxp.com>,
        Aisheng Dong <aisheng.dong@nxp.com>,
        "linux-media@vger.kernel.org" <linux-media@vger.kernel.org>,
        "linux-kernel@vger.kernel.org" <linux-kernel@vger.kernel.org>,
        "devicetree@vger.kernel.org" <devicetree@vger.kernel.org>,
        "linux-arm-kernel@lists.infradead.org" 
        <linux-arm-kernel@lists.infradead.org>
Subject: RE: [EXT] Re: [PATCH v17 08/14] media: amphion: add v4l2 m2m vpu
 decoder stateful driver
Thread-Topic: [EXT] Re: [PATCH v17 08/14] media: amphion: add v4l2 m2m vpu
 decoder stateful driver
Thread-Index: AQHYKKmvApFfbIveCk+7xwiyP21hiq8ydS8AgABn8YA=
Date:   Tue, 18 Apr 2023 01:56:38 +0000
Message-ID: <AM6PR04MB6341456DD2A0B1DD2E962916E79D9@AM6PR04MB6341.eurprd04.prod.outlook.com>
References: <cover.1645615976.git.ming.qian@nxp.com>
         <c38c16d150b72d6b0d45988d4ec5a6ab5045a164.1645615976.git.ming.qian@nxp.com>
 <f96d25754d8811b0dde2ce40b94536c8421e1ecb.camel@ndufresne.ca>
In-Reply-To: <f96d25754d8811b0dde2ce40b94536c8421e1ecb.camel@ndufresne.ca>
Accept-Language: zh-CN, en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
authentication-results: dkim=none (message not signed)
 header.d=none;dmarc=none action=none header.from=nxp.com;
x-ms-publictraffictype: Email
x-ms-traffictypediagnostic: AM6PR04MB6341:EE_|VE1PR04MB7358:EE_
x-ms-office365-filtering-correlation-id: c0e24aac-bc63-4391-d9f8-08db3fb0261e
x-ms-exchange-senderadcheck: 1
x-ms-exchange-antispam-relay: 0
x-microsoft-antispam: BCL:0;
x-microsoft-antispam-message-info: EnG6aGe0RwUT4VgfFDTXGOunzv+7MGJDGiGajcGJv4m9eEAy3jv7mtDmmquKxSRRbMaGWiVexgF9U4Z9irMiU6bfJlAAkCvxbZ2sQdTH5CuhKpP/X/EdzyM+21YIdS76rOzV7Yll7LUKv7ObH4RGbAo7v+neOFlbJG6LvdCzB+PQ9ukoVvoIzekvE0XGnP0zNMPnmNWxrTMKT64AGYWd9FyEh/li+ykty0Ph8vfBQ4i223Y3FaJtKOW55eWR0s2Ac1b00PswyyvYsFLhWnriP7sI0KeQhIu2kpaFM7X+7w8qofqV1eD7izfhPWvWDpiLNYjezwFQBxYvgYTfigpxW/DtgPx6v2sfboZN0NxK3+JUclCfTujeW5H9TqdrJLVwOZOLqHE9wffbGznCuXPCTMFibMMJIggyphKJPiWlVuQajNG4PPrdZxQh81S1qoeUrraPr+YaWgYJnxQ9K2Gcz4ycsbJ/pENrJ9mo/HCSxRKzP1zmL52+Le+e3jVErXoKwxrWCefWP9I75k45ib0hagFsVH5Xy8nZk2TIVELE1dqUbl3Brm0ewv9ckEuADwBPGPxzfz6t1Sj7Imwv+qZNsALQynrrYN6I/ZFsjWR/q0U=
x-forefront-antispam-report: CIP:255.255.255.255;CTRY:;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:NSPM;H:AM6PR04MB6341.eurprd04.prod.outlook.com;PTR:;CAT:NONE;SFS:(13230028)(4636009)(136003)(366004)(346002)(39860400002)(396003)(376002)(451199021)(44832011)(66899021)(55016003)(76116006)(66476007)(66556008)(64756008)(66946007)(66446008)(478600001)(4326008)(110136005)(316002)(5660300002)(52536014)(8676002)(122000001)(8936002)(38100700002)(7416002)(41300700001)(54906003)(186003)(83380400001)(66574015)(71200400001)(9686003)(7696005)(45080400002)(6506007)(26005)(30864003)(38070700005)(33656002)(2906002)(86362001)(579004)(559001);DIR:OUT;SFP:1101;
x-ms-exchange-antispam-messagedata-chunkcount: 1
x-ms-exchange-antispam-messagedata-0: =?gb2312?B?L2hpa2hUL2JadXloK3d4TG43UkJMOGdEeU00SGZma2NkL0RSQUtBN0MySTFh?=
 =?gb2312?B?d2NHSk00NVFLekk3bXZnUEUxS21FbXE0c1ZBSE51dUpJUW5aTEVTQmk4QlJJ?=
 =?gb2312?B?UDgzeWsrZWxsMlJ5QlFlYU9ZUDJHSS9UUXV4c3lmZ1d6b1pPSEtUd2xSeWZO?=
 =?gb2312?B?bUpyVVN4dmJXZUEvQWpJL0cwelhVUjFqQnpwdXRhUmFHYzh4ay8xeVUrOFpG?=
 =?gb2312?B?UnFCQUxHSm14SkZKeXdWSGxZa3pLOExiLzRvU3cyMmE3Rm1CQld2ejdBYXNz?=
 =?gb2312?B?WDExWlUrK2F0eHlFdGFNQzhlblJNQVRSMk5GNDF0MlNTU3pTYWV4em1JNEwr?=
 =?gb2312?B?Rll3d2ZwRUx2M3QvT3pmTm1ZYlRlMXMyVFhha28vdkpueHlrOXlrcTF1NElC?=
 =?gb2312?B?THVLVmlPNlNiaC9JYjNGajBhLzJLSjM1TDFkWWVEZ3Q0c2J0b3IxVUZkaThG?=
 =?gb2312?B?a1p5WDZsMTk4bmF0Qlc3cUNPK21lRzh3U0dnRnJSSWtmUnlPOUg1N3l1aWwx?=
 =?gb2312?B?Sm91UkYyVlRBajdkKzBuZldtVUhmRFBOdzdMZTVhQ1YrNlQraVRhYWgyL2tE?=
 =?gb2312?B?VTdRQS9NeHdoLzhKVzF3SExsQjhFSldZV1hNakpBSE51MHBaS3hsb284dEJK?=
 =?gb2312?B?dHE4b3VuaHVJZTRaYTljQ1Uwak11L0FHTWZPTnVDREI2YVErdGRMSkJVWGZr?=
 =?gb2312?B?d3BPZjZKazUwUmoweTRlQUVjVXBuQ3RxZCtVZ3MyN2RzaHNWa0U2dnFiYy9K?=
 =?gb2312?B?bHRvVEFUQm96U3o3VUJNZUFER3F1bi9TSmx0Y21GTjU1Q2xsSlhJVy9UK3Q5?=
 =?gb2312?B?V2c4QVIrTVprUXhoZzBueHJMcWJ2MEtaVWZYeGdwcnZheVg2andMUU9NSVBX?=
 =?gb2312?B?UHJjaERhRkFzSktwU3FXSHZHOEFyYlZhcDk5U0lQZnd4MG9sbXdHc0dhaEpa?=
 =?gb2312?B?ek1hRm5xanFMTng1WDZuWnY0MkpQajV0OUZPR3JRNGtjZUhZVXdzWjU4WmZH?=
 =?gb2312?B?VVM4eDYzbzFkZGV1YmZxeEllc2prbldud2MrRHBWVUJ0REZQZGN4WkRkUVBI?=
 =?gb2312?B?MjJIZE83M2tlOHZtd282MXY1K1NkdHFST2NtOUtYTXQ4YkJTQ1c5MXJuOWVa?=
 =?gb2312?B?L2lpTjdNZ3FDd3daTlJjeE5CVitLeU5OeVQ4Z1ZVODFDN1NzMWVvR0pac25V?=
 =?gb2312?B?bTc3OVVrdFM3bkJEZVVTNnNNWTVyU2JlVXBxR0J2RUNuV1hzYzd5SzN6cVFB?=
 =?gb2312?B?em8walBTR2w4SFl3bjd2UURkRUR4bWhNNTc3Z3ZhUEJEMk9iZUF6WHFndWdu?=
 =?gb2312?B?QlQvMEJrbkdiZWVwZGRpNHJ1Q2c1b0NuQzMwOHl2ejhYbytnby9mbEVTblk4?=
 =?gb2312?B?aUNNa2NGR1drdC9zK3BuOEFtQSs0ZUtOMlNxc2Urc2l3ZkVWaGZ3OEoxRjQr?=
 =?gb2312?B?Q0NsZ1VDQTFNc0JnMzd6SHM5Y29IRmpwNUpVYWhtd0QwTHB1OXRYN2RnUWpG?=
 =?gb2312?B?cXBSR2doeGxORlo1NHhERFRqRjNQdW9DNHprUmJ4MExvREFFL2tmcnNrQzlW?=
 =?gb2312?B?dkwwZXJsZlowSys5MVpBZW0xRWtIYVo1OHhNcnZHZVVFYlppOGx0T09PalI1?=
 =?gb2312?B?MXBoeHpXa1JINytiTEVvRzEvTHdEUFpuMXNqNmJQTG9wR3dQcU9CYXRrbUJS?=
 =?gb2312?B?OUNNUEtJcU1QUWNqbGozeU1NZ1RucURENTlZYk5wRjUrSFR4b1RlOEpxOC9w?=
 =?gb2312?B?Z3BqOWZscHdJazRBMEkzNHg3YkYxYzlzd0VmUTIvQUZTQ3RsSlllT2JyVWMw?=
 =?gb2312?B?V0kyWDROT0h0RjZhQzZGdUU0Sm42Z3Y2MWpUREpRTEFyaWlkbjN6UnR4MEE1?=
 =?gb2312?B?Yk1zY1l4d3dpa1lDMDJwV0V3SFdWMGkybGxMN0t6bGlRWCtqek8xL2hEa3VV?=
 =?gb2312?B?c1MrckhYQldUUWVWSFJjV3RMWUZIR3hsY3d5czRxWWttYzdlKzhxTXNzZ0h0?=
 =?gb2312?B?QVpzZ3Y5R0wvOXRaTnlnb3RsNTVPR1Zyd1lwNlNUQzlVbDdvMUJ4ang2V3Y2?=
 =?gb2312?B?c2RzZHhSMEQ0SU55N3JUZnpkdmxPMGlwU0Nhak5rQTZNZmkxL0lVNjR6b2p6?=
 =?gb2312?Q?aZN0=3D?=
Content-Type: text/plain; charset="gb2312"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-OriginatorOrg: nxp.com
X-MS-Exchange-CrossTenant-AuthAs: Internal
X-MS-Exchange-CrossTenant-AuthSource: AM6PR04MB6341.eurprd04.prod.outlook.com
X-MS-Exchange-CrossTenant-Network-Message-Id: c0e24aac-bc63-4391-d9f8-08db3fb0261e
X-MS-Exchange-CrossTenant-originalarrivaltime: 18 Apr 2023 01:56:38.8912
 (UTC)
X-MS-Exchange-CrossTenant-fromentityheader: Hosted
X-MS-Exchange-CrossTenant-id: 686ea1d3-bc2b-4c6f-a92c-d99c5c301635
X-MS-Exchange-CrossTenant-mailboxtype: HOSTED
X-MS-Exchange-CrossTenant-userprincipalname: 59ctCJ7fdZ7Eozzsq7rr6HTer8zeXrkOZKc5YFYrOJCQjgpQd29O9fepqYpnbnJSEIoCdlwnDa3mVEKX6qRw/A==
X-MS-Exchange-Transport-CrossTenantHeadersStamped: VE1PR04MB7358
X-Spam-Status: No, score=-2.1 required=5.0 tests=BAYES_00,DKIM_SIGNED,
        DKIM_VALID,DKIM_VALID_AU,DKIM_VALID_EF,RCVD_IN_DNSWL_NONE,
        RCVD_IN_MSPIKE_H2,SPF_HELO_PASS,SPF_PASS,T_PDS_OTHER_BAD_TLD,
        T_SCC_BODY_TEXT_LINE,URIBL_BLOCKED autolearn=ham autolearn_force=no
        version=3.4.6
X-Spam-Checker-Version: SpamAssassin 3.4.6 (2021-04-09) on
        lindbergh.monkeyblade.net
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

SGkgTmljb2xhcywNCg0KDQo+LS0tLS1PcmlnaW5hbCBNZXNzYWdlLS0tLS0NCj5Gcm9tOiBOaWNv
bGFzIER1ZnJlc25lIDxuaWNvbGFzQG5kdWZyZXNuZS5jYT4NCj5TZW50OiAyMDIzxOo01MIxOMjV
IDM6MzINCj5UbzogTWluZyBRaWFuIDxtaW5nLnFpYW5AbnhwLmNvbT47IG1jaGVoYWJAa2VybmVs
Lm9yZzsNCj5zaGF3bmd1b0BrZXJuZWwub3JnOyByb2JoK2R0QGtlcm5lbC5vcmc7IHMuaGF1ZXJA
cGVuZ3V0cm9uaXguZGUNCj5DYzogaHZlcmt1aWwtY2lzY29AeHM0YWxsLm5sOyBrZXJuZWxAcGVu
Z3V0cm9uaXguZGU7IGZlc3RldmFtQGdtYWlsLmNvbTsNCj5kbC1saW51eC1pbXggPGxpbnV4LWlt
eEBueHAuY29tPjsgQWlzaGVuZyBEb25nIDxhaXNoZW5nLmRvbmdAbnhwLmNvbT47DQo+bGludXgt
bWVkaWFAdmdlci5rZXJuZWwub3JnOyBsaW51eC1rZXJuZWxAdmdlci5rZXJuZWwub3JnOw0KPmRl
dmljZXRyZWVAdmdlci5rZXJuZWwub3JnOyBsaW51eC1hcm0ta2VybmVsQGxpc3RzLmluZnJhZGVh
ZC5vcmcNCj5TdWJqZWN0OiBbRVhUXSBSZTogW1BBVENIIHYxNyAwOC8xNF0gbWVkaWE6IGFtcGhp
b246IGFkZCB2NGwyIG0ybSB2cHUNCj5kZWNvZGVyIHN0YXRlZnVsIGRyaXZlcg0KPg0KPkNhdXRp
b246IEVYVCBFbWFpbA0KPg0KPkhpIE1pbmcsDQo+DQo+SSBzdGFydGVkIHRvIHdvcmsgb24gcHJv
cGVyIHJlc29sdXRpb24gY2hhbmdlIHN1cHBvcnQgaW4gR1N0cmVhbWVyIFsxXSwgaXRzDQo+bm90
DQo+cmVhZHkgeWV0LCBidXQgaG9wZWZ1bGx5IHRoaXMgY2FuIGxhbmQgc29vbi4gVGhlIGN1cnJl
bnQgaW1wbGVtZW50YXRpb24geW91cg0KPnRlYW0gaGF2ZSBjb250cmlidXRlZCBoYXZlIG1hbnkg
c2hvcnRjb21pbmcgYW5kIGlzc3Vlcy4NCj4NCj5XaGlsZSB0ZXN0aW5nIHZhcmlvdXMgbWV0aG9k
cywgSSBzdHVtYmxlIGFjcm9zcyBhbiBpbnRlcmVzdGluZyBiZWhhdmlvdXIgb2YNCj55b3VyDQo+
ZHJpdmVyLCBzZWUgY29tbWVudCBpbmxpbmUuDQo+DQo+WzFdDQo+aHR0cHM6Ly9naXRsYWIuZi8N
Cj5yZWVkZXNrdG9wLm9yZyUyRmdzdHJlYW1lciUyRmdzdHJlYW1lciUyRi0NCj4lMkZtZXJnZV9y
ZXF1ZXN0cyUyRjQ0MzcmZGF0YT0wNSU3QzAxJTdDbWluZy5xaWFuJTQwbnhwLmNvbSU3QzkNCj4z
NmEwNDhlMjY2YjQyYzEzZTg4MDhkYjNmN2E2NjgzJTdDNjg2ZWExZDNiYzJiNGM2ZmE5MmNkOTlj
NWMzMDE2Mw0KPjUlN0MwJTdDMCU3QzYzODE3MzU2NzE3NzMxNDMyMCU3Q1Vua25vd24lN0NUV0Zw
Ykdac2IzZDhleUpXSQ0KPmpvaU1DNHdMakF3TURBaUxDSlFJam9pVjJsdU16SWlMQ0pCVGlJNklr
MWhhV3dpTENKWFZDSTZNbjAlM0QlN0MzMA0KPjAwJTdDJTdDJTdDJnNkYXRhPTlocWU3JTJGQmU2
cVpxeDdOcyUyRnpPNUxmaFEzQ0ZJaGk0UlFaWTFWcWwyDQo+Vkg0JTNEJnJlc2VydmVkPTANCj4N
Cj5MZSBtZXJjcmVkaSAyMyBmqKZ2cmllciAyMDIyIKikIDE5OjQwICswODAwLCBNaW5nIFFpYW4g
YSCopmNyaXQgOg0KPj4gVGhpcyBjb25zaXN0cyBvZiB2aWRlbyBkZWNvZGVyIGltcGxlbWVudGF0
aW9uIHBsdXMgZGVjb2RlciBjb250cm9scy4NCj4+DQo+PiBTaWduZWQtb2ZmLWJ5OiBNaW5nIFFp
YW4gPG1pbmcucWlhbkBueHAuY29tPg0KPj4gU2lnbmVkLW9mZi1ieTogU2hpamllIFFpbiA8c2hp
amllLnFpbkBueHAuY29tPg0KPj4gU2lnbmVkLW9mZi1ieTogWmhvdSBQZW5nIDxlYWdsZS56aG91
QG54cC5jb20+DQo+PiBUZXN0ZWQtYnk6IE5pY29sYXMgRHVmcmVzbmUgPG5pY29sYXMuZHVmcmVz
bmVAY29sbGFib3JhLmNvbT4NCj4+IC0tLQ0KPj4gIGRyaXZlcnMvbWVkaWEvcGxhdGZvcm0vYW1w
aGlvbi92ZGVjLmMgfCAxNjkxDQo+KysrKysrKysrKysrKysrKysrKysrKysrKw0KPj4gIDEgZmls
ZSBjaGFuZ2VkLCAxNjkxIGluc2VydGlvbnMoKykNCj4+ICBjcmVhdGUgbW9kZSAxMDA2NDQgZHJp
dmVycy9tZWRpYS9wbGF0Zm9ybS9hbXBoaW9uL3ZkZWMuYw0KPj4NCj4+IGRpZmYgLS1naXQgYS9k
cml2ZXJzL21lZGlhL3BsYXRmb3JtL2FtcGhpb24vdmRlYy5jDQo+Yi9kcml2ZXJzL21lZGlhL3Bs
YXRmb3JtL2FtcGhpb24vdmRlYy5jDQo+PiBuZXcgZmlsZSBtb2RlIDEwMDY0NA0KPj4gaW5kZXgg
MDAwMDAwMDAwMDAwLi4yNGNlNWVhOGViZjcNCj4+IC0tLSAvZGV2L251bGwNCj4+ICsrKyBiL2Ry
aXZlcnMvbWVkaWEvcGxhdGZvcm0vYW1waGlvbi92ZGVjLmMNCj4+IEBAIC0wLDAgKzEsMTY5MSBA
QA0KPj4gKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wDQo+PiArLyoNCj4+ICsg
KiBDb3B5cmlnaHQgMjAyMC0yMDIxIE5YUA0KPj4gKyAqLw0KPj4gKw0KPj4gKyNpbmNsdWRlIDxs
aW51eC9pbml0Lmg+DQo+PiArI2luY2x1ZGUgPGxpbnV4L2ludGVyY29ubmVjdC5oPg0KPj4gKyNp
bmNsdWRlIDxsaW51eC9pb2N0bC5oPg0KPj4gKyNpbmNsdWRlIDxsaW51eC9saXN0Lmg+DQo+PiAr
I2luY2x1ZGUgPGxpbnV4L2tlcm5lbC5oPg0KPj4gKyNpbmNsdWRlIDxsaW51eC9tb2R1bGUuaD4N
Cj4+ICsjaW5jbHVkZSA8bGludXgvdm1hbGxvYy5oPg0KPj4gKyNpbmNsdWRlIDxsaW51eC92aWRl
b2RldjIuaD4NCj4+ICsjaW5jbHVkZSA8bWVkaWEvdjRsMi1kZXZpY2UuaD4NCj4+ICsjaW5jbHVk
ZSA8bWVkaWEvdjRsMi1ldmVudC5oPg0KPj4gKyNpbmNsdWRlIDxtZWRpYS92NGwyLW1lbTJtZW0u
aD4NCj4+ICsjaW5jbHVkZSA8bWVkaWEvdjRsMi1pb2N0bC5oPg0KPj4gKyNpbmNsdWRlIDxtZWRp
YS92aWRlb2J1ZjItdjRsMi5oPg0KPj4gKyNpbmNsdWRlIDxtZWRpYS92aWRlb2J1ZjItZG1hLWNv
bnRpZy5oPg0KPj4gKyNpbmNsdWRlIDxtZWRpYS92aWRlb2J1ZjItdm1hbGxvYy5oPg0KPj4gKyNp
bmNsdWRlICJ2cHUuaCINCj4+ICsjaW5jbHVkZSAidnB1X2RlZnMuaCINCj4+ICsjaW5jbHVkZSAi
dnB1X2NvcmUuaCINCj4+ICsjaW5jbHVkZSAidnB1X2hlbHBlcnMuaCINCj4+ICsjaW5jbHVkZSAi
dnB1X3Y0bDIuaCINCj4+ICsjaW5jbHVkZSAidnB1X2NtZHMuaCINCj4+ICsjaW5jbHVkZSAidnB1
X3JwYy5oIg0KPj4gKw0KPj4gKyNkZWZpbmUgVkRFQ19GUkFNRV9ERVBUSCAgICAgICAgICAgICAy
NTYNCj4+ICsjZGVmaW5lIFZERUNfTUlOX0JVRkZFUl9DQVAgICAgICAgICAgOA0KPj4gKw0KPj4g
K3N0cnVjdCB2ZGVjX2ZzX2luZm8gew0KPj4gKyAgICAgY2hhciBuYW1lWzhdOw0KPj4gKyAgICAg
dTMyIHR5cGU7DQo+PiArICAgICB1MzIgbWF4X2NvdW50Ow0KPj4gKyAgICAgdTMyIHJlcV9jb3Vu
dDsNCj4+ICsgICAgIHUzMiBjb3VudDsNCj4+ICsgICAgIHUzMiBpbmRleDsNCj4+ICsgICAgIHUz
MiBzaXplOw0KPj4gKyAgICAgc3RydWN0IHZwdV9idWZmZXIgYnVmZmVyWzMyXTsNCj4+ICsgICAg
IHUzMiB0YWc7DQo+PiArfTsNCj4+ICsNCj4+ICtzdHJ1Y3QgdmRlY190IHsNCj4+ICsgICAgIHUz
MiBzZXFfaGRyX2ZvdW5kOw0KPj4gKyAgICAgc3RydWN0IHZwdV9idWZmZXIgdWRhdGE7DQo+PiAr
ICAgICBzdHJ1Y3QgdnB1X2RlY29kZV9wYXJhbXMgcGFyYW1zOw0KPj4gKyAgICAgc3RydWN0IHZw
dV9kZWNfY29kZWNfaW5mbyBjb2RlY19pbmZvOw0KPj4gKyAgICAgZW51bSB2cHVfY29kZWNfc3Rh
dGUgc3RhdGU7DQo+PiArDQo+PiArICAgICBzdHJ1Y3QgdnB1X3ZiMl9idWZmZXIgKnNsb3RzW1ZC
Ml9NQVhfRlJBTUVdOw0KPj4gKyAgICAgdTMyIHJlcV9mcmFtZV9jb3VudDsNCj4+ICsgICAgIHN0
cnVjdCB2ZGVjX2ZzX2luZm8gbWJpOw0KPj4gKyAgICAgc3RydWN0IHZkZWNfZnNfaW5mbyBkY3A7
DQo+PiArICAgICB1MzIgc2VxX3RhZzsNCj4+ICsNCj4+ICsgICAgIGJvb2wgcmVzZXRfY29kZWM7
DQo+PiArICAgICBib29sIGZpeGVkX2ZtdDsNCj4+ICsgICAgIHUzMiBkZWNvZGVkX2ZyYW1lX2Nv
dW50Ow0KPj4gKyAgICAgdTMyIGRpc3BsYXlfZnJhbWVfY291bnQ7DQo+PiArICAgICB1MzIgc2Vx
dWVuY2U7DQo+PiArICAgICB1MzIgZW9zX3JlY2VpdmVkOw0KPj4gKyAgICAgYm9vbCBpc19zb3Vy
Y2VfY2hhbmdlZDsNCj4+ICsgICAgIHUzMiBzb3VyY2VfY2hhbmdlOw0KPj4gKyAgICAgdTMyIGRy
YWluOw0KPj4gKyAgICAgdTMyIHRzX3ByZV9jb3VudDsNCj4+ICsgICAgIHUzMiBmcmFtZV9kZXB0
aDsNCj4+ICsgICAgIHM2NCB0c19zdGFydDsNCj4+ICsgICAgIHM2NCB0c19pbnB1dDsNCj4+ICsg
ICAgIHM2NCB0aW1lc3RhbXA7DQo+PiArfTsNCj4+ICsNCj4+ICtzdGF0aWMgY29uc3Qgc3RydWN0
IHZwdV9mb3JtYXQgdmRlY19mb3JtYXRzW10gPSB7DQo+PiArICAgICB7DQo+PiArICAgICAgICAg
ICAgIC5waXhmbXQgPSBWNEwyX1BJWF9GTVRfTlYxMk1fOEwxMjgsDQo+PiArICAgICAgICAgICAg
IC5udW1fcGxhbmVzID0gMiwNCj4+ICsgICAgICAgICAgICAgLnR5cGUgPSBWNEwyX0JVRl9UWVBF
X1ZJREVPX0NBUFRVUkVfTVBMQU5FLA0KPj4gKyAgICAgfSwNCj4+ICsgICAgIHsNCj4+ICsgICAg
ICAgICAgICAgLnBpeGZtdCA9IFY0TDJfUElYX0ZNVF9OVjEyTV8xMEJFXzhMMTI4LA0KPj4gKyAg
ICAgICAgICAgICAubnVtX3BsYW5lcyA9IDIsDQo+PiArICAgICAgICAgICAgIC50eXBlID0gVjRM
Ml9CVUZfVFlQRV9WSURFT19DQVBUVVJFX01QTEFORSwNCj4+ICsgICAgIH0sDQo+PiArICAgICB7
DQo+PiArICAgICAgICAgICAgIC5waXhmbXQgPSBWNEwyX1BJWF9GTVRfSDI2NCwNCj4+ICsgICAg
ICAgICAgICAgLm51bV9wbGFuZXMgPSAxLA0KPj4gKyAgICAgICAgICAgICAudHlwZSA9IFY0TDJf
QlVGX1RZUEVfVklERU9fT1VUUFVUX01QTEFORSwNCj4+ICsgICAgICAgICAgICAgLmZsYWdzID0g
VjRMMl9GTVRfRkxBR19EWU5fUkVTT0xVVElPTg0KPj4gKyAgICAgfSwNCj4+ICsgICAgIHsNCj4+
ICsgICAgICAgICAgICAgLnBpeGZtdCA9IFY0TDJfUElYX0ZNVF9IMjY0X01WQywNCj4+ICsgICAg
ICAgICAgICAgLm51bV9wbGFuZXMgPSAxLA0KPj4gKyAgICAgICAgICAgICAudHlwZSA9IFY0TDJf
QlVGX1RZUEVfVklERU9fT1VUUFVUX01QTEFORSwNCj4+ICsgICAgICAgICAgICAgLmZsYWdzID0g
VjRMMl9GTVRfRkxBR19EWU5fUkVTT0xVVElPTg0KPj4gKyAgICAgfSwNCj4+ICsgICAgIHsNCj4+
ICsgICAgICAgICAgICAgLnBpeGZtdCA9IFY0TDJfUElYX0ZNVF9IRVZDLA0KPj4gKyAgICAgICAg
ICAgICAubnVtX3BsYW5lcyA9IDEsDQo+PiArICAgICAgICAgICAgIC50eXBlID0gVjRMMl9CVUZf
VFlQRV9WSURFT19PVVRQVVRfTVBMQU5FLA0KPj4gKyAgICAgICAgICAgICAuZmxhZ3MgPSBWNEwy
X0ZNVF9GTEFHX0RZTl9SRVNPTFVUSU9ODQo+PiArICAgICB9LA0KPj4gKyAgICAgew0KPj4gKyAg
ICAgICAgICAgICAucGl4Zm10ID0gVjRMMl9QSVhfRk1UX1ZDMV9BTk5FWF9HLA0KPj4gKyAgICAg
ICAgICAgICAubnVtX3BsYW5lcyA9IDEsDQo+PiArICAgICAgICAgICAgIC50eXBlID0gVjRMMl9C
VUZfVFlQRV9WSURFT19PVVRQVVRfTVBMQU5FLA0KPj4gKyAgICAgICAgICAgICAuZmxhZ3MgPSBW
NEwyX0ZNVF9GTEFHX0RZTl9SRVNPTFVUSU9ODQo+PiArICAgICB9LA0KPj4gKyAgICAgew0KPj4g
KyAgICAgICAgICAgICAucGl4Zm10ID0gVjRMMl9QSVhfRk1UX1ZDMV9BTk5FWF9MLA0KPj4gKyAg
ICAgICAgICAgICAubnVtX3BsYW5lcyA9IDEsDQo+PiArICAgICAgICAgICAgIC50eXBlID0gVjRM
Ml9CVUZfVFlQRV9WSURFT19PVVRQVVRfTVBMQU5FLA0KPj4gKyAgICAgICAgICAgICAuZmxhZ3Mg
PSBWNEwyX0ZNVF9GTEFHX0RZTl9SRVNPTFVUSU9ODQo+PiArICAgICB9LA0KPj4gKyAgICAgew0K
Pj4gKyAgICAgICAgICAgICAucGl4Zm10ID0gVjRMMl9QSVhfRk1UX01QRUcyLA0KPj4gKyAgICAg
ICAgICAgICAubnVtX3BsYW5lcyA9IDEsDQo+PiArICAgICAgICAgICAgIC50eXBlID0gVjRMMl9C
VUZfVFlQRV9WSURFT19PVVRQVVRfTVBMQU5FLA0KPj4gKyAgICAgICAgICAgICAuZmxhZ3MgPSBW
NEwyX0ZNVF9GTEFHX0RZTl9SRVNPTFVUSU9ODQo+PiArICAgICB9LA0KPj4gKyAgICAgew0KPj4g
KyAgICAgICAgICAgICAucGl4Zm10ID0gVjRMMl9QSVhfRk1UX01QRUc0LA0KPj4gKyAgICAgICAg
ICAgICAubnVtX3BsYW5lcyA9IDEsDQo+PiArICAgICAgICAgICAgIC50eXBlID0gVjRMMl9CVUZf
VFlQRV9WSURFT19PVVRQVVRfTVBMQU5FLA0KPj4gKyAgICAgICAgICAgICAuZmxhZ3MgPSBWNEwy
X0ZNVF9GTEFHX0RZTl9SRVNPTFVUSU9ODQo+PiArICAgICB9LA0KPj4gKyAgICAgew0KPj4gKyAg
ICAgICAgICAgICAucGl4Zm10ID0gVjRMMl9QSVhfRk1UX1hWSUQsDQo+PiArICAgICAgICAgICAg
IC5udW1fcGxhbmVzID0gMSwNCj4+ICsgICAgICAgICAgICAgLnR5cGUgPSBWNEwyX0JVRl9UWVBF
X1ZJREVPX09VVFBVVF9NUExBTkUsDQo+PiArICAgICAgICAgICAgIC5mbGFncyA9IFY0TDJfRk1U
X0ZMQUdfRFlOX1JFU09MVVRJT04NCj4+ICsgICAgIH0sDQo+PiArICAgICB7DQo+PiArICAgICAg
ICAgICAgIC5waXhmbXQgPSBWNEwyX1BJWF9GTVRfVlA4LA0KPj4gKyAgICAgICAgICAgICAubnVt
X3BsYW5lcyA9IDEsDQo+PiArICAgICAgICAgICAgIC50eXBlID0gVjRMMl9CVUZfVFlQRV9WSURF
T19PVVRQVVRfTVBMQU5FLA0KPj4gKyAgICAgICAgICAgICAuZmxhZ3MgPSBWNEwyX0ZNVF9GTEFH
X0RZTl9SRVNPTFVUSU9ODQo+PiArICAgICB9LA0KPj4gKyAgICAgew0KPj4gKyAgICAgICAgICAg
ICAucGl4Zm10ID0gVjRMMl9QSVhfRk1UX0gyNjMsDQo+PiArICAgICAgICAgICAgIC5udW1fcGxh
bmVzID0gMSwNCj4+ICsgICAgICAgICAgICAgLnR5cGUgPSBWNEwyX0JVRl9UWVBFX1ZJREVPX09V
VFBVVF9NUExBTkUsDQo+PiArICAgICAgICAgICAgIC5mbGFncyA9IFY0TDJfRk1UX0ZMQUdfRFlO
X1JFU09MVVRJT04NCj4+ICsgICAgIH0sDQo+PiArICAgICB7MCwgMCwgMCwgMH0sDQo+PiArfTsN
Cj4+ICsNCj4+ICtzdGF0aWMgY29uc3Qgc3RydWN0IHY0bDJfY3RybF9vcHMgdmRlY19jdHJsX29w
cyA9IHsNCj4+ICsgICAgIC5nX3ZvbGF0aWxlX2N0cmwgPSB2cHVfaGVscGVyX2dfdm9sYXRpbGVf
Y3RybCwNCj4+ICt9Ow0KPj4gKw0KPj4gK3N0YXRpYyBpbnQgdmRlY19jdHJsX2luaXQoc3RydWN0
IHZwdV9pbnN0ICppbnN0KQ0KPj4gK3sNCj4+ICsgICAgIHN0cnVjdCB2NGwyX2N0cmwgKmN0cmw7
DQo+PiArICAgICBpbnQgcmV0Ow0KPj4gKw0KPj4gKyAgICAgcmV0ID0gdjRsMl9jdHJsX2hhbmRs
ZXJfaW5pdCgmaW5zdC0+Y3RybF9oYW5kbGVyLCAyMCk7DQo+PiArICAgICBpZiAocmV0KQ0KPj4g
KyAgICAgICAgICAgICByZXR1cm4gcmV0Ow0KPj4gKw0KPj4gKyAgICAgY3RybCA9IHY0bDJfY3Ry
bF9uZXdfc3RkKCZpbnN0LT5jdHJsX2hhbmRsZXIsICZ2ZGVjX2N0cmxfb3BzLA0KPj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFY0TDJfQ0lEX01JTl9CVUZGRVJTX0ZPUl9DQVBUVVJF
LCAxLCAzMiwgMSwgMik7DQo+PiArICAgICBpZiAoY3RybCkNCj4+ICsgICAgICAgICAgICAgY3Ry
bC0+ZmxhZ3MgfD0gVjRMMl9DVFJMX0ZMQUdfVk9MQVRJTEU7DQo+PiArDQo+PiArICAgICBjdHJs
ID0gdjRsMl9jdHJsX25ld19zdGQoJmluc3QtPmN0cmxfaGFuZGxlciwgJnZkZWNfY3RybF9vcHMs
DQo+PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVjRMMl9DSURfTUlOX0JVRkZFUlNf
Rk9SX09VVFBVVCwgMSwgMzIsIDEsIDIpOw0KPj4gKyAgICAgaWYgKGN0cmwpDQo+PiArICAgICAg
ICAgICAgIGN0cmwtPmZsYWdzIHw9IFY0TDJfQ1RSTF9GTEFHX1ZPTEFUSUxFOw0KPj4gKw0KPj4g
KyAgICAgcmV0ID0gdjRsMl9jdHJsX2hhbmRsZXJfc2V0dXAoJmluc3QtPmN0cmxfaGFuZGxlcik7
DQo+PiArICAgICBpZiAocmV0KSB7DQo+PiArICAgICAgICAgICAgIGRldl9lcnIoaW5zdC0+ZGV2
LCAiWyVkXSBzZXR1cCBjdHJscyBmYWlsLCByZXQgPSAlZFxuIiwgaW5zdC0+aWQsIHJldCk7DQo+
PiArICAgICAgICAgICAgIHY0bDJfY3RybF9oYW5kbGVyX2ZyZWUoJmluc3QtPmN0cmxfaGFuZGxl
cik7DQo+PiArICAgICAgICAgICAgIHJldHVybiByZXQ7DQo+PiArICAgICB9DQo+PiArDQo+PiAr
ICAgICByZXR1cm4gMDsNCj4+ICt9DQo+PiArDQo+PiArc3RhdGljIHZvaWQgdmRlY19zZXRfbGFz
dF9idWZmZXJfZGVxdWV1ZWQoc3RydWN0IHZwdV9pbnN0ICppbnN0KQ0KPj4gK3sNCj4+ICsgICAg
IHN0cnVjdCB2ZGVjX3QgKnZkZWMgPSBpbnN0LT5wcml2Ow0KPj4gKw0KPj4gKyAgICAgaWYgKHZk
ZWMtPmVvc19yZWNlaXZlZCkgew0KPj4gKyAgICAgICAgICAgICBpZiAoIXZwdV9zZXRfbGFzdF9i
dWZmZXJfZGVxdWV1ZWQoaW5zdCkpDQo+PiArICAgICAgICAgICAgICAgICAgICAgdmRlYy0+ZW9z
X3JlY2VpdmVkLS07DQo+PiArICAgICB9DQo+PiArfQ0KPj4gKw0KPj4gK3N0YXRpYyB2b2lkIHZk
ZWNfaGFuZGxlX3Jlc29sdXRpb25fY2hhbmdlKHN0cnVjdCB2cHVfaW5zdCAqaW5zdCkNCj4+ICt7
DQo+PiArICAgICBzdHJ1Y3QgdmRlY190ICp2ZGVjID0gaW5zdC0+cHJpdjsNCj4+ICsgICAgIHN0
cnVjdCB2YjJfcXVldWUgKnE7DQo+PiArDQo+PiArICAgICBpZiAoIWluc3QtPmZoLm0ybV9jdHgp
DQo+PiArICAgICAgICAgICAgIHJldHVybjsNCj4+ICsNCj4+ICsgICAgIGlmIChpbnN0LT5zdGF0
ZSAhPSBWUFVfQ09ERUNfU1RBVEVfRFlBTUlDX1JFU09MVVRJT05fQ0hBTkdFKQ0KPj4gKyAgICAg
ICAgICAgICByZXR1cm47DQo+PiArICAgICBpZiAoIXZkZWMtPnNvdXJjZV9jaGFuZ2UpDQo+PiAr
ICAgICAgICAgICAgIHJldHVybjsNCj4+ICsNCj4+ICsgICAgIHEgPSB2NGwyX20ybV9nZXRfZHN0
X3ZxKGluc3QtPmZoLm0ybV9jdHgpOw0KPj4gKyAgICAgaWYgKCFsaXN0X2VtcHR5KCZxLT5kb25l
X2xpc3QpKQ0KPj4gKyAgICAgICAgICAgICByZXR1cm47DQo+Pg0KPj4NCj4+DQo+Pg0KPg0KPkhl
cmUgeW91IHdhaXQgZm9yIHVzZXJzcGFjZSB0byBkZXF1ZXVlIGFsbCB0aGUgY2FwdHVyZSBidWZm
ZXJzLiBUaGlzIGV4dHJhDQo+ZWZmb3J0IGlzIG5vdCByZXF1aXJlZCBieSB0aGUgc3BlYy4gQnV0
IHdoYXQgaXMgcmVxdWlyZWQgYnkgdGhlIHNwZWMgaXMgdGhhdCB5b3UNCj5zaG91bGQgaW5pdGlh
dGUgYSBkcmFpbiBvZiB0aGUgY2FwdHVyZSBxdWV1ZS4gUGxlYXNlIGZpbmQgYmVsb3cgYSBxdW90
ZSBmcm9tDQo+dGhlDQo+c3BlYzoNCj4NCj4NCj4+IDIuIFRoZSBkZWNvZGVyIHdpbGwgdGhlbiBw
cm9jZXNzIGFuZCBkZWNvZGUgYWxsIHJlbWFpbmluZyBidWZmZXJzIGZyb20NCj5iZWZvcmUNCj4+
IHRoZSByZXNvbHV0aW9uIGNoYW5nZSBwb2ludC4NCj4+DQo+PiAgICBUaGUgbGFzdCBidWZmZXIg
ZnJvbSBiZWZvcmUgdGhlIGNoYW5nZSBtdXN0IGJlIG1hcmtlZCB3aXRoIHRoZQ0KPj4gICAgVjRM
Ml9CVUZfRkxBR19MQVNUIGZsYWcsIHNpbWlsYXJseSB0byB0aGUgRHJhaW4gc2VxdWVuY2UgYWJv
dmUuDQo+DQo+DQoNClllcywgSSBoYXZlIG5vdGljZWQgdGhpcyBzZWN0aW9uIG9mIHNwZWMuDQpC
dXQgZm9yIHNvbWUgbGVnYWN5IGFwcGxpY2F0aW9uLCBpdCB3aWxsIGhhbmRsZSB0aGUgcmVzb2x1
dGlvbiBjaGFuZ2UgZXZlbnQgaW1tZWRpYXRlbHkgd2l0aG91dCBkZXF1ZXVpbmcgY2FwdHVyZSBi
dWZmZXIgdW50aWwgdGhlIGxhc3QgYnVmZmVyLCBhbmQgZXhpdCBpbW1lZGlhdGVseSBpZiB0aGUg
bGFzdCBidWZmZXIgaXMgcmVjZWl2ZWQuDQpzb21lIGZyYW1lcyBtYXkgYmUgbG9zdCBpbiByZXNv
bHV0aW9uIGNoYW5nZSBjYXNlLCBvciB0aGUgYXBwbGljYXRpb24gbWF5IGV4aXQgaW4gYWR2YW5j
ZSB1bmV4cGVjdGVkLg0KDQpTbyBJIGRpZG4ndCBzZXQgdGhlIGxhc3QgZmxhZyBiZWZvcmUgdGhl
IHJlc29sdXRpb24gY2hhbmdlLCBidXQgdHJpZ2dlciB0aGUgZXZlbnQgYWZ0ZXIgYWxsIGNhcHR1
cmUgYnVmZmVycyBhcmUgZGVxdWV1ZWQuDQoNCklmIEkgaW5pdGlhdGUgYSBkcmFpbiBvZiB0aGUg
Y2FwdHVyZSBxdWV1ZSBpbiBkeW5hbWljIHJlc29sdXRpb24gY2hhbmdlLCB3ZSBuZWVkIHRvIGNo
YW5nZSB0aGUgYXBwbGljYXRpb24ncyBiZWhhdmlvciB0byBiZSBtb3JlIG5vcm1hdGl2ZS4NCkJ1
dCBpdCB0YWtlcyBtb3JlIHdvcmssICBXZSdsbCBkaXNjdXNzIGl0IGludGVybmFsbHkgZmlyc3Qs
IGFuZCB0aGVuIHRyeSB0byBmaXggaXQuDQoNCk1pbmcNCg0KPj4NCj4+DQo+PiArDQo+PiArICAg
ICB2ZGVjLT5zb3VyY2VfY2hhbmdlLS07DQo+PiArICAgICB2cHVfbm90aWZ5X3NvdXJjZV9jaGFu
Z2UoaW5zdCk7DQo+PiArfQ0KPj4gKw0KPj4gK3N0YXRpYyBpbnQgdmRlY191cGRhdGVfc3RhdGUo
c3RydWN0IHZwdV9pbnN0ICppbnN0LCBlbnVtIHZwdV9jb2RlY19zdGF0ZQ0KPnN0YXRlLCB1MzIg
Zm9yY2UpDQo+PiArew0KPj4gKyAgICAgc3RydWN0IHZkZWNfdCAqdmRlYyA9IGluc3QtPnByaXY7
DQo+PiArICAgICBlbnVtIHZwdV9jb2RlY19zdGF0ZSBwcmVfc3RhdGUgPSBpbnN0LT5zdGF0ZTsN
Cj4+ICsNCj4+ICsgICAgIGlmIChzdGF0ZSA9PSBWUFVfQ09ERUNfU1RBVEVfU0VFSykgew0KPj4g
KyAgICAgICAgICAgICBpZiAoaW5zdC0+c3RhdGUgPT0NCj5WUFVfQ09ERUNfU1RBVEVfRFlBTUlD
X1JFU09MVVRJT05fQ0hBTkdFKQ0KPj4gKyAgICAgICAgICAgICAgICAgICAgIHZkZWMtPnN0YXRl
ID0gaW5zdC0+c3RhdGU7DQo+PiArICAgICAgICAgICAgIGVsc2UNCj4+ICsgICAgICAgICAgICAg
ICAgICAgICB2ZGVjLT5zdGF0ZSA9IFZQVV9DT0RFQ19TVEFURV9BQ1RJVkU7DQo+PiArICAgICB9
DQo+PiArICAgICBpZiAoaW5zdC0+c3RhdGUgIT0gVlBVX0NPREVDX1NUQVRFX1NFRUsgfHwgZm9y
Y2UpDQo+PiArICAgICAgICAgICAgIGluc3QtPnN0YXRlID0gc3RhdGU7DQo+PiArICAgICBlbHNl
IGlmIChzdGF0ZSA9PSBWUFVfQ09ERUNfU1RBVEVfRFlBTUlDX1JFU09MVVRJT05fQ0hBTkdFKQ0K
Pj4gKyAgICAgICAgICAgICB2ZGVjLT5zdGF0ZSA9IFZQVV9DT0RFQ19TVEFURV9EWUFNSUNfUkVT
T0xVVElPTl9DSEFOR0U7DQo+PiArDQo+PiArICAgICBpZiAoaW5zdC0+c3RhdGUgIT0gcHJlX3N0
YXRlKQ0KPj4gKyAgICAgICAgICAgICB2cHVfdHJhY2UoaW5zdC0+ZGV2LCAiWyVkXSAlZCAtPiAl
ZFxuIiwgaW5zdC0+aWQsIHByZV9zdGF0ZSwgaW5zdC0NCj4+c3RhdGUpOw0KPj4gKw0KPj4gKyAg
ICAgaWYgKGluc3QtPnN0YXRlID09IFZQVV9DT0RFQ19TVEFURV9EWUFNSUNfUkVTT0xVVElPTl9D
SEFOR0UpDQo+PiArICAgICAgICAgICAgIHZkZWNfaGFuZGxlX3Jlc29sdXRpb25fY2hhbmdlKGlu
c3QpOw0KPj4gKw0KPj4gKyAgICAgcmV0dXJuIDA7DQo+PiArfQ0KPj4gKw0KPj4gK3N0YXRpYyBp
bnQgdmRlY19xdWVyeWNhcChzdHJ1Y3QgZmlsZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwy
X2NhcGFiaWxpdHkNCj4qY2FwKQ0KPj4gK3sNCj4+ICsgICAgIHN0cnNjcHkoY2FwLT5kcml2ZXIs
ICJhbXBoaW9uLXZwdSIsIHNpemVvZihjYXAtPmRyaXZlcikpOw0KPj4gKyAgICAgc3Ryc2NweShj
YXAtPmNhcmQsICJhbXBoaW9uIHZwdSBkZWNvZGVyIiwgc2l6ZW9mKGNhcC0+Y2FyZCkpOw0KPj4g
KyAgICAgc3Ryc2NweShjYXAtPmJ1c19pbmZvLCAicGxhdGZvcm06IGFtcGhpb24tdnB1Iiwgc2l6
ZW9mKGNhcC0+YnVzX2luZm8pKTsNCj4+ICsNCj4+ICsgICAgIHJldHVybiAwOw0KPj4gK30NCj4+
ICsNCj4+ICtzdGF0aWMgaW50IHZkZWNfZW51bV9mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQg
KmZoLCBzdHJ1Y3QgdjRsMl9mbXRkZXNjICpmKQ0KPj4gK3sNCj4+ICsgICAgIHN0cnVjdCB2cHVf
aW5zdCAqaW5zdCA9IHRvX2luc3QoZmlsZSk7DQo+PiArICAgICBzdHJ1Y3QgdmRlY190ICp2ZGVj
ID0gaW5zdC0+cHJpdjsNCj4+ICsgICAgIGNvbnN0IHN0cnVjdCB2cHVfZm9ybWF0ICpmbXQ7DQo+
PiArICAgICBpbnQgcmV0ID0gLUVJTlZBTDsNCj4+ICsNCj4+ICsgICAgIHZwdV9pbnN0X2xvY2so
aW5zdCk7DQo+PiArICAgICBpZiAoIVY0TDJfVFlQRV9JU19PVVRQVVQoZi0+dHlwZSkgJiYgdmRl
Yy0+Zml4ZWRfZm10KSB7DQo+PiArICAgICAgICAgICAgIGlmIChmLT5pbmRleCA9PSAwKSB7DQo+
PiArICAgICAgICAgICAgICAgICAgICAgZi0+cGl4ZWxmb3JtYXQgPSBpbnN0LT5jYXBfZm9ybWF0
LnBpeGZtdDsNCj4+ICsgICAgICAgICAgICAgICAgICAgICBmLT5mbGFncyA9IGluc3QtPmNhcF9m
b3JtYXQuZmxhZ3M7DQo+PiArICAgICAgICAgICAgICAgICAgICAgcmV0ID0gMDsNCj4+ICsgICAg
ICAgICAgICAgfQ0KPj4gKyAgICAgfSBlbHNlIHsNCj4+ICsgICAgICAgICAgICAgZm10ID0gdnB1
X2hlbHBlcl9lbnVtX2Zvcm1hdChpbnN0LCBmLT50eXBlLCBmLT5pbmRleCk7DQo+PiArICAgICAg
ICAgICAgIG1lbXNldChmLT5yZXNlcnZlZCwgMCwgc2l6ZW9mKGYtPnJlc2VydmVkKSk7DQo+PiAr
ICAgICAgICAgICAgIGlmICghZm10KQ0KPj4gKyAgICAgICAgICAgICAgICAgICAgIGdvdG8gZXhp
dDsNCj4+ICsNCj4+ICsgICAgICAgICAgICAgZi0+cGl4ZWxmb3JtYXQgPSBmbXQtPnBpeGZtdDsN
Cj4+ICsgICAgICAgICAgICAgZi0+ZmxhZ3MgPSBmbXQtPmZsYWdzOw0KPj4gKyAgICAgICAgICAg
ICByZXQgPSAwOw0KPj4gKyAgICAgfQ0KPj4gKw0KPj4gK2V4aXQ6DQo+PiArICAgICB2cHVfaW5z
dF91bmxvY2soaW5zdCk7DQo+PiArICAgICByZXR1cm4gcmV0Ow0KPj4gK30NCj4+ICsNCj4+ICtz
dGF0aWMgaW50IHZkZWNfZ19mbXQoc3RydWN0IGZpbGUgKmZpbGUsIHZvaWQgKmZoLCBzdHJ1Y3Qg
djRsMl9mb3JtYXQgKmYpDQo+PiArew0KPj4gKyAgICAgc3RydWN0IHZwdV9pbnN0ICppbnN0ID0g
dG9faW5zdChmaWxlKTsNCj4+ICsgICAgIHN0cnVjdCB2ZGVjX3QgKnZkZWMgPSBpbnN0LT5wcml2
Ow0KPj4gKyAgICAgc3RydWN0IHY0bDJfcGl4X2Zvcm1hdF9tcGxhbmUgKnBpeG1wID0gJmYtPmZt
dC5waXhfbXA7DQo+PiArICAgICBzdHJ1Y3QgdnB1X2Zvcm1hdCAqY3VyX2ZtdDsNCj4+ICsgICAg
IGludCBpOw0KPj4gKw0KPj4gKyAgICAgY3VyX2ZtdCA9IHZwdV9nZXRfZm9ybWF0KGluc3QsIGYt
PnR5cGUpOw0KPj4gKw0KPj4gKyAgICAgcGl4bXAtPnBpeGVsZm9ybWF0ID0gY3VyX2ZtdC0+cGl4
Zm10Ow0KPj4gKyAgICAgcGl4bXAtPm51bV9wbGFuZXMgPSBjdXJfZm10LT5udW1fcGxhbmVzOw0K
Pj4gKyAgICAgcGl4bXAtPndpZHRoID0gY3VyX2ZtdC0+d2lkdGg7DQo+PiArICAgICBwaXhtcC0+
aGVpZ2h0ID0gY3VyX2ZtdC0+aGVpZ2h0Ow0KPj4gKyAgICAgcGl4bXAtPmZpZWxkID0gY3VyX2Zt
dC0+ZmllbGQ7DQo+PiArICAgICBwaXhtcC0+ZmxhZ3MgPSBjdXJfZm10LT5mbGFnczsNCj4+ICsg
ICAgIGZvciAoaSA9IDA7IGkgPCBwaXhtcC0+bnVtX3BsYW5lczsgaSsrKSB7DQo+PiArICAgICAg
ICAgICAgIHBpeG1wLT5wbGFuZV9mbXRbaV0uYnl0ZXNwZXJsaW5lID0gY3VyX2ZtdC0+Ynl0ZXNw
ZXJsaW5lW2ldOw0KPj4gKyAgICAgICAgICAgICBwaXhtcC0+cGxhbmVfZm10W2ldLnNpemVpbWFn
ZSA9IGN1cl9mbXQtPnNpemVpbWFnZVtpXTsNCj4+ICsgICAgIH0NCj4+ICsNCj4+ICsgICAgIGYt
PmZtdC5waXhfbXAuY29sb3JzcGFjZSA9IHZkZWMtPmNvZGVjX2luZm8uY29sb3JfcHJpbWFyaWVz
Ow0KPj4gKyAgICAgZi0+Zm10LnBpeF9tcC54ZmVyX2Z1bmMgPSB2ZGVjLT5jb2RlY19pbmZvLnRy
YW5zZmVyX2NoYXJzOw0KPj4gKyAgICAgZi0+Zm10LnBpeF9tcC55Y2Jjcl9lbmMgPSB2ZGVjLT5j
b2RlY19pbmZvLm1hdHJpeF9jb2VmZnM7DQo+PiArICAgICBmLT5mbXQucGl4X21wLnF1YW50aXph
dGlvbiA9IHZkZWMtPmNvZGVjX2luZm8uZnVsbF9yYW5nZTsNCj4+ICsNCj4+ICsgICAgIHJldHVy
biAwOw0KPj4gK30NCj4+ICsNCj4+ICtzdGF0aWMgaW50IHZkZWNfdHJ5X2ZtdChzdHJ1Y3QgZmls
ZSAqZmlsZSwgdm9pZCAqZmgsIHN0cnVjdCB2NGwyX2Zvcm1hdCAqZikNCj4+ICt7DQo+PiArICAg
ICBzdHJ1Y3QgdnB1X2luc3QgKmluc3QgPSB0b19pbnN0KGZpbGUpOw0KPj4gKyAgICAgc3RydWN0
IHZkZWNfdCAqdmRlYyA9IGluc3QtPnByaXY7DQo+PiArDQo+PiArICAgICB2cHVfdHJ5X2ZtdF9j
b21tb24oaW5zdCwgZik7DQo+PiArDQo+PiArICAgICB2cHVfaW5zdF9sb2NrKGluc3QpOw0KPj4g
KyAgICAgaWYgKHZkZWMtPmZpeGVkX2ZtdCkgew0KPj4gKyAgICAgICAgICAgICBmLT5mbXQucGl4
X21wLmNvbG9yc3BhY2UgPSB2ZGVjLT5jb2RlY19pbmZvLmNvbG9yX3ByaW1hcmllczsNCj4+ICsg
ICAgICAgICAgICAgZi0+Zm10LnBpeF9tcC54ZmVyX2Z1bmMgPSB2ZGVjLT5jb2RlY19pbmZvLnRy
YW5zZmVyX2NoYXJzOw0KPj4gKyAgICAgICAgICAgICBmLT5mbXQucGl4X21wLnljYmNyX2VuYyA9
IHZkZWMtPmNvZGVjX2luZm8ubWF0cml4X2NvZWZmczsNCj4+ICsgICAgICAgICAgICAgZi0+Zm10
LnBpeF9tcC5xdWFudGl6YXRpb24gPSB2ZGVjLT5jb2RlY19pbmZvLmZ1bGxfcmFuZ2U7DQo+PiAr
ICAgICB9IGVsc2Ugew0KPj4gKyAgICAgICAgICAgICBmLT5mbXQucGl4X21wLmNvbG9yc3BhY2Ug
PSBWNEwyX0NPTE9SU1BBQ0VfREVGQVVMVDsNCj4+ICsgICAgICAgICAgICAgZi0+Zm10LnBpeF9t
cC54ZmVyX2Z1bmMgPSBWNEwyX1hGRVJfRlVOQ19ERUZBVUxUOw0KPj4gKyAgICAgICAgICAgICBm
LT5mbXQucGl4X21wLnljYmNyX2VuYyA9IFY0TDJfWUNCQ1JfRU5DX0RFRkFVTFQ7DQo+PiArICAg
ICAgICAgICAgIGYtPmZtdC5waXhfbXAucXVhbnRpemF0aW9uID0gVjRMMl9RVUFOVElaQVRJT05f
REVGQVVMVDsNCj4+ICsgICAgIH0NCj4+ICsgICAgIHZwdV9pbnN0X3VubG9jayhpbnN0KTsNCj4+
ICsNCj4+ICsgICAgIHJldHVybiAwOw0KPj4gK30NCj4+ICsNCj4+ICtzdGF0aWMgaW50IHZkZWNf
c19mbXRfY29tbW9uKHN0cnVjdCB2cHVfaW5zdCAqaW5zdCwgc3RydWN0IHY0bDJfZm9ybWF0ICpm
KQ0KPj4gK3sNCj4+ICsgICAgIHN0cnVjdCB2NGwyX3BpeF9mb3JtYXRfbXBsYW5lICpwaXhtcCA9
ICZmLT5mbXQucGl4X21wOw0KPj4gKyAgICAgY29uc3Qgc3RydWN0IHZwdV9mb3JtYXQgKmZtdDsN
Cj4+ICsgICAgIHN0cnVjdCB2cHVfZm9ybWF0ICpjdXJfZm10Ow0KPj4gKyAgICAgc3RydWN0IHZi
Ml9xdWV1ZSAqcTsNCj4+ICsgICAgIHN0cnVjdCB2ZGVjX3QgKnZkZWMgPSBpbnN0LT5wcml2Ow0K
Pj4gKyAgICAgaW50IGk7DQo+PiArDQo+PiArICAgICBpZiAoIWluc3QtPmZoLm0ybV9jdHgpDQo+
PiArICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOw0KPj4gKw0KPj4gKyAgICAgcSA9IHY0bDJf
bTJtX2dldF92cShpbnN0LT5maC5tMm1fY3R4LCBmLT50eXBlKTsNCj4+ICsgICAgIGlmICghcSkN
Cj4+ICsgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7DQo+PiArICAgICBpZiAodmIyX2lzX2J1
c3kocSkpDQo+PiArICAgICAgICAgICAgIHJldHVybiAtRUJVU1k7DQo+PiArDQo+PiArICAgICBm
bXQgPSB2cHVfdHJ5X2ZtdF9jb21tb24oaW5zdCwgZik7DQo+PiArICAgICBpZiAoIWZtdCkNCj4+
ICsgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7DQo+PiArDQo+PiArICAgICBjdXJfZm10ID0g
dnB1X2dldF9mb3JtYXQoaW5zdCwgZi0+dHlwZSk7DQo+PiArICAgICBpZiAoVjRMMl9UWVBFX0lT
X09VVFBVVChmLT50eXBlKSAmJiBpbnN0LT5zdGF0ZSAhPQ0KPlZQVV9DT0RFQ19TVEFURV9ERUlO
SVQpIHsNCj4+ICsgICAgICAgICAgICAgaWYgKGN1cl9mbXQtPnBpeGZtdCAhPSBmbXQtPnBpeGZt
dCkgew0KPj4gKyAgICAgICAgICAgICAgICAgICAgIHZkZWMtPnJlc2V0X2NvZGVjID0gdHJ1ZTsN
Cj4+ICsgICAgICAgICAgICAgICAgICAgICB2ZGVjLT5maXhlZF9mbXQgPSBmYWxzZTsNCj4+ICsg
ICAgICAgICAgICAgfQ0KPj4gKyAgICAgfQ0KPj4gKyAgICAgY3VyX2ZtdC0+cGl4Zm10ID0gZm10
LT5waXhmbXQ7DQo+PiArICAgICBpZiAoVjRMMl9UWVBFX0lTX09VVFBVVChmLT50eXBlKSB8fCAh
dmRlYy0+Zml4ZWRfZm10KSB7DQo+PiArICAgICAgICAgICAgIGN1cl9mbXQtPm51bV9wbGFuZXMg
PSBmbXQtPm51bV9wbGFuZXM7DQo+PiArICAgICAgICAgICAgIGN1cl9mbXQtPmZsYWdzID0gZm10
LT5mbGFnczsNCj4+ICsgICAgICAgICAgICAgY3VyX2ZtdC0+d2lkdGggPSBwaXhtcC0+d2lkdGg7
DQo+PiArICAgICAgICAgICAgIGN1cl9mbXQtPmhlaWdodCA9IHBpeG1wLT5oZWlnaHQ7DQo+PiAr
ICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBmbXQtPm51bV9wbGFuZXM7IGkrKykgew0KPj4g
KyAgICAgICAgICAgICAgICAgICAgIGN1cl9mbXQtPnNpemVpbWFnZVtpXSA9IHBpeG1wLT5wbGFu
ZV9mbXRbaV0uc2l6ZWltYWdlOw0KPj4gKyAgICAgICAgICAgICAgICAgICAgIGN1cl9mbXQtPmJ5
dGVzcGVybGluZVtpXSA9IHBpeG1wLT5wbGFuZV9mbXRbaV0uYnl0ZXNwZXJsaW5lOw0KPj4gKyAg
ICAgICAgICAgICB9DQo+PiArICAgICAgICAgICAgIGlmIChwaXhtcC0+ZmllbGQgIT0gVjRMMl9G
SUVMRF9BTlkpDQo+PiArICAgICAgICAgICAgICAgICAgICAgY3VyX2ZtdC0+ZmllbGQgPSBwaXht
cC0+ZmllbGQ7DQo+PiArICAgICB9IGVsc2Ugew0KPj4gKyAgICAgICAgICAgICBwaXhtcC0+bnVt
X3BsYW5lcyA9IGN1cl9mbXQtPm51bV9wbGFuZXM7DQo+PiArICAgICAgICAgICAgIHBpeG1wLT53
aWR0aCA9IGN1cl9mbXQtPndpZHRoOw0KPj4gKyAgICAgICAgICAgICBwaXhtcC0+aGVpZ2h0ID0g
Y3VyX2ZtdC0+aGVpZ2h0Ow0KPj4gKyAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcGl4bXAt
Pm51bV9wbGFuZXM7IGkrKykgew0KPj4gKyAgICAgICAgICAgICAgICAgICAgIHBpeG1wLT5wbGFu
ZV9mbXRbaV0uYnl0ZXNwZXJsaW5lID0gY3VyX2ZtdC0+Ynl0ZXNwZXJsaW5lW2ldOw0KPj4gKyAg
ICAgICAgICAgICAgICAgICAgIHBpeG1wLT5wbGFuZV9mbXRbaV0uc2l6ZWltYWdlID0gY3VyX2Zt
dC0+c2l6ZWltYWdlW2ldOw0KPj4gKyAgICAgICAgICAgICB9DQo+PiArICAgICAgICAgICAgIHBp
eG1wLT5maWVsZCA9IGN1cl9mbXQtPmZpZWxkOw0KPj4gKyAgICAgfQ0KPj4gKw0KPj4gKyAgICAg
aWYgKCF2ZGVjLT5maXhlZF9mbXQpIHsNCj4+ICsgICAgICAgICAgICAgaWYgKFY0TDJfVFlQRV9J
U19PVVRQVVQoZi0+dHlwZSkpIHsNCj4+ICsgICAgICAgICAgICAgICAgICAgICB2ZGVjLT5wYXJh
bXMuY29kZWNfZm9ybWF0ID0gY3VyX2ZtdC0+cGl4Zm10Ow0KPj4gKyAgICAgICAgICAgICAgICAg
ICAgIHZkZWMtPmNvZGVjX2luZm8uY29sb3JfcHJpbWFyaWVzID0gZi0+Zm10LnBpeF9tcC5jb2xv
cnNwYWNlOw0KPj4gKyAgICAgICAgICAgICAgICAgICAgIHZkZWMtPmNvZGVjX2luZm8udHJhbnNm
ZXJfY2hhcnMgPSBmLT5mbXQucGl4X21wLnhmZXJfZnVuYzsNCj4+ICsgICAgICAgICAgICAgICAg
ICAgICB2ZGVjLT5jb2RlY19pbmZvLm1hdHJpeF9jb2VmZnMgPSBmLT5mbXQucGl4X21wLnljYmNy
X2VuYzsNCj4+ICsgICAgICAgICAgICAgICAgICAgICB2ZGVjLT5jb2RlY19pbmZvLmZ1bGxfcmFu
Z2UgPSBmLT5mbXQucGl4X21wLnF1YW50aXphdGlvbjsNCj4+ICsgICAgICAgICAgICAgfSBlbHNl
IHsNCj4+ICsgICAgICAgICAgICAgICAgICAgICB2ZGVjLT5wYXJhbXMub3V0cHV0X2Zvcm1hdCA9
IGN1cl9mbXQtPnBpeGZtdDsNCj4+ICsgICAgICAgICAgICAgICAgICAgICBpbnN0LT5jcm9wLmxl
ZnQgPSAwOw0KPj4gKyAgICAgICAgICAgICAgICAgICAgIGluc3QtPmNyb3AudG9wID0gMDsNCj4+
ICsgICAgICAgICAgICAgICAgICAgICBpbnN0LT5jcm9wLndpZHRoID0gY3VyX2ZtdC0+d2lkdGg7
DQo+PiArICAgICAgICAgICAgICAgICAgICAgaW5zdC0+Y3JvcC5oZWlnaHQgPSBjdXJfZm10LT5o
ZWlnaHQ7DQo+PiArICAgICAgICAgICAgIH0NCj4+ICsgICAgIH0NCj4+ICsNCj4+ICsgICAgIHZw
dV90cmFjZShpbnN0LT5kZXYsICJbJWRdICVjJWMlYyVjICVkeCVkXG4iLCBpbnN0LT5pZCwNCj4+
ICsgICAgICAgICAgICAgICBmLT5mbXQucGl4X21wLnBpeGVsZm9ybWF0LA0KPj4gKyAgICAgICAg
ICAgICAgIGYtPmZtdC5waXhfbXAucGl4ZWxmb3JtYXQgPj4gOCwNCj4+ICsgICAgICAgICAgICAg
ICBmLT5mbXQucGl4X21wLnBpeGVsZm9ybWF0ID4+IDE2LA0KPj4gKyAgICAgICAgICAgICAgIGYt
PmZtdC5waXhfbXAucGl4ZWxmb3JtYXQgPj4gMjQsDQo+PiArICAgICAgICAgICAgICAgZi0+Zm10
LnBpeF9tcC53aWR0aCwNCj4+ICsgICAgICAgICAgICAgICBmLT5mbXQucGl4X21wLmhlaWdodCk7
DQo+PiArDQo+PiArICAgICByZXR1cm4gMDsNCj4+ICt9DQo+PiArDQo+PiArc3RhdGljIGludCB2
ZGVjX3NfZm10KHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0IHY0bDJfZm9ybWF0
ICpmKQ0KPj4gK3sNCj4+ICsgICAgIHN0cnVjdCB2cHVfaW5zdCAqaW5zdCA9IHRvX2luc3QoZmls
ZSk7DQo+PiArICAgICBzdHJ1Y3QgdjRsMl9waXhfZm9ybWF0X21wbGFuZSAqcGl4bXAgPSAmZi0+
Zm10LnBpeF9tcDsNCj4+ICsgICAgIHN0cnVjdCB2ZGVjX3QgKnZkZWMgPSBpbnN0LT5wcml2Ow0K
Pj4gKyAgICAgaW50IHJldCA9IDA7DQo+PiArDQo+PiArICAgICB2cHVfaW5zdF9sb2NrKGluc3Qp
Ow0KPj4gKyAgICAgcmV0ID0gdmRlY19zX2ZtdF9jb21tb24oaW5zdCwgZik7DQo+PiArICAgICBp
ZiAocmV0KQ0KPj4gKyAgICAgICAgICAgICBnb3RvIGV4aXQ7DQo+PiArDQo+PiArICAgICBpZiAo
VjRMMl9UWVBFX0lTX09VVFBVVChmLT50eXBlKSAmJiAhdmRlYy0+Zml4ZWRfZm10KSB7DQo+PiAr
ICAgICAgICAgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCBmYzsNCj4+ICsNCj4+ICsgICAgICAgICAg
ICAgbWVtc2V0KCZmYywgMCwgc2l6ZW9mKGZjKSk7DQo+PiArICAgICAgICAgICAgIGZjLnR5cGUg
PSBpbnN0LT5jYXBfZm9ybWF0LnR5cGU7DQo+PiArICAgICAgICAgICAgIGZjLmZtdC5waXhfbXAu
cGl4ZWxmb3JtYXQgPSBpbnN0LT5jYXBfZm9ybWF0LnBpeGZtdDsNCj4+ICsgICAgICAgICAgICAg
ZmMuZm10LnBpeF9tcC53aWR0aCA9IHBpeG1wLT53aWR0aDsNCj4+ICsgICAgICAgICAgICAgZmMu
Zm10LnBpeF9tcC5oZWlnaHQgPSBwaXhtcC0+aGVpZ2h0Ow0KPj4gKyAgICAgICAgICAgICB2ZGVj
X3NfZm10X2NvbW1vbihpbnN0LCAmZmMpOw0KPj4gKyAgICAgfQ0KPj4gKw0KPj4gKyAgICAgZi0+
Zm10LnBpeF9tcC5jb2xvcnNwYWNlID0gdmRlYy0+Y29kZWNfaW5mby5jb2xvcl9wcmltYXJpZXM7
DQo+PiArICAgICBmLT5mbXQucGl4X21wLnhmZXJfZnVuYyA9IHZkZWMtPmNvZGVjX2luZm8udHJh
bnNmZXJfY2hhcnM7DQo+PiArICAgICBmLT5mbXQucGl4X21wLnljYmNyX2VuYyA9IHZkZWMtPmNv
ZGVjX2luZm8ubWF0cml4X2NvZWZmczsNCj4+ICsgICAgIGYtPmZtdC5waXhfbXAucXVhbnRpemF0
aW9uID0gdmRlYy0+Y29kZWNfaW5mby5mdWxsX3JhbmdlOw0KPj4gKw0KPj4gK2V4aXQ6DQo+PiAr
ICAgICB2cHVfaW5zdF91bmxvY2soaW5zdCk7DQo+PiArICAgICByZXR1cm4gcmV0Ow0KPj4gK30N
Cj4+ICsNCj4+ICtzdGF0aWMgaW50IHZkZWNfZ19zZWxlY3Rpb24oc3RydWN0IGZpbGUgKmZpbGUs
IHZvaWQgKmZoLCBzdHJ1Y3QgdjRsMl9zZWxlY3Rpb24gKnMpDQo+PiArew0KPj4gKyAgICAgc3Ry
dWN0IHZwdV9pbnN0ICppbnN0ID0gdG9faW5zdChmaWxlKTsNCj4+ICsNCj4+ICsgICAgIGlmIChz
LT50eXBlICE9IFY0TDJfQlVGX1RZUEVfVklERU9fQ0FQVFVSRSAmJiBzLT50eXBlICE9DQo+VjRM
Ml9CVUZfVFlQRV9WSURFT19DQVBUVVJFX01QTEFORSkNCj4+ICsgICAgICAgICAgICAgcmV0dXJu
IC1FSU5WQUw7DQo+PiArDQo+PiArICAgICBzd2l0Y2ggKHMtPnRhcmdldCkgew0KPj4gKyAgICAg
Y2FzZSBWNEwyX1NFTF9UR1RfQ09NUE9TRToNCj4+ICsgICAgIGNhc2UgVjRMMl9TRUxfVEdUX0NP
TVBPU0VfREVGQVVMVDoNCj4+ICsgICAgIGNhc2UgVjRMMl9TRUxfVEdUX0NPTVBPU0VfUEFEREVE
Og0KPj4gKyAgICAgICAgICAgICBzLT5yID0gaW5zdC0+Y3JvcDsNCj4+ICsgICAgICAgICAgICAg
YnJlYWs7DQo+PiArICAgICBjYXNlIFY0TDJfU0VMX1RHVF9DT01QT1NFX0JPVU5EUzoNCj4+ICsg
ICAgICAgICAgICAgcy0+ci5sZWZ0ID0gMDsNCj4+ICsgICAgICAgICAgICAgcy0+ci50b3AgPSAw
Ow0KPj4gKyAgICAgICAgICAgICBzLT5yLndpZHRoID0gaW5zdC0+Y2FwX2Zvcm1hdC53aWR0aDsN
Cj4+ICsgICAgICAgICAgICAgcy0+ci5oZWlnaHQgPSBpbnN0LT5jYXBfZm9ybWF0LmhlaWdodDsN
Cj4+ICsgICAgICAgICAgICAgYnJlYWs7DQo+PiArICAgICBkZWZhdWx0Og0KPj4gKyAgICAgICAg
ICAgICByZXR1cm4gLUVJTlZBTDsNCj4+ICsgICAgIH0NCj4+ICsNCj4+ICsgICAgIHJldHVybiAw
Ow0KPj4gK30NCj4+ICsNCj4+ICtzdGF0aWMgaW50IHZkZWNfZHJhaW4oc3RydWN0IHZwdV9pbnN0
ICppbnN0KQ0KPj4gK3sNCj4+ICsgICAgIHN0cnVjdCB2ZGVjX3QgKnZkZWMgPSBpbnN0LT5wcml2
Ow0KPj4gKw0KPj4gKyAgICAgaWYgKCFpbnN0LT5maC5tMm1fY3R4KQ0KPj4gKyAgICAgICAgICAg
ICByZXR1cm4gMDsNCj4+ICsNCj4+ICsgICAgIGlmICghdmRlYy0+ZHJhaW4pDQo+PiArICAgICAg
ICAgICAgIHJldHVybiAwOw0KPj4gKw0KPj4gKyAgICAgaWYgKHY0bDJfbTJtX251bV9zcmNfYnVm
c19yZWFkeShpbnN0LT5maC5tMm1fY3R4KSkNCj4+ICsgICAgICAgICAgICAgcmV0dXJuIDA7DQo+
PiArDQo+PiArICAgICBpZiAoIXZkZWMtPnBhcmFtcy5mcmFtZV9jb3VudCkgew0KPj4gKyAgICAg
ICAgICAgICB2cHVfc2V0X2xhc3RfYnVmZmVyX2RlcXVldWVkKGluc3QpOw0KPj4gKyAgICAgICAg
ICAgICByZXR1cm4gMDsNCj4+ICsgICAgIH0NCj4+ICsNCj4+ICsgICAgIHZwdV9pZmFjZV9hZGRf
c2NvZGUoaW5zdCwgU0NPREVfUEFERElOR19FT1MpOw0KPj4gKyAgICAgdmRlYy0+cGFyYW1zLmVu
ZF9mbGFnID0gMTsNCj4+ICsgICAgIHZwdV9pZmFjZV9zZXRfZGVjb2RlX3BhcmFtcyhpbnN0LCAm
dmRlYy0+cGFyYW1zLCAxKTsNCj4+ICsgICAgIHZkZWMtPmRyYWluID0gMDsNCj4+ICsgICAgIHZw
dV90cmFjZShpbnN0LT5kZXYsICJbJWRdIGZyYW1lX2NvdW50ID0gJWRcbiIsIGluc3QtPmlkLCB2
ZGVjLQ0KPj5wYXJhbXMuZnJhbWVfY291bnQpOw0KPj4gKw0KPj4gKyAgICAgcmV0dXJuIDA7DQo+
PiArfQ0KPj4gKw0KPj4gK3N0YXRpYyBpbnQgdmRlY19jbWRfc3RhcnQoc3RydWN0IHZwdV9pbnN0
ICppbnN0KQ0KPj4gK3sNCj4+ICsgICAgIHN3aXRjaCAoaW5zdC0+c3RhdGUpIHsNCj4+ICsgICAg
IGNhc2UgVlBVX0NPREVDX1NUQVRFX1NUQVJURUQ6DQo+PiArICAgICBjYXNlIFZQVV9DT0RFQ19T
VEFURV9EUkFJTjoNCj4+ICsgICAgIGNhc2UgVlBVX0NPREVDX1NUQVRFX0RZQU1JQ19SRVNPTFVU
SU9OX0NIQU5HRToNCj4+ICsgICAgICAgICAgICAgdmRlY191cGRhdGVfc3RhdGUoaW5zdCwgVlBV
X0NPREVDX1NUQVRFX0FDVElWRSwgMCk7DQo+PiArICAgICAgICAgICAgIGJyZWFrOw0KPj4gKyAg
ICAgZGVmYXVsdDoNCj4+ICsgICAgICAgICAgICAgYnJlYWs7DQo+PiArICAgICB9DQo+PiArICAg
ICB2cHVfcHJvY2Vzc19jYXB0dXJlX2J1ZmZlcihpbnN0KTsNCj4+ICsgICAgIHJldHVybiAwOw0K
Pj4gK30NCj4+ICsNCj4+ICtzdGF0aWMgaW50IHZkZWNfY21kX3N0b3Aoc3RydWN0IHZwdV9pbnN0
ICppbnN0KQ0KPj4gK3sNCj4+ICsgICAgIHN0cnVjdCB2ZGVjX3QgKnZkZWMgPSBpbnN0LT5wcml2
Ow0KPj4gKw0KPj4gKyAgICAgdnB1X3RyYWNlKGluc3QtPmRldiwgIlslZF1cbiIsIGluc3QtPmlk
KTsNCj4+ICsNCj4+ICsgICAgIGlmIChpbnN0LT5zdGF0ZSA9PSBWUFVfQ09ERUNfU1RBVEVfREVJ
TklUKSB7DQo+PiArICAgICAgICAgICAgIHZwdV9zZXRfbGFzdF9idWZmZXJfZGVxdWV1ZWQoaW5z
dCk7DQo+PiArICAgICB9IGVsc2Ugew0KPj4gKyAgICAgICAgICAgICB2ZGVjLT5kcmFpbiA9IDE7
DQo+PiArICAgICAgICAgICAgIHZkZWNfZHJhaW4oaW5zdCk7DQo+PiArICAgICB9DQo+PiArDQo+
PiArICAgICByZXR1cm4gMDsNCj4+ICt9DQo+PiArDQo+PiArc3RhdGljIGludCB2ZGVjX2RlY29k
ZXJfY21kKHN0cnVjdCBmaWxlICpmaWxlLCB2b2lkICpmaCwgc3RydWN0DQo+djRsMl9kZWNvZGVy
X2NtZCAqY21kKQ0KPj4gK3sNCj4+ICsgICAgIHN0cnVjdCB2cHVfaW5zdCAqaW5zdCA9IHRvX2lu
c3QoZmlsZSk7DQo+PiArICAgICBpbnQgcmV0Ow0KPj4gKw0KPj4gKyAgICAgcmV0ID0gdjRsMl9t
Mm1faW9jdGxfdHJ5X2RlY29kZXJfY21kKGZpbGUsIGZoLCBjbWQpOw0KPj4gKyAgICAgaWYgKHJl
dCkNCj4+ICsgICAgICAgICAgICAgcmV0dXJuIHJldDsNCj4+ICsNCj4+ICsgICAgIHZwdV9pbnN0
X2xvY2soaW5zdCk7DQo+PiArICAgICBzd2l0Y2ggKGNtZC0+Y21kKSB7DQo+PiArICAgICBjYXNl
IFY0TDJfREVDX0NNRF9TVEFSVDoNCj4+ICsgICAgICAgICAgICAgdmRlY19jbWRfc3RhcnQoaW5z
dCk7DQo+PiArICAgICAgICAgICAgIGJyZWFrOw0KPj4gKyAgICAgY2FzZSBWNEwyX0RFQ19DTURf
U1RPUDoNCj4+ICsgICAgICAgICAgICAgdmRlY19jbWRfc3RvcChpbnN0KTsNCj4+ICsgICAgICAg
ICAgICAgYnJlYWs7DQo+PiArICAgICBkZWZhdWx0Og0KPj4gKyAgICAgICAgICAgICBicmVhazsN
Cj4+ICsgICAgIH0NCj4+ICsgICAgIHZwdV9pbnN0X3VubG9jayhpbnN0KTsNCj4+ICsNCj4+ICsg
ICAgIHJldHVybiAwOw0KPj4gK30NCj4+ICsNCj4+ICtzdGF0aWMgaW50IHZkZWNfc3Vic2NyaWJl
X2V2ZW50KHN0cnVjdCB2NGwyX2ZoICpmaCwgY29uc3Qgc3RydWN0DQo+djRsMl9ldmVudF9zdWJz
Y3JpcHRpb24gKnN1YikNCj4+ICt7DQo+PiArICAgICBzd2l0Y2ggKHN1Yi0+dHlwZSkgew0KPj4g
KyAgICAgY2FzZSBWNEwyX0VWRU5UX0VPUzoNCj4+ICsgICAgICAgICAgICAgcmV0dXJuIHY0bDJf
ZXZlbnRfc3Vic2NyaWJlKGZoLCBzdWIsIDAsIE5VTEwpOw0KPj4gKyAgICAgY2FzZSBWNEwyX0VW
RU5UX1NPVVJDRV9DSEFOR0U6DQo+PiArICAgICAgICAgICAgIHJldHVybiB2NGwyX3NyY19jaGFu
Z2VfZXZlbnRfc3Vic2NyaWJlKGZoLCBzdWIpOw0KPj4gKyAgICAgY2FzZSBWNEwyX0VWRU5UX0NU
Ukw6DQo+PiArICAgICAgICAgICAgIHJldHVybiB2NGwyX2N0cmxfc3Vic2NyaWJlX2V2ZW50KGZo
LCBzdWIpOw0KPj4gKyAgICAgZGVmYXVsdDoNCj4+ICsgICAgICAgICAgICAgcmV0dXJuIC1FSU5W
QUw7DQo+PiArICAgICB9DQo+PiArDQo+PiArICAgICByZXR1cm4gMDsNCj4+ICt9DQo+PiArDQo+
PiArc3RhdGljIGNvbnN0IHN0cnVjdCB2NGwyX2lvY3RsX29wcyB2ZGVjX2lvY3RsX29wcyA9IHsN
Cj4+ICsgICAgIC52aWRpb2NfcXVlcnljYXAgICAgICAgICAgICAgICA9IHZkZWNfcXVlcnljYXAs
DQo+PiArICAgICAudmlkaW9jX2VudW1fZm10X3ZpZF9jYXAgICAgICAgPSB2ZGVjX2VudW1fZm10
LA0KPj4gKyAgICAgLnZpZGlvY19lbnVtX2ZtdF92aWRfb3V0ICAgICAgID0gdmRlY19lbnVtX2Zt
dCwNCj4+ICsgICAgIC52aWRpb2NfZ19mbXRfdmlkX2NhcF9tcGxhbmUgICA9IHZkZWNfZ19mbXQs
DQo+PiArICAgICAudmlkaW9jX2dfZm10X3ZpZF9vdXRfbXBsYW5lICAgPSB2ZGVjX2dfZm10LA0K
Pj4gKyAgICAgLnZpZGlvY190cnlfZm10X3ZpZF9jYXBfbXBsYW5lID0gdmRlY190cnlfZm10LA0K
Pj4gKyAgICAgLnZpZGlvY190cnlfZm10X3ZpZF9vdXRfbXBsYW5lID0gdmRlY190cnlfZm10LA0K
Pj4gKyAgICAgLnZpZGlvY19zX2ZtdF92aWRfY2FwX21wbGFuZSAgID0gdmRlY19zX2ZtdCwNCj4+
ICsgICAgIC52aWRpb2Nfc19mbXRfdmlkX291dF9tcGxhbmUgICA9IHZkZWNfc19mbXQsDQo+PiAr
ICAgICAudmlkaW9jX2dfc2VsZWN0aW9uICAgICAgICAgICAgPSB2ZGVjX2dfc2VsZWN0aW9uLA0K
Pj4gKyAgICAgLnZpZGlvY190cnlfZGVjb2Rlcl9jbWQgICAgICAgID0gdjRsMl9tMm1faW9jdGxf
dHJ5X2RlY29kZXJfY21kLA0KPj4gKyAgICAgLnZpZGlvY19kZWNvZGVyX2NtZCAgICAgICAgICAg
ID0gdmRlY19kZWNvZGVyX2NtZCwNCj4+ICsgICAgIC52aWRpb2Nfc3Vic2NyaWJlX2V2ZW50ICAg
ICAgICA9IHZkZWNfc3Vic2NyaWJlX2V2ZW50LA0KPj4gKyAgICAgLnZpZGlvY191bnN1YnNjcmli
ZV9ldmVudCAgICAgID0gdjRsMl9ldmVudF91bnN1YnNjcmliZSwNCj4+ICsgICAgIC52aWRpb2Nf
cmVxYnVmcyAgICAgICAgICAgICAgICA9IHY0bDJfbTJtX2lvY3RsX3JlcWJ1ZnMsDQo+PiArICAg
ICAudmlkaW9jX2NyZWF0ZV9idWZzICAgICAgICAgICAgPSB2NGwyX20ybV9pb2N0bF9jcmVhdGVf
YnVmcywNCj4+ICsgICAgIC52aWRpb2NfcHJlcGFyZV9idWYgICAgICAgICAgICA9IHY0bDJfbTJt
X2lvY3RsX3ByZXBhcmVfYnVmLA0KPj4gKyAgICAgLnZpZGlvY19xdWVyeWJ1ZiAgICAgICAgICAg
ICAgID0gdjRsMl9tMm1faW9jdGxfcXVlcnlidWYsDQo+PiArICAgICAudmlkaW9jX3FidWYgICAg
ICAgICAgICAgICAgICAgPSB2NGwyX20ybV9pb2N0bF9xYnVmLA0KPj4gKyAgICAgLnZpZGlvY19l
eHBidWYgICAgICAgICAgICAgICAgID0gdjRsMl9tMm1faW9jdGxfZXhwYnVmLA0KPj4gKyAgICAg
LnZpZGlvY19kcWJ1ZiAgICAgICAgICAgICAgICAgID0gdjRsMl9tMm1faW9jdGxfZHFidWYsDQo+
PiArICAgICAudmlkaW9jX3N0cmVhbW9uICAgICAgICAgICAgICAgPSB2NGwyX20ybV9pb2N0bF9z
dHJlYW1vbiwNCj4+ICsgICAgIC52aWRpb2Nfc3RyZWFtb2ZmICAgICAgICAgICAgICA9IHY0bDJf
bTJtX2lvY3RsX3N0cmVhbW9mZiwNCj4+ICt9Ow0KPj4gKw0KPj4gK3N0YXRpYyBib29sIHZkZWNf
Y2hlY2tfcmVhZHkoc3RydWN0IHZwdV9pbnN0ICppbnN0LCB1bnNpZ25lZCBpbnQgdHlwZSkNCj4+
ICt7DQo+PiArICAgICBzdHJ1Y3QgdmRlY190ICp2ZGVjID0gaW5zdC0+cHJpdjsNCj4+ICsNCj4+
ICsgICAgIGlmIChWNEwyX1RZUEVfSVNfT1VUUFVUKHR5cGUpKSB7DQo+PiArICAgICAgICAgICAg
IGlmICh2ZGVjLT50c19wcmVfY291bnQgPj0gdmRlYy0+ZnJhbWVfZGVwdGgpDQo+PiArICAgICAg
ICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KPj4gKyAgICAgICAgICAgICByZXR1cm4gdHJ1
ZTsNCj4+ICsgICAgIH0NCj4+ICsNCj4+ICsgICAgIGlmICh2ZGVjLT5yZXFfZnJhbWVfY291bnQp
DQo+PiArICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KPj4gKw0KPj4gKyAgICAgcmV0dXJuIGZh
bHNlOw0KPj4gK30NCj4+ICsNCj4+ICtzdGF0aWMgaW50IHZkZWNfZnJhbWVfZGVjb2RlZChzdHJ1
Y3QgdnB1X2luc3QgKmluc3QsIHZvaWQgKmFyZykNCj4+ICt7DQo+PiArICAgICBzdHJ1Y3QgdmRl
Y190ICp2ZGVjID0gaW5zdC0+cHJpdjsNCj4+ICsgICAgIHN0cnVjdCB2cHVfZGVjX3BpY19pbmZv
ICppbmZvID0gYXJnOw0KPj4gKyAgICAgc3RydWN0IHZwdV92YjJfYnVmZmVyICp2cHVfYnVmOw0K
Pj4gKyAgICAgc3RydWN0IHZiMl92NGwyX2J1ZmZlciAqdmJ1ZjsNCj4+ICsgICAgIGludCByZXQg
PSAwOw0KPj4gKw0KPj4gKyAgICAgaWYgKCFpbmZvIHx8IGluZm8tPmlkID49IEFSUkFZX1NJWkUo
dmRlYy0+c2xvdHMpKQ0KPj4gKyAgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsNCj4+ICsNCj4+
ICsgICAgIHZwdV9pbnN0X2xvY2soaW5zdCk7DQo+PiArICAgICB2cHVfYnVmID0gdmRlYy0+c2xv
dHNbaW5mby0+aWRdOw0KPj4gKyAgICAgaWYgKCF2cHVfYnVmKSB7DQo+PiArICAgICAgICAgICAg
IGRldl9lcnIoaW5zdC0+ZGV2LCAiWyVkXSBkZWNvZGVkIGludmFsaWQgZnJhbWVbJWRdXG4iLCBp
bnN0LT5pZCwNCj5pbmZvLT5pZCk7DQo+PiArICAgICAgICAgICAgIHJldCA9IC1FSU5WQUw7DQo+
PiArICAgICAgICAgICAgIGdvdG8gZXhpdDsNCj4+ICsgICAgIH0NCj4+ICsgICAgIHZidWYgPSAm
dnB1X2J1Zi0+bTJtX2J1Zi52YjsNCj4+ICsgICAgIGlmICh2cHVfZ2V0X2J1ZmZlcl9zdGF0ZSh2
YnVmKSA9PSBWUFVfQlVGX1NUQVRFX0RFQ09ERUQpDQo+PiArICAgICAgICAgICAgIGRldl9pbmZv
KGluc3QtPmRldiwgIlslZF0gYnVmWyVkXSBoYXMgYmVlbiBkZWNvZGVkXG4iLCBpbnN0LT5pZCwN
Cj5pbmZvLT5pZCk7DQo+PiArICAgICB2cHVfc2V0X2J1ZmZlcl9zdGF0ZSh2YnVmLCBWUFVfQlVG
X1NUQVRFX0RFQ09ERUQpOw0KPj4gKyAgICAgdmRlYy0+ZGVjb2RlZF9mcmFtZV9jb3VudCsrOw0K
Pj4gKyAgICAgaWYgKHZkZWMtPnRzX3ByZV9jb3VudCA+PSBpbmZvLT5jb25zdW1lZF9jb3VudCkN
Cj4+ICsgICAgICAgICAgICAgdmRlYy0+dHNfcHJlX2NvdW50IC09IGluZm8tPmNvbnN1bWVkX2Nv
dW50Ow0KPj4gKyAgICAgZWxzZQ0KPj4gKyAgICAgICAgICAgICB2ZGVjLT50c19wcmVfY291bnQg
PSAwOw0KPj4gK2V4aXQ6DQo+PiArICAgICB2cHVfaW5zdF91bmxvY2soaW5zdCk7DQo+PiArDQo+
PiArICAgICByZXR1cm4gcmV0Ow0KPj4gK30NCj4+ICsNCj4+ICtzdGF0aWMgc3RydWN0IHZwdV92
YjJfYnVmZmVyICp2ZGVjX2ZpbmRfYnVmZmVyKHN0cnVjdCB2cHVfaW5zdCAqaW5zdCwgdTMyDQo+
bHVtYSkNCj4+ICt7DQo+PiArICAgICBzdHJ1Y3QgdmRlY190ICp2ZGVjID0gaW5zdC0+cHJpdjsN
Cj4+ICsgICAgIGludCBpOw0KPj4gKw0KPj4gKyAgICAgZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJ
WkUodmRlYy0+c2xvdHMpOyBpKyspIHsNCj4+ICsgICAgICAgICAgICAgaWYgKCF2ZGVjLT5zbG90
c1tpXSkNCj4+ICsgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCj4+ICsgICAgICAgICAg
ICAgaWYgKGx1bWEgPT0gdmRlYy0+c2xvdHNbaV0tPmx1bWEpDQo+PiArICAgICAgICAgICAgICAg
ICAgICAgcmV0dXJuIHZkZWMtPnNsb3RzW2ldOw0KPj4gKyAgICAgfQ0KPj4gKw0KPj4gKyAgICAg
cmV0dXJuIE5VTEw7DQo+PiArfQ0KPj4gKw0KPj4gK3N0YXRpYyB2b2lkIHZkZWNfYnVmX2RvbmUo
c3RydWN0IHZwdV9pbnN0ICppbnN0LCBzdHJ1Y3QgdnB1X2ZyYW1lX2luZm8NCj4qZnJhbWUpDQo+
PiArew0KPj4gKyAgICAgc3RydWN0IHZkZWNfdCAqdmRlYyA9IGluc3QtPnByaXY7DQo+PiArICAg
ICBzdHJ1Y3QgdnB1X3ZiMl9idWZmZXIgKnZwdV9idWY7DQo+PiArICAgICBzdHJ1Y3QgdmIyX3Y0
bDJfYnVmZmVyICp2YnVmOw0KPj4gKyAgICAgdTMyIHNlcXVlbmNlOw0KPj4gKw0KPj4gKyAgICAg
aWYgKCFmcmFtZSkNCj4+ICsgICAgICAgICAgICAgcmV0dXJuOw0KPj4gKw0KPj4gKyAgICAgdnB1
X2luc3RfbG9jayhpbnN0KTsNCj4+ICsgICAgIHNlcXVlbmNlID0gdmRlYy0+c2VxdWVuY2UrKzsN
Cj4+ICsgICAgIHZwdV9idWYgPSB2ZGVjX2ZpbmRfYnVmZmVyKGluc3QsIGZyYW1lLT5sdW1hKTsN
Cj4+ICsgICAgIHZwdV9pbnN0X3VubG9jayhpbnN0KTsNCj4+ICsgICAgIGlmICghdnB1X2J1Zikg
ew0KPj4gKyAgICAgICAgICAgICBkZXZfZXJyKGluc3QtPmRldiwgIlslZF0gY2FuJ3QgZmluZCBi
dWZmZXIsIGlkID0gJWQsIGFkZHIgPSAweCV4XG4iLA0KPj4gKyAgICAgICAgICAgICAgICAgICAg
IGluc3QtPmlkLCBmcmFtZS0+aWQsIGZyYW1lLT5sdW1hKTsNCj4+ICsgICAgICAgICAgICAgcmV0
dXJuOw0KPj4gKyAgICAgfQ0KPj4gKyAgICAgaWYgKGZyYW1lLT5za2lwcGVkKSB7DQo+PiArICAg
ICAgICAgICAgIGRldl9kYmcoaW5zdC0+ZGV2LCAiWyVkXSBmcmFtZSBza2lwXG4iLCBpbnN0LT5p
ZCk7DQo+PiArICAgICAgICAgICAgIHJldHVybjsNCj4+ICsgICAgIH0NCj4+ICsNCj4+ICsgICAg
IHZidWYgPSAmdnB1X2J1Zi0+bTJtX2J1Zi52YjsNCj4+ICsgICAgIGlmICh2YnVmLT52YjJfYnVm
LmluZGV4ICE9IGZyYW1lLT5pZCkNCj4+ICsgICAgICAgICAgICAgZGV2X2VycihpbnN0LT5kZXYs
ICJbJWRdIGJ1ZmZlciBpZCglZCwgJWQpIGRpc21hdGNoXG4iLA0KPj4gKyAgICAgICAgICAgICAg
ICAgICAgIGluc3QtPmlkLCB2YnVmLT52YjJfYnVmLmluZGV4LCBmcmFtZS0+aWQpOw0KPj4gKw0K
Pj4gKyAgICAgaWYgKHZwdV9nZXRfYnVmZmVyX3N0YXRlKHZidWYpICE9IFZQVV9CVUZfU1RBVEVf
REVDT0RFRCkNCj4+ICsgICAgICAgICAgICAgZGV2X2VycihpbnN0LT5kZXYsICJbJWRdIGJ1ZmZl
ciglZCkgcmVhZHkgd2l0aG91dCBkZWNvZGVkXG4iLA0KPmluc3QtPmlkLCBmcmFtZS0+aWQpOw0K
Pj4gKyAgICAgdnB1X3NldF9idWZmZXJfc3RhdGUodmJ1ZiwgVlBVX0JVRl9TVEFURV9SRUFEWSk7
DQo+PiArICAgICB2YjJfc2V0X3BsYW5lX3BheWxvYWQoJnZidWYtPnZiMl9idWYsIDAsIGluc3Qt
DQo+PmNhcF9mb3JtYXQuc2l6ZWltYWdlWzBdKTsNCj4+ICsgICAgIHZiMl9zZXRfcGxhbmVfcGF5
bG9hZCgmdmJ1Zi0+dmIyX2J1ZiwgMSwgaW5zdC0NCj4+Y2FwX2Zvcm1hdC5zaXplaW1hZ2VbMV0p
Ow0KPj4gKyAgICAgdmJ1Zi0+dmIyX2J1Zi50aW1lc3RhbXAgPSBmcmFtZS0+dGltZXN0YW1wOw0K
Pj4gKyAgICAgdmJ1Zi0+ZmllbGQgPSBpbnN0LT5jYXBfZm9ybWF0LmZpZWxkOw0KPj4gKyAgICAg
dmJ1Zi0+c2VxdWVuY2UgPSBzZXF1ZW5jZTsNCj4+ICsgICAgIGRldl9kYmcoaW5zdC0+ZGV2LCAi
WyVkXVtPVVRQVVQgVFNdJTMybGxkXG4iLCBpbnN0LT5pZCwgZnJhbWUtDQo+PnRpbWVzdGFtcCk7
DQo+PiArDQo+PiArICAgICB2NGwyX20ybV9idWZfZG9uZSh2YnVmLCBWQjJfQlVGX1NUQVRFX0RP
TkUpOw0KPj4gKyAgICAgdnB1X2luc3RfbG9jayhpbnN0KTsNCj4+ICsgICAgIHZkZWMtPnRpbWVz
dGFtcCA9IGZyYW1lLT50aW1lc3RhbXA7DQo+PiArICAgICB2ZGVjLT5kaXNwbGF5X2ZyYW1lX2Nv
dW50Kys7DQo+PiArICAgICB2cHVfaW5zdF91bmxvY2soaW5zdCk7DQo+PiArICAgICBkZXZfZGJn
KGluc3QtPmRldiwgIlslZF0gZGVjb2RlZCA6ICVkLCBkaXNwbGF5IDogJWQsIHNlcXVlbmNlIDog
JWRcbiIsDQo+PiArICAgICAgICAgICAgIGluc3QtPmlkLCB2ZGVjLT5kZWNvZGVkX2ZyYW1lX2Nv
dW50LCB2ZGVjLT5kaXNwbGF5X2ZyYW1lX2NvdW50LA0KPnZkZWMtPnNlcXVlbmNlKTsNCj4+ICt9
DQo+PiArDQo+PiArc3RhdGljIHZvaWQgdmRlY19zdG9wX2RvbmUoc3RydWN0IHZwdV9pbnN0ICpp
bnN0KQ0KPj4gK3sNCj4+ICsgICAgIHN0cnVjdCB2ZGVjX3QgKnZkZWMgPSBpbnN0LT5wcml2Ow0K
Pj4gKw0KPj4gKyAgICAgdnB1X2luc3RfbG9jayhpbnN0KTsNCj4+ICsgICAgIHZkZWNfdXBkYXRl
X3N0YXRlKGluc3QsIFZQVV9DT0RFQ19TVEFURV9ERUlOSVQsIDApOw0KPj4gKyAgICAgdmRlYy0+
c2VxX2hkcl9mb3VuZCA9IDA7DQo+PiArICAgICB2ZGVjLT5yZXFfZnJhbWVfY291bnQgPSAwOw0K
Pj4gKyAgICAgdmRlYy0+cmVzZXRfY29kZWMgPSBmYWxzZTsNCj4+ICsgICAgIHZkZWMtPmZpeGVk
X2ZtdCA9IGZhbHNlOw0KPj4gKyAgICAgdmRlYy0+cGFyYW1zLmVuZF9mbGFnID0gMDsNCj4+ICsg
ICAgIHZkZWMtPmRyYWluID0gMDsNCj4+ICsgICAgIHZkZWMtPnRzX3ByZV9jb3VudCA9IDA7DQo+
PiArICAgICB2ZGVjLT50aW1lc3RhbXAgPSBWUFVfSU5WQUxJRF9USU1FU1RBTVA7DQo+PiArICAg
ICB2ZGVjLT50c19zdGFydCA9IFZQVV9JTlZBTElEX1RJTUVTVEFNUDsNCj4+ICsgICAgIHZkZWMt
PnRzX2lucHV0ID0gVlBVX0lOVkFMSURfVElNRVNUQU1QOw0KPj4gKyAgICAgdmRlYy0+cGFyYW1z
LmZyYW1lX2NvdW50ID0gMDsNCj4+ICsgICAgIHZkZWMtPmRlY29kZWRfZnJhbWVfY291bnQgPSAw
Ow0KPj4gKyAgICAgdmRlYy0+ZGlzcGxheV9mcmFtZV9jb3VudCA9IDA7DQo+PiArICAgICB2ZGVj
LT5zZXF1ZW5jZSA9IDA7DQo+PiArICAgICB2ZGVjLT5lb3NfcmVjZWl2ZWQgPSAwOw0KPj4gKyAg
ICAgdmRlYy0+aXNfc291cmNlX2NoYW5nZWQgPSBmYWxzZTsNCj4+ICsgICAgIHZkZWMtPnNvdXJj
ZV9jaGFuZ2UgPSAwOw0KPj4gKyAgICAgdnB1X2luc3RfdW5sb2NrKGluc3QpOw0KPj4gK30NCj4+
ICsNCj4+ICtzdGF0aWMgYm9vbCB2ZGVjX2NoZWNrX3NvdXJjZV9jaGFuZ2Uoc3RydWN0IHZwdV9p
bnN0ICppbnN0KQ0KPj4gK3sNCj4+ICsgICAgIHN0cnVjdCB2ZGVjX3QgKnZkZWMgPSBpbnN0LT5w
cml2Ow0KPj4gKyAgICAgY29uc3Qgc3RydWN0IHZwdV9mb3JtYXQgKmZtdDsNCj4+ICsgICAgIGlu
dCBpOw0KPj4gKw0KPj4gKyAgICAgaWYgKCFpbnN0LT5maC5tMm1fY3R4KQ0KPj4gKyAgICAgICAg
ICAgICByZXR1cm4gZmFsc2U7DQo+PiArDQo+PiArICAgICBpZiAoIXZiMl9pc19zdHJlYW1pbmco
djRsMl9tMm1fZ2V0X2RzdF92cShpbnN0LT5maC5tMm1fY3R4KSkpDQo+PiArICAgICAgICAgICAg
IHJldHVybiB0cnVlOw0KPj4gKyAgICAgZm10ID0gdnB1X2hlbHBlcl9maW5kX2Zvcm1hdChpbnN0
LCBpbnN0LT5jYXBfZm9ybWF0LnR5cGUsIHZkZWMtDQo+PmNvZGVjX2luZm8ucGl4Zm10KTsNCj4+
ICsgICAgIGlmIChpbnN0LT5jYXBfZm9ybWF0LnBpeGZtdCAhPSB2ZGVjLT5jb2RlY19pbmZvLnBp
eGZtdCkNCj4+ICsgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQo+PiArICAgICBpZiAoaW5zdC0+
Y2FwX2Zvcm1hdC53aWR0aCAhPSB2ZGVjLT5jb2RlY19pbmZvLmRlY29kZWRfd2lkdGgpDQo+PiAr
ICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KPj4gKyAgICAgaWYgKGluc3QtPmNhcF9mb3JtYXQu
aGVpZ2h0ICE9IHZkZWMtPmNvZGVjX2luZm8uZGVjb2RlZF9oZWlnaHQpDQo+PiArICAgICAgICAg
ICAgIHJldHVybiB0cnVlOw0KPj4gKyAgICAgaWYgKHZwdV9nZXRfbnVtX2J1ZmZlcnMoaW5zdCwg
aW5zdC0+Y2FwX2Zvcm1hdC50eXBlKSA8IGluc3QtDQo+Pm1pbl9idWZmZXJfY2FwKQ0KPj4gKyAg
ICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCj4+ICsgICAgIGlmIChpbnN0LT5jcm9wLmxlZnQgIT0g
dmRlYy0+Y29kZWNfaW5mby5vZmZzZXRfeCkNCj4+ICsgICAgICAgICAgICAgcmV0dXJuIHRydWU7
DQo+PiArICAgICBpZiAoaW5zdC0+Y3JvcC50b3AgIT0gdmRlYy0+Y29kZWNfaW5mby5vZmZzZXRf
eSkNCj4+ICsgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQo+PiArICAgICBpZiAoaW5zdC0+Y3Jv
cC53aWR0aCAhPSB2ZGVjLT5jb2RlY19pbmZvLndpZHRoKQ0KPj4gKyAgICAgICAgICAgICByZXR1
cm4gdHJ1ZTsNCj4+ICsgICAgIGlmIChpbnN0LT5jcm9wLmhlaWdodCAhPSB2ZGVjLT5jb2RlY19p
bmZvLmhlaWdodCkNCj4+ICsgICAgICAgICAgICAgcmV0dXJuIHRydWU7DQo+PiArICAgICBpZiAo
Zm10ICYmIGluc3QtPmNhcF9mb3JtYXQubnVtX3BsYW5lcyAhPSBmbXQtPm51bV9wbGFuZXMpDQo+
PiArICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KPj4gKyAgICAgZm9yIChpID0gMDsgaSA8IGlu
c3QtPmNhcF9mb3JtYXQubnVtX3BsYW5lczsgaSsrKSB7DQo+PiArICAgICAgICAgICAgIGlmIChp
bnN0LT5jYXBfZm9ybWF0LmJ5dGVzcGVybGluZVtpXSAhPSB2ZGVjLQ0KPj5jb2RlY19pbmZvLmJ5
dGVzcGVybGluZVtpXSkNCj4+ICsgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCj4+
ICsgICAgICAgICAgICAgaWYgKGluc3QtPmNhcF9mb3JtYXQuc2l6ZWltYWdlW2ldICE9IHZkZWMt
PmNvZGVjX2luZm8uc2l6ZWltYWdlW2ldKQ0KPj4gKyAgICAgICAgICAgICAgICAgICAgIHJldHVy
biB0cnVlOw0KPj4gKyAgICAgfQ0KPj4gKw0KPj4gKyAgICAgcmV0dXJuIGZhbHNlOw0KPj4gK30N
Cj4+ICsNCj4+ICtzdGF0aWMgdm9pZCB2ZGVjX2luaXRfZm10KHN0cnVjdCB2cHVfaW5zdCAqaW5z
dCkNCj4+ICt7DQo+PiArICAgICBzdHJ1Y3QgdmRlY190ICp2ZGVjID0gaW5zdC0+cHJpdjsNCj4+
ICsgICAgIGNvbnN0IHN0cnVjdCB2cHVfZm9ybWF0ICpmbXQ7DQo+PiArICAgICBpbnQgaTsNCj4+
ICsNCj4+ICsgICAgIGZtdCA9IHZwdV9oZWxwZXJfZmluZF9mb3JtYXQoaW5zdCwgaW5zdC0+Y2Fw
X2Zvcm1hdC50eXBlLCB2ZGVjLQ0KPj5jb2RlY19pbmZvLnBpeGZtdCk7DQo+PiArICAgICBpbnN0
LT5vdXRfZm9ybWF0LndpZHRoID0gdmRlYy0+Y29kZWNfaW5mby53aWR0aDsNCj4+ICsgICAgIGlu
c3QtPm91dF9mb3JtYXQuaGVpZ2h0ID0gdmRlYy0+Y29kZWNfaW5mby5oZWlnaHQ7DQo+PiArICAg
ICBpbnN0LT5jYXBfZm9ybWF0LndpZHRoID0gdmRlYy0+Y29kZWNfaW5mby5kZWNvZGVkX3dpZHRo
Ow0KPj4gKyAgICAgaW5zdC0+Y2FwX2Zvcm1hdC5oZWlnaHQgPSB2ZGVjLT5jb2RlY19pbmZvLmRl
Y29kZWRfaGVpZ2h0Ow0KPj4gKyAgICAgaW5zdC0+Y2FwX2Zvcm1hdC5waXhmbXQgPSB2ZGVjLT5j
b2RlY19pbmZvLnBpeGZtdDsNCj4+ICsgICAgIGlmIChmbXQpIHsNCj4+ICsgICAgICAgICAgICAg
aW5zdC0+Y2FwX2Zvcm1hdC5udW1fcGxhbmVzID0gZm10LT5udW1fcGxhbmVzOw0KPj4gKyAgICAg
ICAgICAgICBpbnN0LT5jYXBfZm9ybWF0LmZsYWdzID0gZm10LT5mbGFnczsNCj4+ICsgICAgIH0N
Cj4+ICsgICAgIGZvciAoaSA9IDA7IGkgPCBpbnN0LT5jYXBfZm9ybWF0Lm51bV9wbGFuZXM7IGkr
Kykgew0KPj4gKyAgICAgICAgICAgICBpbnN0LT5jYXBfZm9ybWF0LmJ5dGVzcGVybGluZVtpXSA9
IHZkZWMtPmNvZGVjX2luZm8uYnl0ZXNwZXJsaW5lW2ldOw0KPj4gKyAgICAgICAgICAgICBpbnN0
LT5jYXBfZm9ybWF0LnNpemVpbWFnZVtpXSA9IHZkZWMtPmNvZGVjX2luZm8uc2l6ZWltYWdlW2ld
Ow0KPj4gKyAgICAgfQ0KPj4gKyAgICAgaWYgKHZkZWMtPmNvZGVjX2luZm8ucHJvZ3Jlc3NpdmUp
DQo+PiArICAgICAgICAgICAgIGluc3QtPmNhcF9mb3JtYXQuZmllbGQgPSBWNEwyX0ZJRUxEX05P
TkU7DQo+PiArICAgICBlbHNlDQo+PiArICAgICAgICAgICAgIGluc3QtPmNhcF9mb3JtYXQuZmll
bGQgPSBWNEwyX0ZJRUxEX1NFUV9CVDsNCj4+ICsgICAgIGlmICh2ZGVjLT5jb2RlY19pbmZvLmNv
bG9yX3ByaW1hcmllcyA9PSBWNEwyX0NPTE9SU1BBQ0VfREVGQVVMVCkNCj4+ICsgICAgICAgICAg
ICAgdmRlYy0+Y29kZWNfaW5mby5jb2xvcl9wcmltYXJpZXMgPSBWNEwyX0NPTE9SU1BBQ0VfUkVD
NzA5Ow0KPj4gKyAgICAgaWYgKHZkZWMtPmNvZGVjX2luZm8udHJhbnNmZXJfY2hhcnMgPT0gVjRM
Ml9YRkVSX0ZVTkNfREVGQVVMVCkNCj4+ICsgICAgICAgICAgICAgdmRlYy0+Y29kZWNfaW5mby50
cmFuc2Zlcl9jaGFycyA9IFY0TDJfWEZFUl9GVU5DXzcwOTsNCj4+ICsgICAgIGlmICh2ZGVjLT5j
b2RlY19pbmZvLm1hdHJpeF9jb2VmZnMgPT0gVjRMMl9ZQ0JDUl9FTkNfREVGQVVMVCkNCj4+ICsg
ICAgICAgICAgICAgdmRlYy0+Y29kZWNfaW5mby5tYXRyaXhfY29lZmZzID0gVjRMMl9ZQ0JDUl9F
TkNfNzA5Ow0KPj4gKyAgICAgaWYgKHZkZWMtPmNvZGVjX2luZm8uZnVsbF9yYW5nZSA9PSBWNEwy
X1FVQU5USVpBVElPTl9ERUZBVUxUKQ0KPj4gKyAgICAgICAgICAgICB2ZGVjLT5jb2RlY19pbmZv
LmZ1bGxfcmFuZ2UgPSBWNEwyX1FVQU5USVpBVElPTl9MSU1fUkFOR0U7DQo+PiArfQ0KPj4gKw0K
Pj4gK3N0YXRpYyB2b2lkIHZkZWNfaW5pdF9jcm9wKHN0cnVjdCB2cHVfaW5zdCAqaW5zdCkNCj4+
ICt7DQo+PiArICAgICBzdHJ1Y3QgdmRlY190ICp2ZGVjID0gaW5zdC0+cHJpdjsNCj4+ICsNCj4+
ICsgICAgIGluc3QtPmNyb3AubGVmdCA9IHZkZWMtPmNvZGVjX2luZm8ub2Zmc2V0X3g7DQo+PiAr
ICAgICBpbnN0LT5jcm9wLnRvcCA9IHZkZWMtPmNvZGVjX2luZm8ub2Zmc2V0X3k7DQo+PiArICAg
ICBpbnN0LT5jcm9wLndpZHRoID0gdmRlYy0+Y29kZWNfaW5mby53aWR0aDsNCj4+ICsgICAgIGlu
c3QtPmNyb3AuaGVpZ2h0ID0gdmRlYy0+Y29kZWNfaW5mby5oZWlnaHQ7DQo+PiArfQ0KPj4gKw0K
Pj4gK3N0YXRpYyB2b2lkIHZkZWNfaW5pdF9tYmkoc3RydWN0IHZwdV9pbnN0ICppbnN0KQ0KPj4g
K3sNCj4+ICsgICAgIHN0cnVjdCB2ZGVjX3QgKnZkZWMgPSBpbnN0LT5wcml2Ow0KPj4gKw0KPj4g
KyAgICAgdmRlYy0+bWJpLnNpemUgPSB2ZGVjLT5jb2RlY19pbmZvLm1iaV9zaXplOw0KPj4gKyAg
ICAgdmRlYy0+bWJpLm1heF9jb3VudCA9IEFSUkFZX1NJWkUodmRlYy0+bWJpLmJ1ZmZlcik7DQo+
PiArICAgICBzY25wcmludGYodmRlYy0+bWJpLm5hbWUsIHNpemVvZih2ZGVjLT5tYmkubmFtZSks
ICJtYmkiKTsNCj4+ICsgICAgIHZkZWMtPm1iaS50eXBlID0gTUVNX1JFU19NQkk7DQo+PiArICAg
ICB2ZGVjLT5tYmkudGFnID0gdmRlYy0+c2VxX3RhZzsNCj4+ICt9DQo+PiArDQo+PiArc3RhdGlj
IHZvaWQgdmRlY19pbml0X2RjcChzdHJ1Y3QgdnB1X2luc3QgKmluc3QpDQo+PiArew0KPj4gKyAg
ICAgc3RydWN0IHZkZWNfdCAqdmRlYyA9IGluc3QtPnByaXY7DQo+PiArDQo+PiArICAgICB2ZGVj
LT5kY3Auc2l6ZSA9IHZkZWMtPmNvZGVjX2luZm8uZGNwX3NpemU7DQo+PiArICAgICB2ZGVjLT5k
Y3AubWF4X2NvdW50ID0gQVJSQVlfU0laRSh2ZGVjLT5kY3AuYnVmZmVyKTsNCj4+ICsgICAgIHNj
bnByaW50Zih2ZGVjLT5kY3AubmFtZSwgc2l6ZW9mKHZkZWMtPmRjcC5uYW1lKSwgImRjcCIpOw0K
Pj4gKyAgICAgdmRlYy0+ZGNwLnR5cGUgPSBNRU1fUkVTX0RDUDsNCj4+ICsgICAgIHZkZWMtPmRj
cC50YWcgPSB2ZGVjLT5zZXFfdGFnOw0KPj4gK30NCj4+ICsNCj4+ICtzdGF0aWMgdm9pZCB2ZGVj
X3JlcXVlc3Rfb25lX2ZzKHN0cnVjdCB2ZGVjX2ZzX2luZm8gKmZzKQ0KPj4gK3sNCj4+ICsgICAg
IGZzLT5yZXFfY291bnQrKzsNCj4+ICsgICAgIGlmIChmcy0+cmVxX2NvdW50ID4gZnMtPm1heF9j
b3VudCkNCj4+ICsgICAgICAgICAgICAgZnMtPnJlcV9jb3VudCA9IGZzLT5tYXhfY291bnQ7DQo+
PiArfQ0KPj4gKw0KPj4gK3N0YXRpYyBpbnQgdmRlY19hbGxvY19mc19idWZmZXIoc3RydWN0IHZw
dV9pbnN0ICppbnN0LCBzdHJ1Y3QgdmRlY19mc19pbmZvICpmcykNCj4+ICt7DQo+PiArICAgICBz
dHJ1Y3QgdnB1X2J1ZmZlciAqYnVmZmVyOw0KPj4gKw0KPj4gKyAgICAgaWYgKCFmcy0+c2l6ZSkN
Cj4+ICsgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7DQo+PiArDQo+PiArICAgICBpZiAoZnMt
PmNvdW50ID49IGZzLT5yZXFfY291bnQpDQo+PiArICAgICAgICAgICAgIHJldHVybiAtRUlOVkFM
Ow0KPj4gKw0KPj4gKyAgICAgYnVmZmVyID0gJmZzLT5idWZmZXJbZnMtPmNvdW50XTsNCj4+ICsg
ICAgIGlmIChidWZmZXItPnZpcnQgJiYgYnVmZmVyLT5sZW5ndGggPj0gZnMtPnNpemUpDQo+PiAr
ICAgICAgICAgICAgIHJldHVybiAwOw0KPj4gKw0KPj4gKyAgICAgdnB1X2ZyZWVfZG1hKGJ1ZmZl
cik7DQo+PiArICAgICBidWZmZXItPmxlbmd0aCA9IGZzLT5zaXplOw0KPj4gKyAgICAgcmV0dXJu
IHZwdV9hbGxvY19kbWEoaW5zdC0+Y29yZSwgYnVmZmVyKTsNCj4+ICt9DQo+PiArDQo+PiArc3Rh
dGljIHZvaWQgdmRlY19hbGxvY19mcyhzdHJ1Y3QgdnB1X2luc3QgKmluc3QsIHN0cnVjdCB2ZGVj
X2ZzX2luZm8gKmZzKQ0KPj4gK3sNCj4+ICsgICAgIGludCByZXQ7DQo+PiArDQo+PiArICAgICB3
aGlsZSAoZnMtPmNvdW50IDwgZnMtPnJlcV9jb3VudCkgew0KPj4gKyAgICAgICAgICAgICByZXQg
PSB2ZGVjX2FsbG9jX2ZzX2J1ZmZlcihpbnN0LCBmcyk7DQo+PiArICAgICAgICAgICAgIGlmIChy
ZXQpDQo+PiArICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQo+PiArICAgICAgICAgICAgIGZz
LT5jb3VudCsrOw0KPj4gKyAgICAgfQ0KPj4gK30NCj4+ICsNCj4+ICtzdGF0aWMgdm9pZCB2ZGVj
X2NsZWFyX2ZzKHN0cnVjdCB2ZGVjX2ZzX2luZm8gKmZzKQ0KPj4gK3sNCj4+ICsgICAgIHUzMiBp
Ow0KPj4gKw0KPj4gKyAgICAgaWYgKCFmcykNCj4+ICsgICAgICAgICAgICAgcmV0dXJuOw0KPj4g
Kw0KPj4gKyAgICAgZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUoZnMtPmJ1ZmZlcik7IGkrKykN
Cj4+ICsgICAgICAgICAgICAgdnB1X2ZyZWVfZG1hKCZmcy0+YnVmZmVyW2ldKTsNCj4+ICsgICAg
IG1lbXNldChmcywgMCwgc2l6ZW9mKCpmcykpOw0KPj4gK30NCj4+ICsNCj4+ICtzdGF0aWMgaW50
IHZkZWNfcmVzcG9uc2VfZnMoc3RydWN0IHZwdV9pbnN0ICppbnN0LCBzdHJ1Y3QgdmRlY19mc19p
bmZvICpmcykNCj4+ICt7DQo+PiArICAgICBzdHJ1Y3QgdnB1X2ZzX2luZm8gaW5mbzsNCj4+ICsg
ICAgIGludCByZXQ7DQo+PiArDQo+PiArICAgICBpZiAoZnMtPmluZGV4ID49IGZzLT5jb3VudCkN
Cj4+ICsgICAgICAgICAgICAgcmV0dXJuIDA7DQo+PiArDQo+PiArICAgICBtZW1zZXQoJmluZm8s
IDAsIHNpemVvZihpbmZvKSk7DQo+PiArICAgICBpbmZvLmlkID0gZnMtPmluZGV4Ow0KPj4gKyAg
ICAgaW5mby50eXBlID0gZnMtPnR5cGU7DQo+PiArICAgICBpbmZvLnRhZyA9IGZzLT50YWc7DQo+
PiArICAgICBpbmZvLmx1bWFfYWRkciA9IGZzLT5idWZmZXJbZnMtPmluZGV4XS5waHlzOw0KPj4g
KyAgICAgaW5mby5sdW1hX3NpemUgPSBmcy0+YnVmZmVyW2ZzLT5pbmRleF0ubGVuZ3RoOw0KPj4g
KyAgICAgcmV0ID0gdnB1X3Nlc3Npb25fYWxsb2NfZnMoaW5zdCwgJmluZm8pOw0KPj4gKyAgICAg
aWYgKHJldCkNCj4+ICsgICAgICAgICAgICAgcmV0dXJuIHJldDsNCj4+ICsNCj4+ICsgICAgIGZz
LT5pbmRleCsrOw0KPj4gKyAgICAgcmV0dXJuIDA7DQo+PiArfQ0KPj4gKw0KPj4gK3N0YXRpYyBp
bnQgdmRlY19yZXNwb25zZV9mcmFtZV9hYm5vcm1hbChzdHJ1Y3QgdnB1X2luc3QgKmluc3QpDQo+
PiArew0KPj4gKyAgICAgc3RydWN0IHZkZWNfdCAqdmRlYyA9IGluc3QtPnByaXY7DQo+PiArICAg
ICBzdHJ1Y3QgdnB1X2ZzX2luZm8gaW5mbzsNCj4+ICsNCj4+ICsgICAgIGlmICghdmRlYy0+cmVx
X2ZyYW1lX2NvdW50KQ0KPj4gKyAgICAgICAgICAgICByZXR1cm4gMDsNCj4+ICsNCj4+ICsgICAg
IG1lbXNldCgmaW5mbywgMCwgc2l6ZW9mKGluZm8pKTsNCj4+ICsgICAgIGluZm8udHlwZSA9IE1F
TV9SRVNfRlJBTUU7DQo+PiArICAgICBpbmZvLnRhZyA9IHZkZWMtPnNlcV90YWcgKyAweGYwOw0K
Pj4gKyAgICAgdnB1X3Nlc3Npb25fYWxsb2NfZnMoaW5zdCwgJmluZm8pOw0KPj4gKyAgICAgdmRl
Yy0+cmVxX2ZyYW1lX2NvdW50LS07DQo+PiArDQo+PiArICAgICByZXR1cm4gMDsNCj4+ICt9DQo+
PiArDQo+PiArc3RhdGljIGludCB2ZGVjX3Jlc3BvbnNlX2ZyYW1lKHN0cnVjdCB2cHVfaW5zdCAq
aW5zdCwgc3RydWN0DQo+dmIyX3Y0bDJfYnVmZmVyICp2YnVmKQ0KPj4gK3sNCj4+ICsgICAgIHN0
cnVjdCB2ZGVjX3QgKnZkZWMgPSBpbnN0LT5wcml2Ow0KPj4gKyAgICAgc3RydWN0IHZwdV92YjJf
YnVmZmVyICp2cHVfYnVmOw0KPj4gKyAgICAgc3RydWN0IHZwdV9mc19pbmZvIGluZm87DQo+PiAr
ICAgICBpbnQgcmV0Ow0KPj4gKw0KPj4gKyAgICAgaWYgKGluc3QtPnN0YXRlICE9IFZQVV9DT0RF
Q19TVEFURV9BQ1RJVkUpDQo+PiArICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOw0KPj4gKw0K
Pj4gKyAgICAgaWYgKCF2ZGVjLT5yZXFfZnJhbWVfY291bnQpDQo+PiArICAgICAgICAgICAgIHJl
dHVybiAtRUlOVkFMOw0KPj4gKw0KPj4gKyAgICAgaWYgKCF2YnVmKQ0KPj4gKyAgICAgICAgICAg
ICByZXR1cm4gLUVJTlZBTDsNCj4+ICsNCj4+ICsgICAgIGlmICh2ZGVjLT5zbG90c1t2YnVmLT52
YjJfYnVmLmluZGV4XSkgew0KPj4gKyAgICAgICAgICAgICBkZXZfZXJyKGluc3QtPmRldiwgIlsl
ZF0gcmVwZWF0IGFsbG9jIGZzICVkXG4iLA0KPj4gKyAgICAgICAgICAgICAgICAgICAgIGluc3Qt
PmlkLCB2YnVmLT52YjJfYnVmLmluZGV4KTsNCj4+ICsgICAgICAgICAgICAgcmV0dXJuIC1FSU5W
QUw7DQo+PiArICAgICB9DQo+PiArDQo+PiArICAgICBkZXZfZGJnKGluc3QtPmRldiwgIlslZF0g
c3RhdGUgPSAlZCwgYWxsb2MgZnMgJWQsIHRhZyA9IDB4JXhcbiIsDQo+PiArICAgICAgICAgICAg
IGluc3QtPmlkLCBpbnN0LT5zdGF0ZSwgdmJ1Zi0+dmIyX2J1Zi5pbmRleCwgdmRlYy0+c2VxX3Rh
Zyk7DQo+PiArICAgICB2cHVfYnVmID0gdG9fdnB1X3ZiMl9idWZmZXIodmJ1Zik7DQo+PiArDQo+
PiArICAgICBtZW1zZXQoJmluZm8sIDAsIHNpemVvZihpbmZvKSk7DQo+PiArICAgICBpbmZvLmlk
ID0gdmJ1Zi0+dmIyX2J1Zi5pbmRleDsNCj4+ICsgICAgIGluZm8udHlwZSA9IE1FTV9SRVNfRlJB
TUU7DQo+PiArICAgICBpbmZvLnRhZyA9IHZkZWMtPnNlcV90YWc7DQo+PiArICAgICBpbmZvLmx1
bWFfYWRkciA9IHZwdV9nZXRfdmJfcGh5X2FkZHIoJnZidWYtPnZiMl9idWYsIDApOw0KPj4gKyAg
ICAgaW5mby5sdW1hX3NpemUgPSBpbnN0LT5jYXBfZm9ybWF0LnNpemVpbWFnZVswXTsNCj4+ICsg
ICAgIGluZm8uY2hyb21hX2FkZHIgPSB2cHVfZ2V0X3ZiX3BoeV9hZGRyKCZ2YnVmLT52YjJfYnVm
LCAxKTsNCj4+ICsgICAgIGluZm8uY2hyb21hdV9zaXplID0gaW5zdC0+Y2FwX2Zvcm1hdC5zaXpl
aW1hZ2VbMV07DQo+PiArICAgICBpbmZvLmJ5dGVzcGVybGluZSA9IGluc3QtPmNhcF9mb3JtYXQu
Ynl0ZXNwZXJsaW5lWzBdOw0KPj4gKyAgICAgcmV0ID0gdnB1X3Nlc3Npb25fYWxsb2NfZnMoaW5z
dCwgJmluZm8pOw0KPj4gKyAgICAgaWYgKHJldCkNCj4+ICsgICAgICAgICAgICAgcmV0dXJuIHJl
dDsNCj4+ICsNCj4+ICsgICAgIHZwdV9idWYtPnRhZyA9IGluZm8udGFnOw0KPj4gKyAgICAgdnB1
X2J1Zi0+bHVtYSA9IGluZm8ubHVtYV9hZGRyOw0KPj4gKyAgICAgdnB1X2J1Zi0+Y2hyb21hX3Ug
PSBpbmZvLmNocm9tYXVfc2l6ZTsNCj4+ICsgICAgIHZwdV9idWYtPmNocm9tYV92ID0gMDsNCj4+
ICsgICAgIHZwdV9zZXRfYnVmZmVyX3N0YXRlKHZidWYsIFZQVV9CVUZfU1RBVEVfSU5VU0UpOw0K
Pj4gKyAgICAgdmRlYy0+c2xvdHNbaW5mby5pZF0gPSB2cHVfYnVmOw0KPj4gKyAgICAgdmRlYy0+
cmVxX2ZyYW1lX2NvdW50LS07DQo+PiArDQo+PiArICAgICByZXR1cm4gMDsNCj4+ICt9DQo+PiAr
DQo+PiArc3RhdGljIHZvaWQgdmRlY19yZXNwb25zZV9mc19yZXF1ZXN0KHN0cnVjdCB2cHVfaW5z
dCAqaW5zdCwgYm9vbCBmb3JjZSkNCj4+ICt7DQo+PiArICAgICBzdHJ1Y3QgdmRlY190ICp2ZGVj
ID0gaW5zdC0+cHJpdjsNCj4+ICsgICAgIGludCBpOw0KPj4gKyAgICAgaW50IHJldDsNCj4+ICsN
Cj4+ICsgICAgIGlmIChmb3JjZSkgew0KPj4gKyAgICAgICAgICAgICBmb3IgKGkgPSB2ZGVjLT5y
ZXFfZnJhbWVfY291bnQ7IGkgPiAwOyBpLS0pDQo+PiArICAgICAgICAgICAgICAgICAgICAgdmRl
Y19yZXNwb25zZV9mcmFtZV9hYm5vcm1hbChpbnN0KTsNCj4+ICsgICAgICAgICAgICAgcmV0dXJu
Ow0KPj4gKyAgICAgfQ0KPj4gKw0KPj4gKyAgICAgZm9yIChpID0gdmRlYy0+cmVxX2ZyYW1lX2Nv
dW50OyBpID4gMDsgaS0tKSB7DQo+PiArICAgICAgICAgICAgIHJldCA9IHZwdV9wcm9jZXNzX2Nh
cHR1cmVfYnVmZmVyKGluc3QpOw0KPj4gKyAgICAgICAgICAgICBpZiAocmV0KQ0KPj4gKyAgICAg
ICAgICAgICAgICAgICAgIGJyZWFrOw0KPj4gKyAgICAgICAgICAgICBpZiAodmRlYy0+ZW9zX3Jl
Y2VpdmVkKQ0KPj4gKyAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPj4gKyAgICAgfQ0KPj4g
Kw0KPj4gKyAgICAgZm9yIChpID0gdmRlYy0+bWJpLmluZGV4OyBpIDwgdmRlYy0+bWJpLmNvdW50
OyBpKyspIHsNCj4+ICsgICAgICAgICAgICAgaWYgKHZkZWNfcmVzcG9uc2VfZnMoaW5zdCwgJnZk
ZWMtPm1iaSkpDQo+PiArICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQo+PiArICAgICAgICAg
ICAgIGlmICh2ZGVjLT5lb3NfcmVjZWl2ZWQpDQo+PiArICAgICAgICAgICAgICAgICAgICAgYnJl
YWs7DQo+PiArICAgICB9DQo+PiArICAgICBmb3IgKGkgPSB2ZGVjLT5kY3AuaW5kZXg7IGkgPCB2
ZGVjLT5kY3AuY291bnQ7IGkrKykgew0KPj4gKyAgICAgICAgICAgICBpZiAodmRlY19yZXNwb25z
ZV9mcyhpbnN0LCAmdmRlYy0+ZGNwKSkNCj4+ICsgICAgICAgICAgICAgICAgICAgICBicmVhazsN
Cj4+ICsgICAgICAgICAgICAgaWYgKHZkZWMtPmVvc19yZWNlaXZlZCkNCj4+ICsgICAgICAgICAg
ICAgICAgICAgICBicmVhazsNCj4+ICsgICAgIH0NCj4+ICt9DQo+PiArDQo+PiArc3RhdGljIHZv
aWQgdmRlY19yZXNwb25zZV9mc19yZWxlYXNlKHN0cnVjdCB2cHVfaW5zdCAqaW5zdCwgdTMyIGlk
LCB1MzIgdGFnKQ0KPj4gK3sNCj4+ICsgICAgIHN0cnVjdCB2cHVfZnNfaW5mbyBpbmZvOw0KPj4g
Kw0KPj4gKyAgICAgbWVtc2V0KCZpbmZvLCAwLCBzaXplb2YoaW5mbykpOw0KPj4gKyAgICAgaW5m
by5pZCA9IGlkOw0KPj4gKyAgICAgaW5mby50YWcgPSB0YWc7DQo+PiArICAgICB2cHVfc2Vzc2lv
bl9yZWxlYXNlX2ZzKGluc3QsICZpbmZvKTsNCj4+ICt9DQo+PiArDQo+PiArc3RhdGljIHZvaWQg
dmRlY19yZWN5Y2xlX2J1ZmZlcihzdHJ1Y3QgdnB1X2luc3QgKmluc3QsIHN0cnVjdA0KPnZiMl92
NGwyX2J1ZmZlciAqdmJ1ZikNCj4+ICt7DQo+PiArICAgICBpZiAoIWluc3QtPmZoLm0ybV9jdHgp
DQo+PiArICAgICAgICAgICAgIHJldHVybjsNCj4+ICsgICAgIGlmICh2YnVmLT52YjJfYnVmLnN0
YXRlICE9IFZCMl9CVUZfU1RBVEVfQUNUSVZFKQ0KPj4gKyAgICAgICAgICAgICByZXR1cm47DQo+
PiArICAgICBpZiAodnB1X2ZpbmRfYnVmX2J5X2lkeChpbnN0LCB2YnVmLT52YjJfYnVmLnR5cGUs
IHZidWYtPnZiMl9idWYuaW5kZXgpKQ0KPj4gKyAgICAgICAgICAgICByZXR1cm47DQo+PiArICAg
ICB2NGwyX20ybV9idWZfcXVldWUoaW5zdC0+ZmgubTJtX2N0eCwgdmJ1Zik7DQo+PiArfQ0KPj4g
Kw0KPj4gK3N0YXRpYyB2b2lkIHZkZWNfY2xlYXJfc2xvdHMoc3RydWN0IHZwdV9pbnN0ICppbnN0
KQ0KPj4gK3sNCj4+ICsgICAgIHN0cnVjdCB2ZGVjX3QgKnZkZWMgPSBpbnN0LT5wcml2Ow0KPj4g
KyAgICAgc3RydWN0IHZwdV92YjJfYnVmZmVyICp2cHVfYnVmOw0KPj4gKyAgICAgc3RydWN0IHZi
Ml92NGwyX2J1ZmZlciAqdmJ1ZjsNCj4+ICsgICAgIGludCBpOw0KPj4gKw0KPj4gKyAgICAgZm9y
IChpID0gMDsgaSA8IEFSUkFZX1NJWkUodmRlYy0+c2xvdHMpOyBpKyspIHsNCj4+ICsgICAgICAg
ICAgICAgaWYgKCF2ZGVjLT5zbG90c1tpXSkNCj4+ICsgICAgICAgICAgICAgICAgICAgICBjb250
aW51ZTsNCj4+ICsNCj4+ICsgICAgICAgICAgICAgdnB1X2J1ZiA9IHZkZWMtPnNsb3RzW2ldOw0K
Pj4gKyAgICAgICAgICAgICB2YnVmID0gJnZwdV9idWYtPm0ybV9idWYudmI7DQo+PiArDQo+PiAr
ICAgICAgICAgICAgIHZkZWNfcmVjeWNsZV9idWZmZXIoaW5zdCwgdmJ1Zik7DQo+PiArICAgICAg
ICAgICAgIHZkZWMtPnNsb3RzW2ldLT5zdGF0ZSA9IFZQVV9CVUZfU1RBVEVfSURMRTsNCj4+ICsg
ICAgICAgICAgICAgdmRlYy0+c2xvdHNbaV0gPSBOVUxMOw0KPj4gKyAgICAgfQ0KPj4gK30NCj4+
ICsNCj4+ICtzdGF0aWMgdm9pZCB2ZGVjX2V2ZW50X3NlcV9oZHIoc3RydWN0IHZwdV9pbnN0ICpp
bnN0LCBzdHJ1Y3QNCj52cHVfZGVjX2NvZGVjX2luZm8gKmhkcikNCj4+ICt7DQo+PiArICAgICBz
dHJ1Y3QgdmRlY190ICp2ZGVjID0gaW5zdC0+cHJpdjsNCj4+ICsNCj4+ICsgICAgIHZwdV9pbnN0
X2xvY2soaW5zdCk7DQo+PiArICAgICBtZW1jcHkoJnZkZWMtPmNvZGVjX2luZm8sIGhkciwgc2l6
ZW9mKHZkZWMtPmNvZGVjX2luZm8pKTsNCj4+ICsNCj4+ICsgICAgIHZwdV90cmFjZShpbnN0LT5k
ZXYsICJbJWRdICVkIHggJWQsIGNyb3AgOiAoJWQsICVkKSAlZCB4ICVkLCAlZCwgJWRcbiIsDQo+
PiArICAgICAgICAgICAgICAgaW5zdC0+aWQsDQo+PiArICAgICAgICAgICAgICAgdmRlYy0+Y29k
ZWNfaW5mby5kZWNvZGVkX3dpZHRoLA0KPj4gKyAgICAgICAgICAgICAgIHZkZWMtPmNvZGVjX2lu
Zm8uZGVjb2RlZF9oZWlnaHQsDQo+PiArICAgICAgICAgICAgICAgdmRlYy0+Y29kZWNfaW5mby5v
ZmZzZXRfeCwNCj4+ICsgICAgICAgICAgICAgICB2ZGVjLT5jb2RlY19pbmZvLm9mZnNldF95LA0K
Pj4gKyAgICAgICAgICAgICAgIHZkZWMtPmNvZGVjX2luZm8ud2lkdGgsDQo+PiArICAgICAgICAg
ICAgICAgdmRlYy0+Y29kZWNfaW5mby5oZWlnaHQsDQo+PiArICAgICAgICAgICAgICAgaGRyLT5u
dW1fcmVmX2ZybXMsDQo+PiArICAgICAgICAgICAgICAgaGRyLT5udW1fZHBiX2ZybXMpOw0KPj4g
KyAgICAgaW5zdC0+bWluX2J1ZmZlcl9jYXAgPSBoZHItPm51bV9yZWZfZnJtcyArIGhkci0+bnVt
X2RwYl9mcm1zOw0KPj4gKyAgICAgdmRlYy0+aXNfc291cmNlX2NoYW5nZWQgPSB2ZGVjX2NoZWNr
X3NvdXJjZV9jaGFuZ2UoaW5zdCk7DQo+PiArICAgICB2ZGVjX2luaXRfZm10KGluc3QpOw0KPj4g
KyAgICAgdmRlY19pbml0X2Nyb3AoaW5zdCk7DQo+PiArICAgICB2ZGVjX2luaXRfbWJpKGluc3Qp
Ow0KPj4gKyAgICAgdmRlY19pbml0X2RjcChpbnN0KTsNCj4+ICsgICAgIGlmICghdmRlYy0+c2Vx
X2hkcl9mb3VuZCkgew0KPj4gKyAgICAgICAgICAgICB2ZGVjLT5zZXFfdGFnID0gdmRlYy0+Y29k
ZWNfaW5mby50YWc7DQo+PiArICAgICAgICAgICAgIGlmICh2ZGVjLT5pc19zb3VyY2VfY2hhbmdl
ZCkgew0KPj4gKyAgICAgICAgICAgICAgICAgICAgIHZkZWNfdXBkYXRlX3N0YXRlKGluc3QsDQo+
VlBVX0NPREVDX1NUQVRFX0RZQU1JQ19SRVNPTFVUSU9OX0NIQU5HRSwgMCk7DQo+PiArICAgICAg
ICAgICAgICAgICAgICAgdnB1X25vdGlmeV9zb3VyY2VfY2hhbmdlKGluc3QpOw0KPj4gKyAgICAg
ICAgICAgICAgICAgICAgIHZkZWMtPmlzX3NvdXJjZV9jaGFuZ2VkID0gZmFsc2U7DQo+PiArICAg
ICAgICAgICAgIH0NCj4+ICsgICAgIH0NCj4+ICsgICAgIGlmICh2ZGVjLT5zZXFfdGFnICE9IHZk
ZWMtPmNvZGVjX2luZm8udGFnKSB7DQo+PiArICAgICAgICAgICAgIHZkZWNfcmVzcG9uc2VfZnNf
cmVxdWVzdChpbnN0LCB0cnVlKTsNCj4+ICsgICAgICAgICAgICAgdnB1X3RyYWNlKGluc3QtPmRl
diwgIlslZF0gc2VxIHRhZyBjaGFuZ2U6ICVkIC0+ICVkXG4iLA0KPj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgaW5zdC0+aWQsIHZkZWMtPnNlcV90YWcsIHZkZWMtPmNvZGVjX2luZm8udGFnKTsN
Cj4+ICsgICAgIH0NCj4+ICsgICAgIHZkZWMtPnNlcV9oZHJfZm91bmQrKzsNCj4+ICsgICAgIHZk
ZWMtPmZpeGVkX2ZtdCA9IHRydWU7DQo+PiArICAgICB2cHVfaW5zdF91bmxvY2soaW5zdCk7DQo+
PiArfQ0KPj4gKw0KPj4gK3N0YXRpYyB2b2lkIHZkZWNfZXZlbnRfcmVzb2x1dGlvbl9jaGFuZ2Uo
c3RydWN0IHZwdV9pbnN0ICppbnN0KQ0KPj4gK3sNCj4+ICsgICAgIHN0cnVjdCB2ZGVjX3QgKnZk
ZWMgPSBpbnN0LT5wcml2Ow0KPj4gKw0KPj4gKyAgICAgdnB1X3RyYWNlKGluc3QtPmRldiwgIlsl
ZF1cbiIsIGluc3QtPmlkKTsNCj4+ICsgICAgIHZwdV9pbnN0X2xvY2soaW5zdCk7DQo+PiArICAg
ICB2ZGVjLT5zZXFfdGFnID0gdmRlYy0+Y29kZWNfaW5mby50YWc7DQo+PiArICAgICB2ZGVjX2Ns
ZWFyX2ZzKCZ2ZGVjLT5tYmkpOw0KPj4gKyAgICAgdmRlY19jbGVhcl9mcygmdmRlYy0+ZGNwKTsN
Cj4+ICsgICAgIHZkZWNfY2xlYXJfc2xvdHMoaW5zdCk7DQo+PiArICAgICB2ZGVjX2luaXRfbWJp
KGluc3QpOw0KPj4gKyAgICAgdmRlY19pbml0X2RjcChpbnN0KTsNCj4+ICsgICAgIGlmICh2ZGVj
LT5pc19zb3VyY2VfY2hhbmdlZCkgew0KPj4gKyAgICAgICAgICAgICB2ZGVjX3VwZGF0ZV9zdGF0
ZShpbnN0LA0KPlZQVV9DT0RFQ19TVEFURV9EWUFNSUNfUkVTT0xVVElPTl9DSEFOR0UsIDApOw0K
Pj4gKyAgICAgICAgICAgICB2ZGVjLT5zb3VyY2VfY2hhbmdlKys7DQo+PiArICAgICAgICAgICAg
IHZkZWNfaGFuZGxlX3Jlc29sdXRpb25fY2hhbmdlKGluc3QpOw0KPj4gKyAgICAgICAgICAgICB2
ZGVjLT5pc19zb3VyY2VfY2hhbmdlZCA9IGZhbHNlOw0KPj4gKyAgICAgfQ0KPj4gKyAgICAgdnB1
X2luc3RfdW5sb2NrKGluc3QpOw0KPj4gK30NCj4+ICsNCj4+ICtzdGF0aWMgdm9pZCB2ZGVjX2V2
ZW50X3JlcV9mcyhzdHJ1Y3QgdnB1X2luc3QgKmluc3QsIHN0cnVjdCB2cHVfZnNfaW5mbyAqZnMp
DQo+PiArew0KPj4gKyAgICAgc3RydWN0IHZkZWNfdCAqdmRlYyA9IGluc3QtPnByaXY7DQo+PiAr
DQo+PiArICAgICBpZiAoIWZzKQ0KPj4gKyAgICAgICAgICAgICByZXR1cm47DQo+PiArDQo+PiAr
ICAgICB2cHVfaW5zdF9sb2NrKGluc3QpOw0KPj4gKw0KPj4gKyAgICAgc3dpdGNoIChmcy0+dHlw
ZSkgew0KPj4gKyAgICAgY2FzZSBNRU1fUkVTX0ZSQU1FOg0KPj4gKyAgICAgICAgICAgICB2ZGVj
LT5yZXFfZnJhbWVfY291bnQrKzsNCj4+ICsgICAgICAgICAgICAgYnJlYWs7DQo+PiArICAgICBj
YXNlIE1FTV9SRVNfTUJJOg0KPj4gKyAgICAgICAgICAgICB2ZGVjX3JlcXVlc3Rfb25lX2ZzKCZ2
ZGVjLT5tYmkpOw0KPj4gKyAgICAgICAgICAgICBicmVhazsNCj4+ICsgICAgIGNhc2UgTUVNX1JF
U19EQ1A6DQo+PiArICAgICAgICAgICAgIHZkZWNfcmVxdWVzdF9vbmVfZnMoJnZkZWMtPmRjcCk7
DQo+PiArICAgICAgICAgICAgIGJyZWFrOw0KPj4gKyAgICAgZGVmYXVsdDoNCj4+ICsgICAgICAg
ICAgICAgYnJlYWs7DQo+PiArICAgICB9DQo+PiArDQo+PiArICAgICB2ZGVjX2FsbG9jX2ZzKGlu
c3QsICZ2ZGVjLT5tYmkpOw0KPj4gKyAgICAgdmRlY19hbGxvY19mcyhpbnN0LCAmdmRlYy0+ZGNw
KTsNCj4+ICsNCj4+ICsgICAgIHZkZWNfcmVzcG9uc2VfZnNfcmVxdWVzdChpbnN0LCBmYWxzZSk7
DQo+PiArDQo+PiArICAgICB2cHVfaW5zdF91bmxvY2soaW5zdCk7DQo+PiArfQ0KPj4gKw0KPj4g
K3N0YXRpYyB2b2lkIHZkZWNfZXZuZXRfcmVsX2ZzKHN0cnVjdCB2cHVfaW5zdCAqaW5zdCwgc3Ry
dWN0IHZwdV9mc19pbmZvICpmcykNCj4+ICt7DQo+PiArICAgICBzdHJ1Y3QgdmRlY190ICp2ZGVj
ID0gaW5zdC0+cHJpdjsNCj4+ICsgICAgIHN0cnVjdCB2cHVfdmIyX2J1ZmZlciAqdnB1X2J1ZjsN
Cj4+ICsgICAgIHN0cnVjdCB2YjJfdjRsMl9idWZmZXIgKnZidWY7DQo+PiArDQo+PiArICAgICBp
ZiAoIWZzIHx8IGZzLT5pZCA+PSBBUlJBWV9TSVpFKHZkZWMtPnNsb3RzKSkNCj4+ICsgICAgICAg
ICAgICAgcmV0dXJuOw0KPj4gKyAgICAgaWYgKGZzLT50eXBlICE9IE1FTV9SRVNfRlJBTUUpDQo+
PiArICAgICAgICAgICAgIHJldHVybjsNCj4+ICsNCj4+ICsgICAgIGlmIChmcy0+aWQgPj0gdnB1
X2dldF9udW1fYnVmZmVycyhpbnN0LCBpbnN0LT5jYXBfZm9ybWF0LnR5cGUpKSB7DQo+PiArICAg
ICAgICAgICAgIGRldl9lcnIoaW5zdC0+ZGV2LCAiWyVkXSBpbnZhbGlkIGZzKCVkKSB0byByZWxl
YXNlXG4iLCBpbnN0LT5pZCwgZnMtDQo+PmlkKTsNCj4+ICsgICAgICAgICAgICAgcmV0dXJuOw0K
Pj4gKyAgICAgfQ0KPj4gKw0KPj4gKyAgICAgdnB1X2luc3RfbG9jayhpbnN0KTsNCj4+ICsgICAg
IHZwdV9idWYgPSB2ZGVjLT5zbG90c1tmcy0+aWRdOw0KPj4gKyAgICAgdmRlYy0+c2xvdHNbZnMt
PmlkXSA9IE5VTEw7DQo+PiArDQo+PiArICAgICBpZiAoIXZwdV9idWYpIHsNCj4+ICsgICAgICAg
ICAgICAgZGV2X2RiZyhpbnN0LT5kZXYsICJbJWRdIGZzWyVkXSBoYXMgYmVlIHJlbGVhc2VkXG4i
LCBpbnN0LT5pZCwgZnMtDQo+PmlkKTsNCj4+ICsgICAgICAgICAgICAgZ290byBleGl0Ow0KPj4g
KyAgICAgfQ0KPj4gKw0KPj4gKyAgICAgdmJ1ZiA9ICZ2cHVfYnVmLT5tMm1fYnVmLnZiOw0KPj4g
KyAgICAgaWYgKHZwdV9nZXRfYnVmZmVyX3N0YXRlKHZidWYpID09IFZQVV9CVUZfU1RBVEVfREVD
T0RFRCkgew0KPj4gKyAgICAgICAgICAgICBkZXZfZGJnKGluc3QtPmRldiwgIlslZF0gZnJhbWUg
c2tpcFxuIiwgaW5zdC0+aWQpOw0KPj4gKyAgICAgICAgICAgICB2ZGVjLT5zZXF1ZW5jZSsrOw0K
Pj4gKyAgICAgfQ0KPj4gKw0KPj4gKyAgICAgdmRlY19yZXNwb25zZV9mc19yZWxlYXNlKGluc3Qs
IGZzLT5pZCwgdnB1X2J1Zi0+dGFnKTsNCj4+ICsgICAgIGlmICh2cHVfZ2V0X2J1ZmZlcl9zdGF0
ZSh2YnVmKSAhPSBWUFVfQlVGX1NUQVRFX1JFQURZKQ0KPj4gKyAgICAgICAgICAgICB2ZGVjX3Jl
Y3ljbGVfYnVmZmVyKGluc3QsIHZidWYpOw0KPj4gKw0KPj4gKyAgICAgdnB1X3NldF9idWZmZXJf
c3RhdGUodmJ1ZiwgVlBVX0JVRl9TVEFURV9JRExFKTsNCj4+ICsgICAgIHZwdV9wcm9jZXNzX2Nh
cHR1cmVfYnVmZmVyKGluc3QpOw0KPj4gKw0KPj4gK2V4aXQ6DQo+PiArICAgICB2cHVfaW5zdF91
bmxvY2soaW5zdCk7DQo+PiArfQ0KPj4gKw0KPj4gK3N0YXRpYyB2b2lkIHZkZWNfZXZlbnRfZW9z
KHN0cnVjdCB2cHVfaW5zdCAqaW5zdCkNCj4+ICt7DQo+PiArICAgICBzdHJ1Y3QgdmRlY190ICp2
ZGVjID0gaW5zdC0+cHJpdjsNCj4+ICsNCj4+ICsgICAgIHZwdV90cmFjZShpbnN0LT5kZXYsICJb
JWRdIGlucHV0IDogJWQsIGRlY29kZWQgOiAlZCwgZGlzcGxheSA6ICVkLA0KPnNlcXVlbmNlIDog
JWRcbiIsDQo+PiArICAgICAgICAgICAgICAgaW5zdC0+aWQsDQo+PiArICAgICAgICAgICAgICAg
dmRlYy0+cGFyYW1zLmZyYW1lX2NvdW50LA0KPj4gKyAgICAgICAgICAgICAgIHZkZWMtPmRlY29k
ZWRfZnJhbWVfY291bnQsDQo+PiArICAgICAgICAgICAgICAgdmRlYy0+ZGlzcGxheV9mcmFtZV9j
b3VudCwNCj4+ICsgICAgICAgICAgICAgICB2ZGVjLT5zZXF1ZW5jZSk7DQo+PiArICAgICB2cHVf
aW5zdF9sb2NrKGluc3QpOw0KPj4gKyAgICAgdmRlYy0+ZW9zX3JlY2VpdmVkKys7DQo+PiArICAg
ICB2ZGVjLT5maXhlZF9mbXQgPSBmYWxzZTsNCj4+ICsgICAgIGluc3QtPm1pbl9idWZmZXJfY2Fw
ID0gVkRFQ19NSU5fQlVGRkVSX0NBUDsNCj4+ICsgICAgIHZkZWNfdXBkYXRlX3N0YXRlKGluc3Qs
IFZQVV9DT0RFQ19TVEFURV9EUkFJTiwgMCk7DQo+PiArICAgICB2ZGVjX3NldF9sYXN0X2J1ZmZl
cl9kZXF1ZXVlZChpbnN0KTsNCj4+ICsgICAgIHZwdV9pbnN0X3VubG9jayhpbnN0KTsNCj4+ICt9
DQo+PiArDQo+PiArc3RhdGljIHZvaWQgdmRlY19ldmVudF9ub3RpZnkoc3RydWN0IHZwdV9pbnN0
ICppbnN0LCB1MzIgZXZlbnQsIHZvaWQgKmRhdGEpDQo+PiArew0KPj4gKyAgICAgc3dpdGNoIChl
dmVudCkgew0KPj4gKyAgICAgY2FzZSBWUFVfTVNHX0lEX1NFUV9IRFJfRk9VTkQ6DQo+PiArICAg
ICAgICAgICAgIHZkZWNfZXZlbnRfc2VxX2hkcihpbnN0LCBkYXRhKTsNCj4+ICsgICAgICAgICAg
ICAgYnJlYWs7DQo+PiArICAgICBjYXNlIFZQVV9NU0dfSURfUkVTX0NIQU5HRToNCj4+ICsgICAg
ICAgICAgICAgdmRlY19ldmVudF9yZXNvbHV0aW9uX2NoYW5nZShpbnN0KTsNCj4+ICsgICAgICAg
ICAgICAgYnJlYWs7DQo+PiArICAgICBjYXNlIFZQVV9NU0dfSURfRlJBTUVfUkVROg0KPj4gKyAg
ICAgICAgICAgICB2ZGVjX2V2ZW50X3JlcV9mcyhpbnN0LCBkYXRhKTsNCj4+ICsgICAgICAgICAg
ICAgYnJlYWs7DQo+PiArICAgICBjYXNlIFZQVV9NU0dfSURfRlJBTUVfUkVMRUFTRToNCj4+ICsg
ICAgICAgICAgICAgdmRlY19ldm5ldF9yZWxfZnMoaW5zdCwgZGF0YSk7DQo+PiArICAgICAgICAg
ICAgIGJyZWFrOw0KPj4gKyAgICAgY2FzZSBWUFVfTVNHX0lEX1BJQ19FT1M6DQo+PiArICAgICAg
ICAgICAgIHZkZWNfZXZlbnRfZW9zKGluc3QpOw0KPj4gKyAgICAgICAgICAgICBicmVhazsNCj4+
ICsgICAgIGRlZmF1bHQ6DQo+PiArICAgICAgICAgICAgIGJyZWFrOw0KPj4gKyAgICAgfQ0KPj4g
K30NCj4+ICsNCj4+ICtzdGF0aWMgaW50IHZkZWNfcHJvY2Vzc19vdXRwdXQoc3RydWN0IHZwdV9p
bnN0ICppbnN0LCBzdHJ1Y3QgdmIyX2J1ZmZlciAqdmIpDQo+PiArew0KPj4gKyAgICAgc3RydWN0
IHZkZWNfdCAqdmRlYyA9IGluc3QtPnByaXY7DQo+PiArICAgICBzdHJ1Y3QgdmIyX3Y0bDJfYnVm
ZmVyICp2YnVmOw0KPj4gKyAgICAgc3RydWN0IHZwdV9ycGNfYnVmZmVyX2Rlc2MgZGVzYzsNCj4+
ICsgICAgIHM2NCB0aW1lc3RhbXA7DQo+PiArICAgICB1MzIgZnJlZV9zcGFjZTsNCj4+ICsgICAg
IGludCByZXQ7DQo+PiArDQo+PiArICAgICB2YnVmID0gdG9fdmIyX3Y0bDJfYnVmZmVyKHZiKTsN
Cj4+ICsgICAgIGRldl9kYmcoaW5zdC0+ZGV2LCAiWyVkXSBkZWMgb3V0cHV0IFslZF0gJWQgOiAl
bGRcbiIsDQo+PiArICAgICAgICAgICAgIGluc3QtPmlkLCB2YnVmLT5zZXF1ZW5jZSwgdmItPmlu
ZGV4LCB2YjJfZ2V0X3BsYW5lX3BheWxvYWQodmIsIDApKTsNCj4+ICsNCj4+ICsgICAgIGlmIChp
bnN0LT5zdGF0ZSA9PSBWUFVfQ09ERUNfU1RBVEVfREVJTklUKQ0KPj4gKyAgICAgICAgICAgICBy
ZXR1cm4gLUVJTlZBTDsNCj4+ICsgICAgIGlmICh2ZGVjLT5yZXNldF9jb2RlYykNCj4+ICsgICAg
ICAgICAgICAgcmV0dXJuIC1FSU5WQUw7DQo+PiArDQo+PiArICAgICBpZiAoaW5zdC0+c3RhdGUg
PT0gVlBVX0NPREVDX1NUQVRFX1NUQVJURUQpDQo+PiArICAgICAgICAgICAgIHZkZWNfdXBkYXRl
X3N0YXRlKGluc3QsIFZQVV9DT0RFQ19TVEFURV9BQ1RJVkUsIDApOw0KPj4gKw0KPj4gKyAgICAg
cmV0ID0gdnB1X2lmYWNlX2dldF9zdHJlYW1fYnVmZmVyX2Rlc2MoaW5zdCwgJmRlc2MpOw0KPj4g
KyAgICAgaWYgKHJldCkNCj4+ICsgICAgICAgICAgICAgcmV0dXJuIHJldDsNCj4+ICsNCj4+ICsg
ICAgIGZyZWVfc3BhY2UgPSB2cHVfaGVscGVyX2dldF9mcmVlX3NwYWNlKGluc3QpOw0KPj4gKyAg
ICAgaWYgKGZyZWVfc3BhY2UgPCB2YjJfZ2V0X3BsYW5lX3BheWxvYWQodmIsIDApICsgMHg0MDAw
MCkNCj4+ICsgICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07DQo+PiArDQo+PiArICAgICB0aW1l
c3RhbXAgPSB2Yi0+dGltZXN0YW1wOw0KPj4gKyAgICAgaWYgKHRpbWVzdGFtcCA+PSAwICYmIHZk
ZWMtPnRzX3N0YXJ0IDwgMCkNCj4+ICsgICAgICAgICAgICAgdmRlYy0+dHNfc3RhcnQgPSB0aW1l
c3RhbXA7DQo+PiArICAgICBpZiAodmRlYy0+dHNfaW5wdXQgPCB0aW1lc3RhbXApDQo+PiArICAg
ICAgICAgICAgIHZkZWMtPnRzX2lucHV0ID0gdGltZXN0YW1wOw0KPj4gKw0KPj4gKyAgICAgcmV0
ID0gdnB1X2lmYWNlX2lucHV0X2ZyYW1lKGluc3QsIHZiKTsNCj4+ICsgICAgIGlmIChyZXQgPCAw
KQ0KPj4gKyAgICAgICAgICAgICByZXR1cm4gLUVOT01FTTsNCj4+ICsNCj4+ICsgICAgIGRldl9k
YmcoaW5zdC0+ZGV2LCAiWyVkXVtJTlBVVCAgVFNdJTMybGxkXG4iLCBpbnN0LT5pZCwgdmItPnRp
bWVzdGFtcCk7DQo+PiArICAgICB2ZGVjLT50c19wcmVfY291bnQrKzsNCj4+ICsgICAgIHZkZWMt
PnBhcmFtcy5mcmFtZV9jb3VudCsrOw0KPj4gKw0KPj4gKyAgICAgdjRsMl9tMm1fc3JjX2J1Zl9y
ZW1vdmVfYnlfYnVmKGluc3QtPmZoLm0ybV9jdHgsIHZidWYpOw0KPj4gKyAgICAgdnB1X3NldF9i
dWZmZXJfc3RhdGUodmJ1ZiwgVlBVX0JVRl9TVEFURV9JRExFKTsNCj4+ICsgICAgIHY0bDJfbTJt
X2J1Zl9kb25lKHZidWYsIFZCMl9CVUZfU1RBVEVfRE9ORSk7DQo+PiArDQo+PiArICAgICBpZiAo
dmRlYy0+ZHJhaW4pDQo+PiArICAgICAgICAgICAgIHZkZWNfZHJhaW4oaW5zdCk7DQo+PiArDQo+
PiArICAgICByZXR1cm4gMDsNCj4+ICt9DQo+PiArDQo+PiArc3RhdGljIGludCB2ZGVjX3Byb2Nl
c3NfY2FwdHVyZShzdHJ1Y3QgdnB1X2luc3QgKmluc3QsIHN0cnVjdCB2YjJfYnVmZmVyICp2YikN
Cj4+ICt7DQo+PiArICAgICBzdHJ1Y3QgdmRlY190ICp2ZGVjID0gaW5zdC0+cHJpdjsNCj4+ICsg
ICAgIHN0cnVjdCB2YjJfdjRsMl9idWZmZXIgKnZidWYgPSB0b192YjJfdjRsMl9idWZmZXIodmIp
Ow0KPj4gKyAgICAgaW50IHJldDsNCj4+ICsNCj4+ICsgICAgIGlmIChpbnN0LT5zdGF0ZSA9PSBW
UFVfQ09ERUNfU1RBVEVfRFlBTUlDX1JFU09MVVRJT05fQ0hBTkdFKQ0KPj4gKyAgICAgICAgICAg
ICByZXR1cm4gLUVJTlZBTDsNCj4+ICsgICAgIGlmICh2ZGVjLT5yZXNldF9jb2RlYykNCj4+ICsg
ICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7DQo+PiArDQo+PiArICAgICByZXQgPSB2ZGVjX3Jl
c3BvbnNlX2ZyYW1lKGluc3QsIHZidWYpOw0KPj4gKyAgICAgaWYgKHJldCkNCj4+ICsgICAgICAg
ICAgICAgcmV0dXJuIHJldDsNCj4+ICsgICAgIHY0bDJfbTJtX2RzdF9idWZfcmVtb3ZlX2J5X2J1
ZihpbnN0LT5maC5tMm1fY3R4LCB2YnVmKTsNCj4+ICsgICAgIHJldHVybiAwOw0KPj4gK30NCj4+
ICsNCj4+ICtzdGF0aWMgdm9pZCB2ZGVjX29uX3F1ZXVlX2VtcHR5KHN0cnVjdCB2cHVfaW5zdCAq
aW5zdCwgdTMyIHR5cGUpDQo+PiArew0KPj4gKyAgICAgc3RydWN0IHZkZWNfdCAqdmRlYyA9IGlu
c3QtPnByaXY7DQo+PiArDQo+PiArICAgICBpZiAoVjRMMl9UWVBFX0lTX09VVFBVVCh0eXBlKSkN
Cj4+ICsgICAgICAgICAgICAgcmV0dXJuOw0KPj4gKw0KPj4gKyAgICAgdmRlY19oYW5kbGVfcmVz
b2x1dGlvbl9jaGFuZ2UoaW5zdCk7DQo+PiArICAgICBpZiAodmRlYy0+ZW9zX3JlY2VpdmVkKQ0K
Pj4gKyAgICAgICAgICAgICB2ZGVjX3NldF9sYXN0X2J1ZmZlcl9kZXF1ZXVlZChpbnN0KTsNCj4+
ICt9DQo+PiArDQo+PiArc3RhdGljIHZvaWQgdmRlY19hYm9ydChzdHJ1Y3QgdnB1X2luc3QgKmlu
c3QpDQo+PiArew0KPj4gKyAgICAgc3RydWN0IHZkZWNfdCAqdmRlYyA9IGluc3QtPnByaXY7DQo+
PiArICAgICBzdHJ1Y3QgdnB1X3JwY19idWZmZXJfZGVzYyBkZXNjOw0KPj4gKyAgICAgaW50IHJl
dDsNCj4+ICsNCj4+ICsgICAgIHZwdV90cmFjZShpbnN0LT5kZXYsICJbJWRdIHN0YXRlID0gJWRc
biIsIGluc3QtPmlkLCBpbnN0LT5zdGF0ZSk7DQo+PiArICAgICB2cHVfaWZhY2VfYWRkX3Njb2Rl
KGluc3QsIFNDT0RFX1BBRERJTkdfQUJPUlQpOw0KPj4gKyAgICAgdmRlYy0+cGFyYW1zLmVuZF9m
bGFnID0gMTsNCj4+ICsgICAgIHZwdV9pZmFjZV9zZXRfZGVjb2RlX3BhcmFtcyhpbnN0LCAmdmRl
Yy0+cGFyYW1zLCAxKTsNCj4+ICsNCj4+ICsgICAgIHZwdV9zZXNzaW9uX2Fib3J0KGluc3QpOw0K
Pj4gKw0KPj4gKyAgICAgcmV0ID0gdnB1X2lmYWNlX2dldF9zdHJlYW1fYnVmZmVyX2Rlc2MoaW5z
dCwgJmRlc2MpOw0KPj4gKyAgICAgaWYgKCFyZXQpDQo+PiArICAgICAgICAgICAgIHZwdV9pZmFj
ZV91cGRhdGVfc3RyZWFtX2J1ZmZlcihpbnN0LCBkZXNjLnJwdHIsIDEpOw0KPj4gKw0KPj4gKyAg
ICAgdnB1X3Nlc3Npb25fcnN0X2J1ZihpbnN0KTsNCj4+ICsgICAgIHZwdV90cmFjZShpbnN0LT5k
ZXYsICJbJWRdIGlucHV0IDogJWQsIGRlY29kZWQgOiAlZCwgZGlzcGxheSA6ICVkLA0KPnNlcXVl
bmNlIDogJWRcbiIsDQo+PiArICAgICAgICAgICAgICAgaW5zdC0+aWQsDQo+PiArICAgICAgICAg
ICAgICAgdmRlYy0+cGFyYW1zLmZyYW1lX2NvdW50LA0KPj4gKyAgICAgICAgICAgICAgIHZkZWMt
PmRlY29kZWRfZnJhbWVfY291bnQsDQo+PiArICAgICAgICAgICAgICAgdmRlYy0+ZGlzcGxheV9m
cmFtZV9jb3VudCwNCj4+ICsgICAgICAgICAgICAgICB2ZGVjLT5zZXF1ZW5jZSk7DQo+PiArICAg
ICB2ZGVjLT5wYXJhbXMuZW5kX2ZsYWcgPSAwOw0KPj4gKyAgICAgdmRlYy0+ZHJhaW4gPSAwOw0K
Pj4gKyAgICAgdmRlYy0+dHNfcHJlX2NvdW50ID0gMDsNCj4+ICsgICAgIHZkZWMtPnRpbWVzdGFt
cCA9IFZQVV9JTlZBTElEX1RJTUVTVEFNUDsNCj4+ICsgICAgIHZkZWMtPnRzX3N0YXJ0ID0gVlBV
X0lOVkFMSURfVElNRVNUQU1QOw0KPj4gKyAgICAgdmRlYy0+dHNfaW5wdXQgPSBWUFVfSU5WQUxJ
RF9USU1FU1RBTVA7DQo+PiArICAgICB2ZGVjLT5wYXJhbXMuZnJhbWVfY291bnQgPSAwOw0KPj4g
KyAgICAgdmRlYy0+ZGVjb2RlZF9mcmFtZV9jb3VudCA9IDA7DQo+PiArICAgICB2ZGVjLT5kaXNw
bGF5X2ZyYW1lX2NvdW50ID0gMDsNCj4+ICsgICAgIHZkZWMtPnNlcXVlbmNlID0gMDsNCj4+ICt9
DQo+PiArDQo+PiArc3RhdGljIHZvaWQgdmRlY19zdG9wKHN0cnVjdCB2cHVfaW5zdCAqaW5zdCwg
Ym9vbCBmcmVlKQ0KPj4gK3sNCj4+ICsgICAgIHN0cnVjdCB2ZGVjX3QgKnZkZWMgPSBpbnN0LT5w
cml2Ow0KPj4gKw0KPj4gKyAgICAgdmRlY19jbGVhcl9zbG90cyhpbnN0KTsNCj4+ICsgICAgIGlm
IChpbnN0LT5zdGF0ZSAhPSBWUFVfQ09ERUNfU1RBVEVfREVJTklUKQ0KPj4gKyAgICAgICAgICAg
ICB2cHVfc2Vzc2lvbl9zdG9wKGluc3QpOw0KPj4gKyAgICAgdmRlY19jbGVhcl9mcygmdmRlYy0+
bWJpKTsNCj4+ICsgICAgIHZkZWNfY2xlYXJfZnMoJnZkZWMtPmRjcCk7DQo+PiArICAgICBpZiAo
ZnJlZSkgew0KPj4gKyAgICAgICAgICAgICB2cHVfZnJlZV9kbWEoJnZkZWMtPnVkYXRhKTsNCj4+
ICsgICAgICAgICAgICAgdnB1X2ZyZWVfZG1hKCZpbnN0LT5zdHJlYW1fYnVmZmVyKTsNCj4+ICsg
ICAgIH0NCj4+ICsgICAgIHZkZWNfdXBkYXRlX3N0YXRlKGluc3QsIFZQVV9DT0RFQ19TVEFURV9E
RUlOSVQsIDEpOw0KPj4gKyAgICAgdmRlYy0+cmVzZXRfY29kZWMgPSBmYWxzZTsNCj4+ICt9DQo+
PiArDQo+PiArc3RhdGljIHZvaWQgdmRlY19yZWxlYXNlKHN0cnVjdCB2cHVfaW5zdCAqaW5zdCkN
Cj4+ICt7DQo+PiArICAgICBpZiAoaW5zdC0+aWQgIT0gVlBVX0lOU1RfTlVMTF9JRCkNCj4+ICsg
ICAgICAgICAgICAgdnB1X3RyYWNlKGluc3QtPmRldiwgIlslZF1cbiIsIGluc3QtPmlkKTsNCj4+
ICsgICAgIHZwdV9pbnN0X2xvY2soaW5zdCk7DQo+PiArICAgICB2ZGVjX3N0b3AoaW5zdCwgdHJ1
ZSk7DQo+PiArICAgICB2cHVfaW5zdF91bmxvY2soaW5zdCk7DQo+PiArfQ0KPj4gKw0KPj4gK3N0
YXRpYyB2b2lkIHZkZWNfY2xlYW51cChzdHJ1Y3QgdnB1X2luc3QgKmluc3QpDQo+PiArew0KPj4g
KyAgICAgc3RydWN0IHZkZWNfdCAqdmRlYzsNCj4+ICsNCj4+ICsgICAgIGlmICghaW5zdCkNCj4+
ICsgICAgICAgICAgICAgcmV0dXJuOw0KPj4gKw0KPj4gKyAgICAgdmRlYyA9IGluc3QtPnByaXY7
DQo+PiArICAgICBpZiAodmRlYykNCj4+ICsgICAgICAgICAgICAgdmZyZWUodmRlYyk7DQo+PiAr
ICAgICBpbnN0LT5wcml2ID0gTlVMTDsNCj4+ICsgICAgIHZmcmVlKGluc3QpOw0KPj4gK30NCj4+
ICsNCj4+ICtzdGF0aWMgdm9pZCB2ZGVjX2luaXRfcGFyYW1zKHN0cnVjdCB2ZGVjX3QgKnZkZWMp
DQo+PiArew0KPj4gKyAgICAgdmRlYy0+cGFyYW1zLmZyYW1lX2NvdW50ID0gMDsNCj4+ICsgICAg
IHZkZWMtPnBhcmFtcy5lbmRfZmxhZyA9IDA7DQo+PiArfQ0KPj4gKw0KPj4gK3N0YXRpYyBpbnQg
dmRlY19zdGFydChzdHJ1Y3QgdnB1X2luc3QgKmluc3QpDQo+PiArew0KPj4gKyAgICAgc3RydWN0
IHZkZWNfdCAqdmRlYyA9IGluc3QtPnByaXY7DQo+PiArICAgICBpbnQgc3RyZWFtX2J1ZmZlcl9z
aXplOw0KPj4gKyAgICAgaW50IHJldDsNCj4+ICsNCj4+ICsgICAgIGlmIChpbnN0LT5zdGF0ZSAh
PSBWUFVfQ09ERUNfU1RBVEVfREVJTklUKQ0KPj4gKyAgICAgICAgICAgICByZXR1cm4gMDsNCj4+
ICsNCj4+ICsgICAgIHZwdV90cmFjZShpbnN0LT5kZXYsICJbJWRdXG4iLCBpbnN0LT5pZCk7DQo+
PiArICAgICBpZiAoIXZkZWMtPnVkYXRhLnZpcnQpIHsNCj4+ICsgICAgICAgICAgICAgdmRlYy0+
dWRhdGEubGVuZ3RoID0gMHgxMDAwOw0KPj4gKyAgICAgICAgICAgICByZXQgPSB2cHVfYWxsb2Nf
ZG1hKGluc3QtPmNvcmUsICZ2ZGVjLT51ZGF0YSk7DQo+PiArICAgICAgICAgICAgIGlmIChyZXQp
IHsNCj4+ICsgICAgICAgICAgICAgICAgICAgICBkZXZfZXJyKGluc3QtPmRldiwgIlslZF0gYWxs
b2MgdWRhdGEgZmFpbFxuIiwgaW5zdC0+aWQpOw0KPj4gKyAgICAgICAgICAgICAgICAgICAgIGdv
dG8gZXJyb3I7DQo+PiArICAgICAgICAgICAgIH0NCj4+ICsgICAgIH0NCj4+ICsNCj4+ICsgICAg
IGlmICghaW5zdC0+c3RyZWFtX2J1ZmZlci52aXJ0KSB7DQo+PiArICAgICAgICAgICAgIHN0cmVh
bV9idWZmZXJfc2l6ZSA9IHZwdV9pZmFjZV9nZXRfc3RyZWFtX2J1ZmZlcl9zaXplKGluc3QtPmNv
cmUpOw0KPj4gKyAgICAgICAgICAgICBpZiAoc3RyZWFtX2J1ZmZlcl9zaXplID4gMCkgew0KPj4g
KyAgICAgICAgICAgICAgICAgICAgIGluc3QtPnN0cmVhbV9idWZmZXIubGVuZ3RoID0gc3RyZWFt
X2J1ZmZlcl9zaXplOw0KPj4gKyAgICAgICAgICAgICAgICAgICAgIHJldCA9IHZwdV9hbGxvY19k
bWEoaW5zdC0+Y29yZSwgJmluc3QtPnN0cmVhbV9idWZmZXIpOw0KPj4gKyAgICAgICAgICAgICAg
ICAgICAgIGlmIChyZXQpIHsNCj4+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRldl9l
cnIoaW5zdC0+ZGV2LCAiWyVkXSBhbGxvYyBzdHJlYW0gYnVmZmVyIGZhaWxcbiIsIGluc3QtDQo+
PmlkKTsNCj4+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gZXJyb3I7DQo+PiAr
ICAgICAgICAgICAgICAgICAgICAgfQ0KPj4gKyAgICAgICAgICAgICAgICAgICAgIGluc3QtPnVz
ZV9zdHJlYW1fYnVmZmVyID0gdHJ1ZTsNCj4+ICsgICAgICAgICAgICAgfQ0KPj4gKyAgICAgfQ0K
Pj4gKw0KPj4gKyAgICAgaWYgKGluc3QtPnVzZV9zdHJlYW1fYnVmZmVyKQ0KPj4gKyAgICAgICAg
ICAgICB2cHVfaWZhY2VfY29uZmlnX3N0cmVhbV9idWZmZXIoaW5zdCwgJmluc3QtPnN0cmVhbV9i
dWZmZXIpOw0KPj4gKyAgICAgdnB1X2lmYWNlX2luaXRfaW5zdGFuY2UoaW5zdCk7DQo+PiArICAg
ICB2ZGVjLT5wYXJhbXMudWRhdGEuYmFzZSA9IHZkZWMtPnVkYXRhLnBoeXM7DQo+PiArICAgICB2
ZGVjLT5wYXJhbXMudWRhdGEuc2l6ZSA9IHZkZWMtPnVkYXRhLmxlbmd0aDsNCj4+ICsgICAgIHJl
dCA9IHZwdV9pZmFjZV9zZXRfZGVjb2RlX3BhcmFtcyhpbnN0LCAmdmRlYy0+cGFyYW1zLCAwKTsN
Cj4+ICsgICAgIGlmIChyZXQpIHsNCj4+ICsgICAgICAgICAgICAgZGV2X2VycihpbnN0LT5kZXYs
ICJbJWRdIHNldCBkZWNvZGUgcGFyYW1zIGZhaWxcbiIsIGluc3QtPmlkKTsNCj4+ICsgICAgICAg
ICAgICAgZ290byBlcnJvcjsNCj4+ICsgICAgIH0NCj4+ICsNCj4+ICsgICAgIHZkZWNfaW5pdF9w
YXJhbXModmRlYyk7DQo+PiArICAgICByZXQgPSB2cHVfc2Vzc2lvbl9zdGFydChpbnN0KTsNCj4+
ICsgICAgIGlmIChyZXQpIHsNCj4+ICsgICAgICAgICAgICAgZGV2X2VycihpbnN0LT5kZXYsICJb
JWRdIHN0YXJ0IGZhaWxcbiIsIGluc3QtPmlkKTsNCj4+ICsgICAgICAgICAgICAgZ290byBlcnJv
cjsNCj4+ICsgICAgIH0NCj4+ICsNCj4+ICsgICAgIHZkZWNfdXBkYXRlX3N0YXRlKGluc3QsIFZQ
VV9DT0RFQ19TVEFURV9TVEFSVEVELCAwKTsNCj4+ICsNCj4+ICsgICAgIHJldHVybiAwOw0KPj4g
K2Vycm9yOg0KPj4gKyAgICAgdnB1X2ZyZWVfZG1hKCZ2ZGVjLT51ZGF0YSk7DQo+PiArICAgICB2
cHVfZnJlZV9kbWEoJmluc3QtPnN0cmVhbV9idWZmZXIpOw0KPj4gKyAgICAgcmV0dXJuIHJldDsN
Cj4+ICt9DQo+PiArDQo+PiArc3RhdGljIGludCB2ZGVjX3N0YXJ0X3Nlc3Npb24oc3RydWN0IHZw
dV9pbnN0ICppbnN0LCB1MzIgdHlwZSkNCj4+ICt7DQo+PiArICAgICBzdHJ1Y3QgdmRlY190ICp2
ZGVjID0gaW5zdC0+cHJpdjsNCj4+ICsgICAgIGludCByZXQgPSAwOw0KPj4gKw0KPj4gKyAgICAg
aWYgKFY0TDJfVFlQRV9JU19PVVRQVVQodHlwZSkpIHsNCj4+ICsgICAgICAgICAgICAgaWYgKHZk
ZWMtPnJlc2V0X2NvZGVjKQ0KPj4gKyAgICAgICAgICAgICAgICAgICAgIHZkZWNfc3RvcChpbnN0
LCBmYWxzZSk7DQo+PiArICAgICAgICAgICAgIGlmIChpbnN0LT5zdGF0ZSA9PSBWUFVfQ09ERUNf
U1RBVEVfREVJTklUKSB7DQo+PiArICAgICAgICAgICAgICAgICAgICAgcmV0ID0gdmRlY19zdGFy
dChpbnN0KTsNCj4+ICsgICAgICAgICAgICAgICAgICAgICBpZiAocmV0KQ0KPj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJldDsNCj4+ICsgICAgICAgICAgICAgfQ0KPj4g
KyAgICAgfQ0KPj4gKw0KPj4gKyAgICAgaWYgKFY0TDJfVFlQRV9JU19PVVRQVVQodHlwZSkpIHsN
Cj4+ICsgICAgICAgICAgICAgaWYgKGluc3QtPnN0YXRlID09IFZQVV9DT0RFQ19TVEFURV9TRUVL
KQ0KPj4gKyAgICAgICAgICAgICAgICAgICAgIHZkZWNfdXBkYXRlX3N0YXRlKGluc3QsIHZkZWMt
PnN0YXRlLCAxKTsNCj4+ICsgICAgICAgICAgICAgdmRlYy0+ZW9zX3JlY2VpdmVkID0gMDsNCj4+
ICsgICAgICAgICAgICAgdnB1X3Byb2Nlc3Nfb3V0cHV0X2J1ZmZlcihpbnN0KTsNCj4+ICsgICAg
IH0gZWxzZSB7DQo+PiArICAgICAgICAgICAgIHZkZWNfY21kX3N0YXJ0KGluc3QpOw0KPj4gKyAg
ICAgfQ0KPj4gKyAgICAgaWYgKGluc3QtPnN0YXRlID09IFZQVV9DT0RFQ19TVEFURV9BQ1RJVkUp
DQo+PiArICAgICAgICAgICAgIHZkZWNfcmVzcG9uc2VfZnNfcmVxdWVzdChpbnN0LCBmYWxzZSk7
DQo+PiArDQo+PiArICAgICByZXR1cm4gcmV0Ow0KPj4gK30NCj4+ICsNCj4+ICtzdGF0aWMgaW50
IHZkZWNfc3RvcF9zZXNzaW9uKHN0cnVjdCB2cHVfaW5zdCAqaW5zdCwgdTMyIHR5cGUpDQo+PiAr
ew0KPj4gKyAgICAgc3RydWN0IHZkZWNfdCAqdmRlYyA9IGluc3QtPnByaXY7DQo+PiArDQo+PiAr
ICAgICBpZiAoaW5zdC0+c3RhdGUgPT0gVlBVX0NPREVDX1NUQVRFX0RFSU5JVCkNCj4+ICsgICAg
ICAgICAgICAgcmV0dXJuIDA7DQo+PiArDQo+PiArICAgICBpZiAoVjRMMl9UWVBFX0lTX09VVFBV
VCh0eXBlKSkgew0KPj4gKyAgICAgICAgICAgICB2ZGVjX3VwZGF0ZV9zdGF0ZShpbnN0LCBWUFVf
Q09ERUNfU1RBVEVfU0VFSywgMCk7DQo+PiArICAgICAgICAgICAgIHZkZWMtPmRyYWluID0gMDsN
Cj4+ICsgICAgIH0gZWxzZSB7DQo+PiArICAgICAgICAgICAgIGlmIChpbnN0LT5zdGF0ZSAhPQ0K
PlZQVV9DT0RFQ19TVEFURV9EWUFNSUNfUkVTT0xVVElPTl9DSEFOR0UpDQo+PiArICAgICAgICAg
ICAgICAgICAgICAgdmRlY19hYm9ydChpbnN0KTsNCj4+ICsNCj4+ICsgICAgICAgICAgICAgdmRl
Yy0+ZW9zX3JlY2VpdmVkID0gMDsNCj4+ICsgICAgICAgICAgICAgdmRlY19jbGVhcl9zbG90cyhp
bnN0KTsNCj4+ICsgICAgIH0NCj4+ICsNCj4+ICsgICAgIHJldHVybiAwOw0KPj4gK30NCj4+ICsN
Cj4+ICtzdGF0aWMgaW50IHZkZWNfZ2V0X2RlYnVnX2luZm8oc3RydWN0IHZwdV9pbnN0ICppbnN0
LCBjaGFyICpzdHIsIHUzMiBzaXplLA0KPnUzMiBpKQ0KPj4gK3sNCj4+ICsgICAgIHN0cnVjdCB2
ZGVjX3QgKnZkZWMgPSBpbnN0LT5wcml2Ow0KPj4gKyAgICAgaW50IG51bSA9IC0xOw0KPj4gKw0K
Pj4gKyAgICAgc3dpdGNoIChpKSB7DQo+PiArICAgICBjYXNlIDA6DQo+PiArICAgICAgICAgICAg
IG51bSA9IHNjbnByaW50ZihzdHIsIHNpemUsDQo+PiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAicmVxX2ZyYW1lX2NvdW50ID0gJWRcbmludGVybGFjZWQgPSAlZFxuIiwNCj4+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHZkZWMtPnJlcV9mcmFtZV9jb3VudCwNCj4+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHZkZWMtPmNvZGVjX2luZm8ucHJvZ3Jlc3NpdmUgPyAw
IDogMSk7DQo+PiArICAgICAgICAgICAgIGJyZWFrOw0KPj4gKyAgICAgY2FzZSAxOg0KPj4gKyAg
ICAgICAgICAgICBudW0gPSBzY25wcmludGYoc3RyLCBzaXplLA0KPj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIm1iaTogc2l6ZSA9IDB4JXggcmVxdWVzdCA9ICVkLCBhbGxvYyA9ICVk
LCByZXNwb25zZQ0KPj0gJWRcbiIsDQo+PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2
ZGVjLT5tYmkuc2l6ZSwNCj4+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZkZWMtPm1i
aS5yZXFfY291bnQsDQo+PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZGVjLT5tYmku
Y291bnQsDQo+PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZGVjLT5tYmkuaW5kZXgp
Ow0KPj4gKyAgICAgICAgICAgICBicmVhazsNCj4+ICsgICAgIGNhc2UgMjoNCj4+ICsgICAgICAg
ICAgICAgbnVtID0gc2NucHJpbnRmKHN0ciwgc2l6ZSwNCj4+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICJkY3A6IHNpemUgPSAweCV4IHJlcXVlc3QgPSAlZCwgYWxsb2MgPSAlZCwgcmVz
cG9uc2UNCj49ICVkXG4iLA0KPj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmRlYy0+
ZGNwLnNpemUsDQo+PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZGVjLT5kY3AucmVx
X2NvdW50LA0KPj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmRlYy0+ZGNwLmNvdW50
LA0KPj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmRlYy0+ZGNwLmluZGV4KTsNCj4+
ICsgICAgICAgICAgICAgYnJlYWs7DQo+PiArICAgICBjYXNlIDM6DQo+PiArICAgICAgICAgICAg
IG51bSA9IHNjbnByaW50ZihzdHIsIHNpemUsICJpbnB1dF9mcmFtZV9jb3VudCA9ICVkXG4iLCB2
ZGVjLQ0KPj5wYXJhbXMuZnJhbWVfY291bnQpOw0KPj4gKyAgICAgICAgICAgICBicmVhazsNCj4+
ICsgICAgIGNhc2UgNDoNCj4+ICsgICAgICAgICAgICAgbnVtID0gc2NucHJpbnRmKHN0ciwgc2l6
ZSwgImRlY29kZWRfZnJhbWVfY291bnQgPSAlZFxuIiwgdmRlYy0NCj4+ZGVjb2RlZF9mcmFtZV9j
b3VudCk7DQo+PiArICAgICAgICAgICAgIGJyZWFrOw0KPj4gKyAgICAgY2FzZSA1Og0KPj4gKyAg
ICAgICAgICAgICBudW0gPSBzY25wcmludGYoc3RyLCBzaXplLCAiZGlzcGxheV9mcmFtZV9jb3Vu
dCA9ICVkXG4iLCB2ZGVjLQ0KPj5kaXNwbGF5X2ZyYW1lX2NvdW50KTsNCj4+ICsgICAgICAgICAg
ICAgYnJlYWs7DQo+PiArICAgICBjYXNlIDY6DQo+PiArICAgICAgICAgICAgIG51bSA9IHNjbnBy
aW50ZihzdHIsIHNpemUsICJzZXF1ZW5jZSA9ICVkXG4iLCB2ZGVjLT5zZXF1ZW5jZSk7DQo+PiAr
ICAgICAgICAgICAgIGJyZWFrOw0KPj4gKyAgICAgY2FzZSA3Og0KPj4gKyAgICAgICAgICAgICBu
dW0gPSBzY25wcmludGYoc3RyLCBzaXplLCAiZHJhaW4gPSAlZCwgZW9zID0gJWQsIHNvdXJjZV9j
aGFuZ2UNCj49ICVkXG4iLA0KPj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmRlYy0+
ZHJhaW4sIHZkZWMtPmVvc19yZWNlaXZlZCwgdmRlYy0+c291cmNlX2NoYW5nZSk7DQo+PiArICAg
ICAgICAgICAgIGJyZWFrOw0KPj4gKyAgICAgY2FzZSA4Og0KPj4gKyAgICAgICAgICAgICBudW0g
PSBzY25wcmludGYoc3RyLCBzaXplLCAidHNfcHJlX2NvdW50ID0gJWQsIGZyYW1lX2RlcHRoID0g
JWRcbiIsDQo+PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ZGVjLT50c19wcmVfY291
bnQsIHZkZWMtPmZyYW1lX2RlcHRoKTsNCj4+ICsgICAgICAgICAgICAgYnJlYWs7DQo+PiArICAg
ICBjYXNlIDk6DQo+PiArICAgICAgICAgICAgIG51bSA9IHNjbnByaW50ZihzdHIsIHNpemUsICJm
cHMgPSAlZC8lZFxuIiwNCj4+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZkZWMtPmNv
ZGVjX2luZm8uZnJhbWVfcmF0ZS5udW1lcmF0b3IsDQo+PiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB2ZGVjLT5jb2RlY19pbmZvLmZyYW1lX3JhdGUuZGVub21pbmF0b3IpOw0KPj4gKyAg
ICAgICAgICAgICBicmVhazsNCj4+ICsgICAgIGNhc2UgMTA6DQo+PiArICAgICB7DQo+PiArICAg
ICAgICAgICAgIHM2NCB0aW1lc3RhbXAgPSB2ZGVjLT50aW1lc3RhbXA7DQo+PiArICAgICAgICAg
ICAgIHM2NCB0c19zdGFydCA9IHZkZWMtPnRzX3N0YXJ0Ow0KPj4gKyAgICAgICAgICAgICBzNjQg
dHNfaW5wdXQgPSB2ZGVjLT50c19pbnB1dDsNCj4+ICsNCj4+ICsgICAgICAgICAgICAgbnVtID0g
c2NucHJpbnRmKHN0ciwgc2l6ZSwgInRpbWVzdGFtcA0KPj0gJTlsbGQuJTA5bGxkKCU5bGxkLiUw
OWxsZCwgJTlsbGQuJTA5bGxkKVxuIiwNCj4+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHRpbWVzdGFtcCAvIE5TRUNfUEVSX1NFQywNCj4+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHRpbWVzdGFtcCAlIE5TRUNfUEVSX1NFQywNCj4+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHRzX3N0YXJ0IC8gTlNFQ19QRVJfU0VDLA0KPj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdHNfc3RhcnQgJSBOU0VDX1BFUl9TRUMsDQo+PiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB0c19pbnB1dCAvIE5TRUNfUEVSX1NFQywNCj4+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHRzX2lucHV0ICUgTlNFQ19QRVJfU0VDKTsNCj4+ICsgICAgIH0NCj4+ICsg
ICAgICAgICAgICAgYnJlYWs7DQo+PiArICAgICBkZWZhdWx0Og0KPj4gKyAgICAgICAgICAgICBi
cmVhazsNCj4+ICsgICAgIH0NCj4+ICsNCj4+ICsgICAgIHJldHVybiBudW07DQo+PiArfQ0KPj4g
Kw0KPj4gK3N0YXRpYyBzdHJ1Y3QgdnB1X2luc3Rfb3BzIHZkZWNfaW5zdF9vcHMgPSB7DQo+PiAr
ICAgICAuY3RybF9pbml0ID0gdmRlY19jdHJsX2luaXQsDQo+PiArICAgICAuY2hlY2tfcmVhZHkg
PSB2ZGVjX2NoZWNrX3JlYWR5LA0KPj4gKyAgICAgLmJ1Zl9kb25lID0gdmRlY19idWZfZG9uZSwN
Cj4+ICsgICAgIC5nZXRfb25lX2ZyYW1lID0gdmRlY19mcmFtZV9kZWNvZGVkLA0KPj4gKyAgICAg
LnN0b3BfZG9uZSA9IHZkZWNfc3RvcF9kb25lLA0KPj4gKyAgICAgLmV2ZW50X25vdGlmeSA9IHZk
ZWNfZXZlbnRfbm90aWZ5LA0KPj4gKyAgICAgLnJlbGVhc2UgPSB2ZGVjX3JlbGVhc2UsDQo+PiAr
ICAgICAuY2xlYW51cCA9IHZkZWNfY2xlYW51cCwNCj4+ICsgICAgIC5zdGFydCA9IHZkZWNfc3Rh
cnRfc2Vzc2lvbiwNCj4+ICsgICAgIC5zdG9wID0gdmRlY19zdG9wX3Nlc3Npb24sDQo+PiArICAg
ICAucHJvY2Vzc19vdXRwdXQgPSB2ZGVjX3Byb2Nlc3Nfb3V0cHV0LA0KPj4gKyAgICAgLnByb2Nl
c3NfY2FwdHVyZSA9IHZkZWNfcHJvY2Vzc19jYXB0dXJlLA0KPj4gKyAgICAgLm9uX3F1ZXVlX2Vt
cHR5ID0gdmRlY19vbl9xdWV1ZV9lbXB0eSwNCj4+ICsgICAgIC5nZXRfZGVidWdfaW5mbyA9IHZk
ZWNfZ2V0X2RlYnVnX2luZm8sDQo+PiArICAgICAud2FpdF9wcmVwYXJlID0gdnB1X2luc3RfdW5s
b2NrLA0KPj4gKyAgICAgLndhaXRfZmluaXNoID0gdnB1X2luc3RfbG9jaywNCj4+ICt9Ow0KPj4g
Kw0KPj4gK3N0YXRpYyB2b2lkIHZkZWNfaW5pdChzdHJ1Y3QgZmlsZSAqZmlsZSkNCj4+ICt7DQo+
PiArICAgICBzdHJ1Y3QgdnB1X2luc3QgKmluc3QgPSB0b19pbnN0KGZpbGUpOw0KPj4gKyAgICAg
c3RydWN0IHZkZWNfdCAqdmRlYzsNCj4+ICsgICAgIHN0cnVjdCB2NGwyX2Zvcm1hdCBmOw0KPj4g
Kw0KPj4gKyAgICAgdmRlYyA9IGluc3QtPnByaXY7DQo+PiArICAgICB2ZGVjLT5mcmFtZV9kZXB0
aCA9IFZERUNfRlJBTUVfREVQVEg7DQo+PiArICAgICB2ZGVjLT50aW1lc3RhbXAgPSBWUFVfSU5W
QUxJRF9USU1FU1RBTVA7DQo+PiArICAgICB2ZGVjLT50c19zdGFydCA9IFZQVV9JTlZBTElEX1RJ
TUVTVEFNUDsNCj4+ICsgICAgIHZkZWMtPnRzX2lucHV0ID0gVlBVX0lOVkFMSURfVElNRVNUQU1Q
Ow0KPj4gKw0KPj4gKyAgICAgbWVtc2V0KCZmLCAwLCBzaXplb2YoZikpOw0KPj4gKyAgICAgZi50
eXBlID0gVjRMMl9CVUZfVFlQRV9WSURFT19PVVRQVVRfTVBMQU5FOw0KPj4gKyAgICAgZi5mbXQu
cGl4X21wLnBpeGVsZm9ybWF0ID0gVjRMMl9QSVhfRk1UX0gyNjQ7DQo+PiArICAgICBmLmZtdC5w
aXhfbXAud2lkdGggPSAxMjgwOw0KPj4gKyAgICAgZi5mbXQucGl4X21wLmhlaWdodCA9IDcyMDsN
Cj4+ICsgICAgIGYuZm10LnBpeF9tcC5maWVsZCA9IFY0TDJfRklFTERfTk9ORTsNCj4+ICsgICAg
IHZkZWNfc19mbXQoZmlsZSwgJmluc3QtPmZoLCAmZik7DQo+PiArDQo+PiArICAgICBtZW1zZXQo
JmYsIDAsIHNpemVvZihmKSk7DQo+PiArICAgICBmLnR5cGUgPSBWNEwyX0JVRl9UWVBFX1ZJREVP
X0NBUFRVUkVfTVBMQU5FOw0KPj4gKyAgICAgZi5mbXQucGl4X21wLnBpeGVsZm9ybWF0ID0gVjRM
Ml9QSVhfRk1UX05WMTJNXzhMMTI4Ow0KPj4gKyAgICAgZi5mbXQucGl4X21wLndpZHRoID0gMTI4
MDsNCj4+ICsgICAgIGYuZm10LnBpeF9tcC5oZWlnaHQgPSA3MjA7DQo+PiArICAgICBmLmZtdC5w
aXhfbXAuZmllbGQgPSBWNEwyX0ZJRUxEX05PTkU7DQo+PiArICAgICB2ZGVjX3NfZm10KGZpbGUs
ICZpbnN0LT5maCwgJmYpOw0KPj4gK30NCj4+ICsNCj4+ICtzdGF0aWMgaW50IHZkZWNfb3Blbihz
dHJ1Y3QgZmlsZSAqZmlsZSkNCj4+ICt7DQo+PiArICAgICBzdHJ1Y3QgdnB1X2luc3QgKmluc3Q7
DQo+PiArICAgICBzdHJ1Y3QgdmRlY190ICp2ZGVjOw0KPj4gKyAgICAgaW50IHJldDsNCj4+ICsN
Cj4+ICsgICAgIGluc3QgPSB2emFsbG9jKHNpemVvZigqaW5zdCkpOw0KPj4gKyAgICAgaWYgKCFp
bnN0KQ0KPj4gKyAgICAgICAgICAgICByZXR1cm4gLUVOT01FTTsNCj4+ICsNCj4+ICsgICAgIHZk
ZWMgPSB2emFsbG9jKHNpemVvZigqdmRlYykpOw0KPj4gKyAgICAgaWYgKCF2ZGVjKSB7DQo+PiAr
ICAgICAgICAgICAgIHZmcmVlKGluc3QpOw0KPj4gKyAgICAgICAgICAgICByZXR1cm4gLUVOT01F
TTsNCj4+ICsgICAgIH0NCj4+ICsNCj4+ICsgICAgIGluc3QtPm9wcyA9ICZ2ZGVjX2luc3Rfb3Bz
Ow0KPj4gKyAgICAgaW5zdC0+Zm9ybWF0cyA9IHZkZWNfZm9ybWF0czsNCj4+ICsgICAgIGluc3Qt
PnR5cGUgPSBWUFVfQ09SRV9UWVBFX0RFQzsNCj4+ICsgICAgIGluc3QtPnByaXYgPSB2ZGVjOw0K
Pj4gKw0KPj4gKyAgICAgcmV0ID0gdnB1X3Y0bDJfb3BlbihmaWxlLCBpbnN0KTsNCj4+ICsgICAg
IGlmIChyZXQpDQo+PiArICAgICAgICAgICAgIHJldHVybiByZXQ7DQo+PiArDQo+PiArICAgICB2
ZGVjLT5maXhlZF9mbXQgPSBmYWxzZTsNCj4+ICsgICAgIGluc3QtPm1pbl9idWZmZXJfY2FwID0g
VkRFQ19NSU5fQlVGRkVSX0NBUDsNCj4+ICsgICAgIHZkZWNfaW5pdChmaWxlKTsNCj4+ICsNCj4+
ICsgICAgIHJldHVybiAwOw0KPj4gK30NCj4+ICsNCj4+ICtzdGF0aWMgX19wb2xsX3QgdmRlY19w
b2xsKHN0cnVjdCBmaWxlICpmaWxlLCBwb2xsX3RhYmxlICp3YWl0KQ0KPj4gK3sNCj4+ICsgICAg
IHN0cnVjdCB2cHVfaW5zdCAqaW5zdCA9IHRvX2luc3QoZmlsZSk7DQo+PiArICAgICBzdHJ1Y3Qg
dmIyX3F1ZXVlICpzcmNfcSwgKmRzdF9xOw0KPj4gKyAgICAgX19wb2xsX3QgcmV0Ow0KPj4gKw0K
Pj4gKyAgICAgcmV0ID0gdjRsMl9tMm1fZm9wX3BvbGwoZmlsZSwgd2FpdCk7DQo+PiArICAgICBz
cmNfcSA9IHY0bDJfbTJtX2dldF9zcmNfdnEoaW5zdC0+ZmgubTJtX2N0eCk7DQo+PiArICAgICBk
c3RfcSA9IHY0bDJfbTJtX2dldF9kc3RfdnEoaW5zdC0+ZmgubTJtX2N0eCk7DQo+PiArICAgICBp
ZiAodmIyX2lzX3N0cmVhbWluZyhzcmNfcSkgJiYgIXZiMl9pc19zdHJlYW1pbmcoZHN0X3EpKQ0K
Pj4gKyAgICAgICAgICAgICByZXQgJj0gKH5FUE9MTEVSUik7DQo+PiArICAgICBpZiAoIXNyY19x
LT5lcnJvciAmJiAhZHN0X3EtPmVycm9yICYmDQo+PiArICAgICAgICAgKHZiMl9pc19zdHJlYW1p
bmcoc3JjX3EpICYmIGxpc3RfZW1wdHkoJnNyY19xLT5xdWV1ZWRfbGlzdCkpICYmDQo+PiArICAg
ICAgICAgKHZiMl9pc19zdHJlYW1pbmcoZHN0X3EpICYmIGxpc3RfZW1wdHkoJmRzdF9xLT5xdWV1
ZWRfbGlzdCkpKQ0KPj4gKyAgICAgICAgICAgICByZXQgJj0gKH5FUE9MTEVSUik7DQo+PiArDQo+
PiArICAgICByZXR1cm4gcmV0Ow0KPj4gK30NCj4+ICsNCj4+ICtzdGF0aWMgY29uc3Qgc3RydWN0
IHY0bDJfZmlsZV9vcGVyYXRpb25zIHZkZWNfZm9wcyA9IHsNCj4+ICsgICAgIC5vd25lciA9IFRI
SVNfTU9EVUxFLA0KPj4gKyAgICAgLm9wZW4gPSB2ZGVjX29wZW4sDQo+PiArICAgICAucmVsZWFz
ZSA9IHZwdV92NGwyX2Nsb3NlLA0KPj4gKyAgICAgLnVubG9ja2VkX2lvY3RsID0gdmlkZW9faW9j
dGwyLA0KPj4gKyAgICAgLnBvbGwgPSB2ZGVjX3BvbGwsDQo+PiArICAgICAubW1hcCA9IHY0bDJf
bTJtX2ZvcF9tbWFwLA0KPj4gK307DQo+PiArDQo+PiArY29uc3Qgc3RydWN0IHY0bDJfaW9jdGxf
b3BzICp2ZGVjX2dldF9pb2N0bF9vcHModm9pZCkNCj4+ICt7DQo+PiArICAgICByZXR1cm4gJnZk
ZWNfaW9jdGxfb3BzOw0KPj4gK30NCj4+ICsNCj4+ICtjb25zdCBzdHJ1Y3QgdjRsMl9maWxlX29w
ZXJhdGlvbnMgKnZkZWNfZ2V0X2ZvcHModm9pZCkNCj4+ICt7DQo+PiArICAgICByZXR1cm4gJnZk
ZWNfZm9wczsNCj4+ICt9DQoNCg==
