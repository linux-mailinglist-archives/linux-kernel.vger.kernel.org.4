Return-Path: <linux-kernel-owner@vger.kernel.org>
X-Original-To: lists+linux-kernel@lfdr.de
Delivered-To: lists+linux-kernel@lfdr.de
Received: from out1.vger.email (out1.vger.email [IPv6:2620:137:e000::1:20])
	by mail.lfdr.de (Postfix) with ESMTP id C43005EC59A
	for <lists+linux-kernel@lfdr.de>; Tue, 27 Sep 2022 16:11:44 +0200 (CEST)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S231637AbiI0OLl (ORCPT <rfc822;lists+linux-kernel@lfdr.de>);
        Tue, 27 Sep 2022 10:11:41 -0400
Received: from lindbergh.monkeyblade.net ([23.128.96.19]:37552 "EHLO
        lindbergh.monkeyblade.net" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
        with ESMTP id S230149AbiI0OLc (ORCPT
        <rfc822;linux-kernel@vger.kernel.org>);
        Tue, 27 Sep 2022 10:11:32 -0400
Received: from smtp-out1.suse.de (smtp-out1.suse.de [IPv6:2001:67c:2178:6::1c])
        by lindbergh.monkeyblade.net (Postfix) with ESMTPS id E10F9A0619
        for <linux-kernel@vger.kernel.org>; Tue, 27 Sep 2022 07:11:29 -0700 (PDT)
Received: from imap2.suse-dmz.suse.de (imap2.suse-dmz.suse.de [192.168.254.74])
        (using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits)
         key-exchange X25519 server-signature ECDSA (P-521) server-digest SHA512)
        (No client certificate requested)
        by smtp-out1.suse.de (Postfix) with ESMTPS id 3658B21EA3;
        Tue, 27 Sep 2022 14:11:28 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=suse.de; s=susede2_rsa;
        t=1664287888; h=from:from:reply-to:date:date:message-id:message-id:to:to:cc:cc:
         mime-version:mime-version:content-type:content-type:
         in-reply-to:in-reply-to:references:references;
        bh=4Gs2kEEXPWw8vO1C2gEMXnJnBJTxf0UA1/lUrHbqkNA=;
        b=OEXGCLQVDDhZ90tqpTdhiNeEUI4kIbcjSBjKa4C3iw5ydwWyZIglT3szRei6kYK7Ij1THB
        iZ33ZLzckAI1TDAm1lyPnkmCVMIjvVJJ2B5oNhBFTsu/rKg6drPlU/WM9v9+W9LebpnnsU
        9P9i+Fb4y4C766XjrY9tTT0ao380bzk=
DKIM-Signature: v=1; a=ed25519-sha256; c=relaxed/relaxed; d=suse.de;
        s=susede2_ed25519; t=1664287888;
        h=from:from:reply-to:date:date:message-id:message-id:to:to:cc:cc:
         mime-version:mime-version:content-type:content-type:
         in-reply-to:in-reply-to:references:references;
        bh=4Gs2kEEXPWw8vO1C2gEMXnJnBJTxf0UA1/lUrHbqkNA=;
        b=xFJenLK09yl5B9GuvcYmJ2U0WILvMRMEomoZ8vKm02QGZl3ggYvDrwJ4lQ5wCHukhakIm7
        8UD/VTnf4hvYL9CA==
Received: from imap2.suse-dmz.suse.de (imap2.suse-dmz.suse.de [192.168.254.74])
        (using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits)
         key-exchange X25519 server-signature ECDSA (P-521) server-digest SHA512)
        (No client certificate requested)
        by imap2.suse-dmz.suse.de (Postfix) with ESMTPS id DF666139B3;
        Tue, 27 Sep 2022 14:11:27 +0000 (UTC)
Received: from dovecot-director2.suse.de ([192.168.254.65])
        by imap2.suse-dmz.suse.de with ESMTPSA
        id ZsLQNY8EM2OSOQAAMHmgww
        (envelope-from <tiwai@suse.de>); Tue, 27 Sep 2022 14:11:27 +0000
Date:   Tue, 27 Sep 2022 16:11:27 +0200
Message-ID: <87ill8gb5c.wl-tiwai@suse.de>
From:   Takashi Iwai <tiwai@suse.de>
To:     Brent Lu <brent.lu@intel.com>
Cc:     alsa-devel@alsa-project.org, Jaroslav Kysela <perex@perex.cz>,
        Takashi Iwai <tiwai@suse.com>,
        Kai Vehmanen <kai.vehmanen@linux.intel.com>,
        Pierre-Louis Bossart <pierre-louis.bossart@linux.intel.com>,
        Mohan Kumar <mkumard@nvidia.com>,
        Ville =?ISO-8859-1?Q?Syrj=E4l=E4?= 
        <ville.syrjala@linux.intel.com>, Yong Zhi <yong.zhi@intel.com>,
        linux-kernel@vger.kernel.org
Subject: Re: [PATCH] ALSA: hda/hdmi: run eld notify in delay work
In-Reply-To: <20220927135807.4097052-1-brent.lu@intel.com>
References: <20220927135807.4097052-1-brent.lu@intel.com>
User-Agent: Wanderlust/2.15.9 (Almost Unreal) Emacs/27.2 Mule/6.0
MIME-Version: 1.0 (generated by SEMI-EPG 1.14.7 - "Harue")
Content-Type: text/plain; charset=US-ASCII
X-Spam-Status: No, score=-2.1 required=5.0 tests=BAYES_00,DKIM_SIGNED,
        DKIM_VALID,DKIM_VALID_AU,DKIM_VALID_EF,RCVD_IN_DNSWL_NONE,
        SPF_HELO_NONE,SPF_PASS autolearn=ham autolearn_force=no version=3.4.6
X-Spam-Checker-Version: SpamAssassin 3.4.6 (2021-04-09) on
        lindbergh.monkeyblade.net
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org

On Tue, 27 Sep 2022 15:58:07 +0200,
Brent Lu wrote:
> 
> During resolution change, display driver would disable HDMI audio then
> enable it in a short time. There is possibility that eld notify for
> HDMI audio enable is called when previous runtime suspend is still
> running. In this case, the elf nofity just returns and not updating the
> status of corresponding HDMI pin/port. Here we move the eld nofity to
> a delay work so we don't lose it.
> 
> Signed-off-by: Brent Lu <brent.lu@intel.com>

We have already a dedicated per-pin work for the delayed ELD check.
Can we reuse it instead of inventing yet another work?
More work needs more cares, and better to avoid unless really needed
(e.g. you forgot cleanup at suspend/removal in this patch).


thanks,

Takashi
